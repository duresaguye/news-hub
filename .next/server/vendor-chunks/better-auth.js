"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/better-auth";
exports.ids = ["vendor-chunks/better-auth"];
exports.modules = {

/***/ "(ssr)/./node_modules/better-auth/dist/client/react/index.mjs":
/*!**************************************************************!*\
  !*** ./node_modules/better-auth/dist/client/react/index.mjs ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter),\n/* harmony export */   createAuthClient: () => (/* binding */ createAuthClient),\n/* harmony export */   useStore: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var _shared_better_auth_RKafzlkP_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/better-auth.RKafzlkP.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/listen-keys/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _shared_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/better-auth.DR3R5wdU.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/env */ \"(ssr)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/error */ \"(ssr)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_BYWGbmZ5_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../shared/better-auth.BYWGbmZ5.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs\");\n/* harmony import */ var _shared_better_auth_msGOU0m9_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../shared/better-auth.msGOU0m9.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs\");\n\n\n\n\n\n\n\n\n\n\nfunction useStore(store, options = {}) {\n  let snapshotRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(store.get());\n  const { keys, deps = [store, keys] } = options;\n  let subscribe = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((onChange) => {\n    const emitChange = (value) => {\n      if (snapshotRef.current === value) return;\n      snapshotRef.current = value;\n      onChange();\n    };\n    emitChange(store.value);\n    if (keys?.length) {\n      return (0,nanostores__WEBPACK_IMPORTED_MODULE_8__.listenKeys)(store, keys, emitChange);\n    }\n    return store.listen(emitChange);\n  }, deps);\n  let get = () => snapshotRef.current;\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe, get, get);\n}\n\nfunction getAtomKey(str) {\n  return `use${capitalizeFirstLetter(str)}`;\n}\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nfunction createAuthClient(options) {\n  const {\n    pluginPathMethods,\n    pluginsActions,\n    pluginsAtoms,\n    $fetch,\n    $store,\n    atomListeners\n  } = (0,_shared_better_auth_RKafzlkP_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(options);\n  let resolvedHooks = {};\n  for (const [key, value] of Object.entries(pluginsAtoms)) {\n    resolvedHooks[getAtomKey(key)] = () => useStore(value);\n  }\n  const routes = {\n    ...pluginsActions,\n    ...resolvedHooks,\n    $fetch,\n    $store\n  };\n  const proxy = (0,_shared_better_auth_RKafzlkP_mjs__WEBPACK_IMPORTED_MODULE_0__.c)(\n    routes,\n    $fetch,\n    pluginPathMethods,\n    pluginsAtoms,\n    atomListeners\n  );\n  return proxy;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jbGllbnQvcmVhY3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUEwRztBQUNsRTtBQUMwQjtBQUNyQztBQUNrQjtBQUNoQjtBQUNFO0FBQ2M7QUFDQTs7QUFFL0MscUNBQXFDO0FBQ3JDLG9CQUFvQiw2Q0FBTTtBQUMxQixVQUFVLDZCQUE2QjtBQUN2QyxrQkFBa0Isa0RBQVc7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHNEQUFVO0FBQ3ZCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxTQUFTLDJEQUFvQjtBQUM3Qjs7QUFFQTtBQUNBLGVBQWUsMkJBQTJCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksRUFBRSxtRUFBZTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixtRUFBc0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NsaWVudC9yZWFjdC9pbmRleC5tanM/M2EzYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnIGFzIGdldENsaWVudENvbmZpZywgYyBhcyBjcmVhdGVEeW5hbWljUGF0aFByb3h5IH0gZnJvbSAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLlJLYWZ6bGtQLm1qcyc7XG5pbXBvcnQgeyBsaXN0ZW5LZXlzIH0gZnJvbSAnbmFub3N0b3Jlcyc7XG5pbXBvcnQgeyB1c2VSZWYsIHVzZUNhbGxiYWNrLCB1c2VTeW5jRXh0ZXJuYWxTdG9yZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CWVdHYm1aNS5tanMnO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGgubXNHT1UwbTkubWpzJztcblxuZnVuY3Rpb24gdXNlU3RvcmUoc3RvcmUsIG9wdGlvbnMgPSB7fSkge1xuICBsZXQgc25hcHNob3RSZWYgPSB1c2VSZWYoc3RvcmUuZ2V0KCkpO1xuICBjb25zdCB7IGtleXMsIGRlcHMgPSBbc3RvcmUsIGtleXNdIH0gPSBvcHRpb25zO1xuICBsZXQgc3Vic2NyaWJlID0gdXNlQ2FsbGJhY2soKG9uQ2hhbmdlKSA9PiB7XG4gICAgY29uc3QgZW1pdENoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgaWYgKHNuYXBzaG90UmVmLmN1cnJlbnQgPT09IHZhbHVlKSByZXR1cm47XG4gICAgICBzbmFwc2hvdFJlZi5jdXJyZW50ID0gdmFsdWU7XG4gICAgICBvbkNoYW5nZSgpO1xuICAgIH07XG4gICAgZW1pdENoYW5nZShzdG9yZS52YWx1ZSk7XG4gICAgaWYgKGtleXM/Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGxpc3RlbktleXMoc3RvcmUsIGtleXMsIGVtaXRDaGFuZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gc3RvcmUubGlzdGVuKGVtaXRDaGFuZ2UpO1xuICB9LCBkZXBzKTtcbiAgbGV0IGdldCA9ICgpID0+IHNuYXBzaG90UmVmLmN1cnJlbnQ7XG4gIHJldHVybiB1c2VTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIGdldCwgZ2V0KTtcbn1cblxuZnVuY3Rpb24gZ2V0QXRvbUtleShzdHIpIHtcbiAgcmV0dXJuIGB1c2Uke2NhcGl0YWxpemVGaXJzdExldHRlcihzdHIpfWA7XG59XG5mdW5jdGlvbiBjYXBpdGFsaXplRmlyc3RMZXR0ZXIoc3RyKSB7XG4gIHJldHVybiBzdHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSk7XG59XG5mdW5jdGlvbiBjcmVhdGVBdXRoQ2xpZW50KG9wdGlvbnMpIHtcbiAgY29uc3Qge1xuICAgIHBsdWdpblBhdGhNZXRob2RzLFxuICAgIHBsdWdpbnNBY3Rpb25zLFxuICAgIHBsdWdpbnNBdG9tcyxcbiAgICAkZmV0Y2gsXG4gICAgJHN0b3JlLFxuICAgIGF0b21MaXN0ZW5lcnNcbiAgfSA9IGdldENsaWVudENvbmZpZyhvcHRpb25zKTtcbiAgbGV0IHJlc29sdmVkSG9va3MgPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocGx1Z2luc0F0b21zKSkge1xuICAgIHJlc29sdmVkSG9va3NbZ2V0QXRvbUtleShrZXkpXSA9ICgpID0+IHVzZVN0b3JlKHZhbHVlKTtcbiAgfVxuICBjb25zdCByb3V0ZXMgPSB7XG4gICAgLi4ucGx1Z2luc0FjdGlvbnMsXG4gICAgLi4ucmVzb2x2ZWRIb29rcyxcbiAgICAkZmV0Y2gsXG4gICAgJHN0b3JlXG4gIH07XG4gIGNvbnN0IHByb3h5ID0gY3JlYXRlRHluYW1pY1BhdGhQcm94eShcbiAgICByb3V0ZXMsXG4gICAgJGZldGNoLFxuICAgIHBsdWdpblBhdGhNZXRob2RzLFxuICAgIHBsdWdpbnNBdG9tcyxcbiAgICBhdG9tTGlzdGVuZXJzXG4gICk7XG4gIHJldHVybiBwcm94eTtcbn1cblxuZXhwb3J0IHsgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyLCBjcmVhdGVBdXRoQ2xpZW50LCB1c2VTdG9yZSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/client/react/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   u: () => (/* binding */ useAuthQuery)\n/* harmony export */ });\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/atom/index.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/lifecycle/index.js\");\n\n\nconst isServer = typeof window === \"undefined\";\nconst useAuthQuery = (initializedAtom, path, $fetch, options) => {\n  const value = (0,nanostores__WEBPACK_IMPORTED_MODULE_0__.atom)({\n    data: null,\n    error: null,\n    isPending: true,\n    isRefetching: false,\n    refetch: (queryParams) => {\n      return fn(queryParams);\n    }\n  });\n  const fn = (queryParams) => {\n    const opts = typeof options === \"function\" ? options({\n      data: value.get().data,\n      error: value.get().error,\n      isPending: value.get().isPending\n    }) : options;\n    $fetch(path, {\n      ...opts,\n      query: {\n        ...opts?.query,\n        ...queryParams?.query\n      },\n      async onSuccess(context) {\n        value.set({\n          data: context.data,\n          error: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onSuccess?.(context);\n      },\n      async onError(context) {\n        const { request } = context;\n        const retryAttempts = typeof request.retry === \"number\" ? request.retry : request.retry?.attempts;\n        const retryAttempt = request.retryAttempt || 0;\n        if (retryAttempts && retryAttempt < retryAttempts) return;\n        value.set({\n          error: context.error,\n          data: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onError?.(context);\n      },\n      async onRequest(context) {\n        const currentValue = value.get();\n        value.set({\n          isPending: currentValue.data === null,\n          data: currentValue.data,\n          error: null,\n          isRefetching: true,\n          refetch: value.value.refetch\n        });\n        await opts?.onRequest?.(context);\n      }\n    }).catch((error) => {\n      value.set({\n        error,\n        data: null,\n        isPending: false,\n        isRefetching: false,\n        refetch: value.value.refetch\n      });\n    });\n  };\n  initializedAtom = Array.isArray(initializedAtom) ? initializedAtom : [initializedAtom];\n  let isMounted = false;\n  for (const initAtom of initializedAtom) {\n    initAtom.subscribe(() => {\n      if (isServer) {\n        return;\n      }\n      if (isMounted) {\n        fn();\n      } else {\n        (0,nanostores__WEBPACK_IMPORTED_MODULE_1__.onMount)(value, () => {\n          const timeoutId = setTimeout(() => {\n            if (!isMounted) {\n              fn();\n              isMounted = true;\n            }\n          }, 0);\n          return () => {\n            value.off();\n            initAtom.off();\n            clearTimeout(timeoutId);\n          };\n        });\n      }\n    });\n  }\n  return value;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQllXR2JtWjUubWpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQzs7QUFFM0M7QUFDQTtBQUNBLGdCQUFnQixnREFBSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsUUFBUSxtREFBTztBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRTZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQllXR2JtWjUubWpzPzE3YWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXRvbSwgb25Nb3VudCB9IGZyb20gJ25hbm9zdG9yZXMnO1xuXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCI7XG5jb25zdCB1c2VBdXRoUXVlcnkgPSAoaW5pdGlhbGl6ZWRBdG9tLCBwYXRoLCAkZmV0Y2gsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdmFsdWUgPSBhdG9tKHtcbiAgICBkYXRhOiBudWxsLFxuICAgIGVycm9yOiBudWxsLFxuICAgIGlzUGVuZGluZzogdHJ1ZSxcbiAgICBpc1JlZmV0Y2hpbmc6IGZhbHNlLFxuICAgIHJlZmV0Y2g6IChxdWVyeVBhcmFtcykgPT4ge1xuICAgICAgcmV0dXJuIGZuKHF1ZXJ5UGFyYW1zKTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBmbiA9IChxdWVyeVBhcmFtcykgPT4ge1xuICAgIGNvbnN0IG9wdHMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJmdW5jdGlvblwiID8gb3B0aW9ucyh7XG4gICAgICBkYXRhOiB2YWx1ZS5nZXQoKS5kYXRhLFxuICAgICAgZXJyb3I6IHZhbHVlLmdldCgpLmVycm9yLFxuICAgICAgaXNQZW5kaW5nOiB2YWx1ZS5nZXQoKS5pc1BlbmRpbmdcbiAgICB9KSA6IG9wdGlvbnM7XG4gICAgJGZldGNoKHBhdGgsIHtcbiAgICAgIC4uLm9wdHMsXG4gICAgICBxdWVyeToge1xuICAgICAgICAuLi5vcHRzPy5xdWVyeSxcbiAgICAgICAgLi4ucXVlcnlQYXJhbXM/LnF1ZXJ5XG4gICAgICB9LFxuICAgICAgYXN5bmMgb25TdWNjZXNzKGNvbnRleHQpIHtcbiAgICAgICAgdmFsdWUuc2V0KHtcbiAgICAgICAgICBkYXRhOiBjb250ZXh0LmRhdGEsXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgaXNQZW5kaW5nOiBmYWxzZSxcbiAgICAgICAgICBpc1JlZmV0Y2hpbmc6IGZhbHNlLFxuICAgICAgICAgIHJlZmV0Y2g6IHZhbHVlLnZhbHVlLnJlZmV0Y2hcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IG9wdHM/Lm9uU3VjY2Vzcz8uKGNvbnRleHQpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIG9uRXJyb3IoY29udGV4dCkge1xuICAgICAgICBjb25zdCB7IHJlcXVlc3QgfSA9IGNvbnRleHQ7XG4gICAgICAgIGNvbnN0IHJldHJ5QXR0ZW1wdHMgPSB0eXBlb2YgcmVxdWVzdC5yZXRyeSA9PT0gXCJudW1iZXJcIiA/IHJlcXVlc3QucmV0cnkgOiByZXF1ZXN0LnJldHJ5Py5hdHRlbXB0cztcbiAgICAgICAgY29uc3QgcmV0cnlBdHRlbXB0ID0gcmVxdWVzdC5yZXRyeUF0dGVtcHQgfHwgMDtcbiAgICAgICAgaWYgKHJldHJ5QXR0ZW1wdHMgJiYgcmV0cnlBdHRlbXB0IDwgcmV0cnlBdHRlbXB0cykgcmV0dXJuO1xuICAgICAgICB2YWx1ZS5zZXQoe1xuICAgICAgICAgIGVycm9yOiBjb250ZXh0LmVycm9yLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgaXNQZW5kaW5nOiBmYWxzZSxcbiAgICAgICAgICBpc1JlZmV0Y2hpbmc6IGZhbHNlLFxuICAgICAgICAgIHJlZmV0Y2g6IHZhbHVlLnZhbHVlLnJlZmV0Y2hcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IG9wdHM/Lm9uRXJyb3I/Lihjb250ZXh0KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBvblJlcXVlc3QoY29udGV4dCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB2YWx1ZS5nZXQoKTtcbiAgICAgICAgdmFsdWUuc2V0KHtcbiAgICAgICAgICBpc1BlbmRpbmc6IGN1cnJlbnRWYWx1ZS5kYXRhID09PSBudWxsLFxuICAgICAgICAgIGRhdGE6IGN1cnJlbnRWYWx1ZS5kYXRhLFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIGlzUmVmZXRjaGluZzogdHJ1ZSxcbiAgICAgICAgICByZWZldGNoOiB2YWx1ZS52YWx1ZS5yZWZldGNoXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBvcHRzPy5vblJlcXVlc3Q/Lihjb250ZXh0KTtcbiAgICAgIH1cbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIHZhbHVlLnNldCh7XG4gICAgICAgIGVycm9yLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBpc1BlbmRpbmc6IGZhbHNlLFxuICAgICAgICBpc1JlZmV0Y2hpbmc6IGZhbHNlLFxuICAgICAgICByZWZldGNoOiB2YWx1ZS52YWx1ZS5yZWZldGNoXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcbiAgaW5pdGlhbGl6ZWRBdG9tID0gQXJyYXkuaXNBcnJheShpbml0aWFsaXplZEF0b20pID8gaW5pdGlhbGl6ZWRBdG9tIDogW2luaXRpYWxpemVkQXRvbV07XG4gIGxldCBpc01vdW50ZWQgPSBmYWxzZTtcbiAgZm9yIChjb25zdCBpbml0QXRvbSBvZiBpbml0aWFsaXplZEF0b20pIHtcbiAgICBpbml0QXRvbS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgaWYgKGlzU2VydmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChpc01vdW50ZWQpIHtcbiAgICAgICAgZm4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9uTW91bnQodmFsdWUsICgpID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghaXNNb3VudGVkKSB7XG4gICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICAgIGlzTW91bnRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHZhbHVlLm9mZigpO1xuICAgICAgICAgICAgaW5pdEF0b20ub2ZmKCk7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xuXG5leHBvcnQgeyB1c2VBdXRoUXVlcnkgYXMgdSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getBaseURL),\n/* harmony export */   b: () => (/* binding */ getHost),\n/* harmony export */   c: () => (/* binding */ getProtocol),\n/* harmony export */   g: () => (/* binding */ getOrigin)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(ssr)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/error */ \"(ssr)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n\n\n\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    const pathname = parsedUrl.pathname.replace(/\\/+$/, \"\") || \"/\";\n    return pathname !== \"/\";\n  } catch (error) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  const trimmedUrl = url.replace(/\\/+$/, \"\");\n  if (!path || path === \"/\") {\n    return trimmedUrl;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${trimmedUrl}${path}`;\n}\nfunction getBaseURL(url, path, request, loadEnv) {\n  if (url) {\n    return withPath(url, path);\n  }\n  if (loadEnv !== false) {\n    const fromEnv = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n    if (fromEnv) {\n      return withPath(fromEnv, path);\n    }\n  }\n  const fromRequest = request?.headers.get(\"x-forwarded-host\");\n  const fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n  if (fromRequest && fromRequestProto) {\n    return withPath(`${fromRequestProto}://${fromRequest}`, path);\n  }\n  if (request) {\n    const url2 = getOrigin(request.url);\n    if (!url2) {\n      throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n        \"Could not get origin from request. Please provide a valid base URL.\"\n      );\n    }\n    return withPath(url2, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  } catch (error) {\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUE0QztBQUNjOztBQUUxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGNBQWMsb0VBQWU7QUFDN0IsMkJBQTJCLElBQUk7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLEtBQUs7QUFDaEQsWUFBWSxXQUFXLEVBQUUsS0FBSztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQUcsb0JBQW9CLHNEQUFHLGdDQUFnQyxzREFBRywyQkFBMkIsc0RBQUcsZ0NBQWdDLHNEQUFHLDBCQUEwQixzREFBRyxvQkFBb0Isc0RBQUc7QUFDdE07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUJBQWlCLEtBQUssWUFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvRUFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFMkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanM/MmM3ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlbnYgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuXG5mdW5jdGlvbiBjaGVja0hhc1BhdGgodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIGNvbnN0IHBhdGhuYW1lID0gcGFyc2VkVXJsLnBhdGhuYW1lLnJlcGxhY2UoL1xcLyskLywgXCJcIikgfHwgXCIvXCI7XG4gICAgcmV0dXJuIHBhdGhuYW1lICE9PSBcIi9cIjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgYEludmFsaWQgYmFzZSBVUkw6ICR7dXJsfS4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBiYXNlIFVSTC5gXG4gICAgKTtcbiAgfVxufVxuZnVuY3Rpb24gd2l0aFBhdGgodXJsLCBwYXRoID0gXCIvYXBpL2F1dGhcIikge1xuICBjb25zdCBoYXNQYXRoID0gY2hlY2tIYXNQYXRoKHVybCk7XG4gIGlmIChoYXNQYXRoKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICBjb25zdCB0cmltbWVkVXJsID0gdXJsLnJlcGxhY2UoL1xcLyskLywgXCJcIik7XG4gIGlmICghcGF0aCB8fCBwYXRoID09PSBcIi9cIikge1xuICAgIHJldHVybiB0cmltbWVkVXJsO1xuICB9XG4gIHBhdGggPSBwYXRoLnN0YXJ0c1dpdGgoXCIvXCIpID8gcGF0aCA6IGAvJHtwYXRofWA7XG4gIHJldHVybiBgJHt0cmltbWVkVXJsfSR7cGF0aH1gO1xufVxuZnVuY3Rpb24gZ2V0QmFzZVVSTCh1cmwsIHBhdGgsIHJlcXVlc3QsIGxvYWRFbnYpIHtcbiAgaWYgKHVybCkge1xuICAgIHJldHVybiB3aXRoUGF0aCh1cmwsIHBhdGgpO1xuICB9XG4gIGlmIChsb2FkRW52ICE9PSBmYWxzZSkge1xuICAgIGNvbnN0IGZyb21FbnYgPSBlbnYuQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5ORVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52LlBVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0JFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTlVYVF9QVUJMSUNfQVVUSF9VUkwgfHwgKGVudi5CQVNFX1VSTCAhPT0gXCIvXCIgPyBlbnYuQkFTRV9VUkwgOiB2b2lkIDApO1xuICAgIGlmIChmcm9tRW52KSB7XG4gICAgICByZXR1cm4gd2l0aFBhdGgoZnJvbUVudiwgcGF0aCk7XG4gICAgfVxuICB9XG4gIGNvbnN0IGZyb21SZXF1ZXN0ID0gcmVxdWVzdD8uaGVhZGVycy5nZXQoXCJ4LWZvcndhcmRlZC1ob3N0XCIpO1xuICBjb25zdCBmcm9tUmVxdWVzdFByb3RvID0gcmVxdWVzdD8uaGVhZGVycy5nZXQoXCJ4LWZvcndhcmRlZC1wcm90b1wiKTtcbiAgaWYgKGZyb21SZXF1ZXN0ICYmIGZyb21SZXF1ZXN0UHJvdG8pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgoYCR7ZnJvbVJlcXVlc3RQcm90b306Ly8ke2Zyb21SZXF1ZXN0fWAsIHBhdGgpO1xuICB9XG4gIGlmIChyZXF1ZXN0KSB7XG4gICAgY29uc3QgdXJsMiA9IGdldE9yaWdpbihyZXF1ZXN0LnVybCk7XG4gICAgaWYgKCF1cmwyKSB7XG4gICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICBcIkNvdWxkIG5vdCBnZXQgb3JpZ2luIGZyb20gcmVxdWVzdC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBiYXNlIFVSTC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHdpdGhQYXRoKHVybDIsIHBhdGgpO1xuICB9XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbikge1xuICAgIHJldHVybiB3aXRoUGF0aCh3aW5kb3cubG9jYXRpb24ub3JpZ2luLCBwYXRoKTtcbiAgfVxuICByZXR1cm4gdm9pZCAwO1xufVxuZnVuY3Rpb24gZ2V0T3JpZ2luKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLm9yaWdpbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0UHJvdG9jb2wodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwucHJvdG9jb2w7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldEhvc3QodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwuaG9zdDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgeyBnZXRCYXNlVVJMIGFzIGEsIGdldEhvc3QgYXMgYiwgZ2V0UHJvdG9jb2wgYXMgYywgZ2V0T3JpZ2luIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createDynamicPathProxy),\n/* harmony export */   g: () => (/* binding */ getClientConfig)\n/* harmony export */ });\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/atom/index.js\");\n/* harmony import */ var _better_auth_BYWGbmZ5_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.BYWGbmZ5.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs\");\n/* harmony import */ var _better_auth_msGOU0m9_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.msGOU0m9.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs\");\n\n\n\n\n\n\nconst redirectPlugin = {\n  id: \"redirect\",\n  name: \"Redirect\",\n  hooks: {\n    onSuccess(context) {\n      if (context.data?.url && context.data?.redirect) {\n        if (typeof window !== \"undefined\" && window.location) {\n          if (window.location) {\n            try {\n              window.location.href = context.data.url;\n            } catch {\n            }\n          }\n        }\n      }\n    }\n  }\n};\n\nfunction getSessionAtom($fetch) {\n  const $signal = (0,nanostores__WEBPACK_IMPORTED_MODULE_4__.atom)(false);\n  const session = (0,_better_auth_BYWGbmZ5_mjs__WEBPACK_IMPORTED_MODULE_2__.u)($signal, \"/get-session\", $fetch, {\n    method: \"GET\"\n  });\n  return {\n    session,\n    $sessionSignal: $signal\n  };\n}\n\nconst getClientConfig = (options, loadEnv) => {\n  const isCredentialsSupported = \"credentials\" in Request.prototype;\n  const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(options?.baseURL, options?.basePath, void 0, loadEnv) ?? \"/api/auth\";\n  const pluginsFetchPlugins = options?.plugins?.flatMap((plugin) => plugin.fetchPlugins).filter((pl) => pl !== void 0) || [];\n  const lifeCyclePlugin = {\n    id: \"lifecycle-hooks\",\n    name: \"lifecycle-hooks\",\n    hooks: {\n      onSuccess: options?.fetchOptions?.onSuccess,\n      onError: options?.fetchOptions?.onError,\n      onRequest: options?.fetchOptions?.onRequest,\n      onResponse: options?.fetchOptions?.onResponse\n    }\n  };\n  const { onSuccess, onError, onRequest, onResponse, ...restOfFetchOptions } = options?.fetchOptions || {};\n  const $fetch = (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.createFetch)({\n    baseURL,\n    ...isCredentialsSupported ? { credentials: \"include\" } : {},\n    method: \"GET\",\n    jsonParser(text) {\n      if (!text) {\n        return null;\n      }\n      return (0,_better_auth_msGOU0m9_mjs__WEBPACK_IMPORTED_MODULE_3__.p)(text, {\n        strict: false\n      });\n    },\n    customFetchImpl: fetch,\n    ...restOfFetchOptions,\n    plugins: [\n      lifeCyclePlugin,\n      ...restOfFetchOptions.plugins || [],\n      ...options?.disableDefaultFetchPlugins ? [] : [redirectPlugin],\n      ...pluginsFetchPlugins\n    ]\n  });\n  const { $sessionSignal, session } = getSessionAtom($fetch);\n  const plugins = options?.plugins || [];\n  let pluginsActions = {};\n  let pluginsAtoms = {\n    $sessionSignal,\n    session\n  };\n  let pluginPathMethods = {\n    \"/sign-out\": \"POST\",\n    \"/revoke-sessions\": \"POST\",\n    \"/revoke-other-sessions\": \"POST\",\n    \"/delete-user\": \"POST\"\n  };\n  const atomListeners = [\n    {\n      signal: \"$sessionSignal\",\n      matcher(path) {\n        return path === \"/sign-out\" || path === \"/update-user\" || path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path === \"/delete-user\" || path === \"/verify-email\";\n      }\n    }\n  ];\n  for (const plugin of plugins) {\n    if (plugin.getAtoms) {\n      Object.assign(pluginsAtoms, plugin.getAtoms?.($fetch));\n    }\n    if (plugin.pathMethods) {\n      Object.assign(pluginPathMethods, plugin.pathMethods);\n    }\n    if (plugin.atomListeners) {\n      atomListeners.push(...plugin.atomListeners);\n    }\n  }\n  const $store = {\n    notify: (signal) => {\n      pluginsAtoms[signal].set(\n        !pluginsAtoms[signal].get()\n      );\n    },\n    listen: (signal, listener) => {\n      pluginsAtoms[signal].subscribe(listener);\n    },\n    atoms: pluginsAtoms\n  };\n  for (const plugin of plugins) {\n    if (plugin.getActions) {\n      Object.assign(\n        pluginsActions,\n        plugin.getActions?.($fetch, $store, options)\n      );\n    }\n  }\n  return {\n    get baseURL() {\n      return baseURL;\n    },\n    pluginsActions,\n    pluginsAtoms,\n    pluginPathMethods,\n    atomListeners,\n    $fetch,\n    $store\n  };\n};\n\nfunction isAtom(value) {\n  return typeof value === \"object\" && value !== null && \"get\" in value && typeof value.get === \"function\" && \"lc\" in value && typeof value.lc === \"number\";\n}\n\nfunction getMethod(path, knownPathMethods, args) {\n  const method = knownPathMethods[path];\n  const { fetchOptions, query, ...body } = args || {};\n  if (method) {\n    return method;\n  }\n  if (fetchOptions?.method) {\n    return fetchOptions.method;\n  }\n  if (body && Object.keys(body).length > 0) {\n    return \"POST\";\n  }\n  return \"GET\";\n}\nfunction createDynamicPathProxy(routes, client, knownPathMethods, atoms, atomListeners) {\n  function createProxy(path = []) {\n    return new Proxy(function() {\n    }, {\n      get(_, prop) {\n        if (typeof prop !== \"string\") {\n          return void 0;\n        }\n        if (prop === \"then\" || prop === \"catch\" || prop === \"finally\") {\n          return void 0;\n        }\n        const fullPath = [...path, prop];\n        let current = routes;\n        for (const segment of fullPath) {\n          if (current && typeof current === \"object\" && segment in current) {\n            current = current[segment];\n          } else {\n            current = void 0;\n            break;\n          }\n        }\n        if (typeof current === \"function\") {\n          return current;\n        }\n        if (isAtom(current)) {\n          return current;\n        }\n        return createProxy(fullPath);\n      },\n      apply: async (_, __, args) => {\n        const routePath = \"/\" + path.map(\n          (segment) => segment.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`)\n        ).join(\"/\");\n        const arg = args[0] || {};\n        const fetchOptions = args[1] || {};\n        const { query, fetchOptions: argFetchOptions, ...body } = arg;\n        const options = {\n          ...fetchOptions,\n          ...argFetchOptions\n        };\n        const method = getMethod(routePath, knownPathMethods, arg);\n        return await client(routePath, {\n          ...options,\n          body: method === \"GET\" ? void 0 : {\n            ...body,\n            ...options?.body || {}\n          },\n          query: query || options?.query,\n          method,\n          async onSuccess(context) {\n            await options?.onSuccess?.(context);\n            if (!atomListeners) return;\n            const matches = atomListeners.filter((s) => s.matcher(routePath));\n            if (!matches.length) return;\n            for (const match of matches) {\n              const signal = atoms[match.signal];\n              if (!signal) return;\n              const val = signal.get();\n              setTimeout(() => {\n                signal.set(!val);\n              }, 10);\n            }\n          }\n        });\n      }\n    });\n  }\n  return createProxy();\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguUkthZnpsa1AubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBa0Q7QUFDVztBQUMzQjtBQUM2QjtBQUNIOztBQUU1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtCQUFrQixnREFBSTtBQUN0QixrQkFBa0IsNERBQVk7QUFDOUI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLDREQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1FQUFtRTtBQUM3RSxpQkFBaUIsZ0VBQVc7QUFDNUI7QUFDQSxrQ0FBa0MseUJBQXlCLElBQUk7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsNERBQVM7QUFDdEI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsVUFBVSwwQkFBMEI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsK0JBQStCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLGlFQUFpRSxxQkFBcUI7QUFDdEY7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGdEQUFnRDtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFNkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5SS2FmemxrUC5tanM/ZTk5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVGZXRjaCB9IGZyb20gJ0BiZXR0ZXItZmV0Y2gvZmV0Y2gnO1xuaW1wb3J0IHsgYSBhcyBnZXRCYXNlVVJMIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanMnO1xuaW1wb3J0IHsgYXRvbSB9IGZyb20gJ25hbm9zdG9yZXMnO1xuaW1wb3J0IHsgdSBhcyB1c2VBdXRoUXVlcnkgfSBmcm9tICcuL2JldHRlci1hdXRoLkJZV0dibVo1Lm1qcyc7XG5pbXBvcnQgeyBwIGFzIHBhcnNlSlNPTiB9IGZyb20gJy4vYmV0dGVyLWF1dGgubXNHT1UwbTkubWpzJztcblxuY29uc3QgcmVkaXJlY3RQbHVnaW4gPSB7XG4gIGlkOiBcInJlZGlyZWN0XCIsXG4gIG5hbWU6IFwiUmVkaXJlY3RcIixcbiAgaG9va3M6IHtcbiAgICBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgaWYgKGNvbnRleHQuZGF0YT8udXJsICYmIGNvbnRleHQuZGF0YT8ucmVkaXJlY3QpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBjb250ZXh0LmRhdGEudXJsO1xuICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBnZXRTZXNzaW9uQXRvbSgkZmV0Y2gpIHtcbiAgY29uc3QgJHNpZ25hbCA9IGF0b20oZmFsc2UpO1xuICBjb25zdCBzZXNzaW9uID0gdXNlQXV0aFF1ZXJ5KCRzaWduYWwsIFwiL2dldC1zZXNzaW9uXCIsICRmZXRjaCwge1xuICAgIG1ldGhvZDogXCJHRVRcIlxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uLFxuICAgICRzZXNzaW9uU2lnbmFsOiAkc2lnbmFsXG4gIH07XG59XG5cbmNvbnN0IGdldENsaWVudENvbmZpZyA9IChvcHRpb25zLCBsb2FkRW52KSA9PiB7XG4gIGNvbnN0IGlzQ3JlZGVudGlhbHNTdXBwb3J0ZWQgPSBcImNyZWRlbnRpYWxzXCIgaW4gUmVxdWVzdC5wcm90b3R5cGU7XG4gIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKG9wdGlvbnM/LmJhc2VVUkwsIG9wdGlvbnM/LmJhc2VQYXRoLCB2b2lkIDAsIGxvYWRFbnYpID8/IFwiL2FwaS9hdXRoXCI7XG4gIGNvbnN0IHBsdWdpbnNGZXRjaFBsdWdpbnMgPSBvcHRpb25zPy5wbHVnaW5zPy5mbGF0TWFwKChwbHVnaW4pID0+IHBsdWdpbi5mZXRjaFBsdWdpbnMpLmZpbHRlcigocGwpID0+IHBsICE9PSB2b2lkIDApIHx8IFtdO1xuICBjb25zdCBsaWZlQ3ljbGVQbHVnaW4gPSB7XG4gICAgaWQ6IFwibGlmZWN5Y2xlLWhvb2tzXCIsXG4gICAgbmFtZTogXCJsaWZlY3ljbGUtaG9va3NcIixcbiAgICBob29rczoge1xuICAgICAgb25TdWNjZXNzOiBvcHRpb25zPy5mZXRjaE9wdGlvbnM/Lm9uU3VjY2VzcyxcbiAgICAgIG9uRXJyb3I6IG9wdGlvbnM/LmZldGNoT3B0aW9ucz8ub25FcnJvcixcbiAgICAgIG9uUmVxdWVzdDogb3B0aW9ucz8uZmV0Y2hPcHRpb25zPy5vblJlcXVlc3QsXG4gICAgICBvblJlc3BvbnNlOiBvcHRpb25zPy5mZXRjaE9wdGlvbnM/Lm9uUmVzcG9uc2VcbiAgICB9XG4gIH07XG4gIGNvbnN0IHsgb25TdWNjZXNzLCBvbkVycm9yLCBvblJlcXVlc3QsIG9uUmVzcG9uc2UsIC4uLnJlc3RPZkZldGNoT3B0aW9ucyB9ID0gb3B0aW9ucz8uZmV0Y2hPcHRpb25zIHx8IHt9O1xuICBjb25zdCAkZmV0Y2ggPSBjcmVhdGVGZXRjaCh7XG4gICAgYmFzZVVSTCxcbiAgICAuLi5pc0NyZWRlbnRpYWxzU3VwcG9ydGVkID8geyBjcmVkZW50aWFsczogXCJpbmNsdWRlXCIgfSA6IHt9LFxuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBqc29uUGFyc2VyKHRleHQpIHtcbiAgICAgIGlmICghdGV4dCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXJzZUpTT04odGV4dCwge1xuICAgICAgICBzdHJpY3Q6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGN1c3RvbUZldGNoSW1wbDogZmV0Y2gsXG4gICAgLi4ucmVzdE9mRmV0Y2hPcHRpb25zLFxuICAgIHBsdWdpbnM6IFtcbiAgICAgIGxpZmVDeWNsZVBsdWdpbixcbiAgICAgIC4uLnJlc3RPZkZldGNoT3B0aW9ucy5wbHVnaW5zIHx8IFtdLFxuICAgICAgLi4ub3B0aW9ucz8uZGlzYWJsZURlZmF1bHRGZXRjaFBsdWdpbnMgPyBbXSA6IFtyZWRpcmVjdFBsdWdpbl0sXG4gICAgICAuLi5wbHVnaW5zRmV0Y2hQbHVnaW5zXG4gICAgXVxuICB9KTtcbiAgY29uc3QgeyAkc2Vzc2lvblNpZ25hbCwgc2Vzc2lvbiB9ID0gZ2V0U2Vzc2lvbkF0b20oJGZldGNoKTtcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnM/LnBsdWdpbnMgfHwgW107XG4gIGxldCBwbHVnaW5zQWN0aW9ucyA9IHt9O1xuICBsZXQgcGx1Z2luc0F0b21zID0ge1xuICAgICRzZXNzaW9uU2lnbmFsLFxuICAgIHNlc3Npb25cbiAgfTtcbiAgbGV0IHBsdWdpblBhdGhNZXRob2RzID0ge1xuICAgIFwiL3NpZ24tb3V0XCI6IFwiUE9TVFwiLFxuICAgIFwiL3Jldm9rZS1zZXNzaW9uc1wiOiBcIlBPU1RcIixcbiAgICBcIi9yZXZva2Utb3RoZXItc2Vzc2lvbnNcIjogXCJQT1NUXCIsXG4gICAgXCIvZGVsZXRlLXVzZXJcIjogXCJQT1NUXCJcbiAgfTtcbiAgY29uc3QgYXRvbUxpc3RlbmVycyA9IFtcbiAgICB7XG4gICAgICBzaWduYWw6IFwiJHNlc3Npb25TaWduYWxcIixcbiAgICAgIG1hdGNoZXIocGF0aCkge1xuICAgICAgICByZXR1cm4gcGF0aCA9PT0gXCIvc2lnbi1vdXRcIiB8fCBwYXRoID09PSBcIi91cGRhdGUtdXNlclwiIHx8IHBhdGguc3RhcnRzV2l0aChcIi9zaWduLWluXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9zaWduLXVwXCIpIHx8IHBhdGggPT09IFwiL2RlbGV0ZS11c2VyXCIgfHwgcGF0aCA9PT0gXCIvdmVyaWZ5LWVtYWlsXCI7XG4gICAgICB9XG4gICAgfVxuICBdO1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBwbHVnaW5zKSB7XG4gICAgaWYgKHBsdWdpbi5nZXRBdG9tcykge1xuICAgICAgT2JqZWN0LmFzc2lnbihwbHVnaW5zQXRvbXMsIHBsdWdpbi5nZXRBdG9tcz8uKCRmZXRjaCkpO1xuICAgIH1cbiAgICBpZiAocGx1Z2luLnBhdGhNZXRob2RzKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHBsdWdpblBhdGhNZXRob2RzLCBwbHVnaW4ucGF0aE1ldGhvZHMpO1xuICAgIH1cbiAgICBpZiAocGx1Z2luLmF0b21MaXN0ZW5lcnMpIHtcbiAgICAgIGF0b21MaXN0ZW5lcnMucHVzaCguLi5wbHVnaW4uYXRvbUxpc3RlbmVycyk7XG4gICAgfVxuICB9XG4gIGNvbnN0ICRzdG9yZSA9IHtcbiAgICBub3RpZnk6IChzaWduYWwpID0+IHtcbiAgICAgIHBsdWdpbnNBdG9tc1tzaWduYWxdLnNldChcbiAgICAgICAgIXBsdWdpbnNBdG9tc1tzaWduYWxdLmdldCgpXG4gICAgICApO1xuICAgIH0sXG4gICAgbGlzdGVuOiAoc2lnbmFsLCBsaXN0ZW5lcikgPT4ge1xuICAgICAgcGx1Z2luc0F0b21zW3NpZ25hbF0uc3Vic2NyaWJlKGxpc3RlbmVyKTtcbiAgICB9LFxuICAgIGF0b21zOiBwbHVnaW5zQXRvbXNcbiAgfTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2YgcGx1Z2lucykge1xuICAgIGlmIChwbHVnaW4uZ2V0QWN0aW9ucykge1xuICAgICAgT2JqZWN0LmFzc2lnbihcbiAgICAgICAgcGx1Z2luc0FjdGlvbnMsXG4gICAgICAgIHBsdWdpbi5nZXRBY3Rpb25zPy4oJGZldGNoLCAkc3RvcmUsIG9wdGlvbnMpXG4gICAgICApO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIGdldCBiYXNlVVJMKCkge1xuICAgICAgcmV0dXJuIGJhc2VVUkw7XG4gICAgfSxcbiAgICBwbHVnaW5zQWN0aW9ucyxcbiAgICBwbHVnaW5zQXRvbXMsXG4gICAgcGx1Z2luUGF0aE1ldGhvZHMsXG4gICAgYXRvbUxpc3RlbmVycyxcbiAgICAkZmV0Y2gsXG4gICAgJHN0b3JlXG4gIH07XG59O1xuXG5mdW5jdGlvbiBpc0F0b20odmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiBcImdldFwiIGluIHZhbHVlICYmIHR5cGVvZiB2YWx1ZS5nZXQgPT09IFwiZnVuY3Rpb25cIiAmJiBcImxjXCIgaW4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlLmxjID09PSBcIm51bWJlclwiO1xufVxuXG5mdW5jdGlvbiBnZXRNZXRob2QocGF0aCwga25vd25QYXRoTWV0aG9kcywgYXJncykge1xuICBjb25zdCBtZXRob2QgPSBrbm93blBhdGhNZXRob2RzW3BhdGhdO1xuICBjb25zdCB7IGZldGNoT3B0aW9ucywgcXVlcnksIC4uLmJvZHkgfSA9IGFyZ3MgfHwge307XG4gIGlmIChtZXRob2QpIHtcbiAgICByZXR1cm4gbWV0aG9kO1xuICB9XG4gIGlmIChmZXRjaE9wdGlvbnM/Lm1ldGhvZCkge1xuICAgIHJldHVybiBmZXRjaE9wdGlvbnMubWV0aG9kO1xuICB9XG4gIGlmIChib2R5ICYmIE9iamVjdC5rZXlzKGJvZHkpLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gXCJQT1NUXCI7XG4gIH1cbiAgcmV0dXJuIFwiR0VUXCI7XG59XG5mdW5jdGlvbiBjcmVhdGVEeW5hbWljUGF0aFByb3h5KHJvdXRlcywgY2xpZW50LCBrbm93blBhdGhNZXRob2RzLCBhdG9tcywgYXRvbUxpc3RlbmVycykge1xuICBmdW5jdGlvbiBjcmVhdGVQcm94eShwYXRoID0gW10pIHtcbiAgICByZXR1cm4gbmV3IFByb3h5KGZ1bmN0aW9uKCkge1xuICAgIH0sIHtcbiAgICAgIGdldChfLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb3AgPT09IFwidGhlblwiIHx8IHByb3AgPT09IFwiY2F0Y2hcIiB8fCBwcm9wID09PSBcImZpbmFsbHlcIikge1xuICAgICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZnVsbFBhdGggPSBbLi4ucGF0aCwgcHJvcF07XG4gICAgICAgIGxldCBjdXJyZW50ID0gcm91dGVzO1xuICAgICAgICBmb3IgKGNvbnN0IHNlZ21lbnQgb2YgZnVsbFBhdGgpIHtcbiAgICAgICAgICBpZiAoY3VycmVudCAmJiB0eXBlb2YgY3VycmVudCA9PT0gXCJvYmplY3RcIiAmJiBzZWdtZW50IGluIGN1cnJlbnQpIHtcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W3NlZ21lbnRdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdXJyZW50ID0gdm9pZCAwO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY3VycmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQXRvbShjdXJyZW50KSkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVQcm94eShmdWxsUGF0aCk7XG4gICAgICB9LFxuICAgICAgYXBwbHk6IGFzeW5jIChfLCBfXywgYXJncykgPT4ge1xuICAgICAgICBjb25zdCByb3V0ZVBhdGggPSBcIi9cIiArIHBhdGgubWFwKFxuICAgICAgICAgIChzZWdtZW50KSA9PiBzZWdtZW50LnJlcGxhY2UoL1tBLVpdL2csIChsZXR0ZXIpID0+IGAtJHtsZXR0ZXIudG9Mb3dlckNhc2UoKX1gKVxuICAgICAgICApLmpvaW4oXCIvXCIpO1xuICAgICAgICBjb25zdCBhcmcgPSBhcmdzWzBdIHx8IHt9O1xuICAgICAgICBjb25zdCBmZXRjaE9wdGlvbnMgPSBhcmdzWzFdIHx8IHt9O1xuICAgICAgICBjb25zdCB7IHF1ZXJ5LCBmZXRjaE9wdGlvbnM6IGFyZ0ZldGNoT3B0aW9ucywgLi4uYm9keSB9ID0gYXJnO1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIC4uLmZldGNoT3B0aW9ucyxcbiAgICAgICAgICAuLi5hcmdGZXRjaE9wdGlvbnNcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gZ2V0TWV0aG9kKHJvdXRlUGF0aCwga25vd25QYXRoTWV0aG9kcywgYXJnKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGNsaWVudChyb3V0ZVBhdGgsIHtcbiAgICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICAgIGJvZHk6IG1ldGhvZCA9PT0gXCJHRVRcIiA/IHZvaWQgMCA6IHtcbiAgICAgICAgICAgIC4uLmJvZHksXG4gICAgICAgICAgICAuLi5vcHRpb25zPy5ib2R5IHx8IHt9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBxdWVyeTogcXVlcnkgfHwgb3B0aW9ucz8ucXVlcnksXG4gICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgIGFzeW5jIG9uU3VjY2Vzcyhjb250ZXh0KSB7XG4gICAgICAgICAgICBhd2FpdCBvcHRpb25zPy5vblN1Y2Nlc3M/Lihjb250ZXh0KTtcbiAgICAgICAgICAgIGlmICghYXRvbUxpc3RlbmVycykgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGF0b21MaXN0ZW5lcnMuZmlsdGVyKChzKSA9PiBzLm1hdGNoZXIocm91dGVQYXRoKSk7XG4gICAgICAgICAgICBpZiAoIW1hdGNoZXMubGVuZ3RoKSByZXR1cm47XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2lnbmFsID0gYXRvbXNbbWF0Y2guc2lnbmFsXTtcbiAgICAgICAgICAgICAgaWYgKCFzaWduYWwpIHJldHVybjtcbiAgICAgICAgICAgICAgY29uc3QgdmFsID0gc2lnbmFsLmdldCgpO1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBzaWduYWwuc2V0KCF2YWwpO1xuICAgICAgICAgICAgICB9LCAxMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gY3JlYXRlUHJveHkoKTtcbn1cblxuZXhwb3J0IHsgY3JlYXRlRHluYW1pY1BhdGhQcm94eSBhcyBjLCBnZXRDbGllbnRDb25maWcgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   p: () => (/* binding */ parseJSON)\n/* harmony export */ });\nconst PROTO_POLLUTION_PATTERNS = {\n  proto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n  constructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n  protoShort: /\"__proto__\"\\s*:/,\n  constructorShort: /\"constructor\"\\s*:/\n};\nconst JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nconst SPECIAL_VALUES = {\n  true: true,\n  false: false,\n  null: null,\n  undefined: void 0,\n  nan: Number.NaN,\n  infinity: Number.POSITIVE_INFINITY,\n  \"-infinity\": Number.NEGATIVE_INFINITY\n};\nconst ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n  return date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n  const match = ISO_DATE_REGEX.exec(value);\n  if (!match) return null;\n  const [\n    ,\n    year,\n    month,\n    day,\n    hour,\n    minute,\n    second,\n    ms,\n    offsetSign,\n    offsetHour,\n    offsetMinute\n  ] = match;\n  let date = new Date(\n    Date.UTC(\n      parseInt(year, 10),\n      parseInt(month, 10) - 1,\n      parseInt(day, 10),\n      parseInt(hour, 10),\n      parseInt(minute, 10),\n      parseInt(second, 10),\n      ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0\n    )\n  );\n  if (offsetSign) {\n    const offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n    date.setUTCMinutes(date.getUTCMinutes() + offset);\n  }\n  return isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n  const {\n    strict = false,\n    warnings = false,\n    reviver,\n    parseDates = true\n  } = options;\n  if (typeof value !== \"string\") {\n    return value;\n  }\n  const trimmed = value.trim();\n  if (trimmed.length > 0 && trimmed[0] === '\"' && trimmed.endsWith('\"') && !trimmed.slice(1, -1).includes('\"')) {\n    return trimmed.slice(1, -1);\n  }\n  const lowerValue = trimmed.toLowerCase();\n  if (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n    return SPECIAL_VALUES[lowerValue];\n  }\n  if (!JSON_SIGNATURE.test(trimmed)) {\n    if (strict) {\n      throw new SyntaxError(\"[better-json] Invalid JSON\");\n    }\n    return value;\n  }\n  const hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n    ([key, pattern]) => {\n      const matches = pattern.test(trimmed);\n      if (matches && warnings) {\n        console.warn(\n          `[better-json] Detected potential prototype pollution attempt using ${key} pattern`\n        );\n      }\n      return matches;\n    }\n  );\n  if (hasProtoPattern && strict) {\n    throw new Error(\n      \"[better-json] Potential prototype pollution attempt detected\"\n    );\n  }\n  try {\n    const secureReviver = (key, value2) => {\n      if (key === \"__proto__\" || key === \"constructor\" && value2 && typeof value2 === \"object\" && \"prototype\" in value2) {\n        if (warnings) {\n          console.warn(\n            `[better-json] Dropping \"${key}\" key to prevent prototype pollution`\n          );\n        }\n        return void 0;\n      }\n      if (parseDates && typeof value2 === \"string\") {\n        const date = parseISODate(value2);\n        if (date) {\n          return date;\n        }\n      }\n      return reviver ? reviver(key, value2) : value2;\n    };\n    return JSON.parse(trimmed, secureReviver);\n  } catch (error) {\n    if (strict) {\n      throw error;\n    }\n    return value;\n  }\n}\nfunction parseJSON(value, options = { strict: true }) {\n  return betterJSONParse(value, options);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGgubXNHT1UwbTkubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBLHFCQUFxQixFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLFdBQVcsS0FBSyxNQUFNLEtBQUs7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLElBQUksa0JBQWtCLEVBQUUsTUFBTSxFQUFFO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0ZBQWdGLEtBQUs7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGNBQWM7QUFDcEQ7QUFDQTs7QUFFMEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5tc0dPVTBtOS5tanM/NGJmMSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQUk9UT19QT0xMVVRJT05fUEFUVEVSTlMgPSB7XG4gIHByb3RvOiAvXCIoPzpffFxcXFx1MHsyfTVbRmZdKXsyfSg/OnB8XFxcXHUwezJ9NzApKD86cnxcXFxcdTB7Mn03MikoPzpvfFxcXFx1MHsyfTZbRmZdKSg/OnR8XFxcXHUwezJ9NzQpKD86b3xcXFxcdTB7Mn02W0ZmXSkoPzpffFxcXFx1MHsyfTVbRmZdKXsyfVwiXFxzKjovLFxuICBjb25zdHJ1Y3RvcjogL1wiKD86Y3xcXFxcdTAwNjMpKD86b3xcXFxcdTAwNltGZl0pKD86bnxcXFxcdTAwNltFZV0pKD86c3xcXFxcdTAwNzMpKD86dHxcXFxcdTAwNzQpKD86cnxcXFxcdTAwNzIpKD86dXxcXFxcdTAwNzUpKD86Y3xcXFxcdTAwNjMpKD86dHxcXFxcdTAwNzQpKD86b3xcXFxcdTAwNltGZl0pKD86cnxcXFxcdTAwNzIpXCJcXHMqOi8sXG4gIHByb3RvU2hvcnQ6IC9cIl9fcHJvdG9fX1wiXFxzKjovLFxuICBjb25zdHJ1Y3RvclNob3J0OiAvXCJjb25zdHJ1Y3RvclwiXFxzKjovXG59O1xuY29uc3QgSlNPTl9TSUdOQVRVUkUgPSAvXlxccypbXCJbe118XlxccyotP1xcZHsxLDE2fShcXC5cXGR7MSwxN30pPyhbRWVdWystXT9cXGQrKT9cXHMqJC87XG5jb25zdCBTUEVDSUFMX1ZBTFVFUyA9IHtcbiAgdHJ1ZTogdHJ1ZSxcbiAgZmFsc2U6IGZhbHNlLFxuICBudWxsOiBudWxsLFxuICB1bmRlZmluZWQ6IHZvaWQgMCxcbiAgbmFuOiBOdW1iZXIuTmFOLFxuICBpbmZpbml0eTogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxuICBcIi1pbmZpbml0eVwiOiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFlcbn07XG5jb25zdCBJU09fREFURV9SRUdFWCA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSlUKFxcZHsyfSk6KFxcZHsyfSk6KFxcZHsyfSkoPzpcXC4oXFxkezEsN30pKT8oPzpafChbKy1dKShcXGR7Mn0pOihcXGR7Mn0pKSQvO1xuZnVuY3Rpb24gaXNWYWxpZERhdGUoZGF0ZSkge1xuICByZXR1cm4gZGF0ZSBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKGRhdGUuZ2V0VGltZSgpKTtcbn1cbmZ1bmN0aW9uIHBhcnNlSVNPRGF0ZSh2YWx1ZSkge1xuICBjb25zdCBtYXRjaCA9IElTT19EQVRFX1JFR0VYLmV4ZWModmFsdWUpO1xuICBpZiAoIW1hdGNoKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgW1xuICAgICxcbiAgICB5ZWFyLFxuICAgIG1vbnRoLFxuICAgIGRheSxcbiAgICBob3VyLFxuICAgIG1pbnV0ZSxcbiAgICBzZWNvbmQsXG4gICAgbXMsXG4gICAgb2Zmc2V0U2lnbixcbiAgICBvZmZzZXRIb3VyLFxuICAgIG9mZnNldE1pbnV0ZVxuICBdID0gbWF0Y2g7XG4gIGxldCBkYXRlID0gbmV3IERhdGUoXG4gICAgRGF0ZS5VVEMoXG4gICAgICBwYXJzZUludCh5ZWFyLCAxMCksXG4gICAgICBwYXJzZUludChtb250aCwgMTApIC0gMSxcbiAgICAgIHBhcnNlSW50KGRheSwgMTApLFxuICAgICAgcGFyc2VJbnQoaG91ciwgMTApLFxuICAgICAgcGFyc2VJbnQobWludXRlLCAxMCksXG4gICAgICBwYXJzZUludChzZWNvbmQsIDEwKSxcbiAgICAgIG1zID8gcGFyc2VJbnQobXMucGFkRW5kKDMsIFwiMFwiKSwgMTApIDogMFxuICAgIClcbiAgKTtcbiAgaWYgKG9mZnNldFNpZ24pIHtcbiAgICBjb25zdCBvZmZzZXQgPSAocGFyc2VJbnQob2Zmc2V0SG91ciwgMTApICogNjAgKyBwYXJzZUludChvZmZzZXRNaW51dGUsIDEwKSkgKiAob2Zmc2V0U2lnbiA9PT0gXCIrXCIgPyAtMSA6IDEpO1xuICAgIGRhdGUuc2V0VVRDTWludXRlcyhkYXRlLmdldFVUQ01pbnV0ZXMoKSArIG9mZnNldCk7XG4gIH1cbiAgcmV0dXJuIGlzVmFsaWREYXRlKGRhdGUpID8gZGF0ZSA6IG51bGw7XG59XG5mdW5jdGlvbiBiZXR0ZXJKU09OUGFyc2UodmFsdWUsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgc3RyaWN0ID0gZmFsc2UsXG4gICAgd2FybmluZ3MgPSBmYWxzZSxcbiAgICByZXZpdmVyLFxuICAgIHBhcnNlRGF0ZXMgPSB0cnVlXG4gIH0gPSBvcHRpb25zO1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGNvbnN0IHRyaW1tZWQgPSB2YWx1ZS50cmltKCk7XG4gIGlmICh0cmltbWVkLmxlbmd0aCA+IDAgJiYgdHJpbW1lZFswXSA9PT0gJ1wiJyAmJiB0cmltbWVkLmVuZHNXaXRoKCdcIicpICYmICF0cmltbWVkLnNsaWNlKDEsIC0xKS5pbmNsdWRlcygnXCInKSkge1xuICAgIHJldHVybiB0cmltbWVkLnNsaWNlKDEsIC0xKTtcbiAgfVxuICBjb25zdCBsb3dlclZhbHVlID0gdHJpbW1lZC50b0xvd2VyQ2FzZSgpO1xuICBpZiAobG93ZXJWYWx1ZS5sZW5ndGggPD0gOSAmJiBsb3dlclZhbHVlIGluIFNQRUNJQUxfVkFMVUVTKSB7XG4gICAgcmV0dXJuIFNQRUNJQUxfVkFMVUVTW2xvd2VyVmFsdWVdO1xuICB9XG4gIGlmICghSlNPTl9TSUdOQVRVUkUudGVzdCh0cmltbWVkKSkge1xuICAgIGlmIChzdHJpY3QpIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcIltiZXR0ZXItanNvbl0gSW52YWxpZCBKU09OXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgY29uc3QgaGFzUHJvdG9QYXR0ZXJuID0gT2JqZWN0LmVudHJpZXMoUFJPVE9fUE9MTFVUSU9OX1BBVFRFUk5TKS5zb21lKFxuICAgIChba2V5LCBwYXR0ZXJuXSkgPT4ge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IHBhdHRlcm4udGVzdCh0cmltbWVkKTtcbiAgICAgIGlmIChtYXRjaGVzICYmIHdhcm5pbmdzKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICBgW2JldHRlci1qc29uXSBEZXRlY3RlZCBwb3RlbnRpYWwgcHJvdG90eXBlIHBvbGx1dGlvbiBhdHRlbXB0IHVzaW5nICR7a2V5fSBwYXR0ZXJuYFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgfVxuICApO1xuICBpZiAoaGFzUHJvdG9QYXR0ZXJuICYmIHN0cmljdCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiW2JldHRlci1qc29uXSBQb3RlbnRpYWwgcHJvdG90eXBlIHBvbGx1dGlvbiBhdHRlbXB0IGRldGVjdGVkXCJcbiAgICApO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3Qgc2VjdXJlUmV2aXZlciA9IChrZXksIHZhbHVlMikgPT4ge1xuICAgICAgaWYgKGtleSA9PT0gXCJfX3Byb3RvX19cIiB8fCBrZXkgPT09IFwiY29uc3RydWN0b3JcIiAmJiB2YWx1ZTIgJiYgdHlwZW9mIHZhbHVlMiA9PT0gXCJvYmplY3RcIiAmJiBcInByb3RvdHlwZVwiIGluIHZhbHVlMikge1xuICAgICAgICBpZiAod2FybmluZ3MpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICBgW2JldHRlci1qc29uXSBEcm9wcGluZyBcIiR7a2V5fVwiIGtleSB0byBwcmV2ZW50IHByb3RvdHlwZSBwb2xsdXRpb25gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgfVxuICAgICAgaWYgKHBhcnNlRGF0ZXMgJiYgdHlwZW9mIHZhbHVlMiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBjb25zdCBkYXRlID0gcGFyc2VJU09EYXRlKHZhbHVlMik7XG4gICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXZpdmVyID8gcmV2aXZlcihrZXksIHZhbHVlMikgOiB2YWx1ZTI7XG4gICAgfTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZSh0cmltbWVkLCBzZWN1cmVSZXZpdmVyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoc3RyaWN0KSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5mdW5jdGlvbiBwYXJzZUpTT04odmFsdWUsIG9wdGlvbnMgPSB7IHN0cmljdDogdHJ1ZSB9KSB7XG4gIHJldHVybiBiZXR0ZXJKU09OUGFyc2UodmFsdWUsIG9wdGlvbnMpO1xufVxuXG5leHBvcnQgeyBwYXJzZUpTT04gYXMgcCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/adapters/index.mjs":
/*!**********************************************************!*\
  !*** ./node_modules/better-auth/dist/adapters/index.mjs ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdapter: () => (/* binding */ createAdapter),\n/* harmony export */   createAdapterFactory: () => (/* reexport safe */ _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c)\n/* harmony export */ });\n/* harmony import */ var _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../shared/better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _shared_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst createAdapter = _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hZGFwdGVycy9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStFO0FBQ2xDO0FBQ0Q7QUFDYjtBQUNhO0FBQ0E7QUFDVDtBQUN0QjtBQUNRO0FBQ1k7QUFDQztBQUNEO0FBQ0U7QUFDckI7QUFDbUI7QUFDRDtBQUNBO0FBQ0M7QUFDVzs7QUFFNUMsc0JBQXNCLCtEQUFvQjs7QUFFSyIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvYWRhcHRlcnMvaW5kZXgubWpzP2Q3NmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYyBhcyBjcmVhdGVBZGFwdGVyRmFjdG9yeSB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5FQnhLZVZOWi5tanMnO1xuZXhwb3J0ICogZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZGIvYWRhcHRlcic7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CS0V0RXB0MC5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGgucFFqZVJrek4ubWpzJztcbmltcG9ydCAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0ICd6b2QnO1xuaW1wb3J0ICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CNFFveGRnYy5tanMnO1xuXG5jb25zdCBjcmVhdGVBZGFwdGVyID0gY3JlYXRlQWRhcHRlckZhY3Rvcnk7XG5cbmV4cG9ydCB7IGNyZWF0ZUFkYXB0ZXIsIGNyZWF0ZUFkYXB0ZXJGYWN0b3J5IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/adapters/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/adapters/prisma-adapter/index.mjs":
/*!*************************************************************************!*\
  !*** ./node_modules/better-auth/dist/adapters/prisma-adapter/index.mjs ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdapter: () => (/* reexport safe */ _index_mjs__WEBPACK_IMPORTED_MODULE_0__.createAdapter),\n/* harmony export */   createAdapterFactory: () => (/* reexport safe */ _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__.c),\n/* harmony export */   prismaAdapter: () => (/* binding */ prismaAdapter)\n/* harmony export */ });\n/* harmony import */ var _index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../index.mjs */ \"(rsc)/./node_modules/better-auth/dist/adapters/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _shared_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../shared/better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst prismaAdapter = (prisma, config) => {\n  let lazyOptions = null;\n  const createCustomAdapter = (prisma2) => ({ getFieldName }) => {\n    const db = prisma2;\n    const convertSelect = (select, model) => {\n      if (!select || !model) return void 0;\n      return select.reduce((prev, cur) => {\n        return {\n          ...prev,\n          [getFieldName({ model, field: cur })]: true\n        };\n      }, {});\n    };\n    function operatorToPrismaOperator(operator) {\n      switch (operator) {\n        case \"starts_with\":\n          return \"startsWith\";\n        case \"ends_with\":\n          return \"endsWith\";\n        case \"ne\":\n          return \"not\";\n        case \"not_in\":\n          return \"notIn\";\n        default:\n          return operator;\n      }\n    }\n    const convertWhereClause = (model, where) => {\n      if (!where || !where.length) return {};\n      if (where.length === 1) {\n        const w = where[0];\n        if (!w) {\n          return;\n        }\n        return {\n          [getFieldName({ model, field: w.field })]: w.operator === \"eq\" || !w.operator ? w.value : {\n            [operatorToPrismaOperator(w.operator)]: w.value\n          }\n        };\n      }\n      const and = where.filter((w) => w.connector === \"AND\" || !w.connector);\n      const or = where.filter((w) => w.connector === \"OR\");\n      const andClause = and.map((w) => {\n        return {\n          [getFieldName({ model, field: w.field })]: w.operator === \"eq\" || !w.operator ? w.value : {\n            [operatorToPrismaOperator(w.operator)]: w.value\n          }\n        };\n      });\n      const orClause = or.map((w) => {\n        return {\n          [getFieldName({ model, field: w.field })]: w.operator === \"eq\" || !w.operator ? w.value : {\n            [operatorToPrismaOperator(w.operator)]: w.value\n          }\n        };\n      });\n      return {\n        ...andClause.length ? { AND: andClause } : {},\n        ...orClause.length ? { OR: orClause } : {}\n      };\n    };\n    return {\n      async create({ model, data: values, select }) {\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].create({\n          data: values,\n          select: convertSelect(select, model)\n        });\n      },\n      async findOne({ model, where, select }) {\n        const whereClause = convertWhereClause(model, where);\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].findFirst({\n          where: whereClause,\n          select: convertSelect(select, model)\n        });\n      },\n      async findMany({ model, where, limit, offset, sortBy }) {\n        const whereClause = convertWhereClause(model, where);\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].findMany({\n          where: whereClause,\n          take: limit || 100,\n          skip: offset || 0,\n          ...sortBy?.field ? {\n            orderBy: {\n              [getFieldName({ model, field: sortBy.field })]: sortBy.direction === \"desc\" ? \"desc\" : \"asc\"\n            }\n          } : {}\n        });\n      },\n      async count({ model, where }) {\n        const whereClause = convertWhereClause(model, where);\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].count({\n          where: whereClause\n        });\n      },\n      async update({ model, where, update }) {\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        const whereClause = convertWhereClause(model, where);\n        return await db[model].update({\n          where: whereClause,\n          data: update\n        });\n      },\n      async updateMany({ model, where, update }) {\n        const whereClause = convertWhereClause(model, where);\n        const result = await db[model].updateMany({\n          where: whereClause,\n          data: update\n        });\n        return result ? result.count : 0;\n      },\n      async delete({ model, where }) {\n        const whereClause = convertWhereClause(model, where);\n        try {\n          await db[model].delete({\n            where: whereClause\n          });\n        } catch (e) {\n        }\n      },\n      async deleteMany({ model, where }) {\n        const whereClause = convertWhereClause(model, where);\n        const result = await db[model].deleteMany({\n          where: whereClause\n        });\n        return result ? result.count : 0;\n      },\n      options: config\n    };\n  };\n  let adapterOptions = null;\n  adapterOptions = {\n    config: {\n      adapterId: \"prisma\",\n      adapterName: \"Prisma Adapter\",\n      usePlural: config.usePlural ?? false,\n      debugLogs: config.debugLogs ?? false,\n      transaction: config.transaction ?? false ? (cb) => prisma.$transaction((tx) => {\n        const adapter2 = (0,_shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__.c)({\n          config: adapterOptions.config,\n          adapter: createCustomAdapter(tx)\n        })(lazyOptions);\n        return cb(adapter2);\n      }) : false\n    },\n    adapter: createCustomAdapter(prisma)\n  };\n  const adapter = (0,_shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__.c)(adapterOptions);\n  return (options) => {\n    lazyOptions = options;\n    return adapter(options);\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hZGFwdGVycy9wcmlzbWEtYWRhcHRlci9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFDYTtBQUN3QjtBQUNyQztBQUNFO0FBQ2hCO0FBQ2dCO0FBQ0E7QUFDWjtBQUN0QjtBQUNRO0FBQ1k7QUFDQztBQUNEO0FBQ0U7QUFDckI7QUFDbUI7QUFDRDtBQUNBO0FBQ2U7O0FBRS9DO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0EsT0FBTyxJQUFJO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix1QkFBdUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix1QkFBdUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSwwQkFBMEIsdUJBQXVCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLGdDQUFnQyxpQkFBaUIsSUFBSTtBQUNyRCwrQkFBK0IsZUFBZTtBQUM5QztBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsNkJBQTZCO0FBQ2xEO0FBQ0Esb0JBQW9CLG9FQUFlO0FBQ25DLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLHNCQUFzQixzQkFBc0I7QUFDNUM7QUFDQTtBQUNBLG9CQUFvQixvRUFBZTtBQUNuQyxxQkFBcUIsT0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCx1QkFBdUIscUNBQXFDO0FBQzVEO0FBQ0E7QUFDQSxvQkFBb0Isb0VBQWU7QUFDbkMscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw0QkFBNEI7QUFDMUQ7QUFDQSxZQUFZO0FBQ1osU0FBUztBQUNULE9BQU87QUFDUCxvQkFBb0IsY0FBYztBQUNsQztBQUNBO0FBQ0Esb0JBQW9CLG9FQUFlO0FBQ25DLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxxQkFBcUIsc0JBQXNCO0FBQzNDO0FBQ0Esb0JBQW9CLG9FQUFlO0FBQ25DLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AseUJBQXlCLHNCQUFzQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUCxxQkFBcUIsY0FBYztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxVQUFVO0FBQ1Y7QUFDQSxPQUFPO0FBQ1AseUJBQXlCLGNBQWM7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsbUVBQW9CO0FBQzdDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQW9CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRStDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hZGFwdGVycy9wcmlzbWEtYWRhcHRlci9pbmRleC5tanM/ZmQ5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBjcmVhdGVBZGFwdGVyIH0gZnJvbSAnLi4vaW5kZXgubWpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcbmltcG9ydCB7IGMgYXMgY3JlYXRlQWRhcHRlckZhY3RvcnkgfSBmcm9tICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzJztcbmV4cG9ydCAqIGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2RiL2FkYXB0ZXInO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLnBRamVSa3pOLm1qcyc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCAnem9kJztcbmltcG9ydCAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5cbmNvbnN0IHByaXNtYUFkYXB0ZXIgPSAocHJpc21hLCBjb25maWcpID0+IHtcbiAgbGV0IGxhenlPcHRpb25zID0gbnVsbDtcbiAgY29uc3QgY3JlYXRlQ3VzdG9tQWRhcHRlciA9IChwcmlzbWEyKSA9PiAoeyBnZXRGaWVsZE5hbWUgfSkgPT4ge1xuICAgIGNvbnN0IGRiID0gcHJpc21hMjtcbiAgICBjb25zdCBjb252ZXJ0U2VsZWN0ID0gKHNlbGVjdCwgbW9kZWwpID0+IHtcbiAgICAgIGlmICghc2VsZWN0IHx8ICFtb2RlbCkgcmV0dXJuIHZvaWQgMDtcbiAgICAgIHJldHVybiBzZWxlY3QucmVkdWNlKChwcmV2LCBjdXIpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgIFtnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IGN1ciB9KV06IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH0sIHt9KTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIG9wZXJhdG9yVG9QcmlzbWFPcGVyYXRvcihvcGVyYXRvcikge1xuICAgICAgc3dpdGNoIChvcGVyYXRvcikge1xuICAgICAgICBjYXNlIFwic3RhcnRzX3dpdGhcIjpcbiAgICAgICAgICByZXR1cm4gXCJzdGFydHNXaXRoXCI7XG4gICAgICAgIGNhc2UgXCJlbmRzX3dpdGhcIjpcbiAgICAgICAgICByZXR1cm4gXCJlbmRzV2l0aFwiO1xuICAgICAgICBjYXNlIFwibmVcIjpcbiAgICAgICAgICByZXR1cm4gXCJub3RcIjtcbiAgICAgICAgY2FzZSBcIm5vdF9pblwiOlxuICAgICAgICAgIHJldHVybiBcIm5vdEluXCI7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIG9wZXJhdG9yO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb252ZXJ0V2hlcmVDbGF1c2UgPSAobW9kZWwsIHdoZXJlKSA9PiB7XG4gICAgICBpZiAoIXdoZXJlIHx8ICF3aGVyZS5sZW5ndGgpIHJldHVybiB7fTtcbiAgICAgIGlmICh3aGVyZS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgY29uc3QgdyA9IHdoZXJlWzBdO1xuICAgICAgICBpZiAoIXcpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBbZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiB3LmZpZWxkIH0pXTogdy5vcGVyYXRvciA9PT0gXCJlcVwiIHx8ICF3Lm9wZXJhdG9yID8gdy52YWx1ZSA6IHtcbiAgICAgICAgICAgIFtvcGVyYXRvclRvUHJpc21hT3BlcmF0b3Iody5vcGVyYXRvcildOiB3LnZhbHVlXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgY29uc3QgYW5kID0gd2hlcmUuZmlsdGVyKCh3KSA9PiB3LmNvbm5lY3RvciA9PT0gXCJBTkRcIiB8fCAhdy5jb25uZWN0b3IpO1xuICAgICAgY29uc3Qgb3IgPSB3aGVyZS5maWx0ZXIoKHcpID0+IHcuY29ubmVjdG9yID09PSBcIk9SXCIpO1xuICAgICAgY29uc3QgYW5kQ2xhdXNlID0gYW5kLm1hcCgodykgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIFtnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHcuZmllbGQgfSldOiB3Lm9wZXJhdG9yID09PSBcImVxXCIgfHwgIXcub3BlcmF0b3IgPyB3LnZhbHVlIDoge1xuICAgICAgICAgICAgW29wZXJhdG9yVG9QcmlzbWFPcGVyYXRvcih3Lm9wZXJhdG9yKV06IHcudmFsdWVcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IG9yQ2xhdXNlID0gb3IubWFwKCh3KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgW2dldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZDogdy5maWVsZCB9KV06IHcub3BlcmF0b3IgPT09IFwiZXFcIiB8fCAhdy5vcGVyYXRvciA/IHcudmFsdWUgOiB7XG4gICAgICAgICAgICBbb3BlcmF0b3JUb1ByaXNtYU9wZXJhdG9yKHcub3BlcmF0b3IpXTogdy52YWx1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uYW5kQ2xhdXNlLmxlbmd0aCA/IHsgQU5EOiBhbmRDbGF1c2UgfSA6IHt9LFxuICAgICAgICAuLi5vckNsYXVzZS5sZW5ndGggPyB7IE9SOiBvckNsYXVzZSB9IDoge31cbiAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgYXN5bmMgY3JlYXRlKHsgbW9kZWwsIGRhdGE6IHZhbHVlcywgc2VsZWN0IH0pIHtcbiAgICAgICAgaWYgKCFkYlttb2RlbF0pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgYE1vZGVsICR7bW9kZWx9IGRvZXMgbm90IGV4aXN0IGluIHRoZSBkYXRhYmFzZS4gSWYgeW91IGhhdmVuJ3QgZ2VuZXJhdGVkIHRoZSBQcmlzbWEgY2xpZW50LCB5b3UgbmVlZCB0byBydW4gJ25weCBwcmlzbWEgZ2VuZXJhdGUnYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IGRiW21vZGVsXS5jcmVhdGUoe1xuICAgICAgICAgIGRhdGE6IHZhbHVlcyxcbiAgICAgICAgICBzZWxlY3Q6IGNvbnZlcnRTZWxlY3Qoc2VsZWN0LCBtb2RlbClcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgZmluZE9uZSh7IG1vZGVsLCB3aGVyZSwgc2VsZWN0IH0pIHtcbiAgICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgaWYgKCFkYlttb2RlbF0pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgYE1vZGVsICR7bW9kZWx9IGRvZXMgbm90IGV4aXN0IGluIHRoZSBkYXRhYmFzZS4gSWYgeW91IGhhdmVuJ3QgZ2VuZXJhdGVkIHRoZSBQcmlzbWEgY2xpZW50LCB5b3UgbmVlZCB0byBydW4gJ25weCBwcmlzbWEgZ2VuZXJhdGUnYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IGRiW21vZGVsXS5maW5kRmlyc3Qoe1xuICAgICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcbiAgICAgICAgICBzZWxlY3Q6IGNvbnZlcnRTZWxlY3Qoc2VsZWN0LCBtb2RlbClcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgZmluZE1hbnkoeyBtb2RlbCwgd2hlcmUsIGxpbWl0LCBvZmZzZXQsIHNvcnRCeSB9KSB7XG4gICAgICAgIGNvbnN0IHdoZXJlQ2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgIGlmICghZGJbbW9kZWxdKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIGBNb2RlbCAke21vZGVsfSBkb2VzIG5vdCBleGlzdCBpbiB0aGUgZGF0YWJhc2UuIElmIHlvdSBoYXZlbid0IGdlbmVyYXRlZCB0aGUgUHJpc21hIGNsaWVudCwgeW91IG5lZWQgdG8gcnVuICducHggcHJpc21hIGdlbmVyYXRlJ2BcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBkYlttb2RlbF0uZmluZE1hbnkoe1xuICAgICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcbiAgICAgICAgICB0YWtlOiBsaW1pdCB8fCAxMDAsXG4gICAgICAgICAgc2tpcDogb2Zmc2V0IHx8IDAsXG4gICAgICAgICAgLi4uc29ydEJ5Py5maWVsZCA/IHtcbiAgICAgICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICAgICAgW2dldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZDogc29ydEJ5LmZpZWxkIH0pXTogc29ydEJ5LmRpcmVjdGlvbiA9PT0gXCJkZXNjXCIgPyBcImRlc2NcIiA6IFwiYXNjXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IDoge31cbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgY291bnQoeyBtb2RlbCwgd2hlcmUgfSkge1xuICAgICAgICBjb25zdCB3aGVyZUNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICBpZiAoIWRiW21vZGVsXSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgICBgTW9kZWwgJHttb2RlbH0gZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlLiBJZiB5b3UgaGF2ZW4ndCBnZW5lcmF0ZWQgdGhlIFByaXNtYSBjbGllbnQsIHlvdSBuZWVkIHRvIHJ1biAnbnB4IHByaXNtYSBnZW5lcmF0ZSdgXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXdhaXQgZGJbbW9kZWxdLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2VcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgdXBkYXRlKHsgbW9kZWwsIHdoZXJlLCB1cGRhdGUgfSkge1xuICAgICAgICBpZiAoIWRiW21vZGVsXSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgICBgTW9kZWwgJHttb2RlbH0gZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlLiBJZiB5b3UgaGF2ZW4ndCBnZW5lcmF0ZWQgdGhlIFByaXNtYSBjbGllbnQsIHlvdSBuZWVkIHRvIHJ1biAnbnB4IHByaXNtYSBnZW5lcmF0ZSdgXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB3aGVyZUNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICByZXR1cm4gYXdhaXQgZGJbbW9kZWxdLnVwZGF0ZSh7XG4gICAgICAgICAgd2hlcmU6IHdoZXJlQ2xhdXNlLFxuICAgICAgICAgIGRhdGE6IHVwZGF0ZVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyB1cGRhdGVNYW55KHsgbW9kZWwsIHdoZXJlLCB1cGRhdGUgfSkge1xuICAgICAgICBjb25zdCB3aGVyZUNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYlttb2RlbF0udXBkYXRlTWFueSh7XG4gICAgICAgICAgd2hlcmU6IHdoZXJlQ2xhdXNlLFxuICAgICAgICAgIGRhdGE6IHVwZGF0ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCA/IHJlc3VsdC5jb3VudCA6IDA7XG4gICAgICB9LFxuICAgICAgYXN5bmMgZGVsZXRlKHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBkYlttb2RlbF0uZGVsZXRlKHtcbiAgICAgICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBhc3luYyBkZWxldGVNYW55KHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGJbbW9kZWxdLmRlbGV0ZU1hbnkoe1xuICAgICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCA/IHJlc3VsdC5jb3VudCA6IDA7XG4gICAgICB9LFxuICAgICAgb3B0aW9uczogY29uZmlnXG4gICAgfTtcbiAgfTtcbiAgbGV0IGFkYXB0ZXJPcHRpb25zID0gbnVsbDtcbiAgYWRhcHRlck9wdGlvbnMgPSB7XG4gICAgY29uZmlnOiB7XG4gICAgICBhZGFwdGVySWQ6IFwicHJpc21hXCIsXG4gICAgICBhZGFwdGVyTmFtZTogXCJQcmlzbWEgQWRhcHRlclwiLFxuICAgICAgdXNlUGx1cmFsOiBjb25maWcudXNlUGx1cmFsID8/IGZhbHNlLFxuICAgICAgZGVidWdMb2dzOiBjb25maWcuZGVidWdMb2dzID8/IGZhbHNlLFxuICAgICAgdHJhbnNhY3Rpb246IGNvbmZpZy50cmFuc2FjdGlvbiA/PyBmYWxzZSA/IChjYikgPT4gcHJpc21hLiR0cmFuc2FjdGlvbigodHgpID0+IHtcbiAgICAgICAgY29uc3QgYWRhcHRlcjIgPSBjcmVhdGVBZGFwdGVyRmFjdG9yeSh7XG4gICAgICAgICAgY29uZmlnOiBhZGFwdGVyT3B0aW9ucy5jb25maWcsXG4gICAgICAgICAgYWRhcHRlcjogY3JlYXRlQ3VzdG9tQWRhcHRlcih0eClcbiAgICAgICAgfSkobGF6eU9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gY2IoYWRhcHRlcjIpO1xuICAgICAgfSkgOiBmYWxzZVxuICAgIH0sXG4gICAgYWRhcHRlcjogY3JlYXRlQ3VzdG9tQWRhcHRlcihwcmlzbWEpXG4gIH07XG4gIGNvbnN0IGFkYXB0ZXIgPSBjcmVhdGVBZGFwdGVyRmFjdG9yeShhZGFwdGVyT3B0aW9ucyk7XG4gIHJldHVybiAob3B0aW9ucykgPT4ge1xuICAgIGxhenlPcHRpb25zID0gb3B0aW9ucztcbiAgICByZXR1cm4gYWRhcHRlcihvcHRpb25zKTtcbiAgfTtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5LCBwcmlzbWFBZGFwdGVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/adapters/prisma-adapter/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/api/index.mjs":
/*!*****************************************************!*\
  !*** ./node_modules/better-auth/dist/api/index.mjs ***!
  \*****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_0__.APIError),\n/* harmony export */   accountInfo: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.f),\n/* harmony export */   callbackOAuth: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.I),\n/* harmony export */   changeEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.A),\n/* harmony export */   changePassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.z),\n/* harmony export */   checkEndpointConflicts: () => (/* binding */ checkEndpointConflicts),\n/* harmony export */   createAuthEndpoint: () => (/* reexport safe */ _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* reexport safe */ _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.createAuthMiddleware),\n/* harmony export */   createEmailVerificationToken: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.c),\n/* harmony export */   deleteUser: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.x),\n/* harmony export */   deleteUserCallback: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.k),\n/* harmony export */   error: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.e),\n/* harmony export */   forgetPassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.E),\n/* harmony export */   forgetPasswordCallback: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.v),\n/* harmony export */   freshSessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.f),\n/* harmony export */   getAccessToken: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.i),\n/* harmony export */   getEndpoints: () => (/* binding */ getEndpoints),\n/* harmony export */   getSession: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.a),\n/* harmony export */   getSessionFromCtx: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.g),\n/* harmony export */   getSessionQuerySchema: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.d),\n/* harmony export */   isSimpleRequest: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.L),\n/* harmony export */   linkSocialAccount: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.m),\n/* harmony export */   listSessions: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.l),\n/* harmony export */   listUserAccounts: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.l),\n/* harmony export */   ok: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.b),\n/* harmony export */   optionsMiddleware: () => (/* reexport safe */ _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.optionsMiddleware),\n/* harmony export */   originCheck: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.o),\n/* harmony export */   originCheckMiddleware: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.a),\n/* harmony export */   refreshToken: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.r),\n/* harmony export */   requestOnlySessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.h),\n/* harmony export */   requestPasswordReset: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.q),\n/* harmony export */   requestPasswordResetCallback: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.n),\n/* harmony export */   resetPassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.D),\n/* harmony export */   revokeOtherSessions: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.r),\n/* harmony export */   revokeSession: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.c),\n/* harmony export */   revokeSessions: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.b),\n/* harmony export */   router: () => (/* binding */ router),\n/* harmony export */   sendVerificationEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.B),\n/* harmony export */   sendVerificationEmailFn: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.K),\n/* harmony export */   sensitiveSessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.e),\n/* harmony export */   sessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.s),\n/* harmony export */   setPassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.y),\n/* harmony export */   signInEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.F),\n/* harmony export */   signInSocial: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.J),\n/* harmony export */   signOut: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.G),\n/* harmony export */   signUpEmail: () => (/* binding */ signUpEmail),\n/* harmony export */   unlinkAccount: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.j),\n/* harmony export */   updateUser: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.u),\n/* harmony export */   verifyEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.C)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../shared/better-auth.BX9UB8EP.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs\");\n/* harmony import */ var _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../shared/better-auth.DEBtROF9.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _shared_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _shared_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../shared/better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _shared_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../shared/better-auth.ClH5r3NH.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _shared_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../shared/better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _shared_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../shared/better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _shared_better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../shared/better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst signUpEmail = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.createAuthEndpoint)(\n  \"/sign-up/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_26__.record(zod__WEBPACK_IMPORTED_MODULE_26__.string(), zod__WEBPACK_IMPORTED_MODULE_26__.any()),\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Sign up a user using email and password\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  email: {\n                    type: \"string\",\n                    description: \"The email of the user\"\n                  },\n                  password: {\n                    type: \"string\",\n                    description: \"The password of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The profile image URL of the user\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  },\n                  rememberMe: {\n                    type: \"boolean\",\n                    description: \"If this is false, the session will not be remembered. Default is `true`.\"\n                  }\n                },\n                required: [\"name\", \"email\", \"password\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Successfully created user\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\",\n                      nullable: true,\n                      description: \"Authentication token for the session\"\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"The unique identifier of the user\"\n                        },\n                        email: {\n                          type: \"string\",\n                          format: \"email\",\n                          description: \"The email address of the user\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"The name of the user\"\n                        },\n                        image: {\n                          type: \"string\",\n                          format: \"uri\",\n                          nullable: true,\n                          description: \"The profile image URL of the user\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Whether the email has been verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was created\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was last updated\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"user\"]\n                  // token is optional\n                }\n              }\n            }\n          },\n          \"422\": {\n            description: \"Unprocessable Entity. User already exists or failed to create user.\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.enabled || ctx.context.options.emailAndPassword?.disableSignUp) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password sign up is not enabled\"\n      });\n    }\n    const body = ctx.body;\n    const { name, email, password, image, callbackURL, rememberMe, ...rest } = body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_26__.email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (password.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (password.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const dbUser = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (dbUser?.user) {\n      ctx.context.logger.info(`Sign-up attempt for existing email: ${email}`);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL\n      });\n    }\n    const hash = await ctx.context.password.hash(password);\n    let createdUser;\n    try {\n      const data = (0,_shared_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_8__.d)(ctx.context.options, rest, \"create\");\n      createdUser = await ctx.context.internalAdapter.createUser(\n        {\n          email: email.toLowerCase(),\n          name,\n          image,\n          ...data,\n          emailVerified: false\n        },\n        ctx\n      );\n      if (!createdUser) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n        });\n      }\n    } catch (e) {\n      if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_6__.isDevelopment)()) {\n        ctx.context.logger.error(\"Failed to create user\", e);\n      }\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n        throw e;\n      }\n      ctx.context.logger?.error(\"Failed to create user\", e);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER,\n        details: e\n      });\n    }\n    if (!createdUser) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n      });\n    }\n    await ctx.context.internalAdapter.linkAccount(\n      {\n        userId: createdUser.id,\n        providerId: \"credential\",\n        accountId: createdUser.id,\n        password: hash\n      },\n      ctx\n    );\n    if (ctx.context.options.emailVerification?.sendOnSignUp || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      const token = await (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\n        ctx.context.secret,\n        createdUser.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${body.callbackURL || \"/\"}`;\n      const args = ctx.request ? [\n        {\n          user: createdUser,\n          url,\n          token\n        },\n        ctx.request\n      ] : [\n        {\n          user: createdUser,\n          url,\n          token\n        }\n      ];\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        ...args\n      );\n    }\n    if (ctx.context.options.emailAndPassword.autoSignIn === false || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      return ctx.json({\n        token: null,\n        user: {\n          id: createdUser.id,\n          email: createdUser.email,\n          name: createdUser.name,\n          image: createdUser.image,\n          emailVerified: createdUser.emailVerified,\n          createdAt: createdUser.createdAt,\n          updatedAt: createdUser.updatedAt\n        }\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      createdUser.id,\n      ctx,\n      rememberMe === false\n    );\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_shared_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_4__.s)(\n      ctx,\n      {\n        session,\n        user: createdUser\n      },\n      rememberMe === false\n    );\n    return ctx.json({\n      token: session.token,\n      user: {\n        id: createdUser.id,\n        email: createdUser.email,\n        name: createdUser.name,\n        image: createdUser.image,\n        emailVerified: createdUser.emailVerified,\n        createdAt: createdUser.createdAt,\n        updatedAt: createdUser.updatedAt\n      }\n    });\n  }\n);\n\nfunction shouldRateLimit(max, window, rateLimitData) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  const timeSinceLastRequest = now - rateLimitData.lastRequest;\n  return timeSinceLastRequest < windowInMs && rateLimitData.count >= max;\n}\nfunction rateLimitResponse(retryAfter) {\n  return new Response(\n    JSON.stringify({\n      message: \"Too many requests. Please try again later.\"\n    }),\n    {\n      status: 429,\n      statusText: \"Too Many Requests\",\n      headers: {\n        \"X-Retry-After\": retryAfter.toString()\n      }\n    }\n  );\n}\nfunction getRetryAfter(lastRequest, window) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  return Math.ceil((lastRequest + windowInMs - now) / 1e3);\n}\nfunction createDBStorage(ctx) {\n  const model = \"rateLimit\";\n  const db = ctx.adapter;\n  return {\n    get: async (key) => {\n      const res = await db.findMany({\n        model,\n        where: [{ field: \"key\", value: key }]\n      });\n      const data = res[0];\n      if (typeof data?.lastRequest === \"bigint\") {\n        data.lastRequest = Number(data.lastRequest);\n      }\n      return data;\n    },\n    set: async (key, value, _update) => {\n      try {\n        if (_update) {\n          await db.updateMany({\n            model,\n            where: [{ field: \"key\", value: key }],\n            update: {\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        } else {\n          await db.create({\n            model,\n            data: {\n              key,\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        }\n      } catch (e) {\n        ctx.logger.error(\"Error setting rate limit\", e);\n      }\n    }\n  };\n}\nconst memory = /* @__PURE__ */ new Map();\nfunction getRateLimitStorage(ctx, rateLimitSettings) {\n  if (ctx.options.rateLimit?.customStorage) {\n    return ctx.options.rateLimit.customStorage;\n  }\n  const storage = ctx.rateLimit.storage;\n  if (storage === \"secondary-storage\") {\n    return {\n      get: async (key) => {\n        const data = await ctx.options.secondaryStorage?.get(key);\n        return data ? (0,_shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_15__.s)(data) : void 0;\n      },\n      set: async (key, value, _update) => {\n        const ttl = rateLimitSettings?.window ?? ctx.options.rateLimit?.window ?? 10;\n        await ctx.options.secondaryStorage?.set?.(\n          key,\n          JSON.stringify(value),\n          ttl\n        );\n      }\n    };\n  } else if (storage === \"memory\") {\n    return {\n      async get(key) {\n        return memory.get(key);\n      },\n      async set(key, value, _update) {\n        memory.set(key, value);\n      }\n    };\n  }\n  return createDBStorage(ctx);\n}\nasync function onRequestRateLimit(req, ctx) {\n  if (!ctx.rateLimit.enabled) {\n    return;\n  }\n  const path = new URL(req.url).pathname.replace(\n    ctx.options.basePath || \"/api/auth\",\n    \"\"\n  );\n  let window = ctx.rateLimit.window;\n  let max = ctx.rateLimit.max;\n  const ip = (0,_shared_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_16__.g)(req, ctx.options);\n  if (!ip) {\n    return;\n  }\n  const key = ip + path;\n  const specialRules = getDefaultSpecialRules();\n  const specialRule = specialRules.find((rule) => rule.pathMatcher(path));\n  if (specialRule) {\n    window = specialRule.window;\n    max = specialRule.max;\n  }\n  for (const plugin of ctx.options.plugins || []) {\n    if (plugin.rateLimit) {\n      const matchedRule = plugin.rateLimit.find(\n        (rule) => rule.pathMatcher(path)\n      );\n      if (matchedRule) {\n        window = matchedRule.window;\n        max = matchedRule.max;\n        break;\n      }\n    }\n  }\n  if (ctx.rateLimit.customRules) {\n    const _path = Object.keys(ctx.rateLimit.customRules).find((p) => {\n      if (p.includes(\"*\")) {\n        const isMatch = (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.w)(p)(path);\n        return isMatch;\n      }\n      return p === path;\n    });\n    if (_path) {\n      const customRule = ctx.rateLimit.customRules[_path];\n      const resolved = typeof customRule === \"function\" ? await customRule(req) : customRule;\n      if (resolved) {\n        window = resolved.window;\n        max = resolved.max;\n      }\n      if (resolved === false) {\n        return;\n      }\n    }\n  }\n  const storage = getRateLimitStorage(ctx, {\n    window\n  });\n  const data = await storage.get(key);\n  const now = Date.now();\n  if (!data) {\n    await storage.set(key, {\n      key,\n      count: 1,\n      lastRequest: now\n    });\n  } else {\n    const timeSinceLastRequest = now - data.lastRequest;\n    if (shouldRateLimit(max, window, data)) {\n      const retryAfter = getRetryAfter(data.lastRequest, window);\n      return rateLimitResponse(retryAfter);\n    } else if (timeSinceLastRequest > window * 1e3) {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: 1,\n          lastRequest: now\n        },\n        true\n      );\n    } else {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: data.count + 1,\n          lastRequest: now\n        },\n        true\n      );\n    }\n  }\n}\nfunction getDefaultSpecialRules() {\n  const specialRules = [\n    {\n      pathMatcher(path) {\n        return path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path.startsWith(\"/change-password\") || path.startsWith(\"/change-email\");\n      },\n      window: 10,\n      max: 3\n    }\n  ];\n  return specialRules;\n}\n\nfunction checkEndpointConflicts(options, logger2) {\n  const endpointRegistry = /* @__PURE__ */ new Map();\n  options.plugins?.forEach((plugin) => {\n    if (plugin.endpoints) {\n      for (const [key, endpoint] of Object.entries(plugin.endpoints)) {\n        if (endpoint && \"path\" in endpoint) {\n          const path = endpoint.path;\n          let methods = [];\n          if (endpoint.options && \"method\" in endpoint.options) {\n            if (Array.isArray(endpoint.options.method)) {\n              methods = endpoint.options.method;\n            } else if (typeof endpoint.options.method === \"string\") {\n              methods = [endpoint.options.method];\n            }\n          }\n          if (methods.length === 0) {\n            methods = [\"*\"];\n          }\n          if (!endpointRegistry.has(path)) {\n            endpointRegistry.set(path, []);\n          }\n          endpointRegistry.get(path).push({\n            pluginId: plugin.id,\n            endpointKey: key,\n            methods\n          });\n        }\n      }\n    }\n  });\n  const conflicts = [];\n  for (const [path, entries] of endpointRegistry.entries()) {\n    if (entries.length > 1) {\n      const methodMap = /* @__PURE__ */ new Map();\n      let hasConflict = false;\n      for (const entry of entries) {\n        for (const method of entry.methods) {\n          if (!methodMap.has(method)) {\n            methodMap.set(method, []);\n          }\n          methodMap.get(method).push(entry.pluginId);\n          if (methodMap.get(method).length > 1) {\n            hasConflict = true;\n          }\n          if (method === \"*\" && entries.length > 1) {\n            hasConflict = true;\n          } else if (method !== \"*\" && methodMap.has(\"*\")) {\n            hasConflict = true;\n          }\n        }\n      }\n      if (hasConflict) {\n        const uniquePlugins = [...new Set(entries.map((e) => e.pluginId))];\n        const conflictingMethods = [];\n        for (const [method, plugins] of methodMap.entries()) {\n          if (plugins.length > 1 || method === \"*\" && entries.length > 1 || method !== \"*\" && methodMap.has(\"*\")) {\n            conflictingMethods.push(method);\n          }\n        }\n        conflicts.push({\n          path,\n          plugins: uniquePlugins,\n          conflictingMethods\n        });\n      }\n    }\n  }\n  if (conflicts.length > 0) {\n    const conflictMessages = conflicts.map(\n      (conflict) => `  - \"${conflict.path}\" [${conflict.conflictingMethods.join(\", \")}] used by plugins: ${conflict.plugins.join(\", \")}`\n    ).join(\"\\n\");\n    logger2.error(\n      `Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths with conflicting HTTP methods:\n${conflictMessages}\n\nTo resolve this, you can:\n\t1. Use only one of the conflicting plugins\n\t2. Configure the plugins to use different paths (if supported)\n\t3. Ensure plugins use different HTTP methods for the same path\n`\n    );\n  }\n}\nfunction getEndpoints(ctx, options) {\n  const pluginEndpoints = options.plugins?.reduce((acc, plugin) => {\n    return {\n      ...acc,\n      ...plugin.endpoints\n    };\n  }, {}) ?? {};\n  const middlewares = options.plugins?.map(\n    (plugin) => plugin.middlewares?.map((m) => {\n      const middleware = (async (context) => {\n        const authContext = await ctx;\n        return m.middleware({\n          ...context,\n          context: {\n            ...authContext,\n            ...context.context\n          }\n        });\n      });\n      middleware.options = m.middleware.options;\n      return {\n        path: m.path,\n        middleware\n      };\n    })\n  ).filter((plugin) => plugin !== void 0).flat() || [];\n  const baseEndpoints = {\n    signInSocial: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.J,\n    callbackOAuth: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.I,\n    getSession: (0,_shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.a)(),\n    signOut: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.G,\n    signUpEmail: signUpEmail(),\n    signInEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.F,\n    forgetPassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.E,\n    resetPassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.D,\n    verifyEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.C,\n    sendVerificationEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.B,\n    changeEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.A,\n    changePassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.z,\n    setPassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.y,\n    updateUser: (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.u)(),\n    deleteUser: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.x,\n    forgetPasswordCallback: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.v,\n    requestPasswordReset: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.q,\n    requestPasswordResetCallback: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.n,\n    listSessions: (0,_shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.l)(),\n    revokeSession: _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.c,\n    revokeSessions: _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.b,\n    revokeOtherSessions: _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.r,\n    linkSocialAccount: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.m,\n    listUserAccounts: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.l,\n    deleteUserCallback: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.k,\n    unlinkAccount: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.j,\n    refreshToken: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.r,\n    getAccessToken: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.i,\n    accountInfo: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.f\n  };\n  const endpoints = {\n    ...baseEndpoints,\n    ...pluginEndpoints,\n    ok: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.b,\n    error: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.e\n  };\n  const api = (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.t)(endpoints, ctx);\n  return {\n    api,\n    middlewares\n  };\n}\nconst router = (ctx, options) => {\n  const { api, middlewares } = getEndpoints(ctx, options);\n  const basePath = new URL(ctx.baseURL).pathname;\n  return (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createRouter)(api, {\n    routerContext: ctx,\n    openapi: {\n      disabled: true\n    },\n    basePath,\n    routerMiddleware: [\n      {\n        path: \"/**\",\n        middleware: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.a\n      },\n      ...middlewares\n    ],\n    async onRequest(req) {\n      const disabledPaths = ctx.options.disabledPaths || [];\n      const path = new URL(req.url).pathname.replace(basePath, \"\");\n      if (disabledPaths.includes(path)) {\n        return new Response(\"Not Found\", { status: 404 });\n      }\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onRequest) {\n          const response = await plugin.onRequest(req, ctx);\n          if (response && \"response\" in response) {\n            return response.response;\n          }\n          if (response && \"request\" in response) {\n            const rateLimitResponse = await onRequestRateLimit(\n              response.request,\n              ctx\n            );\n            if (rateLimitResponse) {\n              return rateLimitResponse;\n            }\n            return response.request;\n          }\n        }\n      }\n      return onRequestRateLimit(req, ctx);\n    },\n    async onResponse(res) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onResponse) {\n          const response = await plugin.onResponse(res, ctx);\n          if (response) {\n            return response.response;\n          }\n        }\n      }\n      return res;\n    },\n    onError(e) {\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError && e.status === \"FOUND\") {\n        return;\n      }\n      if (options.onAPIError?.throw) {\n        throw e;\n      }\n      if (options.onAPIError?.onError) {\n        options.onAPIError.onError(e, ctx);\n        return;\n      }\n      const optLogLevel = options.logger?.level;\n      const log = optLogLevel === \"error\" || optLogLevel === \"warn\" || optLogLevel === \"debug\" ? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_6__.logger : void 0;\n      if (options.logger?.disabled !== true) {\n        if (e && typeof e === \"object\" && \"message\" in e && typeof e.message === \"string\") {\n          if (e.message.includes(\"no column\") || e.message.includes(\"column\") || e.message.includes(\"relation\") || e.message.includes(\"table\") || e.message.includes(\"does not exist\")) {\n            ctx.logger?.error(e.message);\n            return;\n          }\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n          if (e.status === \"INTERNAL_SERVER_ERROR\") {\n            ctx.logger.error(e.status, e);\n          }\n          log?.error(e.message);\n        } else {\n          ctx.logger?.error(\n            e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n            e\n          );\n        }\n      }\n    }\n  });\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hcGkvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUQ7QUFDZDtBQUNxbkI7QUFDbGlCO0FBQ2lDO0FBQ3NFO0FBQ3hNO0FBQ3lDO0FBQ3lDO0FBQ2hDO0FBQ2hCO0FBQ0c7QUFDaEM7QUFDMkM7QUFDdEM7QUFDRjtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNEO0FBQ0E7QUFDWTtBQUM1QjtBQUNzQjtBQUNrQztBQUNSO0FBQ3BCO0FBQ0E7QUFDQTtBQUNYO0FBQ0U7QUFDckI7QUFDZTtBQUNlO0FBQ3ZCO0FBQ3VCOztBQUU1QywwQkFBMEIsZ0ZBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLFVBQVUsd0NBQVEsQ0FBQyx3Q0FBUSxJQUFJLHFDQUFLO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtB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O0FBQ3hCLGdDQUFnQztBQUNoQyxrQkFBa0IsbUVBQVk7QUFDOUIsaUJBQWlCO0FBQ2pCLGtCQUFrQjtBQUNsQix1QkFBdUI7QUFDdkIscUJBQXFCO0FBQ3JCLG9CQUFvQjtBQUNwQixzQkFBc0I7QUFDdEIsaUJBQWlCO0FBQ2pCLGdCQUFnQjtBQUNoQixrQkFBa0I7QUFDbEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLFNBQVM7QUFDVDtBQUNBLGNBQWMsbUVBQWU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxtQkFBbUI7QUFDN0I7QUFDQSxTQUFTLHlEQUFZO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBcUI7QUFDekMsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxhQUFhO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSx1QkFBdUIsaURBQVE7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpR0FBaUcseURBQU07QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsaURBQVE7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRTBrQiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvYXBpL2luZGV4Lm1qcz84Zjc1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFQSUVycm9yLCBjcmVhdGVSb3V0ZXIgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5leHBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGMgYXMgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbiwgdyBhcyB3aWxkY2FyZE1hdGNoLCB1IGFzIHVwZGF0ZVVzZXIsIHQgYXMgdG9BdXRoRW5kcG9pbnRzLCBhIGFzIG9yaWdpbkNoZWNrTWlkZGxld2FyZSwgZSBhcyBlcnJvciwgYiBhcyBvaywgZiBhcyBhY2NvdW50SW5mbywgaSBhcyBnZXRBY2Nlc3NUb2tlbiwgciBhcyByZWZyZXNoVG9rZW4sIGogYXMgdW5saW5rQWNjb3VudCwgayBhcyBkZWxldGVVc2VyQ2FsbGJhY2ssIGwgYXMgbGlzdFVzZXJBY2NvdW50cywgbSBhcyBsaW5rU29jaWFsQWNjb3VudCwgbiBhcyByZXF1ZXN0UGFzc3dvcmRSZXNldENhbGxiYWNrLCBxIGFzIHJlcXVlc3RQYXNzd29yZFJlc2V0LCB2IGFzIGZvcmdldFBhc3N3b3JkQ2FsbGJhY2ssIHggYXMgZGVsZXRlVXNlciwgeSBhcyBzZXRQYXNzd29yZCwgeiBhcyBjaGFuZ2VQYXNzd29yZCwgQSBhcyBjaGFuZ2VFbWFpbCwgQiBhcyBzZW5kVmVyaWZpY2F0aW9uRW1haWwsIEMgYXMgdmVyaWZ5RW1haWwsIEQgYXMgcmVzZXRQYXNzd29yZCwgRSBhcyBmb3JnZXRQYXNzd29yZCwgRiBhcyBzaWduSW5FbWFpbCwgRyBhcyBzaWduT3V0LCBJIGFzIGNhbGxiYWNrT0F1dGgsIEogYXMgc2lnbkluU29jaWFsIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkJYOVVCOEVQLm1qcyc7XG5leHBvcnQgeyBMIGFzIGlzU2ltcGxlUmVxdWVzdCwgbyBhcyBvcmlnaW5DaGVjaywgSyBhcyBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbiB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CWDlVQjhFUC5tanMnO1xuaW1wb3J0IHsgbCBhcyBsaXN0U2Vzc2lvbnMsIGEgYXMgZ2V0U2Vzc2lvbiwgciBhcyByZXZva2VPdGhlclNlc3Npb25zLCBiIGFzIHJldm9rZVNlc3Npb25zLCBjIGFzIHJldm9rZVNlc3Npb24gfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguREVCdFJPRjkubWpzJztcbmV4cG9ydCB7IGYgYXMgZnJlc2hTZXNzaW9uTWlkZGxld2FyZSwgZyBhcyBnZXRTZXNzaW9uRnJvbUN0eCwgZCBhcyBnZXRTZXNzaW9uUXVlcnlTY2hlbWEsIGggYXMgcmVxdWVzdE9ubHlTZXNzaW9uTWlkZGxld2FyZSwgZSBhcyBzZW5zaXRpdmVTZXNzaW9uTWlkZGxld2FyZSwgcyBhcyBzZXNzaW9uTWlkZGxld2FyZSB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5ERUJ0Uk9GOS5tanMnO1xuaW1wb3J0ICogYXMgeiBmcm9tICd6b2QnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvbWlkZGxld2FyZSc7XG5leHBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBvcHRpb25zTWlkZGxld2FyZSB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL21pZGRsZXdhcmUnO1xuaW1wb3J0IHsgcyBhcyBzZXRTZXNzaW9uQ29va2llIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkQ5X3ZRUjgzLm1qcyc7XG5pbXBvcnQgeyBCQVNFX0VSUk9SX0NPREVTIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0IHsgaXNEZXZlbG9wbWVudCwgbG9nZ2VyIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGInO1xuaW1wb3J0IHsgZCBhcyBwYXJzZVVzZXJJbnB1dCB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5Dd2o5ZHQ2aS5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CNFFveGRnYy5tanMnO1xuaW1wb3J0ICdreXNlbHknO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9kYi9hZGFwdGVyJztcbmltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CS0V0RXB0MC5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRJcCB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5DbEg1cjNOSC5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9zb2NpYWwtcHJvdmlkZXJzJztcbmltcG9ydCAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaG1hYyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iaW5hcnknO1xuaW1wb3J0ICdkZWZ1JztcbmltcG9ydCAnLi4vY3J5cHRvL2luZGV4Lm1qcyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanMnO1xuaW1wb3J0ICdqb3NlL2Vycm9ycyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5JaDhDNzZWby5tanMnO1xuXG5jb25zdCBzaWduVXBFbWFpbCA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2lnbi11cC9lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6LnJlY29yZCh6LnN0cmluZygpLCB6LmFueSgpKSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgJEluZmVyOiB7XG4gICAgICAgIGJvZHk6IHt9XG4gICAgICB9LFxuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIHVwIGEgdXNlciB1c2luZyBlbWFpbCBhbmQgcGFzc3dvcmRcIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvZmlsZSBpbWFnZSBVUkwgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gdXNlIGZvciBlbWFpbCB2ZXJpZmljYXRpb24gY2FsbGJhY2tcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlbWVtYmVyTWU6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIklmIHRoaXMgaXMgZmFsc2UsIHRoZSBzZXNzaW9uIHdpbGwgbm90IGJlIHJlbWVtYmVyZWQuIERlZmF1bHQgaXMgYHRydWVgLlwiXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wibmFtZVwiLCBcImVtYWlsXCIsIFwicGFzc3dvcmRcIl1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc2Z1bGx5IGNyZWF0ZWQgdXNlclwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkF1dGhlbnRpY2F0aW9uIHRva2VuIGZvciB0aGUgc2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwidXJpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvZmlsZSBpbWFnZSBVUkwgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZXRoZXIgdGhlIGVtYWlsIGhhcyBiZWVuIHZlcmlmaWVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGVuIHRoZSB1c2VyIHdhcyBjcmVhdGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGVuIHRoZSB1c2VyIHdhcyBsYXN0IHVwZGF0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cGRhdGVkQXRcIlxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgICAvLyB0b2tlbiBpcyBvcHRpb25hbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCI0MjJcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVW5wcm9jZXNzYWJsZSBFbnRpdHkuIFVzZXIgYWxyZWFkeSBleGlzdHMgb3IgZmFpbGVkIHRvIGNyZWF0ZSB1c2VyLlwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5lbmFibGVkIHx8IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uZGlzYWJsZVNpZ25VcCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGFuZCBwYXNzd29yZCBzaWduIHVwIGlzIG5vdCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBib2R5ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgeyBuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGltYWdlLCBjYWxsYmFja1VSTCwgcmVtZW1iZXJNZSwgLi4ucmVzdCB9ID0gYm9keTtcbiAgICBjb25zdCBpc1ZhbGlkRW1haWwgPSB6LmVtYWlsKCkuc2FmZVBhcnNlKGVtYWlsKTtcbiAgICBpZiAoIWlzVmFsaWRFbWFpbC5zdWNjZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1pblBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1pblBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChwYXNzd29yZC5sZW5ndGggPCBtaW5QYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIHNob3J0XCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19TSE9SVFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1heFBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChwYXNzd29yZC5sZW5ndGggPiBtYXhQYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIGxvbmdcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX0xPTkdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBkYlVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICBpZiAoZGJVc2VyPy51c2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuaW5mbyhgU2lnbi11cCBhdHRlbXB0IGZvciBleGlzdGluZyBlbWFpbDogJHtlbWFpbH1gKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX0FMUkVBRFlfRVhJU1RTX1VTRV9BTk9USEVSX0VNQUlMXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgaGFzaCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2gocGFzc3dvcmQpO1xuICAgIGxldCBjcmVhdGVkVXNlcjtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YSA9IHBhcnNlVXNlcklucHV0KGN0eC5jb250ZXh0Lm9wdGlvbnMsIHJlc3QsIFwiY3JlYXRlXCIpO1xuICAgICAgY3JlYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVXNlcihcbiAgICAgICAge1xuICAgICAgICAgIGVtYWlsOiBlbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgaW1hZ2UsXG4gICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICBpZiAoIWNyZWF0ZWRVc2VyKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoaXNEZXZlbG9wbWVudCgpKSB7XG4gICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiLCBlKTtcbiAgICAgIH1cbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlcj8uZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIiwgZSk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSLFxuICAgICAgICBkZXRhaWxzOiBlXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFjcmVhdGVkVXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudChcbiAgICAgIHtcbiAgICAgICAgdXNlcklkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgcHJvdmlkZXJJZDogXCJjcmVkZW50aWFsXCIsXG4gICAgICAgIGFjY291bnRJZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgIHBhc3N3b3JkOiBoYXNoXG4gICAgICB9LFxuICAgICAgY3R4XG4gICAgKTtcbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZE9uU2lnblVwIHx8IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICBjcmVhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICAgICk7XG4gICAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgICBjb25zdCBhcmdzID0gY3R4LnJlcXVlc3QgPyBbXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiBjcmVhdGVkVXNlcixcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgdG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgIF0gOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiBjcmVhdGVkVXNlcixcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgdG9rZW5cbiAgICAgICAgfVxuICAgICAgXTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICAuLi5hcmdzXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLmF1dG9TaWduSW4gPT09IGZhbHNlIHx8IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IGNyZWF0ZWRVc2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiBjcmVhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiBjcmVhdGVkVXNlci5uYW1lLFxuICAgICAgICAgIGltYWdlOiBjcmVhdGVkVXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBjcmVhdGVkVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogY3JlYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogY3JlYXRlZFVzZXIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICBjcmVhdGVkVXNlci5pZCxcbiAgICAgIGN0eCxcbiAgICAgIHJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgY3R4LFxuICAgICAge1xuICAgICAgICBzZXNzaW9uLFxuICAgICAgICB1c2VyOiBjcmVhdGVkVXNlclxuICAgICAgfSxcbiAgICAgIHJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgZW1haWw6IGNyZWF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiBjcmVhdGVkVXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogY3JlYXRlZFVzZXIuaW1hZ2UsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IGNyZWF0ZWRVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogY3JlYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IGNyZWF0ZWRVc2VyLnVwZGF0ZWRBdFxuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xuXG5mdW5jdGlvbiBzaG91bGRSYXRlTGltaXQobWF4LCB3aW5kb3csIHJhdGVMaW1pdERhdGEpIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3Qgd2luZG93SW5NcyA9IHdpbmRvdyAqIDFlMztcbiAgY29uc3QgdGltZVNpbmNlTGFzdFJlcXVlc3QgPSBub3cgLSByYXRlTGltaXREYXRhLmxhc3RSZXF1ZXN0O1xuICByZXR1cm4gdGltZVNpbmNlTGFzdFJlcXVlc3QgPCB3aW5kb3dJbk1zICYmIHJhdGVMaW1pdERhdGEuY291bnQgPj0gbWF4O1xufVxuZnVuY3Rpb24gcmF0ZUxpbWl0UmVzcG9uc2UocmV0cnlBZnRlcikge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG1lc3NhZ2U6IFwiVG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJcbiAgICB9KSxcbiAgICB7XG4gICAgICBzdGF0dXM6IDQyOSxcbiAgICAgIHN0YXR1c1RleHQ6IFwiVG9vIE1hbnkgUmVxdWVzdHNcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJYLVJldHJ5LUFmdGVyXCI6IHJldHJ5QWZ0ZXIudG9TdHJpbmcoKVxuICAgICAgfVxuICAgIH1cbiAgKTtcbn1cbmZ1bmN0aW9uIGdldFJldHJ5QWZ0ZXIobGFzdFJlcXVlc3QsIHdpbmRvdykge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCB3aW5kb3dJbk1zID0gd2luZG93ICogMWUzO1xuICByZXR1cm4gTWF0aC5jZWlsKChsYXN0UmVxdWVzdCArIHdpbmRvd0luTXMgLSBub3cpIC8gMWUzKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURCU3RvcmFnZShjdHgpIHtcbiAgY29uc3QgbW9kZWwgPSBcInJhdGVMaW1pdFwiO1xuICBjb25zdCBkYiA9IGN0eC5hZGFwdGVyO1xuICByZXR1cm4ge1xuICAgIGdldDogYXN5bmMgKGtleSkgPT4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmU6IFt7IGZpZWxkOiBcImtleVwiLCB2YWx1ZToga2V5IH1dXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSByZXNbMF07XG4gICAgICBpZiAodHlwZW9mIGRhdGE/Lmxhc3RSZXF1ZXN0ID09PSBcImJpZ2ludFwiKSB7XG4gICAgICAgIGRhdGEubGFzdFJlcXVlc3QgPSBOdW1iZXIoZGF0YS5sYXN0UmVxdWVzdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHNldDogYXN5bmMgKGtleSwgdmFsdWUsIF91cGRhdGUpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChfdXBkYXRlKSB7XG4gICAgICAgICAgYXdhaXQgZGIudXBkYXRlTWFueSh7XG4gICAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJrZXlcIiwgdmFsdWU6IGtleSB9XSxcbiAgICAgICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXG4gICAgICAgICAgICAgIGxhc3RSZXF1ZXN0OiB2YWx1ZS5sYXN0UmVxdWVzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IGRiLmNyZWF0ZSh7XG4gICAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXG4gICAgICAgICAgICAgIGxhc3RSZXF1ZXN0OiB2YWx1ZS5sYXN0UmVxdWVzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGN0eC5sb2dnZXIuZXJyb3IoXCJFcnJvciBzZXR0aW5nIHJhdGUgbGltaXRcIiwgZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuY29uc3QgbWVtb3J5ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbmZ1bmN0aW9uIGdldFJhdGVMaW1pdFN0b3JhZ2UoY3R4LCByYXRlTGltaXRTZXR0aW5ncykge1xuICBpZiAoY3R4Lm9wdGlvbnMucmF0ZUxpbWl0Py5jdXN0b21TdG9yYWdlKSB7XG4gICAgcmV0dXJuIGN0eC5vcHRpb25zLnJhdGVMaW1pdC5jdXN0b21TdG9yYWdlO1xuICB9XG4gIGNvbnN0IHN0b3JhZ2UgPSBjdHgucmF0ZUxpbWl0LnN0b3JhZ2U7XG4gIGlmIChzdG9yYWdlID09PSBcInNlY29uZGFyeS1zdG9yYWdlXCIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZ2V0OiBhc3luYyAoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjdHgub3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlPy5nZXQoa2V5KTtcbiAgICAgICAgcmV0dXJuIGRhdGEgPyBzYWZlSlNPTlBhcnNlKGRhdGEpIDogdm9pZCAwO1xuICAgICAgfSxcbiAgICAgIHNldDogYXN5bmMgKGtleSwgdmFsdWUsIF91cGRhdGUpID0+IHtcbiAgICAgICAgY29uc3QgdHRsID0gcmF0ZUxpbWl0U2V0dGluZ3M/LndpbmRvdyA/PyBjdHgub3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyA/PyAxMDtcbiAgICAgICAgYXdhaXQgY3R4Lm9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZT8uc2V0Py4oXG4gICAgICAgICAga2V5LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHZhbHVlKSxcbiAgICAgICAgICB0dGxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9O1xuICB9IGVsc2UgaWYgKHN0b3JhZ2UgPT09IFwibWVtb3J5XCIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXN5bmMgZ2V0KGtleSkge1xuICAgICAgICByZXR1cm4gbWVtb3J5LmdldChrZXkpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIHNldChrZXksIHZhbHVlLCBfdXBkYXRlKSB7XG4gICAgICAgIG1lbW9yeS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4gY3JlYXRlREJTdG9yYWdlKGN0eCk7XG59XG5hc3luYyBmdW5jdGlvbiBvblJlcXVlc3RSYXRlTGltaXQocmVxLCBjdHgpIHtcbiAgaWYgKCFjdHgucmF0ZUxpbWl0LmVuYWJsZWQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgcGF0aCA9IG5ldyBVUkwocmVxLnVybCkucGF0aG5hbWUucmVwbGFjZShcbiAgICBjdHgub3B0aW9ucy5iYXNlUGF0aCB8fCBcIi9hcGkvYXV0aFwiLFxuICAgIFwiXCJcbiAgKTtcbiAgbGV0IHdpbmRvdyA9IGN0eC5yYXRlTGltaXQud2luZG93O1xuICBsZXQgbWF4ID0gY3R4LnJhdGVMaW1pdC5tYXg7XG4gIGNvbnN0IGlwID0gZ2V0SXAocmVxLCBjdHgub3B0aW9ucyk7XG4gIGlmICghaXApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qga2V5ID0gaXAgKyBwYXRoO1xuICBjb25zdCBzcGVjaWFsUnVsZXMgPSBnZXREZWZhdWx0U3BlY2lhbFJ1bGVzKCk7XG4gIGNvbnN0IHNwZWNpYWxSdWxlID0gc3BlY2lhbFJ1bGVzLmZpbmQoKHJ1bGUpID0+IHJ1bGUucGF0aE1hdGNoZXIocGF0aCkpO1xuICBpZiAoc3BlY2lhbFJ1bGUpIHtcbiAgICB3aW5kb3cgPSBzcGVjaWFsUnVsZS53aW5kb3c7XG4gICAgbWF4ID0gc3BlY2lhbFJ1bGUubWF4O1xuICB9XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIGN0eC5vcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICBpZiAocGx1Z2luLnJhdGVMaW1pdCkge1xuICAgICAgY29uc3QgbWF0Y2hlZFJ1bGUgPSBwbHVnaW4ucmF0ZUxpbWl0LmZpbmQoXG4gICAgICAgIChydWxlKSA9PiBydWxlLnBhdGhNYXRjaGVyKHBhdGgpXG4gICAgICApO1xuICAgICAgaWYgKG1hdGNoZWRSdWxlKSB7XG4gICAgICAgIHdpbmRvdyA9IG1hdGNoZWRSdWxlLndpbmRvdztcbiAgICAgICAgbWF4ID0gbWF0Y2hlZFJ1bGUubWF4O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGN0eC5yYXRlTGltaXQuY3VzdG9tUnVsZXMpIHtcbiAgICBjb25zdCBfcGF0aCA9IE9iamVjdC5rZXlzKGN0eC5yYXRlTGltaXQuY3VzdG9tUnVsZXMpLmZpbmQoKHApID0+IHtcbiAgICAgIGlmIChwLmluY2x1ZGVzKFwiKlwiKSkge1xuICAgICAgICBjb25zdCBpc01hdGNoID0gd2lsZGNhcmRNYXRjaChwKShwYXRoKTtcbiAgICAgICAgcmV0dXJuIGlzTWF0Y2g7XG4gICAgICB9XG4gICAgICByZXR1cm4gcCA9PT0gcGF0aDtcbiAgICB9KTtcbiAgICBpZiAoX3BhdGgpIHtcbiAgICAgIGNvbnN0IGN1c3RvbVJ1bGUgPSBjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzW19wYXRoXTtcbiAgICAgIGNvbnN0IHJlc29sdmVkID0gdHlwZW9mIGN1c3RvbVJ1bGUgPT09IFwiZnVuY3Rpb25cIiA/IGF3YWl0IGN1c3RvbVJ1bGUocmVxKSA6IGN1c3RvbVJ1bGU7XG4gICAgICBpZiAocmVzb2x2ZWQpIHtcbiAgICAgICAgd2luZG93ID0gcmVzb2x2ZWQud2luZG93O1xuICAgICAgICBtYXggPSByZXNvbHZlZC5tYXg7XG4gICAgICB9XG4gICAgICBpZiAocmVzb2x2ZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgY29uc3Qgc3RvcmFnZSA9IGdldFJhdGVMaW1pdFN0b3JhZ2UoY3R4LCB7XG4gICAgd2luZG93XG4gIH0pO1xuICBjb25zdCBkYXRhID0gYXdhaXQgc3RvcmFnZS5nZXQoa2V5KTtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgaWYgKCFkYXRhKSB7XG4gICAgYXdhaXQgc3RvcmFnZS5zZXQoa2V5LCB7XG4gICAgICBrZXksXG4gICAgICBjb3VudDogMSxcbiAgICAgIGxhc3RSZXF1ZXN0OiBub3dcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0UmVxdWVzdCA9IG5vdyAtIGRhdGEubGFzdFJlcXVlc3Q7XG4gICAgaWYgKHNob3VsZFJhdGVMaW1pdChtYXgsIHdpbmRvdywgZGF0YSkpIHtcbiAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBnZXRSZXRyeUFmdGVyKGRhdGEubGFzdFJlcXVlc3QsIHdpbmRvdyk7XG4gICAgICByZXR1cm4gcmF0ZUxpbWl0UmVzcG9uc2UocmV0cnlBZnRlcik7XG4gICAgfSBlbHNlIGlmICh0aW1lU2luY2VMYXN0UmVxdWVzdCA+IHdpbmRvdyAqIDFlMykge1xuICAgICAgYXdhaXQgc3RvcmFnZS5zZXQoXG4gICAgICAgIGtleSxcbiAgICAgICAge1xuICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgY291bnQ6IDEsXG4gICAgICAgICAgbGFzdFJlcXVlc3Q6IG5vd1xuICAgICAgICB9LFxuICAgICAgICB0cnVlXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBzdG9yYWdlLnNldChcbiAgICAgICAga2V5LFxuICAgICAgICB7XG4gICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICBjb3VudDogZGF0YS5jb3VudCArIDEsXG4gICAgICAgICAgbGFzdFJlcXVlc3Q6IG5vd1xuICAgICAgICB9LFxuICAgICAgICB0cnVlXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gZ2V0RGVmYXVsdFNwZWNpYWxSdWxlcygpIHtcbiAgY29uc3Qgc3BlY2lhbFJ1bGVzID0gW1xuICAgIHtcbiAgICAgIHBhdGhNYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHBhdGguc3RhcnRzV2l0aChcIi9zaWduLWluXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9zaWduLXVwXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9jaGFuZ2UtcGFzc3dvcmRcIikgfHwgcGF0aC5zdGFydHNXaXRoKFwiL2NoYW5nZS1lbWFpbFwiKTtcbiAgICAgIH0sXG4gICAgICB3aW5kb3c6IDEwLFxuICAgICAgbWF4OiAzXG4gICAgfVxuICBdO1xuICByZXR1cm4gc3BlY2lhbFJ1bGVzO1xufVxuXG5mdW5jdGlvbiBjaGVja0VuZHBvaW50Q29uZmxpY3RzKG9wdGlvbnMsIGxvZ2dlcjIpIHtcbiAgY29uc3QgZW5kcG9pbnRSZWdpc3RyeSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIG9wdGlvbnMucGx1Z2lucz8uZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgaWYgKHBsdWdpbi5lbmRwb2ludHMpIHtcbiAgICAgIGZvciAoY29uc3QgW2tleSwgZW5kcG9pbnRdIG9mIE9iamVjdC5lbnRyaWVzKHBsdWdpbi5lbmRwb2ludHMpKSB7XG4gICAgICAgIGlmIChlbmRwb2ludCAmJiBcInBhdGhcIiBpbiBlbmRwb2ludCkge1xuICAgICAgICAgIGNvbnN0IHBhdGggPSBlbmRwb2ludC5wYXRoO1xuICAgICAgICAgIGxldCBtZXRob2RzID0gW107XG4gICAgICAgICAgaWYgKGVuZHBvaW50Lm9wdGlvbnMgJiYgXCJtZXRob2RcIiBpbiBlbmRwb2ludC5vcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShlbmRwb2ludC5vcHRpb25zLm1ldGhvZCkpIHtcbiAgICAgICAgICAgICAgbWV0aG9kcyA9IGVuZHBvaW50Lm9wdGlvbnMubWV0aG9kO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZW5kcG9pbnQub3B0aW9ucy5tZXRob2QgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgbWV0aG9kcyA9IFtlbmRwb2ludC5vcHRpb25zLm1ldGhvZF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChtZXRob2RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbWV0aG9kcyA9IFtcIipcIl07XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZW5kcG9pbnRSZWdpc3RyeS5oYXMocGF0aCkpIHtcbiAgICAgICAgICAgIGVuZHBvaW50UmVnaXN0cnkuc2V0KHBhdGgsIFtdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZW5kcG9pbnRSZWdpc3RyeS5nZXQocGF0aCkucHVzaCh7XG4gICAgICAgICAgICBwbHVnaW5JZDogcGx1Z2luLmlkLFxuICAgICAgICAgICAgZW5kcG9pbnRLZXk6IGtleSxcbiAgICAgICAgICAgIG1ldGhvZHNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGNvbnN0IGNvbmZsaWN0cyA9IFtdO1xuICBmb3IgKGNvbnN0IFtwYXRoLCBlbnRyaWVzXSBvZiBlbmRwb2ludFJlZ2lzdHJ5LmVudHJpZXMoKSkge1xuICAgIGlmIChlbnRyaWVzLmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnN0IG1ldGhvZE1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gICAgICBsZXQgaGFzQ29uZmxpY3QgPSBmYWxzZTtcbiAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgICAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiBlbnRyeS5tZXRob2RzKSB7XG4gICAgICAgICAgaWYgKCFtZXRob2RNYXAuaGFzKG1ldGhvZCkpIHtcbiAgICAgICAgICAgIG1ldGhvZE1hcC5zZXQobWV0aG9kLCBbXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1ldGhvZE1hcC5nZXQobWV0aG9kKS5wdXNoKGVudHJ5LnBsdWdpbklkKTtcbiAgICAgICAgICBpZiAobWV0aG9kTWFwLmdldChtZXRob2QpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGhhc0NvbmZsaWN0ID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCIqXCIgJiYgZW50cmllcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBoYXNDb25mbGljdCA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgIT09IFwiKlwiICYmIG1ldGhvZE1hcC5oYXMoXCIqXCIpKSB7XG4gICAgICAgICAgICBoYXNDb25mbGljdCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoaGFzQ29uZmxpY3QpIHtcbiAgICAgICAgY29uc3QgdW5pcXVlUGx1Z2lucyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlKSA9PiBlLnBsdWdpbklkKSldO1xuICAgICAgICBjb25zdCBjb25mbGljdGluZ01ldGhvZHMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBbbWV0aG9kLCBwbHVnaW5zXSBvZiBtZXRob2RNYXAuZW50cmllcygpKSB7XG4gICAgICAgICAgaWYgKHBsdWdpbnMubGVuZ3RoID4gMSB8fCBtZXRob2QgPT09IFwiKlwiICYmIGVudHJpZXMubGVuZ3RoID4gMSB8fCBtZXRob2QgIT09IFwiKlwiICYmIG1ldGhvZE1hcC5oYXMoXCIqXCIpKSB7XG4gICAgICAgICAgICBjb25mbGljdGluZ01ldGhvZHMucHVzaChtZXRob2QpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25mbGljdHMucHVzaCh7XG4gICAgICAgICAgcGF0aCxcbiAgICAgICAgICBwbHVnaW5zOiB1bmlxdWVQbHVnaW5zLFxuICAgICAgICAgIGNvbmZsaWN0aW5nTWV0aG9kc1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGNvbmZsaWN0cy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgY29uZmxpY3RNZXNzYWdlcyA9IGNvbmZsaWN0cy5tYXAoXG4gICAgICAoY29uZmxpY3QpID0+IGAgIC0gXCIke2NvbmZsaWN0LnBhdGh9XCIgWyR7Y29uZmxpY3QuY29uZmxpY3RpbmdNZXRob2RzLmpvaW4oXCIsIFwiKX1dIHVzZWQgYnkgcGx1Z2luczogJHtjb25mbGljdC5wbHVnaW5zLmpvaW4oXCIsIFwiKX1gXG4gICAgKS5qb2luKFwiXFxuXCIpO1xuICAgIGxvZ2dlcjIuZXJyb3IoXG4gICAgICBgRW5kcG9pbnQgcGF0aCBjb25mbGljdHMgZGV0ZWN0ZWQhIE11bHRpcGxlIHBsdWdpbnMgYXJlIHRyeWluZyB0byB1c2UgdGhlIHNhbWUgZW5kcG9pbnQgcGF0aHMgd2l0aCBjb25mbGljdGluZyBIVFRQIG1ldGhvZHM6XG4ke2NvbmZsaWN0TWVzc2FnZXN9XG5cblRvIHJlc29sdmUgdGhpcywgeW91IGNhbjpcblx0MS4gVXNlIG9ubHkgb25lIG9mIHRoZSBjb25mbGljdGluZyBwbHVnaW5zXG5cdDIuIENvbmZpZ3VyZSB0aGUgcGx1Z2lucyB0byB1c2UgZGlmZmVyZW50IHBhdGhzIChpZiBzdXBwb3J0ZWQpXG5cdDMuIEVuc3VyZSBwbHVnaW5zIHVzZSBkaWZmZXJlbnQgSFRUUCBtZXRob2RzIGZvciB0aGUgc2FtZSBwYXRoXG5gXG4gICAgKTtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0RW5kcG9pbnRzKGN0eCwgb3B0aW9ucykge1xuICBjb25zdCBwbHVnaW5FbmRwb2ludHMgPSBvcHRpb25zLnBsdWdpbnM/LnJlZHVjZSgoYWNjLCBwbHVnaW4pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uYWNjLFxuICAgICAgLi4ucGx1Z2luLmVuZHBvaW50c1xuICAgIH07XG4gIH0sIHt9KSA/PyB7fTtcbiAgY29uc3QgbWlkZGxld2FyZXMgPSBvcHRpb25zLnBsdWdpbnM/Lm1hcChcbiAgICAocGx1Z2luKSA9PiBwbHVnaW4ubWlkZGxld2FyZXM/Lm1hcCgobSkgPT4ge1xuICAgICAgY29uc3QgbWlkZGxld2FyZSA9IChhc3luYyAoY29udGV4dCkgPT4ge1xuICAgICAgICBjb25zdCBhdXRoQ29udGV4dCA9IGF3YWl0IGN0eDtcbiAgICAgICAgcmV0dXJuIG0ubWlkZGxld2FyZSh7XG4gICAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAuLi5hdXRoQ29udGV4dCxcbiAgICAgICAgICAgIC4uLmNvbnRleHQuY29udGV4dFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIG1pZGRsZXdhcmUub3B0aW9ucyA9IG0ubWlkZGxld2FyZS5vcHRpb25zO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aDogbS5wYXRoLFxuICAgICAgICBtaWRkbGV3YXJlXG4gICAgICB9O1xuICAgIH0pXG4gICkuZmlsdGVyKChwbHVnaW4pID0+IHBsdWdpbiAhPT0gdm9pZCAwKS5mbGF0KCkgfHwgW107XG4gIGNvbnN0IGJhc2VFbmRwb2ludHMgPSB7XG4gICAgc2lnbkluU29jaWFsLFxuICAgIGNhbGxiYWNrT0F1dGgsXG4gICAgZ2V0U2Vzc2lvbjogZ2V0U2Vzc2lvbigpLFxuICAgIHNpZ25PdXQsXG4gICAgc2lnblVwRW1haWw6IHNpZ25VcEVtYWlsKCksXG4gICAgc2lnbkluRW1haWwsXG4gICAgZm9yZ2V0UGFzc3dvcmQsXG4gICAgcmVzZXRQYXNzd29yZCxcbiAgICB2ZXJpZnlFbWFpbCxcbiAgICBzZW5kVmVyaWZpY2F0aW9uRW1haWwsXG4gICAgY2hhbmdlRW1haWwsXG4gICAgY2hhbmdlUGFzc3dvcmQsXG4gICAgc2V0UGFzc3dvcmQsXG4gICAgdXBkYXRlVXNlcjogdXBkYXRlVXNlcigpLFxuICAgIGRlbGV0ZVVzZXIsXG4gICAgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjayxcbiAgICByZXF1ZXN0UGFzc3dvcmRSZXNldCxcbiAgICByZXF1ZXN0UGFzc3dvcmRSZXNldENhbGxiYWNrLFxuICAgIGxpc3RTZXNzaW9uczogbGlzdFNlc3Npb25zKCksXG4gICAgcmV2b2tlU2Vzc2lvbixcbiAgICByZXZva2VTZXNzaW9ucyxcbiAgICByZXZva2VPdGhlclNlc3Npb25zLFxuICAgIGxpbmtTb2NpYWxBY2NvdW50LFxuICAgIGxpc3RVc2VyQWNjb3VudHMsXG4gICAgZGVsZXRlVXNlckNhbGxiYWNrLFxuICAgIHVubGlua0FjY291bnQsXG4gICAgcmVmcmVzaFRva2VuLFxuICAgIGdldEFjY2Vzc1Rva2VuLFxuICAgIGFjY291bnRJbmZvXG4gIH07XG4gIGNvbnN0IGVuZHBvaW50cyA9IHtcbiAgICAuLi5iYXNlRW5kcG9pbnRzLFxuICAgIC4uLnBsdWdpbkVuZHBvaW50cyxcbiAgICBvayxcbiAgICBlcnJvclxuICB9O1xuICBjb25zdCBhcGkgPSB0b0F1dGhFbmRwb2ludHMoZW5kcG9pbnRzLCBjdHgpO1xuICByZXR1cm4ge1xuICAgIGFwaSxcbiAgICBtaWRkbGV3YXJlc1xuICB9O1xufVxuY29uc3Qgcm91dGVyID0gKGN0eCwgb3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGFwaSwgbWlkZGxld2FyZXMgfSA9IGdldEVuZHBvaW50cyhjdHgsIG9wdGlvbnMpO1xuICBjb25zdCBiYXNlUGF0aCA9IG5ldyBVUkwoY3R4LmJhc2VVUkwpLnBhdGhuYW1lO1xuICByZXR1cm4gY3JlYXRlUm91dGVyKGFwaSwge1xuICAgIHJvdXRlckNvbnRleHQ6IGN0eCxcbiAgICBvcGVuYXBpOiB7XG4gICAgICBkaXNhYmxlZDogdHJ1ZVxuICAgIH0sXG4gICAgYmFzZVBhdGgsXG4gICAgcm91dGVyTWlkZGxld2FyZTogW1xuICAgICAge1xuICAgICAgICBwYXRoOiBcIi8qKlwiLFxuICAgICAgICBtaWRkbGV3YXJlOiBvcmlnaW5DaGVja01pZGRsZXdhcmVcbiAgICAgIH0sXG4gICAgICAuLi5taWRkbGV3YXJlc1xuICAgIF0sXG4gICAgYXN5bmMgb25SZXF1ZXN0KHJlcSkge1xuICAgICAgY29uc3QgZGlzYWJsZWRQYXRocyA9IGN0eC5vcHRpb25zLmRpc2FibGVkUGF0aHMgfHwgW107XG4gICAgICBjb25zdCBwYXRoID0gbmV3IFVSTChyZXEudXJsKS5wYXRobmFtZS5yZXBsYWNlKGJhc2VQYXRoLCBcIlwiKTtcbiAgICAgIGlmIChkaXNhYmxlZFBhdGhzLmluY2x1ZGVzKHBhdGgpKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXCJOb3QgRm91bmRcIiwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIGN0eC5vcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICAgICAgaWYgKHBsdWdpbi5vblJlcXVlc3QpIHtcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBsdWdpbi5vblJlcXVlc3QocmVxLCBjdHgpO1xuICAgICAgICAgIGlmIChyZXNwb25zZSAmJiBcInJlc3BvbnNlXCIgaW4gcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZXNwb25zZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3BvbnNlICYmIFwicmVxdWVzdFwiIGluIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zdCByYXRlTGltaXRSZXNwb25zZSA9IGF3YWl0IG9uUmVxdWVzdFJhdGVMaW1pdChcbiAgICAgICAgICAgICAgcmVzcG9uc2UucmVxdWVzdCxcbiAgICAgICAgICAgICAgY3R4XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKHJhdGVMaW1pdFJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIHJldHVybiByYXRlTGltaXRSZXNwb25zZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZXF1ZXN0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9uUmVxdWVzdFJhdGVMaW1pdChyZXEsIGN0eCk7XG4gICAgfSxcbiAgICBhc3luYyBvblJlc3BvbnNlKHJlcykge1xuICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgY3R4Lm9wdGlvbnMucGx1Z2lucyB8fCBbXSkge1xuICAgICAgICBpZiAocGx1Z2luLm9uUmVzcG9uc2UpIHtcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBsdWdpbi5vblJlc3BvbnNlKHJlcywgY3R4KTtcbiAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZXNwb25zZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBvbkVycm9yKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IgJiYgZS5zdGF0dXMgPT09IFwiRk9VTkRcIikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5vbkFQSUVycm9yPy50aHJvdykge1xuICAgICAgICB0aHJvdyBlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMub25BUElFcnJvcj8ub25FcnJvcikge1xuICAgICAgICBvcHRpb25zLm9uQVBJRXJyb3Iub25FcnJvcihlLCBjdHgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBvcHRMb2dMZXZlbCA9IG9wdGlvbnMubG9nZ2VyPy5sZXZlbDtcbiAgICAgIGNvbnN0IGxvZyA9IG9wdExvZ0xldmVsID09PSBcImVycm9yXCIgfHwgb3B0TG9nTGV2ZWwgPT09IFwid2FyblwiIHx8IG9wdExvZ0xldmVsID09PSBcImRlYnVnXCIgPyBsb2dnZXIgOiB2b2lkIDA7XG4gICAgICBpZiAob3B0aW9ucy5sb2dnZXI/LmRpc2FibGVkICE9PSB0cnVlKSB7XG4gICAgICAgIGlmIChlICYmIHR5cGVvZiBlID09PSBcIm9iamVjdFwiICYmIFwibWVzc2FnZVwiIGluIGUgJiYgdHlwZW9mIGUubWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoXCJubyBjb2x1bW5cIikgfHwgZS5tZXNzYWdlLmluY2x1ZGVzKFwiY29sdW1uXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcInJlbGF0aW9uXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcInRhYmxlXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgICAgICBjdHgubG9nZ2VyPy5lcnJvcihlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgaWYgKGUuc3RhdHVzID09PSBcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiKSB7XG4gICAgICAgICAgICBjdHgubG9nZ2VyLmVycm9yKGUuc3RhdHVzLCBlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbG9nPy5lcnJvcihlLm1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN0eC5sb2dnZXI/LmVycm9yKFxuICAgICAgICAgICAgZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlID8gZS5uYW1lIDogXCJcIixcbiAgICAgICAgICAgIGVcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmV4cG9ydCB7IGFjY291bnRJbmZvLCBjYWxsYmFja09BdXRoLCBjaGFuZ2VFbWFpbCwgY2hhbmdlUGFzc3dvcmQsIGNoZWNrRW5kcG9pbnRDb25mbGljdHMsIGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4sIGRlbGV0ZVVzZXIsIGRlbGV0ZVVzZXJDYWxsYmFjaywgZXJyb3IsIGZvcmdldFBhc3N3b3JkLCBmb3JnZXRQYXNzd29yZENhbGxiYWNrLCBnZXRBY2Nlc3NUb2tlbiwgZ2V0RW5kcG9pbnRzLCBnZXRTZXNzaW9uLCBsaW5rU29jaWFsQWNjb3VudCwgbGlzdFNlc3Npb25zLCBsaXN0VXNlckFjY291bnRzLCBvaywgb3JpZ2luQ2hlY2tNaWRkbGV3YXJlLCByZWZyZXNoVG9rZW4sIHJlcXVlc3RQYXNzd29yZFJlc2V0LCByZXF1ZXN0UGFzc3dvcmRSZXNldENhbGxiYWNrLCByZXNldFBhc3N3b3JkLCByZXZva2VPdGhlclNlc3Npb25zLCByZXZva2VTZXNzaW9uLCByZXZva2VTZXNzaW9ucywgcm91dGVyLCBzZW5kVmVyaWZpY2F0aW9uRW1haWwsIHNldFBhc3N3b3JkLCBzaWduSW5FbWFpbCwgc2lnbkluU29jaWFsLCBzaWduT3V0LCBzaWduVXBFbWFpbCwgdW5saW5rQWNjb3VudCwgdXBkYXRlVXNlciwgdmVyaWZ5RW1haWwgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/api/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs":
/*!*********************************************************************!*\
  !*** ./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BunSqliteAdapter: () => (/* binding */ BunSqliteAdapter),\n/* harmony export */   BunSqliteDialect: () => (/* binding */ BunSqliteDialect),\n/* harmony export */   BunSqliteDriver: () => (/* binding */ BunSqliteDriver),\n/* harmony export */   BunSqliteIntrospector: () => (/* binding */ BunSqliteIntrospector),\n/* harmony export */   BunSqliteQueryCompiler: () => (/* binding */ BunSqliteQueryCompiler)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/compiled-query.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/migration/migrator.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/raw-builder/sql.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/default-query-compiler.js\");\n\n\nclass BunSqliteAdapter {\n  get supportsCreateIfNotExists() {\n    return true;\n  }\n  get supportsTransactionalDdl() {\n    return false;\n  }\n  get supportsReturning() {\n    return true;\n  }\n  async acquireMigrationLock() {\n  }\n  async releaseMigrationLock() {\n  }\n  get supportsOutput() {\n    return true;\n  }\n}\nclass BunSqliteDriver {\n  #config;\n  #connectionMutex = new ConnectionMutex();\n  #db;\n  #connection;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  async init() {\n    this.#db = this.#config.database;\n    this.#connection = new BunSqliteConnection(this.#db);\n    if (this.#config.onCreateConnection) {\n      await this.#config.onCreateConnection(this.#connection);\n    }\n  }\n  async acquireConnection() {\n    await this.#connectionMutex.lock();\n    return this.#connection;\n  }\n  async beginTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"begin\"));\n  }\n  async commitTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"commit\"));\n  }\n  async rollbackTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"rollback\"));\n  }\n  async releaseConnection() {\n    this.#connectionMutex.unlock();\n  }\n  async destroy() {\n    this.#db?.close();\n  }\n}\nclass BunSqliteConnection {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  executeQuery(compiledQuery) {\n    const { sql: sql2, parameters } = compiledQuery;\n    const stmt = this.#db.prepare(sql2);\n    return Promise.resolve({\n      rows: stmt.all(parameters)\n    });\n  }\n  async *streamQuery() {\n    throw new Error(\"Streaming query is not supported by SQLite driver.\");\n  }\n}\nclass ConnectionMutex {\n  #promise;\n  #resolve;\n  async lock() {\n    while (this.#promise) {\n      await this.#promise;\n    }\n    this.#promise = new Promise((resolve) => {\n      this.#resolve = resolve;\n    });\n  }\n  unlock() {\n    const resolve = this.#resolve;\n    this.#promise = void 0;\n    this.#resolve = void 0;\n    resolve?.();\n  }\n}\nclass BunSqliteIntrospector {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  async getSchemas() {\n    return [];\n  }\n  async getTables(options = { withInternalKyselyTables: false }) {\n    let query = this.#db.selectFrom(\"sqlite_schema\").where(\"type\", \"=\", \"table\").where(\"name\", \"not like\", \"sqlite_%\").select(\"name\").$castTo();\n    if (!options.withInternalKyselyTables) {\n      query = query.where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_TABLE).where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_LOCK_TABLE);\n    }\n    const tables = await query.execute();\n    return Promise.all(tables.map(({ name }) => this.#getTableMetadata(name)));\n  }\n  async getMetadata(options) {\n    return {\n      tables: await this.getTables(options)\n    };\n  }\n  async #getTableMetadata(table) {\n    const db = this.#db;\n    const createSql = await db.selectFrom(\"sqlite_master\").where(\"name\", \"=\", table).select(\"sql\").$castTo().execute();\n    const autoIncrementCol = createSql[0]?.sql?.split(/[\\(\\),]/)?.find((it) => it.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g, \"\");\n    const columns = await db.selectFrom(\n      (0,kysely__WEBPACK_IMPORTED_MODULE_2__.sql)`pragma_table_info(${table})`.as(\"table_info\")\n    ).select([\"name\", \"type\", \"notnull\", \"dflt_value\"]).execute();\n    return {\n      name: table,\n      columns: columns.map((col) => ({\n        name: col.name,\n        dataType: col.type,\n        isNullable: !col.notnull,\n        isAutoIncrementing: col.name === autoIncrementCol,\n        hasDefaultValue: col.dflt_value != null\n      })),\n      isView: true\n    };\n  }\n}\nclass BunSqliteQueryCompiler extends kysely__WEBPACK_IMPORTED_MODULE_3__.DefaultQueryCompiler {\n  getCurrentParameterPlaceholder() {\n    return \"?\";\n  }\n  getLeftIdentifierWrapper() {\n    return '\"';\n  }\n  getRightIdentifierWrapper() {\n    return '\"';\n  }\n  getAutoIncrement() {\n    return \"autoincrement\";\n  }\n}\nclass BunSqliteDialect {\n  #config;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  createDriver() {\n    return new BunSqliteDriver(this.#config);\n  }\n  createQueryCompiler() {\n    return new BunSqliteQueryCompiler();\n  }\n  createAdapter() {\n    return new BunSqliteAdapter();\n  }\n  createIntrospector(db) {\n    return new BunSqliteIntrospector(db);\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVua3MvYnVuLXNxbGl0ZS1kaWFsZWN0Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBeUg7O0FBRXpIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpREFBYTtBQUMvQztBQUNBO0FBQ0Esa0NBQWtDLGlEQUFhO0FBQy9DO0FBQ0E7QUFDQSxrQ0FBa0MsaURBQWE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0JBQXdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGlDQUFpQztBQUMvRDtBQUNBO0FBQ0Esd0NBQXdDLDJEQUF1QixzQkFBc0IsZ0VBQTRCO0FBQ2pIO0FBQ0E7QUFDQSxxQ0FBcUMsTUFBTTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSwyQ0FBRyxxQkFBcUIsTUFBTTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsd0RBQW9CO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRThHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVua3MvYnVuLXNxbGl0ZS1kaWFsZWN0Lm1qcz9kMjI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBpbGVkUXVlcnksIERlZmF1bHRRdWVyeUNvbXBpbGVyLCBERUZBVUxUX01JR1JBVElPTl9UQUJMRSwgREVGQVVMVF9NSUdSQVRJT05fTE9DS19UQUJMRSwgc3FsIH0gZnJvbSAna3lzZWx5JztcblxuY2xhc3MgQnVuU3FsaXRlQWRhcHRlciB7XG4gIGdldCBzdXBwb3J0c0NyZWF0ZUlmTm90RXhpc3RzKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGdldCBzdXBwb3J0c1RyYW5zYWN0aW9uYWxEZGwoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGdldCBzdXBwb3J0c1JldHVybmluZygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBhc3luYyBhY3F1aXJlTWlncmF0aW9uTG9jaygpIHtcbiAgfVxuICBhc3luYyByZWxlYXNlTWlncmF0aW9uTG9jaygpIHtcbiAgfVxuICBnZXQgc3VwcG9ydHNPdXRwdXQoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cbmNsYXNzIEJ1blNxbGl0ZURyaXZlciB7XG4gICNjb25maWc7XG4gICNjb25uZWN0aW9uTXV0ZXggPSBuZXcgQ29ubmVjdGlvbk11dGV4KCk7XG4gICNkYjtcbiAgI2Nvbm5lY3Rpb247XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuI2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG4gIH1cbiAgYXN5bmMgaW5pdCgpIHtcbiAgICB0aGlzLiNkYiA9IHRoaXMuI2NvbmZpZy5kYXRhYmFzZTtcbiAgICB0aGlzLiNjb25uZWN0aW9uID0gbmV3IEJ1blNxbGl0ZUNvbm5lY3Rpb24odGhpcy4jZGIpO1xuICAgIGlmICh0aGlzLiNjb25maWcub25DcmVhdGVDb25uZWN0aW9uKSB7XG4gICAgICBhd2FpdCB0aGlzLiNjb25maWcub25DcmVhdGVDb25uZWN0aW9uKHRoaXMuI2Nvbm5lY3Rpb24pO1xuICAgIH1cbiAgfVxuICBhc3luYyBhY3F1aXJlQ29ubmVjdGlvbigpIHtcbiAgICBhd2FpdCB0aGlzLiNjb25uZWN0aW9uTXV0ZXgubG9jaygpO1xuICAgIHJldHVybiB0aGlzLiNjb25uZWN0aW9uO1xuICB9XG4gIGFzeW5jIGJlZ2luVHJhbnNhY3Rpb24oY29ubmVjdGlvbikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZVF1ZXJ5KENvbXBpbGVkUXVlcnkucmF3KFwiYmVnaW5cIikpO1xuICB9XG4gIGFzeW5jIGNvbW1pdFRyYW5zYWN0aW9uKGNvbm5lY3Rpb24pIHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGVRdWVyeShDb21waWxlZFF1ZXJ5LnJhdyhcImNvbW1pdFwiKSk7XG4gIH1cbiAgYXN5bmMgcm9sbGJhY2tUcmFuc2FjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlUXVlcnkoQ29tcGlsZWRRdWVyeS5yYXcoXCJyb2xsYmFja1wiKSk7XG4gIH1cbiAgYXN5bmMgcmVsZWFzZUNvbm5lY3Rpb24oKSB7XG4gICAgdGhpcy4jY29ubmVjdGlvbk11dGV4LnVubG9jaygpO1xuICB9XG4gIGFzeW5jIGRlc3Ryb3koKSB7XG4gICAgdGhpcy4jZGI/LmNsb3NlKCk7XG4gIH1cbn1cbmNsYXNzIEJ1blNxbGl0ZUNvbm5lY3Rpb24ge1xuICAjZGI7XG4gIGNvbnN0cnVjdG9yKGRiKSB7XG4gICAgdGhpcy4jZGIgPSBkYjtcbiAgfVxuICBleGVjdXRlUXVlcnkoY29tcGlsZWRRdWVyeSkge1xuICAgIGNvbnN0IHsgc3FsOiBzcWwyLCBwYXJhbWV0ZXJzIH0gPSBjb21waWxlZFF1ZXJ5O1xuICAgIGNvbnN0IHN0bXQgPSB0aGlzLiNkYi5wcmVwYXJlKHNxbDIpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgcm93czogc3RtdC5hbGwocGFyYW1ldGVycylcbiAgICB9KTtcbiAgfVxuICBhc3luYyAqc3RyZWFtUXVlcnkoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiU3RyZWFtaW5nIHF1ZXJ5IGlzIG5vdCBzdXBwb3J0ZWQgYnkgU1FMaXRlIGRyaXZlci5cIik7XG4gIH1cbn1cbmNsYXNzIENvbm5lY3Rpb25NdXRleCB7XG4gICNwcm9taXNlO1xuICAjcmVzb2x2ZTtcbiAgYXN5bmMgbG9jaygpIHtcbiAgICB3aGlsZSAodGhpcy4jcHJvbWlzZSkge1xuICAgICAgYXdhaXQgdGhpcy4jcHJvbWlzZTtcbiAgICB9XG4gICAgdGhpcy4jcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0aGlzLiNyZXNvbHZlID0gcmVzb2x2ZTtcbiAgICB9KTtcbiAgfVxuICB1bmxvY2soKSB7XG4gICAgY29uc3QgcmVzb2x2ZSA9IHRoaXMuI3Jlc29sdmU7XG4gICAgdGhpcy4jcHJvbWlzZSA9IHZvaWQgMDtcbiAgICB0aGlzLiNyZXNvbHZlID0gdm9pZCAwO1xuICAgIHJlc29sdmU/LigpO1xuICB9XG59XG5jbGFzcyBCdW5TcWxpdGVJbnRyb3NwZWN0b3Ige1xuICAjZGI7XG4gIGNvbnN0cnVjdG9yKGRiKSB7XG4gICAgdGhpcy4jZGIgPSBkYjtcbiAgfVxuICBhc3luYyBnZXRTY2hlbWFzKCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBhc3luYyBnZXRUYWJsZXMob3B0aW9ucyA9IHsgd2l0aEludGVybmFsS3lzZWx5VGFibGVzOiBmYWxzZSB9KSB7XG4gICAgbGV0IHF1ZXJ5ID0gdGhpcy4jZGIuc2VsZWN0RnJvbShcInNxbGl0ZV9zY2hlbWFcIikud2hlcmUoXCJ0eXBlXCIsIFwiPVwiLCBcInRhYmxlXCIpLndoZXJlKFwibmFtZVwiLCBcIm5vdCBsaWtlXCIsIFwic3FsaXRlXyVcIikuc2VsZWN0KFwibmFtZVwiKS4kY2FzdFRvKCk7XG4gICAgaWYgKCFvcHRpb25zLndpdGhJbnRlcm5hbEt5c2VseVRhYmxlcykge1xuICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZShcIm5hbWVcIiwgXCIhPVwiLCBERUZBVUxUX01JR1JBVElPTl9UQUJMRSkud2hlcmUoXCJuYW1lXCIsIFwiIT1cIiwgREVGQVVMVF9NSUdSQVRJT05fTE9DS19UQUJMRSk7XG4gICAgfVxuICAgIGNvbnN0IHRhYmxlcyA9IGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwodGFibGVzLm1hcCgoeyBuYW1lIH0pID0+IHRoaXMuI2dldFRhYmxlTWV0YWRhdGEobmFtZSkpKTtcbiAgfVxuICBhc3luYyBnZXRNZXRhZGF0YShvcHRpb25zKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRhYmxlczogYXdhaXQgdGhpcy5nZXRUYWJsZXMob3B0aW9ucylcbiAgICB9O1xuICB9XG4gIGFzeW5jICNnZXRUYWJsZU1ldGFkYXRhKHRhYmxlKSB7XG4gICAgY29uc3QgZGIgPSB0aGlzLiNkYjtcbiAgICBjb25zdCBjcmVhdGVTcWwgPSBhd2FpdCBkYi5zZWxlY3RGcm9tKFwic3FsaXRlX21hc3RlclwiKS53aGVyZShcIm5hbWVcIiwgXCI9XCIsIHRhYmxlKS5zZWxlY3QoXCJzcWxcIikuJGNhc3RUbygpLmV4ZWN1dGUoKTtcbiAgICBjb25zdCBhdXRvSW5jcmVtZW50Q29sID0gY3JlYXRlU3FsWzBdPy5zcWw/LnNwbGl0KC9bXFwoXFwpLF0vKT8uZmluZCgoaXQpID0+IGl0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJhdXRvaW5jcmVtZW50XCIpKT8uc3BsaXQoL1xccysvKT8uWzBdPy5yZXBsYWNlKC9bXCJgXS9nLCBcIlwiKTtcbiAgICBjb25zdCBjb2x1bW5zID0gYXdhaXQgZGIuc2VsZWN0RnJvbShcbiAgICAgIHNxbGBwcmFnbWFfdGFibGVfaW5mbygke3RhYmxlfSlgLmFzKFwidGFibGVfaW5mb1wiKVxuICAgICkuc2VsZWN0KFtcIm5hbWVcIiwgXCJ0eXBlXCIsIFwibm90bnVsbFwiLCBcImRmbHRfdmFsdWVcIl0pLmV4ZWN1dGUoKTtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGFibGUsXG4gICAgICBjb2x1bW5zOiBjb2x1bW5zLm1hcCgoY29sKSA9PiAoe1xuICAgICAgICBuYW1lOiBjb2wubmFtZSxcbiAgICAgICAgZGF0YVR5cGU6IGNvbC50eXBlLFxuICAgICAgICBpc051bGxhYmxlOiAhY29sLm5vdG51bGwsXG4gICAgICAgIGlzQXV0b0luY3JlbWVudGluZzogY29sLm5hbWUgPT09IGF1dG9JbmNyZW1lbnRDb2wsXG4gICAgICAgIGhhc0RlZmF1bHRWYWx1ZTogY29sLmRmbHRfdmFsdWUgIT0gbnVsbFxuICAgICAgfSkpLFxuICAgICAgaXNWaWV3OiB0cnVlXG4gICAgfTtcbiAgfVxufVxuY2xhc3MgQnVuU3FsaXRlUXVlcnlDb21waWxlciBleHRlbmRzIERlZmF1bHRRdWVyeUNvbXBpbGVyIHtcbiAgZ2V0Q3VycmVudFBhcmFtZXRlclBsYWNlaG9sZGVyKCkge1xuICAgIHJldHVybiBcIj9cIjtcbiAgfVxuICBnZXRMZWZ0SWRlbnRpZmllcldyYXBwZXIoKSB7XG4gICAgcmV0dXJuICdcIic7XG4gIH1cbiAgZ2V0UmlnaHRJZGVudGlmaWVyV3JhcHBlcigpIHtcbiAgICByZXR1cm4gJ1wiJztcbiAgfVxuICBnZXRBdXRvSW5jcmVtZW50KCkge1xuICAgIHJldHVybiBcImF1dG9pbmNyZW1lbnRcIjtcbiAgfVxufVxuY2xhc3MgQnVuU3FsaXRlRGlhbGVjdCB7XG4gICNjb25maWc7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuI2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG4gIH1cbiAgY3JlYXRlRHJpdmVyKCkge1xuICAgIHJldHVybiBuZXcgQnVuU3FsaXRlRHJpdmVyKHRoaXMuI2NvbmZpZyk7XG4gIH1cbiAgY3JlYXRlUXVlcnlDb21waWxlcigpIHtcbiAgICByZXR1cm4gbmV3IEJ1blNxbGl0ZVF1ZXJ5Q29tcGlsZXIoKTtcbiAgfVxuICBjcmVhdGVBZGFwdGVyKCkge1xuICAgIHJldHVybiBuZXcgQnVuU3FsaXRlQWRhcHRlcigpO1xuICB9XG4gIGNyZWF0ZUludHJvc3BlY3RvcihkYikge1xuICAgIHJldHVybiBuZXcgQnVuU3FsaXRlSW50cm9zcGVjdG9yKGRiKTtcbiAgfVxufVxuXG5leHBvcnQgeyBCdW5TcWxpdGVBZGFwdGVyLCBCdW5TcWxpdGVEaWFsZWN0LCBCdW5TcWxpdGVEcml2ZXIsIEJ1blNxbGl0ZUludHJvc3BlY3RvciwgQnVuU3FsaXRlUXVlcnlDb21waWxlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs":
/*!**********************************************************************!*\
  !*** ./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NodeSqliteAdapter: () => (/* binding */ NodeSqliteAdapter),\n/* harmony export */   NodeSqliteDialect: () => (/* binding */ NodeSqliteDialect),\n/* harmony export */   NodeSqliteDriver: () => (/* binding */ NodeSqliteDriver),\n/* harmony export */   NodeSqliteIntrospector: () => (/* binding */ NodeSqliteIntrospector),\n/* harmony export */   NodeSqliteQueryCompiler: () => (/* binding */ NodeSqliteQueryCompiler)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/compiled-query.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/migration/migrator.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/raw-builder/sql.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/default-query-compiler.js\");\n\n\nclass NodeSqliteAdapter {\n  get supportsCreateIfNotExists() {\n    return true;\n  }\n  get supportsTransactionalDdl() {\n    return false;\n  }\n  get supportsReturning() {\n    return true;\n  }\n  async acquireMigrationLock() {\n  }\n  async releaseMigrationLock() {\n  }\n  get supportsOutput() {\n    return true;\n  }\n}\nclass NodeSqliteDriver {\n  #config;\n  #connectionMutex = new ConnectionMutex();\n  #db;\n  #connection;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  async init() {\n    this.#db = this.#config.database;\n    this.#connection = new NodeSqliteConnection(this.#db);\n    if (this.#config.onCreateConnection) {\n      await this.#config.onCreateConnection(this.#connection);\n    }\n  }\n  async acquireConnection() {\n    await this.#connectionMutex.lock();\n    return this.#connection;\n  }\n  async beginTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"begin\"));\n  }\n  async commitTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"commit\"));\n  }\n  async rollbackTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"rollback\"));\n  }\n  async releaseConnection() {\n    this.#connectionMutex.unlock();\n  }\n  async destroy() {\n    this.#db?.close();\n  }\n}\nclass NodeSqliteConnection {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  executeQuery(compiledQuery) {\n    const { sql: sql2, parameters } = compiledQuery;\n    const stmt = this.#db.prepare(sql2);\n    const rows = stmt.all(...parameters);\n    return Promise.resolve({\n      rows\n    });\n  }\n  async *streamQuery() {\n    throw new Error(\"Streaming query is not supported by SQLite driver.\");\n  }\n}\nclass ConnectionMutex {\n  #promise;\n  #resolve;\n  async lock() {\n    while (this.#promise) {\n      await this.#promise;\n    }\n    this.#promise = new Promise((resolve) => {\n      this.#resolve = resolve;\n    });\n  }\n  unlock() {\n    const resolve = this.#resolve;\n    this.#promise = void 0;\n    this.#resolve = void 0;\n    resolve?.();\n  }\n}\nclass NodeSqliteIntrospector {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  async getSchemas() {\n    return [];\n  }\n  async getTables(options = { withInternalKyselyTables: false }) {\n    let query = this.#db.selectFrom(\"sqlite_schema\").where(\"type\", \"=\", \"table\").where(\"name\", \"not like\", \"sqlite_%\").select(\"name\").$castTo();\n    if (!options.withInternalKyselyTables) {\n      query = query.where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_TABLE).where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_LOCK_TABLE);\n    }\n    const tables = await query.execute();\n    return Promise.all(tables.map(({ name }) => this.#getTableMetadata(name)));\n  }\n  async getMetadata(options) {\n    return {\n      tables: await this.getTables(options)\n    };\n  }\n  async #getTableMetadata(table) {\n    const db = this.#db;\n    const createSql = await db.selectFrom(\"sqlite_master\").where(\"name\", \"=\", table).select(\"sql\").$castTo().execute();\n    const autoIncrementCol = createSql[0]?.sql?.split(/[\\(\\),]/)?.find((it) => it.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g, \"\");\n    const columns = await db.selectFrom(\n      (0,kysely__WEBPACK_IMPORTED_MODULE_2__.sql)`pragma_table_info(${table})`.as(\"table_info\")\n    ).select([\"name\", \"type\", \"notnull\", \"dflt_value\"]).execute();\n    return {\n      name: table,\n      columns: columns.map((col) => ({\n        name: col.name,\n        dataType: col.type,\n        isNullable: !col.notnull,\n        isAutoIncrementing: col.name === autoIncrementCol,\n        hasDefaultValue: col.dflt_value != null\n      })),\n      isView: true\n    };\n  }\n}\nclass NodeSqliteQueryCompiler extends kysely__WEBPACK_IMPORTED_MODULE_3__.DefaultQueryCompiler {\n  getCurrentParameterPlaceholder() {\n    return \"?\";\n  }\n  getLeftIdentifierWrapper() {\n    return '\"';\n  }\n  getRightIdentifierWrapper() {\n    return '\"';\n  }\n  getAutoIncrement() {\n    return \"autoincrement\";\n  }\n}\nclass NodeSqliteDialect {\n  #config;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  createDriver() {\n    return new NodeSqliteDriver(this.#config);\n  }\n  createQueryCompiler() {\n    return new NodeSqliteQueryCompiler();\n  }\n  createAdapter() {\n    return new NodeSqliteAdapter();\n  }\n  createIntrospector(db) {\n    return new NodeSqliteIntrospector(db);\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVua3Mvbm9kZS1zcWxpdGUtZGlhbGVjdC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQXlIOztBQUV6SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsaURBQWE7QUFDL0M7QUFDQTtBQUNBLGtDQUFrQyxpREFBYTtBQUMvQztBQUNBO0FBQ0Esa0NBQWtDLGlEQUFhO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdCQUF3QjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGlDQUFpQztBQUMvRDtBQUNBO0FBQ0Esd0NBQXdDLDJEQUF1QixzQkFBc0IsZ0VBQTRCO0FBQ2pIO0FBQ0E7QUFDQSxxQ0FBcUMsTUFBTTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSwyQ0FBRyxxQkFBcUIsTUFBTTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0Msd0RBQW9CO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW1IIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVua3Mvbm9kZS1zcWxpdGUtZGlhbGVjdC5tanM/NzUyNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21waWxlZFF1ZXJ5LCBEZWZhdWx0UXVlcnlDb21waWxlciwgREVGQVVMVF9NSUdSQVRJT05fVEFCTEUsIERFRkFVTFRfTUlHUkFUSU9OX0xPQ0tfVEFCTEUsIHNxbCB9IGZyb20gJ2t5c2VseSc7XG5cbmNsYXNzIE5vZGVTcWxpdGVBZGFwdGVyIHtcbiAgZ2V0IHN1cHBvcnRzQ3JlYXRlSWZOb3RFeGlzdHMoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzVHJhbnNhY3Rpb25hbERkbCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzUmV0dXJuaW5nKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGFzeW5jIGFjcXVpcmVNaWdyYXRpb25Mb2NrKCkge1xuICB9XG4gIGFzeW5jIHJlbGVhc2VNaWdyYXRpb25Mb2NrKCkge1xuICB9XG4gIGdldCBzdXBwb3J0c091dHB1dCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuY2xhc3MgTm9kZVNxbGl0ZURyaXZlciB7XG4gICNjb25maWc7XG4gICNjb25uZWN0aW9uTXV0ZXggPSBuZXcgQ29ubmVjdGlvbk11dGV4KCk7XG4gICNkYjtcbiAgI2Nvbm5lY3Rpb247XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuI2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG4gIH1cbiAgYXN5bmMgaW5pdCgpIHtcbiAgICB0aGlzLiNkYiA9IHRoaXMuI2NvbmZpZy5kYXRhYmFzZTtcbiAgICB0aGlzLiNjb25uZWN0aW9uID0gbmV3IE5vZGVTcWxpdGVDb25uZWN0aW9uKHRoaXMuI2RiKTtcbiAgICBpZiAodGhpcy4jY29uZmlnLm9uQ3JlYXRlQ29ubmVjdGlvbikge1xuICAgICAgYXdhaXQgdGhpcy4jY29uZmlnLm9uQ3JlYXRlQ29ubmVjdGlvbih0aGlzLiNjb25uZWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgYWNxdWlyZUNvbm5lY3Rpb24oKSB7XG4gICAgYXdhaXQgdGhpcy4jY29ubmVjdGlvbk11dGV4LmxvY2soKTtcbiAgICByZXR1cm4gdGhpcy4jY29ubmVjdGlvbjtcbiAgfVxuICBhc3luYyBiZWdpblRyYW5zYWN0aW9uKGNvbm5lY3Rpb24pIHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGVRdWVyeShDb21waWxlZFF1ZXJ5LnJhdyhcImJlZ2luXCIpKTtcbiAgfVxuICBhc3luYyBjb21taXRUcmFuc2FjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlUXVlcnkoQ29tcGlsZWRRdWVyeS5yYXcoXCJjb21taXRcIikpO1xuICB9XG4gIGFzeW5jIHJvbGxiYWNrVHJhbnNhY3Rpb24oY29ubmVjdGlvbikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZVF1ZXJ5KENvbXBpbGVkUXVlcnkucmF3KFwicm9sbGJhY2tcIikpO1xuICB9XG4gIGFzeW5jIHJlbGVhc2VDb25uZWN0aW9uKCkge1xuICAgIHRoaXMuI2Nvbm5lY3Rpb25NdXRleC51bmxvY2soKTtcbiAgfVxuICBhc3luYyBkZXN0cm95KCkge1xuICAgIHRoaXMuI2RiPy5jbG9zZSgpO1xuICB9XG59XG5jbGFzcyBOb2RlU3FsaXRlQ29ubmVjdGlvbiB7XG4gICNkYjtcbiAgY29uc3RydWN0b3IoZGIpIHtcbiAgICB0aGlzLiNkYiA9IGRiO1xuICB9XG4gIGV4ZWN1dGVRdWVyeShjb21waWxlZFF1ZXJ5KSB7XG4gICAgY29uc3QgeyBzcWw6IHNxbDIsIHBhcmFtZXRlcnMgfSA9IGNvbXBpbGVkUXVlcnk7XG4gICAgY29uc3Qgc3RtdCA9IHRoaXMuI2RiLnByZXBhcmUoc3FsMik7XG4gICAgY29uc3Qgcm93cyA9IHN0bXQuYWxsKC4uLnBhcmFtZXRlcnMpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgcm93c1xuICAgIH0pO1xuICB9XG4gIGFzeW5jICpzdHJlYW1RdWVyeSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdHJlYW1pbmcgcXVlcnkgaXMgbm90IHN1cHBvcnRlZCBieSBTUUxpdGUgZHJpdmVyLlwiKTtcbiAgfVxufVxuY2xhc3MgQ29ubmVjdGlvbk11dGV4IHtcbiAgI3Byb21pc2U7XG4gICNyZXNvbHZlO1xuICBhc3luYyBsb2NrKCkge1xuICAgIHdoaWxlICh0aGlzLiNwcm9taXNlKSB7XG4gICAgICBhd2FpdCB0aGlzLiNwcm9taXNlO1xuICAgIH1cbiAgICB0aGlzLiNwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHRoaXMuI3Jlc29sdmUgPSByZXNvbHZlO1xuICAgIH0pO1xuICB9XG4gIHVubG9jaygpIHtcbiAgICBjb25zdCByZXNvbHZlID0gdGhpcy4jcmVzb2x2ZTtcbiAgICB0aGlzLiNwcm9taXNlID0gdm9pZCAwO1xuICAgIHRoaXMuI3Jlc29sdmUgPSB2b2lkIDA7XG4gICAgcmVzb2x2ZT8uKCk7XG4gIH1cbn1cbmNsYXNzIE5vZGVTcWxpdGVJbnRyb3NwZWN0b3Ige1xuICAjZGI7XG4gIGNvbnN0cnVjdG9yKGRiKSB7XG4gICAgdGhpcy4jZGIgPSBkYjtcbiAgfVxuICBhc3luYyBnZXRTY2hlbWFzKCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBhc3luYyBnZXRUYWJsZXMob3B0aW9ucyA9IHsgd2l0aEludGVybmFsS3lzZWx5VGFibGVzOiBmYWxzZSB9KSB7XG4gICAgbGV0IHF1ZXJ5ID0gdGhpcy4jZGIuc2VsZWN0RnJvbShcInNxbGl0ZV9zY2hlbWFcIikud2hlcmUoXCJ0eXBlXCIsIFwiPVwiLCBcInRhYmxlXCIpLndoZXJlKFwibmFtZVwiLCBcIm5vdCBsaWtlXCIsIFwic3FsaXRlXyVcIikuc2VsZWN0KFwibmFtZVwiKS4kY2FzdFRvKCk7XG4gICAgaWYgKCFvcHRpb25zLndpdGhJbnRlcm5hbEt5c2VseVRhYmxlcykge1xuICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZShcIm5hbWVcIiwgXCIhPVwiLCBERUZBVUxUX01JR1JBVElPTl9UQUJMRSkud2hlcmUoXCJuYW1lXCIsIFwiIT1cIiwgREVGQVVMVF9NSUdSQVRJT05fTE9DS19UQUJMRSk7XG4gICAgfVxuICAgIGNvbnN0IHRhYmxlcyA9IGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwodGFibGVzLm1hcCgoeyBuYW1lIH0pID0+IHRoaXMuI2dldFRhYmxlTWV0YWRhdGEobmFtZSkpKTtcbiAgfVxuICBhc3luYyBnZXRNZXRhZGF0YShvcHRpb25zKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRhYmxlczogYXdhaXQgdGhpcy5nZXRUYWJsZXMob3B0aW9ucylcbiAgICB9O1xuICB9XG4gIGFzeW5jICNnZXRUYWJsZU1ldGFkYXRhKHRhYmxlKSB7XG4gICAgY29uc3QgZGIgPSB0aGlzLiNkYjtcbiAgICBjb25zdCBjcmVhdGVTcWwgPSBhd2FpdCBkYi5zZWxlY3RGcm9tKFwic3FsaXRlX21hc3RlclwiKS53aGVyZShcIm5hbWVcIiwgXCI9XCIsIHRhYmxlKS5zZWxlY3QoXCJzcWxcIikuJGNhc3RUbygpLmV4ZWN1dGUoKTtcbiAgICBjb25zdCBhdXRvSW5jcmVtZW50Q29sID0gY3JlYXRlU3FsWzBdPy5zcWw/LnNwbGl0KC9bXFwoXFwpLF0vKT8uZmluZCgoaXQpID0+IGl0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJhdXRvaW5jcmVtZW50XCIpKT8uc3BsaXQoL1xccysvKT8uWzBdPy5yZXBsYWNlKC9bXCJgXS9nLCBcIlwiKTtcbiAgICBjb25zdCBjb2x1bW5zID0gYXdhaXQgZGIuc2VsZWN0RnJvbShcbiAgICAgIHNxbGBwcmFnbWFfdGFibGVfaW5mbygke3RhYmxlfSlgLmFzKFwidGFibGVfaW5mb1wiKVxuICAgICkuc2VsZWN0KFtcIm5hbWVcIiwgXCJ0eXBlXCIsIFwibm90bnVsbFwiLCBcImRmbHRfdmFsdWVcIl0pLmV4ZWN1dGUoKTtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGFibGUsXG4gICAgICBjb2x1bW5zOiBjb2x1bW5zLm1hcCgoY29sKSA9PiAoe1xuICAgICAgICBuYW1lOiBjb2wubmFtZSxcbiAgICAgICAgZGF0YVR5cGU6IGNvbC50eXBlLFxuICAgICAgICBpc051bGxhYmxlOiAhY29sLm5vdG51bGwsXG4gICAgICAgIGlzQXV0b0luY3JlbWVudGluZzogY29sLm5hbWUgPT09IGF1dG9JbmNyZW1lbnRDb2wsXG4gICAgICAgIGhhc0RlZmF1bHRWYWx1ZTogY29sLmRmbHRfdmFsdWUgIT0gbnVsbFxuICAgICAgfSkpLFxuICAgICAgaXNWaWV3OiB0cnVlXG4gICAgfTtcbiAgfVxufVxuY2xhc3MgTm9kZVNxbGl0ZVF1ZXJ5Q29tcGlsZXIgZXh0ZW5kcyBEZWZhdWx0UXVlcnlDb21waWxlciB7XG4gIGdldEN1cnJlbnRQYXJhbWV0ZXJQbGFjZWhvbGRlcigpIHtcbiAgICByZXR1cm4gXCI/XCI7XG4gIH1cbiAgZ2V0TGVmdElkZW50aWZpZXJXcmFwcGVyKCkge1xuICAgIHJldHVybiAnXCInO1xuICB9XG4gIGdldFJpZ2h0SWRlbnRpZmllcldyYXBwZXIoKSB7XG4gICAgcmV0dXJuICdcIic7XG4gIH1cbiAgZ2V0QXV0b0luY3JlbWVudCgpIHtcbiAgICByZXR1cm4gXCJhdXRvaW5jcmVtZW50XCI7XG4gIH1cbn1cbmNsYXNzIE5vZGVTcWxpdGVEaWFsZWN0IHtcbiAgI2NvbmZpZztcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgdGhpcy4jY29uZmlnID0geyAuLi5jb25maWcgfTtcbiAgfVxuICBjcmVhdGVEcml2ZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBOb2RlU3FsaXRlRHJpdmVyKHRoaXMuI2NvbmZpZyk7XG4gIH1cbiAgY3JlYXRlUXVlcnlDb21waWxlcigpIHtcbiAgICByZXR1cm4gbmV3IE5vZGVTcWxpdGVRdWVyeUNvbXBpbGVyKCk7XG4gIH1cbiAgY3JlYXRlQWRhcHRlcigpIHtcbiAgICByZXR1cm4gbmV3IE5vZGVTcWxpdGVBZGFwdGVyKCk7XG4gIH1cbiAgY3JlYXRlSW50cm9zcGVjdG9yKGRiKSB7XG4gICAgcmV0dXJuIG5ldyBOb2RlU3FsaXRlSW50cm9zcGVjdG9yKGRiKTtcbiAgfVxufVxuXG5leHBvcnQgeyBOb2RlU3FsaXRlQWRhcHRlciwgTm9kZVNxbGl0ZURpYWxlY3QsIE5vZGVTcWxpdGVEcml2ZXIsIE5vZGVTcWxpdGVJbnRyb3NwZWN0b3IsIE5vZGVTcWxpdGVRdWVyeUNvbXBpbGVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/crypto/index.mjs":
/*!********************************************************!*\
  !*** ./node_modules/better-auth/dist/crypto/index.mjs ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compareHash: () => (/* binding */ compareHash),\n/* harmony export */   constantTimeEqual: () => (/* binding */ constantTimeEqual),\n/* harmony export */   generateRandomString: () => (/* reexport safe */ _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_4__.g),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   hashToBase64: () => (/* binding */ hashToBase64),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   symmetricDecrypt: () => (/* binding */ symmetricDecrypt),\n/* harmony export */   symmetricEncrypt: () => (/* binding */ symmetricEncrypt),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @noble/ciphers/chacha.js */ \"(rsc)/./node_modules/@noble/ciphers/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @noble/ciphers/utils.js */ \"(rsc)/./node_modules/@noble/ciphers/utils.js\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/sign.js\");\n/* harmony import */ var _noble_hashes_scrypt_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @noble/hashes/scrypt.js */ \"(rsc)/./node_modules/@noble/hashes/scrypt.js\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/hashes/utils.js */ \"(rsc)/./node_modules/@noble/hashes/utils.js\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\nasync function signJWT(payload, secret, expiresIn = 3600) {\n  const jwt = await new jose__WEBPACK_IMPORTED_MODULE_6__.SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n  return jwt;\n}\n\nfunction constantTimeEqual(a, b) {\n  const aBuffer = new Uint8Array(a);\n  const bBuffer = new Uint8Array(b);\n  let c = aBuffer.length ^ bBuffer.length;\n  const length = Math.max(aBuffer.length, bBuffer.length);\n  for (let i = 0; i < length; i++) {\n    c |= (i < aBuffer.length ? aBuffer[i] : 0) ^ (i < bBuffer.length ? bBuffer[i] : 0);\n  }\n  return c === 0;\n}\n\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__.base64.encode(buffer);\n}\nasync function compareHash(data, hash) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(\n    typeof data === \"string\" ? new TextEncoder().encode(data) : data\n  );\n  const hashBuffer = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__.base64.decode(hash);\n  return constantTimeEqual(buffer, hashBuffer);\n}\n\nconst config = {\n  N: 16384,\n  r: 16,\n  p: 1,\n  dkLen: 64\n};\nasync function generateKey(password, salt) {\n  return await (0,_noble_hashes_scrypt_js__WEBPACK_IMPORTED_MODULE_7__.scryptAsync)(password.normalize(\"NFKC\"), salt, {\n    N: config.N,\n    p: config.p,\n    r: config.r,\n    dkLen: config.dkLen,\n    maxmem: 128 * config.N * config.r * 2\n  });\n}\nconst hashPassword = async (password) => {\n  const salt = _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(crypto.getRandomValues(new Uint8Array(16)));\n  const key = await generateKey(password, salt);\n  return `${salt}:${_better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(key)}`;\n};\nconst verifyPassword = async ({\n  hash,\n  password\n}) => {\n  const [salt, key] = hash.split(\":\");\n  if (!salt || !key) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"Invalid password hash\");\n  }\n  const targetKey = await generateKey(password, salt);\n  return constantTimeEqual(targetKey, (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_8__.hexToBytes)(key));\n};\n\nconst symmetricEncrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.utf8ToBytes)(data);\n  const chacha = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.managedNonce)(_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_10__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.bytesToHex)(chacha.encrypt(dataAsBytes));\n};\nconst symmetricDecrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.hexToBytes)(data);\n  const chacha = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.managedNonce)(_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_10__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jcnlwdG8vaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXFEO0FBQ1E7QUFDK0M7QUFDekQ7QUFDcEI7QUFDdUI7QUFDVDtBQUNPO0FBQ007QUFDcUI7QUFDNUM7O0FBRW5DO0FBQ0Esd0JBQXdCLHlDQUFPLCtCQUErQixjQUFjO0FBQzVFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixZQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUJBQXVCLG1FQUFVO0FBQ2pDLFNBQVMsNkRBQU07QUFDZjtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFVO0FBQ2pDO0FBQ0E7QUFDQSxxQkFBcUIsNkRBQU07QUFDM0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsb0VBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsZUFBZSx1REFBRztBQUNsQjtBQUNBLFlBQVksS0FBSyxHQUFHLHVEQUFHLGFBQWE7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLGNBQWMsb0VBQWU7QUFDN0I7QUFDQTtBQUNBLHNDQUFzQyxrRUFBVTtBQUNoRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMkJBQTJCLG1FQUFVO0FBQ3JDLHNCQUFzQixvRUFBVztBQUNqQyxpQkFBaUIscUVBQVksQ0FBQyx3RUFBaUI7QUFDL0MsU0FBUyxtRUFBVTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwyQkFBMkIsbUVBQVU7QUFDckMsc0JBQXNCLG1FQUFZO0FBQ2xDLGlCQUFpQixxRUFBWSxDQUFDLHdFQUFpQjtBQUMvQztBQUNBOztBQUVtSSIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY3J5cHRvL2luZGV4Lm1qcz8zNWI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgeyB4Y2hhY2hhMjBwb2x5MTMwNSB9IGZyb20gJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgeyB1dGY4VG9CeXRlcywgbWFuYWdlZE5vbmNlLCBieXRlc1RvSGV4LCBoZXhUb0J5dGVzIGFzIGhleFRvQnl0ZXMkMSB9IGZyb20gJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCB7IGJhc2U2NCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgU2lnbkpXVCB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0IHsgc2NyeXB0QXN5bmMgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgeyBoZXggfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCB7IGhleFRvQnl0ZXMgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcbmV4cG9ydCB7IGcgYXMgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbmFzeW5jIGZ1bmN0aW9uIHNpZ25KV1QocGF5bG9hZCwgc2VjcmV0LCBleHBpcmVzSW4gPSAzNjAwKSB7XG4gIGNvbnN0IGp3dCA9IGF3YWl0IG5ldyBTaWduSldUKHBheWxvYWQpLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogXCJIUzI1NlwiIH0pLnNldElzc3VlZEF0KCkuc2V0RXhwaXJhdGlvblRpbWUoTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMWUzKSArIGV4cGlyZXNJbikuc2lnbihuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VjcmV0KSk7XG4gIHJldHVybiBqd3Q7XG59XG5cbmZ1bmN0aW9uIGNvbnN0YW50VGltZUVxdWFsKGEsIGIpIHtcbiAgY29uc3QgYUJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGEpO1xuICBjb25zdCBiQnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYik7XG4gIGxldCBjID0gYUJ1ZmZlci5sZW5ndGggXiBiQnVmZmVyLmxlbmd0aDtcbiAgY29uc3QgbGVuZ3RoID0gTWF0aC5tYXgoYUJ1ZmZlci5sZW5ndGgsIGJCdWZmZXIubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGMgfD0gKGkgPCBhQnVmZmVyLmxlbmd0aCA/IGFCdWZmZXJbaV0gOiAwKSBeIChpIDwgYkJ1ZmZlci5sZW5ndGggPyBiQnVmZmVyW2ldIDogMCk7XG4gIH1cbiAgcmV0dXJuIGMgPT09IDA7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhc2hUb0Jhc2U2NChkYXRhKSB7XG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChkYXRhKTtcbiAgcmV0dXJuIGJhc2U2NC5lbmNvZGUoYnVmZmVyKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbXBhcmVIYXNoKGRhdGEsIGhhc2gpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KFxuICAgIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpIDogZGF0YVxuICApO1xuICBjb25zdCBoYXNoQnVmZmVyID0gYmFzZTY0LmRlY29kZShoYXNoKTtcbiAgcmV0dXJuIGNvbnN0YW50VGltZUVxdWFsKGJ1ZmZlciwgaGFzaEJ1ZmZlcik7XG59XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgTjogMTYzODQsXG4gIHI6IDE2LFxuICBwOiAxLFxuICBka0xlbjogNjRcbn07XG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCkge1xuICByZXR1cm4gYXdhaXQgc2NyeXB0QXN5bmMocGFzc3dvcmQubm9ybWFsaXplKFwiTkZLQ1wiKSwgc2FsdCwge1xuICAgIE46IGNvbmZpZy5OLFxuICAgIHA6IGNvbmZpZy5wLFxuICAgIHI6IGNvbmZpZy5yLFxuICAgIGRrTGVuOiBjb25maWcuZGtMZW4sXG4gICAgbWF4bWVtOiAxMjggKiBjb25maWcuTiAqIGNvbmZpZy5yICogMlxuICB9KTtcbn1cbmNvbnN0IGhhc2hQYXNzd29yZCA9IGFzeW5jIChwYXNzd29yZCkgPT4ge1xuICBjb25zdCBzYWx0ID0gaGV4LmVuY29kZShjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDE2KSkpO1xuICBjb25zdCBrZXkgPSBhd2FpdCBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCk7XG4gIHJldHVybiBgJHtzYWx0fToke2hleC5lbmNvZGUoa2V5KX1gO1xufTtcbmNvbnN0IHZlcmlmeVBhc3N3b3JkID0gYXN5bmMgKHtcbiAgaGFzaCxcbiAgcGFzc3dvcmRcbn0pID0+IHtcbiAgY29uc3QgW3NhbHQsIGtleV0gPSBoYXNoLnNwbGl0KFwiOlwiKTtcbiAgaWYgKCFzYWx0IHx8ICFrZXkpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiSW52YWxpZCBwYXNzd29yZCBoYXNoXCIpO1xuICB9XG4gIGNvbnN0IHRhcmdldEtleSA9IGF3YWl0IGdlbmVyYXRlS2V5KHBhc3N3b3JkLCBzYWx0KTtcbiAgcmV0dXJuIGNvbnN0YW50VGltZUVxdWFsKHRhcmdldEtleSwgaGV4VG9CeXRlcyhrZXkpKTtcbn07XG5cbmNvbnN0IHN5bW1ldHJpY0VuY3J5cHQgPSBhc3luYyAoe1xuICBrZXksXG4gIGRhdGFcbn0pID0+IHtcbiAgY29uc3Qga2V5QXNCeXRlcyA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChrZXkpO1xuICBjb25zdCBkYXRhQXNCeXRlcyA9IHV0ZjhUb0J5dGVzKGRhdGEpO1xuICBjb25zdCBjaGFjaGEgPSBtYW5hZ2VkTm9uY2UoeGNoYWNoYTIwcG9seTEzMDUpKG5ldyBVaW50OEFycmF5KGtleUFzQnl0ZXMpKTtcbiAgcmV0dXJuIGJ5dGVzVG9IZXgoY2hhY2hhLmVuY3J5cHQoZGF0YUFzQnl0ZXMpKTtcbn07XG5jb25zdCBzeW1tZXRyaWNEZWNyeXB0ID0gYXN5bmMgKHtcbiAga2V5LFxuICBkYXRhXG59KSA9PiB7XG4gIGNvbnN0IGtleUFzQnl0ZXMgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3Qoa2V5KTtcbiAgY29uc3QgZGF0YUFzQnl0ZXMgPSBoZXhUb0J5dGVzJDEoZGF0YSk7XG4gIGNvbnN0IGNoYWNoYSA9IG1hbmFnZWROb25jZSh4Y2hhY2hhMjBwb2x5MTMwNSkobmV3IFVpbnQ4QXJyYXkoa2V5QXNCeXRlcykpO1xuICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGNoYWNoYS5kZWNyeXB0KGRhdGFBc0J5dGVzKSk7XG59O1xuXG5leHBvcnQgeyBjb21wYXJlSGFzaCwgY29uc3RhbnRUaW1lRXF1YWwsIGhhc2hQYXNzd29yZCwgaGFzaFRvQmFzZTY0LCBzaWduSldULCBzeW1tZXRyaWNEZWNyeXB0LCBzeW1tZXRyaWNFbmNyeXB0LCB2ZXJpZnlQYXNzd29yZCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/index.mjs":
/*!*************************************************!*\
  !*** ./node_modules/better-auth/dist/index.mjs ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_10__.APIError),\n/* harmony export */   BASE_ERROR_CODES: () => (/* reexport safe */ _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__.BASE_ERROR_CODES),\n/* harmony export */   BetterAuthError: () => (/* reexport safe */ _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError),\n/* harmony export */   ENV: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.ENV),\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__.H),\n/* harmony export */   TTY_COLORS: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.TTY_COLORS),\n/* harmony export */   betterAuth: () => (/* reexport safe */ _shared_better_auth_CDx1PoNO_mjs__WEBPACK_IMPORTED_MODULE_5__.b),\n/* harmony export */   capitalizeFirstLetter: () => (/* reexport safe */ _shared_better_auth_D_2CmEwz_mjs__WEBPACK_IMPORTED_MODULE_6__.c),\n/* harmony export */   clientCredentialsToken: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.clientCredentialsToken),\n/* harmony export */   createAuthorizationCodeRequest: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationCodeRequest),\n/* harmony export */   createAuthorizationURL: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL),\n/* harmony export */   createClientCredentialsTokenRequest: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createClientCredentialsTokenRequest),\n/* harmony export */   createLogger: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.createLogger),\n/* harmony export */   createRefreshAccessTokenRequest: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createRefreshAccessTokenRequest),\n/* harmony export */   createTelemetry: () => (/* reexport safe */ _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_9__.createTelemetry),\n/* harmony export */   defineErrorCodes: () => (/* reexport safe */ _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_4__.defineErrorCodes),\n/* harmony export */   env: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env),\n/* harmony export */   generateCodeChallenge: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.generateCodeChallenge),\n/* harmony export */   generateId: () => (/* reexport safe */ _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_8__.g),\n/* harmony export */   generateState: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__.g),\n/* harmony export */   getBooleanEnvVar: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getBooleanEnvVar),\n/* harmony export */   getColorDepth: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getColorDepth),\n/* harmony export */   getEnvVar: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getEnvVar),\n/* harmony export */   getOAuth2Tokens: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.getOAuth2Tokens),\n/* harmony export */   getTelemetryAuthConfig: () => (/* reexport safe */ _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_9__.getTelemetryAuthConfig),\n/* harmony export */   isDevelopment: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isDevelopment),\n/* harmony export */   isProduction: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isProduction),\n/* harmony export */   isTest: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest),\n/* harmony export */   levels: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.levels),\n/* harmony export */   logger: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger),\n/* harmony export */   nodeENV: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.nodeENV),\n/* harmony export */   parseState: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__.p),\n/* harmony export */   refreshAccessToken: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken),\n/* harmony export */   shouldPublishLog: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.shouldPublishLog),\n/* harmony export */   validateAuthorizationCode: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode),\n/* harmony export */   validateToken: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateToken)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core */ \"(rsc)/./node_modules/@better-auth/core/dist/index.mjs\");\n/* harmony import */ var _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/oauth2 */ \"(rsc)/./node_modules/@better-auth/core/dist/oauth2/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/utils */ \"(rsc)/./node_modules/@better-auth/core/dist/utils/index.mjs\");\n/* harmony import */ var _shared_better_auth_CDx1PoNO_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./shared/better-auth.CDx1PoNO.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs\");\n/* harmony import */ var _shared_better_auth_D_2CmEwz_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./shared/better-auth.D-2CmEwz.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs\");\n/* harmony import */ var _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./shared/better-auth.BX9UB8EP.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/telemetry */ \"(rsc)/./node_modules/@better-auth/telemetry/dist/index.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./shared/better-auth.DEBtROF9.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _api_index_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./api/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/api/index.mjs\");\n/* harmony import */ var _shared_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./shared/better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var _shared_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./shared/better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _shared_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./shared/better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _shared_better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./shared/better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n/* harmony import */ var _shared_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./shared/better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _shared_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./shared/better-auth.ClH5r3NH.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _shared_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./shared/better-auth.BG42OQGC.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs\");\n/* harmony import */ var _shared_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./shared/better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _shared_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./shared/better-auth.CBTS2OzX.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\");\n/* harmony import */ var _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./shared/better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n/* harmony import */ var _shared_better_auth_BNpIwq4C_mjs__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./shared/better-auth.BNpIwq4C.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _shared_better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./shared/better-auth.YwDQhoPc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNDO0FBQ0o7QUFDTztBQUNEO0FBQ0E7QUFDNEI7QUFDVztBQUM2QjtBQUN4QztBQUNhO0FBQzFDO0FBQ0k7QUFDOUI7QUFDeUI7QUFDSDtBQUNGO0FBQ0U7QUFDTDtBQUNkO0FBQ3NCO0FBQ2I7QUFDa0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDRjtBQUNDO0FBQ0Q7QUFDbkI7QUFDbUI7QUFDRDtBQUNBO0FBQ1c7QUFDQTtBQUM3QjtBQUNjO0FBQ2U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0Q7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2luZGV4Lm1qcz8zNmU4Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCAqIGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5leHBvcnQgKiBmcm9tICdAYmV0dGVyLWF1dGgvY29yZSc7XG5leHBvcnQgKiBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9vYXV0aDInO1xuZXhwb3J0ICogZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuZXhwb3J0ICogZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvdXRpbHMnO1xuZXhwb3J0IHsgYiBhcyBiZXR0ZXJBdXRoIH0gZnJvbSAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ0R4MVBvTk8ubWpzJztcbmV4cG9ydCB7IGMgYXMgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyIH0gZnJvbSAnLi9zaGFyZWQvYmV0dGVyLWF1dGguRC0yQ21Fd3oubWpzJztcbmV4cG9ydCB7IEggYXMgSElERV9NRVRBREFUQSwgZyBhcyBnZW5lcmF0ZVN0YXRlLCBwIGFzIHBhcnNlU3RhdGUgfSBmcm9tICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CWDlVQjhFUC5tanMnO1xuZXhwb3J0IHsgZyBhcyBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmV4cG9ydCB7IGNyZWF0ZVRlbGVtZXRyeSwgZ2V0VGVsZW1ldHJ5QXV0aENvbmZpZyB9IGZyb20gJ0BiZXR0ZXItYXV0aC90ZWxlbWV0cnknO1xuZXhwb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkRFQnRST0Y5Lm1qcyc7XG5pbXBvcnQgJ3pvZCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL21pZGRsZXdhcmUnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGInO1xuaW1wb3J0ICdreXNlbHknO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9kYi9hZGFwdGVyJztcbmltcG9ydCAnLi9hcGkvaW5kZXgubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguRDlfdlFSODMubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguSWg4Qzc2Vm8ubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ3dqOWR0NmkubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkNsSDVyM05ILm1qcyc7XG5pbXBvcnQgJ2RlZnUnO1xuaW1wb3J0ICcuL2NyeXB0by9pbmRleC5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CRzQyT1FHQy5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5wUWplUmt6Ti5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5DQlRTMk96WC5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5FQnhLZVZOWi5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CTnBJd3E0Qy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9zb2NpYWwtcHJvdmlkZXJzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzJztcbmltcG9ydCAnam9zZS9lcnJvcnMnO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ generateRandomString)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n\n\nconst generateRandomString = (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\n  \"a-z\",\n  \"0-9\",\n  \"A-Z\",\n  \"-_\"\n);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXdFOztBQUV4RSw2QkFBNkIsc0ZBQTJCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzPzg4YWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbmNvbnN0IGdlbmVyYXRlUmFuZG9tU3RyaW5nID0gY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yKFxuICBcImEtelwiLFxuICBcIjAtOVwiLFxuICBcIkEtWlwiLFxuICBcIi1fXCJcbik7XG5cbmV4cG9ydCB7IGdlbmVyYXRlUmFuZG9tU3RyaW5nIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getAdapter),\n/* harmony export */   b: () => (/* binding */ convertToDB),\n/* harmony export */   c: () => (/* binding */ createInternalAdapter),\n/* harmony export */   d: () => (/* binding */ convertFromDB),\n/* harmony export */   e: () => (/* binding */ getMigrations),\n/* harmony export */   f: () => (/* binding */ getSchema),\n/* harmony export */   g: () => (/* binding */ getWithHooks),\n/* harmony export */   m: () => (/* binding */ matchType)\n/* harmony export */ });\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.ClH5r3NH.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.CBTS2OzX.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _better_auth_BNpIwq4C_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./better-auth.BNpIwq4C.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/raw-builder/sql.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getWithHooks(adapter, ctx) {\n  const hooks = ctx.hooks;\n  async function createWithHooks(data, model, customCreateFn, context, trxAdapter) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.before;\n      if (toRun) {\n        const result = await toRun(actualData, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\" && \"data\" in result;\n        if (isObject) {\n          actualData = {\n            ...actualData,\n            ...result.data\n          };\n        }\n      }\n    }\n    const customCreated = customCreateFn ? await customCreateFn.fn(actualData) : null;\n    const created = !customCreateFn || customCreateFn.executeMainFn ? await (trxAdapter || adapter).create({\n      model,\n      data: actualData,\n      forceAllowId: true\n    }) : customCreated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.after;\n      if (toRun) {\n        await toRun(created, context);\n      }\n    }\n    return created;\n  }\n  async function updateWithHooks(data, where, model, customUpdateFn, context, trxAdapter) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await (trxAdapter || adapter).update({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated, context);\n      }\n    }\n    return updated;\n  }\n  async function updateManyWithHooks(data, where, model, customUpdateFn, context, trxAdapter) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await (trxAdapter || adapter).updateMany({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated, context);\n      }\n    }\n    return updated;\n  }\n  return {\n    createWithHooks,\n    updateWithHooks,\n    updateManyWithHooks\n  };\n}\n\nconst createInternalAdapter = (adapter, ctx) => {\n  const logger = ctx.logger;\n  const options = ctx.options;\n  const secondaryStorage = options.secondaryStorage;\n  const sessionExpiration = options.session?.expiresIn || 60 * 60 * 24 * 7;\n  const { createWithHooks, updateWithHooks, updateManyWithHooks } = getWithHooks(adapter, ctx);\n  async function refreshUserSessions(user) {\n    if (!secondaryStorage) return;\n    const listRaw = await secondaryStorage.get(`active-sessions-${user.id}`);\n    if (!listRaw) return;\n    const now = Date.now();\n    const list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(listRaw) || [];\n    const validSessions = list.filter((s) => s.expiresAt > now);\n    await Promise.all(\n      validSessions.map(async ({ token }) => {\n        const cached = await secondaryStorage.get(token);\n        if (!cached) return;\n        const parsed = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(cached);\n        if (!parsed) return;\n        const sessionTTL = Math.max(\n          Math.floor(new Date(parsed.session.expiresAt).getTime() - now) / 1e3,\n          0\n        );\n        await secondaryStorage.set(\n          token,\n          JSON.stringify({\n            session: parsed.session,\n            user\n          }),\n          Math.floor(sessionTTL)\n        );\n      })\n    );\n  }\n  return {\n    createOAuthUser: async (user, account, context) => {\n      return adapter.transaction(async (trxAdapter) => {\n        const createdUser = await createWithHooks(\n          {\n            // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n            createdAt: /* @__PURE__ */ new Date(),\n            updatedAt: /* @__PURE__ */ new Date(),\n            ...user\n          },\n          \"user\",\n          void 0,\n          context,\n          trxAdapter\n        );\n        const createdAccount = await createWithHooks(\n          {\n            ...account,\n            userId: createdUser.id,\n            // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n            createdAt: /* @__PURE__ */ new Date(),\n            updatedAt: /* @__PURE__ */ new Date()\n          },\n          \"account\",\n          void 0,\n          context,\n          trxAdapter\n        );\n        return {\n          user: createdUser,\n          account: createdAccount\n        };\n      });\n    },\n    createUser: async (user, context, trxAdapter) => {\n      const createdUser = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...user,\n          email: user.email?.toLowerCase()\n        },\n        \"user\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return createdUser;\n    },\n    createAccount: async (account, context, trxAdapter) => {\n      const createdAccount = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return createdAccount;\n    },\n    listSessions: async (userId, trxAdapter) => {\n      if (secondaryStorage) {\n        const currentList = await secondaryStorage.get(\n          `active-sessions-${userId}`\n        );\n        if (!currentList) return [];\n        const list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n        const now = Date.now();\n        const validSessions = list.filter((s) => s.expiresAt > now);\n        const sessions2 = [];\n        for (const session of validSessions) {\n          const sessionStringified = await secondaryStorage.get(session.token);\n          if (sessionStringified) {\n            const s = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n            if (!s) return [];\n            const parsedSession = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, {\n              ...s.session,\n              expiresAt: new Date(s.session.expiresAt)\n            });\n            sessions2.push(parsedSession);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await (trxAdapter || adapter).findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return sessions;\n    },\n    listUsers: async (limit, offset, sortBy, where, trxAdapter) => {\n      const users = await (trxAdapter || adapter).findMany({\n        model: \"user\",\n        limit,\n        offset,\n        sortBy,\n        where\n      });\n      return users;\n    },\n    countTotalUsers: async (where, trxAdapter) => {\n      const total = await (trxAdapter || adapter).count({\n        model: \"user\",\n        where\n      });\n      if (typeof total === \"string\") {\n        return parseInt(total);\n      }\n      return total;\n    },\n    deleteUser: async (userId, trxAdapter) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(`active-sessions-${userId}`);\n      }\n      if (!secondaryStorage || options.session?.storeSessionInDatabase) {\n        await (trxAdapter || adapter).deleteMany({\n          model: \"session\",\n          where: [\n            {\n              field: \"userId\",\n              value: userId\n            }\n          ]\n        });\n      }\n      await (trxAdapter || adapter).deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      await (trxAdapter || adapter).delete({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n    },\n    createSession: async (userId, ctx2, dontRememberMe, override, overrideAll, trxAdapter) => {\n      const headers = ctx2.headers || ctx2.request?.headers;\n      const { id: _, ...rest } = override || {};\n      const data = {\n        ipAddress: ctx2.request || ctx2.headers ? (0,_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_2__.g)(ctx2.request || ctx2.headers, ctx2.context.options) || \"\" : \"\",\n        userAgent: headers?.get(\"user-agent\") || \"\",\n        ...rest,\n        /**\n         * If the user doesn't want to be remembered\n         * set the session to expire in 1 day.\n         * The cookie will be set to expire at the end of the session\n         */\n        expiresAt: dontRememberMe ? (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(60 * 60 * 24, \"sec\") : (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(sessionExpiration, \"sec\"),\n        userId,\n        token: (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__.g)(32),\n        // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n        createdAt: /* @__PURE__ */ new Date(),\n        updatedAt: /* @__PURE__ */ new Date(),\n        ...overrideAll ? rest : {}\n      };\n      const res = await createWithHooks(\n        data,\n        \"session\",\n        secondaryStorage ? {\n          fn: async (sessionData) => {\n            const currentList = await secondaryStorage.get(\n              `active-sessions-${userId}`\n            );\n            let list = [];\n            const now = Date.now();\n            if (currentList) {\n              list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n              list = list.filter((session) => session.expiresAt > now);\n            }\n            const sorted = list.sort((a, b) => a.expiresAt - b.expiresAt);\n            let furthestSessionExp = sorted.at(-1)?.expiresAt;\n            sorted.push({\n              token: data.token,\n              expiresAt: data.expiresAt.getTime()\n            });\n            if (!furthestSessionExp || furthestSessionExp < data.expiresAt.getTime()) {\n              furthestSessionExp = data.expiresAt.getTime();\n            }\n            const furthestSessionTTL = Math.max(\n              Math.floor((furthestSessionExp - now) / 1e3),\n              0\n            );\n            if (furthestSessionTTL > 0) {\n              await secondaryStorage.set(\n                `active-sessions-${userId}`,\n                JSON.stringify(sorted),\n                furthestSessionTTL\n              );\n            }\n            const user = await adapter.findOne({\n              model: \"user\",\n              where: [\n                {\n                  field: \"id\",\n                  value: userId\n                }\n              ]\n            });\n            const sessionTTL = Math.max(\n              Math.floor((data.expiresAt.getTime() - now) / 1e3),\n              0\n            );\n            if (sessionTTL > 0) {\n              await secondaryStorage.set(\n                data.token,\n                JSON.stringify({\n                  session: sessionData,\n                  user\n                }),\n                sessionTTL\n              );\n            }\n            return sessionData;\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0,\n        ctx2,\n        trxAdapter\n      );\n      return res;\n    },\n    findSession: async (token, trxAdapter) => {\n      if (secondaryStorage) {\n        const sessionStringified = await secondaryStorage.get(token);\n        if (!sessionStringified && !options.session?.storeSessionInDatabase) {\n          return null;\n        }\n        if (sessionStringified) {\n          const s = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n          if (!s) return null;\n          const parsedSession2 = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, {\n            ...s.session,\n            expiresAt: new Date(s.session.expiresAt),\n            createdAt: new Date(s.session.createdAt),\n            updatedAt: new Date(s.session.updatedAt)\n          });\n          const parsedUser2 = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.p)(ctx.options, {\n            ...s.user,\n            createdAt: new Date(s.user.createdAt),\n            updatedAt: new Date(s.user.updatedAt)\n          });\n          return {\n            session: parsedSession2,\n            user: parsedUser2\n          };\n        }\n      }\n      const session = await (trxAdapter || adapter).findOne({\n        model: \"session\",\n        where: [\n          {\n            value: token,\n            field: \"token\"\n          }\n        ]\n      });\n      if (!session) {\n        return null;\n      }\n      const user = await (trxAdapter || adapter).findOne({\n        model: \"user\",\n        where: [\n          {\n            value: session.userId,\n            field: \"id\"\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const parsedSession = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, session);\n      const parsedUser = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.p)(ctx.options, user);\n      return {\n        session: parsedSession,\n        user: parsedUser\n      };\n    },\n    findSessions: async (sessionTokens, trxAdapter) => {\n      if (secondaryStorage) {\n        const sessions2 = [];\n        for (const sessionToken of sessionTokens) {\n          const sessionStringified = await secondaryStorage.get(sessionToken);\n          if (sessionStringified) {\n            const s = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n            if (!s) return [];\n            const session = {\n              session: {\n                ...s.session,\n                expiresAt: new Date(s.session.expiresAt)\n              },\n              user: {\n                ...s.user,\n                createdAt: new Date(s.user.createdAt),\n                updatedAt: new Date(s.user.updatedAt)\n              }\n            };\n            sessions2.push(session);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await (trxAdapter || adapter).findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: sessionTokens,\n            operator: \"in\"\n          }\n        ]\n      });\n      const userIds = sessions.map((session) => {\n        return session.userId;\n      });\n      if (!userIds.length) return [];\n      const users = await (trxAdapter || adapter).findMany({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return sessions.map((session) => {\n        const user = users.find((u) => u.id === session.userId);\n        if (!user) return null;\n        return {\n          session,\n          user\n        };\n      });\n    },\n    updateSession: async (sessionToken, session, context, trxAdapter) => {\n      const updatedSession = await updateWithHooks(\n        session,\n        [{ field: \"token\", value: sessionToken }],\n        \"session\",\n        secondaryStorage ? {\n          async fn(data) {\n            const currentSession = await secondaryStorage.get(sessionToken);\n            let updatedSession2 = null;\n            if (currentSession) {\n              const parsedSession = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentSession);\n              if (!parsedSession) return null;\n              updatedSession2 = {\n                ...parsedSession.session,\n                ...data\n              };\n              return updatedSession2;\n            } else {\n              return null;\n            }\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0,\n        context,\n        trxAdapter\n      );\n      return updatedSession;\n    },\n    deleteSession: async (token, trxAdapter) => {\n      if (secondaryStorage) {\n        const data = await secondaryStorage.get(token);\n        if (data) {\n          const { session } = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(data) ?? {};\n          if (!session) {\n            logger.error(\"Session not found in secondary storage\");\n            return;\n          }\n          const userId = session.userId;\n          const currentList = await secondaryStorage.get(\n            `active-sessions-${userId}`\n          );\n          if (currentList) {\n            let list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n            const now = Date.now();\n            const filtered = list.filter(\n              (session2) => session2.expiresAt > now && session2.token !== token\n            );\n            const sorted = filtered.sort((a, b) => a.expiresAt - b.expiresAt);\n            const furthestSessionExp = sorted.at(-1)?.expiresAt;\n            if (filtered.length > 0 && furthestSessionExp && furthestSessionExp > Date.now()) {\n              await secondaryStorage.set(\n                `active-sessions-${userId}`,\n                JSON.stringify(filtered),\n                Math.floor((furthestSessionExp - now) / 1e3)\n              );\n            } else {\n              await secondaryStorage.delete(`active-sessions-${userId}`);\n            }\n          } else {\n            logger.error(\"Active sessions list not found in secondary storage\");\n          }\n        }\n        await secondaryStorage.delete(token);\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await (trxAdapter || adapter).delete({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: token\n          }\n        ]\n      });\n    },\n    deleteAccounts: async (userId, trxAdapter) => {\n      await (trxAdapter || adapter).deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteAccount: async (accountId, trxAdapter) => {\n      await (trxAdapter || adapter).delete({\n        model: \"account\",\n        where: [\n          {\n            field: \"id\",\n            value: accountId\n          }\n        ]\n      });\n    },\n    deleteSessions: async (userIdOrSessionTokens, trxAdapter) => {\n      if (secondaryStorage) {\n        if (typeof userIdOrSessionTokens === \"string\") {\n          const activeSession = await secondaryStorage.get(\n            `active-sessions-${userIdOrSessionTokens}`\n          );\n          const sessions = activeSession ? (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(activeSession) : [];\n          if (!sessions) return;\n          for (const session of sessions) {\n            await secondaryStorage.delete(session.token);\n          }\n        } else {\n          for (const sessionToken of userIdOrSessionTokens) {\n            const session = await secondaryStorage.get(sessionToken);\n            if (session) {\n              await secondaryStorage.delete(sessionToken);\n            }\n          }\n        }\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await (trxAdapter || adapter).deleteMany({\n        model: \"session\",\n        where: [\n          {\n            field: Array.isArray(userIdOrSessionTokens) ? \"token\" : \"userId\",\n            value: userIdOrSessionTokens,\n            operator: Array.isArray(userIdOrSessionTokens) ? \"in\" : void 0\n          }\n        ]\n      });\n    },\n    findOAuthUser: async (email, accountId, providerId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findMany({\n        model: \"account\",\n        where: [\n          {\n            value: accountId,\n            field: \"accountId\"\n          }\n        ]\n      }).then((accounts) => {\n        return accounts.find((a) => a.providerId === providerId);\n      });\n      if (account) {\n        const user = await (trxAdapter || adapter).findOne({\n          model: \"user\",\n          where: [\n            {\n              value: account.userId,\n              field: \"id\"\n            }\n          ]\n        });\n        if (user) {\n          return {\n            user,\n            accounts: [account]\n          };\n        } else {\n          const user2 = await (trxAdapter || adapter).findOne({\n            model: \"user\",\n            where: [\n              {\n                value: email.toLowerCase(),\n                field: \"email\"\n              }\n            ]\n          });\n          if (user2) {\n            return {\n              user: user2,\n              accounts: [account]\n            };\n          }\n          return null;\n        }\n      } else {\n        const user = await (trxAdapter || adapter).findOne({\n          model: \"user\",\n          where: [\n            {\n              value: email.toLowerCase(),\n              field: \"email\"\n            }\n          ]\n        });\n        if (user) {\n          const accounts = await (trxAdapter || adapter).findMany({\n            model: \"account\",\n            where: [\n              {\n                value: user.id,\n                field: \"userId\"\n              }\n            ]\n          });\n          return {\n            user,\n            accounts: accounts || []\n          };\n        } else {\n          return null;\n        }\n      }\n    },\n    findUserByEmail: async (email, options2, trxAdapter) => {\n      const user = await (trxAdapter || adapter).findOne({\n        model: \"user\",\n        where: [\n          {\n            value: email.toLowerCase(),\n            field: \"email\"\n          }\n        ]\n      });\n      if (!user) return null;\n      if (options2?.includeAccounts) {\n        const accounts = await (trxAdapter || adapter).findMany({\n          model: \"account\",\n          where: [\n            {\n              value: user.id,\n              field: \"userId\"\n            }\n          ]\n        });\n        return {\n          user,\n          accounts\n        };\n      }\n      return {\n        user,\n        accounts: []\n      };\n    },\n    findUserById: async (userId, trxAdapter) => {\n      const user = await (trxAdapter || adapter).findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n      return user;\n    },\n    linkAccount: async (account, context, trxAdapter) => {\n      const _account = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return _account;\n    },\n    updateUser: async (userId, data, context, trxAdapter) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ],\n        \"user\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      await refreshUserSessions(user);\n      await refreshUserSessions(user);\n      return user;\n    },\n    updateUserByEmail: async (email, data, context, trxAdapter) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"email\",\n            value: email.toLowerCase()\n          }\n        ],\n        \"user\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      await refreshUserSessions(user);\n      await refreshUserSessions(user);\n      return user;\n    },\n    updatePassword: async (userId, password, context, trxAdapter) => {\n      await updateManyWithHooks(\n        {\n          password\n        },\n        [\n          {\n            field: \"userId\",\n            value: userId\n          },\n          {\n            field: \"providerId\",\n            value: \"credential\"\n          }\n        ],\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n    },\n    findAccounts: async (userId, trxAdapter) => {\n      const accounts = await (trxAdapter || adapter).findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return accounts;\n    },\n    findAccount: async (accountId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByProviderId: async (accountId, providerId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          },\n          {\n            field: \"providerId\",\n            value: providerId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByUserId: async (userId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return account;\n    },\n    updateAccount: async (id, data, context, trxAdapter) => {\n      const account = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return account;\n    },\n    createVerificationValue: async (data, context, trxAdapter) => {\n      const verification = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...data\n        },\n        \"verification\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return verification;\n    },\n    findVerificationValue: async (identifier, trxAdapter) => {\n      const verification = await (trxAdapter || adapter).findMany(\n        {\n          model: \"verification\",\n          where: [\n            {\n              field: \"identifier\",\n              value: identifier\n            }\n          ],\n          sortBy: {\n            field: \"createdAt\",\n            direction: \"desc\"\n          },\n          limit: 1\n        }\n      );\n      if (!options.verification?.disableCleanup) {\n        await (trxAdapter || adapter).deleteMany({\n          model: \"verification\",\n          where: [\n            {\n              field: \"expiresAt\",\n              value: /* @__PURE__ */ new Date(),\n              operator: \"lt\"\n            }\n          ]\n        });\n      }\n      const lastVerification = verification[0];\n      return lastVerification;\n    },\n    deleteVerificationValue: async (id, trxAdapter) => {\n      await (trxAdapter || adapter).delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n    },\n    deleteVerificationByIdentifier: async (identifier, trxAdapter) => {\n      await (trxAdapter || adapter).delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ]\n      });\n    },\n    updateVerificationValue: async (id, data, context, trxAdapter) => {\n      const verification = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"verification\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return verification;\n    }\n  };\n};\n\nasync function getAdapter(options) {\n  if (!options.database) {\n    const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_14__.g)(options);\n    const memoryDB = Object.keys(tables).reduce((acc, key) => {\n      acc[key] = [];\n      return acc;\n    }, {});\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_12__.logger.warn(\n      \"No database configuration provided. Using memory adapter in development\"\n    );\n    return (0,_better_auth_BNpIwq4C_mjs__WEBPACK_IMPORTED_MODULE_17__.m)(memoryDB)(options);\n  }\n  if (typeof options.database === \"function\") {\n    return options.database(options);\n  }\n  const { kysely, databaseType, transaction } = await (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__.c)(options);\n  if (!kysely) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_9__.BetterAuthError(\"Failed to initialize database adapter\");\n  }\n  return (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__.k)(kysely, {\n    type: databaseType || \"sqlite\",\n    debugLogs: \"debugLogs\" in options.database ? options.database.debugLogs : false,\n    transaction\n  })(options);\n}\nfunction convertToDB(fields, values) {\n  let result = values.id ? {\n    id: values.id\n  } : {};\n  for (const key in fields) {\n    const field = fields[key];\n    const value = values[key];\n    if (value === void 0) {\n      continue;\n    }\n    result[field.fieldName || key] = value;\n  }\n  return result;\n}\nfunction convertFromDB(fields, values) {\n  if (!values) {\n    return null;\n  }\n  let result = {\n    id: values.id\n  };\n  for (const [key, value] of Object.entries(fields)) {\n    result[key] = values[value.fieldName || key];\n  }\n  return result;\n}\n\nfunction getSchema(config) {\n  const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_14__.g)(config);\n  let schema = {};\n  for (const key in tables) {\n    const table = tables[key];\n    const fields = table.fields;\n    let actualFields = {};\n    Object.entries(fields).forEach(([key2, field]) => {\n      actualFields[field.fieldName || key2] = field;\n      if (field.references) {\n        const refTable = tables[field.references.model];\n        if (refTable) {\n          actualFields[field.fieldName || key2].references = {\n            ...field.references,\n            model: refTable.modelName,\n            field: field.references.field\n          };\n        }\n      }\n    });\n    if (schema[table.modelName]) {\n      schema[table.modelName].fields = {\n        ...schema[table.modelName].fields,\n        ...actualFields\n      };\n      continue;\n    }\n    schema[table.modelName] = {\n      fields: actualFields,\n      order: table.order || Infinity\n    };\n  }\n  return schema;\n}\n\nconst postgresMap = {\n  string: [\"character varying\", \"varchar\", \"text\"],\n  number: [\n    \"int4\",\n    \"integer\",\n    \"bigint\",\n    \"smallint\",\n    \"numeric\",\n    \"real\",\n    \"double precision\"\n  ],\n  boolean: [\"bool\", \"boolean\"],\n  date: [\"timestamptz\", \"timestamp\", \"date\"],\n  json: [\"json\", \"jsonb\"]\n};\nconst mysqlMap = {\n  string: [\"varchar\", \"text\"],\n  number: [\n    \"integer\",\n    \"int\",\n    \"bigint\",\n    \"smallint\",\n    \"decimal\",\n    \"float\",\n    \"double\"\n  ],\n  boolean: [\"boolean\", \"tinyint\"],\n  date: [\"timestamp\", \"datetime\", \"date\"],\n  json: [\"json\"]\n};\nconst sqliteMap = {\n  string: [\"TEXT\"],\n  number: [\"INTEGER\", \"REAL\"],\n  boolean: [\"INTEGER\", \"BOOLEAN\"],\n  // 0 or 1\n  date: [\"DATE\", \"INTEGER\"],\n  json: [\"TEXT\"]\n};\nconst mssqlMap = {\n  string: [\"varchar\", \"nvarchar\"],\n  number: [\"int\", \"bigint\", \"smallint\", \"decimal\", \"float\", \"double\"],\n  boolean: [\"bit\", \"smallint\"],\n  date: [\"datetime2\", \"date\", \"datetime\"],\n  json: [\"varchar\", \"nvarchar\"]\n};\nconst map = {\n  postgres: postgresMap,\n  mysql: mysqlMap,\n  sqlite: sqliteMap,\n  mssql: mssqlMap\n};\nfunction matchType(columnDataType, fieldType, dbType) {\n  function normalize(type) {\n    return type.toLowerCase().split(\"(\")[0].trim();\n  }\n  if (fieldType === \"string[]\" || fieldType === \"number[]\") {\n    return columnDataType.toLowerCase().includes(\"json\");\n  }\n  const types = map[dbType];\n  const expected = Array.isArray(fieldType) ? types[\"string\"].map((t) => t.toLowerCase()) : types[fieldType].map((t) => t.toLowerCase());\n  return expected.includes(normalize(columnDataType));\n}\nasync function getPostgresSchema(db) {\n  try {\n    const result = await (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`SHOW search_path`.execute(\n      db\n    );\n    if (result.rows[0]?.search_path) {\n      const schemas = result.rows[0].search_path.split(\",\").map((s) => s.trim()).map((s) => s.replace(/^[\"']|[\"']$/g, \"\")).filter((s) => !s.startsWith(\"$\"));\n      return schemas[0] || \"public\";\n    }\n  } catch (error) {\n  }\n  return \"public\";\n}\nasync function getMigrations(config) {\n  const betterAuthSchema = getSchema(config);\n  const logger = (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_12__.createLogger)(config.logger);\n  let { kysely: db, databaseType: dbType } = await (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__.c)(config);\n  if (!dbType) {\n    logger.warn(\n      \"Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this.\"\n    );\n    dbType = \"sqlite\";\n  }\n  if (!db) {\n    logger.error(\n      \"Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter.\"\n    );\n    process.exit(1);\n  }\n  let currentSchema = \"public\";\n  if (dbType === \"postgres\") {\n    currentSchema = await getPostgresSchema(db);\n    logger.debug(\n      `PostgreSQL migration: Using schema '${currentSchema}' (from search_path)`\n    );\n    try {\n      const schemaCheck = await (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`\n\t\t\t\tSELECT schema_name \n\t\t\t\tFROM information_schema.schemata \n\t\t\t\tWHERE schema_name = ${currentSchema}\n\t\t\t`.execute(db);\n      if (!schemaCheck.rows[0]) {\n        logger.warn(\n          `Schema '${currentSchema}' does not exist. Tables will be inspected from available schemas. Consider creating the schema first or checking your database configuration.`\n        );\n      }\n    } catch (error) {\n      logger.debug(\n        `Could not verify schema existence: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n  const allTableMetadata = await db.introspection.getTables();\n  let tableMetadata = allTableMetadata;\n  if (dbType === \"postgres\") {\n    try {\n      const tablesInSchema = await (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`\n\t\t\t\tSELECT table_name \n\t\t\t\tFROM information_schema.tables \n\t\t\t\tWHERE table_schema = ${currentSchema}\n\t\t\t\tAND table_type = 'BASE TABLE'\n\t\t\t`.execute(db);\n      const tableNamesInSchema = new Set(\n        tablesInSchema.rows.map((row) => row.table_name)\n      );\n      tableMetadata = allTableMetadata.filter(\n        (table) => table.schema === currentSchema && tableNamesInSchema.has(table.name)\n      );\n      logger.debug(\n        `Found ${tableMetadata.length} table(s) in schema '${currentSchema}': ${tableMetadata.map((t) => t.name).join(\", \") || \"(none)\"}`\n      );\n    } catch (error) {\n      logger.warn(\n        `Could not filter tables by schema. Using all discovered tables. Error: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n  const toBeCreated = [];\n  const toBeAdded = [];\n  for (const [key, value] of Object.entries(betterAuthSchema)) {\n    const table = tableMetadata.find((t) => t.name === key);\n    if (!table) {\n      const tIndex = toBeCreated.findIndex((t) => t.table === key);\n      const tableData = {\n        table: key,\n        fields: value.fields,\n        order: value.order || Infinity\n      };\n      const insertIndex = toBeCreated.findIndex(\n        (t) => (t.order || Infinity) > tableData.order\n      );\n      if (insertIndex === -1) {\n        if (tIndex === -1) {\n          toBeCreated.push(tableData);\n        } else {\n          toBeCreated[tIndex].fields = {\n            ...toBeCreated[tIndex].fields,\n            ...value.fields\n          };\n        }\n      } else {\n        toBeCreated.splice(insertIndex, 0, tableData);\n      }\n      continue;\n    }\n    let toBeAddedFields = {};\n    for (const [fieldName, field] of Object.entries(value.fields)) {\n      const column = table.columns.find((c) => c.name === fieldName);\n      if (!column) {\n        toBeAddedFields[fieldName] = field;\n        continue;\n      }\n      if (matchType(column.dataType, field.type, dbType)) {\n        continue;\n      } else {\n        logger.warn(\n          `Field ${fieldName} in table ${key} has a different type in the database. Expected ${field.type} but got ${column.dataType}.`\n        );\n      }\n    }\n    if (Object.keys(toBeAddedFields).length > 0) {\n      toBeAdded.push({\n        table: key,\n        fields: toBeAddedFields,\n        order: value.order || Infinity\n      });\n    }\n  }\n  const migrations = [];\n  function getType(field, fieldName) {\n    const type = field.type;\n    const typeMap = {\n      string: {\n        sqlite: \"text\",\n        postgres: \"text\",\n        mysql: field.unique ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\",\n        mssql: field.unique || field.sortable ? \"varchar(255)\" : field.references ? \"varchar(36)\" : (\n          // mssql deprecated `text`, and the alternative is `varchar(max)`.\n          // Kysely type interface doesn't support `text`, so we set this to `varchar(8000)` as\n          // that's the max length for `varchar`\n          \"varchar(8000)\"\n        )\n      },\n      boolean: {\n        sqlite: \"integer\",\n        postgres: \"boolean\",\n        mysql: \"boolean\",\n        mssql: \"smallint\"\n      },\n      number: {\n        sqlite: field.bigint ? \"bigint\" : \"integer\",\n        postgres: field.bigint ? \"bigint\" : \"integer\",\n        mysql: field.bigint ? \"bigint\" : \"integer\",\n        mssql: field.bigint ? \"bigint\" : \"integer\"\n      },\n      date: {\n        sqlite: \"date\",\n        postgres: \"timestamptz\",\n        mysql: \"timestamp(3)\",\n        mssql: (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`datetime2(3)`\n      },\n      json: {\n        sqlite: \"text\",\n        postgres: \"jsonb\",\n        mysql: \"json\",\n        mssql: \"varchar(8000)\"\n      },\n      id: {\n        postgres: config.advanced?.database?.useNumberId ? \"serial\" : \"text\",\n        mysql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        mssql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        sqlite: config.advanced?.database?.useNumberId ? \"integer\" : \"text\"\n      },\n      foreignKeyId: {\n        postgres: config.advanced?.database?.useNumberId ? \"integer\" : \"text\",\n        mysql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        mssql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        sqlite: config.advanced?.database?.useNumberId ? \"integer\" : \"text\"\n      }\n    };\n    if (fieldName === \"id\" || field.references?.field === \"id\") {\n      if (fieldName === \"id\") {\n        return typeMap.id[dbType];\n      }\n      return typeMap.foreignKeyId[dbType];\n    }\n    if (dbType === \"sqlite\" && (type === \"string[]\" || type === \"number[]\")) {\n      return \"text\";\n    }\n    if (type === \"string[]\" || type === \"number[]\") {\n      return \"jsonb\";\n    }\n    if (Array.isArray(type)) {\n      return \"text\";\n    }\n    return typeMap[type][dbType || \"sqlite\"];\n  }\n  if (toBeAdded.length) {\n    for (const table of toBeAdded) {\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field, fieldName);\n        const exec = db.schema.alterTable(table.table).addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            ).onDelete(field.references.onDelete || \"cascade\");\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          if (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) {\n            if (dbType === \"mysql\") {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP(3)`);\n            } else {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP`);\n            }\n          }\n          return col;\n        });\n        migrations.push(exec);\n      }\n    }\n  }\n  if (toBeCreated.length) {\n    for (const table of toBeCreated) {\n      let dbT = db.schema.createTable(table.table).addColumn(\n        \"id\",\n        config.advanced?.database?.useNumberId ? dbType === \"postgres\" ? \"serial\" : \"integer\" : dbType === \"mysql\" || dbType === \"mssql\" ? \"varchar(36)\" : \"text\",\n        (col) => {\n          if (config.advanced?.database?.useNumberId) {\n            if (dbType === \"postgres\" || dbType === \"sqlite\") {\n              return col.primaryKey().notNull();\n            } else if (dbType === \"mssql\") {\n              return col.identity().primaryKey().notNull();\n            }\n            return col.autoIncrement().primaryKey().notNull();\n          }\n          return col.primaryKey().notNull();\n        }\n      );\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field, fieldName);\n        dbT = dbT.addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(`${field.references.model}.${field.references.field}`).onDelete(field.references.onDelete || \"cascade\");\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          if (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) {\n            if (dbType === \"mysql\") {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP(3)`);\n            } else {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP`);\n            }\n          }\n          return col;\n        });\n      }\n      migrations.push(dbT);\n    }\n  }\n  async function runMigrations() {\n    for (const migration of migrations) {\n      await migration.execute();\n    }\n  }\n  async function compileMigrations() {\n    const compiled = migrations.map((m) => m.compile().sql);\n    return compiled.join(\";\\n\\n\") + \";\";\n  }\n  return { toBeCreated, toBeAdded, runMigrations, compileMigrations };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQkc0Mk9RR0MubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUEwRDtBQUNpQztBQUNuQztBQUNRO0FBQ0g7QUFDaEQ7QUFDUTtBQUNZO0FBQ0M7QUFDRDtBQUNFO0FBQ3JCO0FBQ21CO0FBQ0Q7QUFDQTtBQUMwQjtBQUN0QjtBQUNOO0FBQytCO0FBQzFCO0FBQzZCO0FBQzBCO0FBQ3BEO0FBQzBCO0FBQ25DOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSx3REFBd0Q7QUFDbEU7QUFDQTtBQUNBLGtFQUFrRSxRQUFRO0FBQzFFO0FBQ0E7QUFDQSxpQkFBaUIsNERBQWE7QUFDOUI7QUFDQTtBQUNBLGlDQUFpQyxPQUFPO0FBQ3hDO0FBQ0E7QUFDQSx1QkFBdUIsNERBQWE7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsT0FBTztBQUNwQztBQUNBO0FBQ0EscUJBQXFCLDREQUFhO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw0REFBYTtBQUNuQztBQUNBLGtDQUFrQyw0REFBa0I7QUFDcEQ7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EseURBQXlELE9BQU87QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxjQUFjLGlCQUFpQjtBQUMvQjtBQUNBLGtEQUFrRCw0REFBSztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyw0REFBTyx3QkFBd0IsNERBQU87QUFDMUU7QUFDQSxlQUFlLDREQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw0REFBYTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsT0FBTztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNERBQWE7QUFDakM7QUFDQSxpQ0FBaUMsNERBQWtCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLDhCQUE4Qiw0REFBZTtBQUM3QztBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw0REFBa0I7QUFDOUMseUJBQXlCLDREQUFlO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw0REFBYTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsV0FBVyxxQ0FBcUM7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLDREQUFhO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFVBQVUsRUFBRSw0REFBYTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsT0FBTztBQUN0QztBQUNBO0FBQ0EsdUJBQXVCLDREQUFhO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsT0FBTztBQUMxQztBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2QsK0RBQStELE9BQU87QUFDdEU7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixzQkFBc0I7QUFDckQ7QUFDQSwyQ0FBMkMsNERBQWE7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix1QkFBdUIsR0FBRyx1QkFBdUI7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsNENBQUc7QUFDckMsY0FBYztBQUNkLGtDQUFrQyw0Q0FBRztBQUNyQztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHVCQUF1QixHQUFHLHVCQUF1QjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsNENBQUc7QUFDckMsY0FBYztBQUNkLGtDQUFrQyw0Q0FBRztBQUNyQztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0EsV0FBVztBQUNYOztBQUVvSyIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkJHNDJPUUdDLm1qcz8wNWI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGcgYXMgZ2V0RGF0ZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCB7IGIgYXMgcGFyc2VTZXNzaW9uT3V0cHV0LCBwIGFzIHBhcnNlVXNlck91dHB1dCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ3dqOWR0NmkubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0SXAgfSBmcm9tICcuL2JldHRlci1hdXRoLkNsSDVyM05ILm1qcyc7XG5pbXBvcnQgeyBzIGFzIHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdlbmVyYXRlSWQgfSBmcm9tICcuL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcyc7XG5pbXBvcnQgJ3pvZCc7XG5pbXBvcnQgJ2JldHRlci1jYWxsJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgJy4vYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGInO1xuaW1wb3J0IHsgbG9nZ2VyLCBjcmVhdGVMb2dnZXIgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCB7IGcgYXMgZ2V0QXV0aFRhYmxlcyB9IGZyb20gJy4vYmV0dGVyLWF1dGgucFFqZVJrek4ubWpzJztcbmltcG9ydCB7IGMgYXMgY3JlYXRlS3lzZWx5QWRhcHRlciwgayBhcyBreXNlbHlBZGFwdGVyIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DQlRTMk96WC5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9kYi9hZGFwdGVyJztcbmltcG9ydCB7IG0gYXMgbWVtb3J5QWRhcHRlciB9IGZyb20gJy4vYmV0dGVyLWF1dGguQk5wSXdxNEMubWpzJztcbmltcG9ydCB7IHNxbCB9IGZyb20gJ2t5c2VseSc7XG5cbmZ1bmN0aW9uIGdldFdpdGhIb29rcyhhZGFwdGVyLCBjdHgpIHtcbiAgY29uc3QgaG9va3MgPSBjdHguaG9va3M7XG4gIGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVdpdGhIb29rcyhkYXRhLCBtb2RlbCwgY3VzdG9tQ3JlYXRlRm4sIGNvbnRleHQsIHRyeEFkYXB0ZXIpIHtcbiAgICBsZXQgYWN0dWFsRGF0YSA9IGRhdGE7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy5jcmVhdGU/LmJlZm9yZTtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b1J1bihhY3R1YWxEYXRhLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc09iamVjdCA9IHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCIgJiYgXCJkYXRhXCIgaW4gcmVzdWx0O1xuICAgICAgICBpZiAoaXNPYmplY3QpIHtcbiAgICAgICAgICBhY3R1YWxEYXRhID0ge1xuICAgICAgICAgICAgLi4uYWN0dWFsRGF0YSxcbiAgICAgICAgICAgIC4uLnJlc3VsdC5kYXRhXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjdXN0b21DcmVhdGVkID0gY3VzdG9tQ3JlYXRlRm4gPyBhd2FpdCBjdXN0b21DcmVhdGVGbi5mbihhY3R1YWxEYXRhKSA6IG51bGw7XG4gICAgY29uc3QgY3JlYXRlZCA9ICFjdXN0b21DcmVhdGVGbiB8fCBjdXN0b21DcmVhdGVGbi5leGVjdXRlTWFpbkZuID8gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuY3JlYXRlKHtcbiAgICAgIG1vZGVsLFxuICAgICAgZGF0YTogYWN0dWFsRGF0YSxcbiAgICAgIGZvcmNlQWxsb3dJZDogdHJ1ZVxuICAgIH0pIDogY3VzdG9tQ3JlYXRlZDtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LmNyZWF0ZT8uYWZ0ZXI7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgYXdhaXQgdG9SdW4oY3JlYXRlZCwgY29udGV4dCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVkO1xuICB9XG4gIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVdpdGhIb29rcyhkYXRhLCB3aGVyZSwgbW9kZWwsIGN1c3RvbVVwZGF0ZUZuLCBjb250ZXh0LCB0cnhBZGFwdGVyKSB7XG4gICAgbGV0IGFjdHVhbERhdGEgPSBkYXRhO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5iZWZvcmU7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9SdW4oZGF0YSwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNPYmplY3QgPSB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiO1xuICAgICAgICBhY3R1YWxEYXRhID0gaXNPYmplY3QgPyByZXN1bHQuZGF0YSA6IHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY3VzdG9tVXBkYXRlZCA9IGN1c3RvbVVwZGF0ZUZuID8gYXdhaXQgY3VzdG9tVXBkYXRlRm4uZm4oYWN0dWFsRGF0YSkgOiBudWxsO1xuICAgIGNvbnN0IHVwZGF0ZWQgPSAhY3VzdG9tVXBkYXRlRm4gfHwgY3VzdG9tVXBkYXRlRm4uZXhlY3V0ZU1haW5GbiA/IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLnVwZGF0ZSh7XG4gICAgICBtb2RlbCxcbiAgICAgIHVwZGF0ZTogYWN0dWFsRGF0YSxcbiAgICAgIHdoZXJlXG4gICAgfSkgOiBjdXN0b21VcGRhdGVkO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5hZnRlcjtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBhd2FpdCB0b1J1bih1cGRhdGVkLCBjb250ZXh0KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZWQ7XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWFueVdpdGhIb29rcyhkYXRhLCB3aGVyZSwgbW9kZWwsIGN1c3RvbVVwZGF0ZUZuLCBjb250ZXh0LCB0cnhBZGFwdGVyKSB7XG4gICAgbGV0IGFjdHVhbERhdGEgPSBkYXRhO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5iZWZvcmU7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9SdW4oZGF0YSwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNPYmplY3QgPSB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiO1xuICAgICAgICBhY3R1YWxEYXRhID0gaXNPYmplY3QgPyByZXN1bHQuZGF0YSA6IHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY3VzdG9tVXBkYXRlZCA9IGN1c3RvbVVwZGF0ZUZuID8gYXdhaXQgY3VzdG9tVXBkYXRlRm4uZm4oYWN0dWFsRGF0YSkgOiBudWxsO1xuICAgIGNvbnN0IHVwZGF0ZWQgPSAhY3VzdG9tVXBkYXRlRm4gfHwgY3VzdG9tVXBkYXRlRm4uZXhlY3V0ZU1haW5GbiA/IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLnVwZGF0ZU1hbnkoe1xuICAgICAgbW9kZWwsXG4gICAgICB1cGRhdGU6IGFjdHVhbERhdGEsXG4gICAgICB3aGVyZVxuICAgIH0pIDogY3VzdG9tVXBkYXRlZDtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYWZ0ZXI7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgYXdhaXQgdG9SdW4odXBkYXRlZCwgY29udGV4dCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVkO1xuICB9XG4gIHJldHVybiB7XG4gICAgY3JlYXRlV2l0aEhvb2tzLFxuICAgIHVwZGF0ZVdpdGhIb29rcyxcbiAgICB1cGRhdGVNYW55V2l0aEhvb2tzXG4gIH07XG59XG5cbmNvbnN0IGNyZWF0ZUludGVybmFsQWRhcHRlciA9IChhZGFwdGVyLCBjdHgpID0+IHtcbiAgY29uc3QgbG9nZ2VyID0gY3R4LmxvZ2dlcjtcbiAgY29uc3Qgb3B0aW9ucyA9IGN0eC5vcHRpb25zO1xuICBjb25zdCBzZWNvbmRhcnlTdG9yYWdlID0gb3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlO1xuICBjb25zdCBzZXNzaW9uRXhwaXJhdGlvbiA9IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luIHx8IDYwICogNjAgKiAyNCAqIDc7XG4gIGNvbnN0IHsgY3JlYXRlV2l0aEhvb2tzLCB1cGRhdGVXaXRoSG9va3MsIHVwZGF0ZU1hbnlXaXRoSG9va3MgfSA9IGdldFdpdGhIb29rcyhhZGFwdGVyLCBjdHgpO1xuICBhc3luYyBmdW5jdGlvbiByZWZyZXNoVXNlclNlc3Npb25zKHVzZXIpIHtcbiAgICBpZiAoIXNlY29uZGFyeVN0b3JhZ2UpIHJldHVybjtcbiAgICBjb25zdCBsaXN0UmF3ID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXIuaWR9YCk7XG4gICAgaWYgKCFsaXN0UmF3KSByZXR1cm47XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBsaXN0ID0gc2FmZUpTT05QYXJzZShsaXN0UmF3KSB8fCBbXTtcbiAgICBjb25zdCB2YWxpZFNlc3Npb25zID0gbGlzdC5maWx0ZXIoKHMpID0+IHMuZXhwaXJlc0F0ID4gbm93KTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIHZhbGlkU2Vzc2lvbnMubWFwKGFzeW5jICh7IHRva2VuIH0pID0+IHtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQodG9rZW4pO1xuICAgICAgICBpZiAoIWNhY2hlZCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBwYXJzZWQgPSBzYWZlSlNPTlBhcnNlKGNhY2hlZCk7XG4gICAgICAgIGlmICghcGFyc2VkKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHNlc3Npb25UVEwgPSBNYXRoLm1heChcbiAgICAgICAgICBNYXRoLmZsb29yKG5ldyBEYXRlKHBhcnNlZC5zZXNzaW9uLmV4cGlyZXNBdCkuZ2V0VGltZSgpIC0gbm93KSAvIDFlMyxcbiAgICAgICAgICAwXG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2Uuc2V0KFxuICAgICAgICAgIHRva2VuLFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHNlc3Npb246IHBhcnNlZC5zZXNzaW9uLFxuICAgICAgICAgICAgdXNlclxuICAgICAgICAgIH0pLFxuICAgICAgICAgIE1hdGguZmxvb3Ioc2Vzc2lvblRUTClcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGNyZWF0ZU9BdXRoVXNlcjogYXN5bmMgKHVzZXIsIGFjY291bnQsIGNvbnRleHQpID0+IHtcbiAgICAgIHJldHVybiBhZGFwdGVyLnRyYW5zYWN0aW9uKGFzeW5jICh0cnhBZGFwdGVyKSA9PiB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZWRVc2VyID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIC8vIHRvZG86IHdlIHNob3VsZCByZW1vdmUgYXV0byBzZXR0aW5nIGNyZWF0ZWRBdCBhbmQgdXBkYXRlZEF0IGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UsIHNpbmNlIHRoZSBkYiBnZW5lcmF0b3JzIGFscmVhZHkgaGFuZGxlIHRoYXRcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgLi4udXNlclxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJ1c2VyXCIsXG4gICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgICApO1xuICAgICAgICBjb25zdCBjcmVhdGVkQWNjb3VudCA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5hY2NvdW50LFxuICAgICAgICAgICAgdXNlcklkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgICAgIC8vIHRvZG86IHdlIHNob3VsZCByZW1vdmUgYXV0byBzZXR0aW5nIGNyZWF0ZWRBdCBhbmQgdXBkYXRlZEF0IGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UsIHNpbmNlIHRoZSBkYiBnZW5lcmF0b3JzIGFscmVhZHkgaGFuZGxlIHRoYXRcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImFjY291bnRcIixcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICB0cnhBZGFwdGVyXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgICAgYWNjb3VudDogY3JlYXRlZEFjY291bnRcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY3JlYXRlVXNlcjogYXN5bmMgKHVzZXIsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZWRVc2VyID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsPy50b0xvd2VyQ2FzZSgpXG4gICAgICAgIH0sXG4gICAgICAgIFwidXNlclwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3JlYXRlZFVzZXI7XG4gICAgfSxcbiAgICBjcmVhdGVBY2NvdW50OiBhc3luYyAoYWNjb3VudCwgY29udGV4dCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlZEFjY291bnQgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIC4uLmFjY291bnRcbiAgICAgICAgfSxcbiAgICAgICAgXCJhY2NvdW50XCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgKTtcbiAgICAgIHJldHVybiBjcmVhdGVkQWNjb3VudDtcbiAgICB9LFxuICAgIGxpc3RTZXNzaW9uczogYXN5bmMgKHVzZXJJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3QgY3VycmVudExpc3QgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChcbiAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFjdXJyZW50TGlzdCkgcmV0dXJuIFtdO1xuICAgICAgICBjb25zdCBsaXN0ID0gc2FmZUpTT05QYXJzZShjdXJyZW50TGlzdCkgfHwgW107XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IHZhbGlkU2Vzc2lvbnMgPSBsaXN0LmZpbHRlcigocykgPT4gcy5leHBpcmVzQXQgPiBub3cpO1xuICAgICAgICBjb25zdCBzZXNzaW9uczIgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzZXNzaW9uIG9mIHZhbGlkU2Vzc2lvbnMpIHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uU3RyaW5naWZpZWQgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uLnRva2VuKTtcbiAgICAgICAgICBpZiAoc2Vzc2lvblN0cmluZ2lmaWVkKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gc2FmZUpTT05QYXJzZShzZXNzaW9uU3RyaW5naWZpZWQpO1xuICAgICAgICAgICAgaWYgKCFzKSByZXR1cm4gW107XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRTZXNzaW9uID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCB7XG4gICAgICAgICAgICAgIC4uLnMuc2Vzc2lvbixcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXNzaW9uczIucHVzaChwYXJzZWRTZXNzaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlc3Npb25zMjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzZXNzaW9ucztcbiAgICB9LFxuICAgIGxpc3RVc2VyczogYXN5bmMgKGxpbWl0LCBvZmZzZXQsIHNvcnRCeSwgd2hlcmUsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIGxpbWl0LFxuICAgICAgICBvZmZzZXQsXG4gICAgICAgIHNvcnRCeSxcbiAgICAgICAgd2hlcmVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVzZXJzO1xuICAgIH0sXG4gICAgY291bnRUb3RhbFVzZXJzOiBhc3luYyAod2hlcmUsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuY291bnQoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIGlmICh0eXBlb2YgdG90YWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHRvdGFsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9LFxuICAgIGRlbGV0ZVVzZXI6IGFzeW5jICh1c2VySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCk7XG4gICAgICB9XG4gICAgICBpZiAoIXNlY29uZGFyeVN0b3JhZ2UgfHwgb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgIGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmRlbGV0ZU1hbnkoe1xuICAgICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5kZWxldGVNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY3JlYXRlU2Vzc2lvbjogYXN5bmMgKHVzZXJJZCwgY3R4MiwgZG9udFJlbWVtYmVyTWUsIG92ZXJyaWRlLCBvdmVycmlkZUFsbCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgaGVhZGVycyA9IGN0eDIuaGVhZGVycyB8fCBjdHgyLnJlcXVlc3Q/LmhlYWRlcnM7XG4gICAgICBjb25zdCB7IGlkOiBfLCAuLi5yZXN0IH0gPSBvdmVycmlkZSB8fCB7fTtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGlwQWRkcmVzczogY3R4Mi5yZXF1ZXN0IHx8IGN0eDIuaGVhZGVycyA/IGdldElwKGN0eDIucmVxdWVzdCB8fCBjdHgyLmhlYWRlcnMsIGN0eDIuY29udGV4dC5vcHRpb25zKSB8fCBcIlwiIDogXCJcIixcbiAgICAgICAgdXNlckFnZW50OiBoZWFkZXJzPy5nZXQoXCJ1c2VyLWFnZW50XCIpIHx8IFwiXCIsXG4gICAgICAgIC4uLnJlc3QsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGUgdXNlciBkb2Vzbid0IHdhbnQgdG8gYmUgcmVtZW1iZXJlZFxuICAgICAgICAgKiBzZXQgdGhlIHNlc3Npb24gdG8gZXhwaXJlIGluIDEgZGF5LlxuICAgICAgICAgKiBUaGUgY29va2llIHdpbGwgYmUgc2V0IHRvIGV4cGlyZSBhdCB0aGUgZW5kIG9mIHRoZSBzZXNzaW9uXG4gICAgICAgICAqL1xuICAgICAgICBleHBpcmVzQXQ6IGRvbnRSZW1lbWJlck1lID8gZ2V0RGF0ZSg2MCAqIDYwICogMjQsIFwic2VjXCIpIDogZ2V0RGF0ZShzZXNzaW9uRXhwaXJhdGlvbiwgXCJzZWNcIiksXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdG9rZW46IGdlbmVyYXRlSWQoMzIpLFxuICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIC4uLm92ZXJyaWRlQWxsID8gcmVzdCA6IHt9XG4gICAgICB9O1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBcInNlc3Npb25cIixcbiAgICAgICAgc2Vjb25kYXJ5U3RvcmFnZSA/IHtcbiAgICAgICAgICBmbjogYXN5bmMgKHNlc3Npb25EYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50TGlzdCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KFxuICAgICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBsZXQgbGlzdCA9IFtdO1xuICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50TGlzdCkge1xuICAgICAgICAgICAgICBsaXN0ID0gc2FmZUpTT05QYXJzZShjdXJyZW50TGlzdCkgfHwgW107XG4gICAgICAgICAgICAgIGxpc3QgPSBsaXN0LmZpbHRlcigoc2Vzc2lvbikgPT4gc2Vzc2lvbi5leHBpcmVzQXQgPiBub3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc29ydGVkID0gbGlzdC5zb3J0KChhLCBiKSA9PiBhLmV4cGlyZXNBdCAtIGIuZXhwaXJlc0F0KTtcbiAgICAgICAgICAgIGxldCBmdXJ0aGVzdFNlc3Npb25FeHAgPSBzb3J0ZWQuYXQoLTEpPy5leHBpcmVzQXQ7XG4gICAgICAgICAgICBzb3J0ZWQucHVzaCh7XG4gICAgICAgICAgICAgIHRva2VuOiBkYXRhLnRva2VuLFxuICAgICAgICAgICAgICBleHBpcmVzQXQ6IGRhdGEuZXhwaXJlc0F0LmdldFRpbWUoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWZ1cnRoZXN0U2Vzc2lvbkV4cCB8fCBmdXJ0aGVzdFNlc3Npb25FeHAgPCBkYXRhLmV4cGlyZXNBdC5nZXRUaW1lKCkpIHtcbiAgICAgICAgICAgICAgZnVydGhlc3RTZXNzaW9uRXhwID0gZGF0YS5leHBpcmVzQXQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZnVydGhlc3RTZXNzaW9uVFRMID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgIE1hdGguZmxvb3IoKGZ1cnRoZXN0U2Vzc2lvbkV4cCAtIG5vdykgLyAxZTMpLFxuICAgICAgICAgICAgICAwXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKGZ1cnRoZXN0U2Vzc2lvblRUTCA+IDApIHtcbiAgICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5zZXQoXG4gICAgICAgICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gLFxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHNvcnRlZCksXG4gICAgICAgICAgICAgICAgZnVydGhlc3RTZXNzaW9uVFRMXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25UVEwgPSBNYXRoLm1heChcbiAgICAgICAgICAgICAgTWF0aC5mbG9vcigoZGF0YS5leHBpcmVzQXQuZ2V0VGltZSgpIC0gbm93KSAvIDFlMyksXG4gICAgICAgICAgICAgIDBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoc2Vzc2lvblRUTCA+IDApIHtcbiAgICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5zZXQoXG4gICAgICAgICAgICAgICAgZGF0YS50b2tlbixcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICBzZXNzaW9uOiBzZXNzaW9uRGF0YSxcbiAgICAgICAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBzZXNzaW9uVFRMXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc2Vzc2lvbkRhdGE7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBleGVjdXRlTWFpbkZuOiBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2VcbiAgICAgICAgfSA6IHZvaWQgMCxcbiAgICAgICAgY3R4MixcbiAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBmaW5kU2Vzc2lvbjogYXN5bmMgKHRva2VuLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBjb25zdCBzZXNzaW9uU3RyaW5naWZpZWQgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldCh0b2tlbik7XG4gICAgICAgIGlmICghc2Vzc2lvblN0cmluZ2lmaWVkICYmICFvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2Vzc2lvblN0cmluZ2lmaWVkKSB7XG4gICAgICAgICAgY29uc3QgcyA9IHNhZmVKU09OUGFyc2Uoc2Vzc2lvblN0cmluZ2lmaWVkKTtcbiAgICAgICAgICBpZiAoIXMpIHJldHVybiBudWxsO1xuICAgICAgICAgIGNvbnN0IHBhcnNlZFNlc3Npb24yID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCB7XG4gICAgICAgICAgICAuLi5zLnNlc3Npb24sXG4gICAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi5leHBpcmVzQXQpLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShzLnNlc3Npb24uY3JlYXRlZEF0KSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocy5zZXNzaW9uLnVwZGF0ZWRBdClcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCBwYXJzZWRVc2VyMiA9IHBhcnNlVXNlck91dHB1dChjdHgub3B0aW9ucywge1xuICAgICAgICAgICAgLi4ucy51c2VyLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShzLnVzZXIuY3JlYXRlZEF0KSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocy51c2VyLnVwZGF0ZWRBdClcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2Vzc2lvbjogcGFyc2VkU2Vzc2lvbjIsXG4gICAgICAgICAgICB1c2VyOiBwYXJzZWRVc2VyMlxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiB0b2tlbixcbiAgICAgICAgICAgIGZpZWxkOiBcInRva2VuXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IHNlc3Npb24udXNlcklkLFxuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwYXJzZWRTZXNzaW9uID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCBzZXNzaW9uKTtcbiAgICAgIGNvbnN0IHBhcnNlZFVzZXIgPSBwYXJzZVVzZXJPdXRwdXQoY3R4Lm9wdGlvbnMsIHVzZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2Vzc2lvbjogcGFyc2VkU2Vzc2lvbixcbiAgICAgICAgdXNlcjogcGFyc2VkVXNlclxuICAgICAgfTtcbiAgICB9LFxuICAgIGZpbmRTZXNzaW9uczogYXN5bmMgKHNlc3Npb25Ub2tlbnMsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb25zMiA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb25Ub2tlbiBvZiBzZXNzaW9uVG9rZW5zKSB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICBpZiAoc2Vzc2lvblN0cmluZ2lmaWVkKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gc2FmZUpTT05QYXJzZShzZXNzaW9uU3RyaW5naWZpZWQpO1xuICAgICAgICAgICAgaWYgKCFzKSByZXR1cm4gW107XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uID0ge1xuICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgLi4ucy5zZXNzaW9uLFxuICAgICAgICAgICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUocy5zZXNzaW9uLmV4cGlyZXNBdClcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIC4uLnMudXNlcixcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHMudXNlci5jcmVhdGVkQXQpLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocy51c2VyLnVwZGF0ZWRBdClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNlc3Npb25zMi5wdXNoKHNlc3Npb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2Vzc2lvbnMyO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ0b2tlblwiLFxuICAgICAgICAgICAgdmFsdWU6IHNlc3Npb25Ub2tlbnMsXG4gICAgICAgICAgICBvcGVyYXRvcjogXCJpblwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHVzZXJJZHMgPSBzZXNzaW9ucy5tYXAoKHNlc3Npb24pID0+IHtcbiAgICAgICAgcmV0dXJuIHNlc3Npb24udXNlcklkO1xuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXJJZHMubGVuZ3RoKSByZXR1cm4gW107XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkcyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBcImluXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNlc3Npb25zLm1hcCgoc2Vzc2lvbikgPT4ge1xuICAgICAgICBjb25zdCB1c2VyID0gdXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gc2Vzc2lvbi51c2VySWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgdXNlclxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSxcbiAgICB1cGRhdGVTZXNzaW9uOiBhc3luYyAoc2Vzc2lvblRva2VuLCBzZXNzaW9uLCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbiA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgW3sgZmllbGQ6IFwidG9rZW5cIiwgdmFsdWU6IHNlc3Npb25Ub2tlbiB9XSxcbiAgICAgICAgXCJzZXNzaW9uXCIsXG4gICAgICAgIHNlY29uZGFyeVN0b3JhZ2UgPyB7XG4gICAgICAgICAgYXN5bmMgZm4oZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgbGV0IHVwZGF0ZWRTZXNzaW9uMiA9IG51bGw7XG4gICAgICAgICAgICBpZiAoY3VycmVudFNlc3Npb24pIHtcbiAgICAgICAgICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbiA9IHNhZmVKU09OUGFyc2UoY3VycmVudFNlc3Npb24pO1xuICAgICAgICAgICAgICBpZiAoIXBhcnNlZFNlc3Npb24pIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICB1cGRhdGVkU2Vzc2lvbjIgPSB7XG4gICAgICAgICAgICAgICAgLi4ucGFyc2VkU2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgICAgICAgICAgIC4uLmRhdGFcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9uMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0ZU1haW5Gbjogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlXG4gICAgICAgIH0gOiB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gdXBkYXRlZFNlc3Npb247XG4gICAgfSxcbiAgICBkZWxldGVTZXNzaW9uOiBhc3luYyAodG9rZW4sIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldCh0b2tlbik7XG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgY29uc3QgeyBzZXNzaW9uIH0gPSBzYWZlSlNPTlBhcnNlKGRhdGEpID8/IHt9O1xuICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiU2Vzc2lvbiBub3QgZm91bmQgaW4gc2Vjb25kYXJ5IHN0b3JhZ2VcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IHNlc3Npb24udXNlcklkO1xuICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaXN0ID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoXG4gICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChjdXJyZW50TGlzdCkge1xuICAgICAgICAgICAgbGV0IGxpc3QgPSBzYWZlSlNPTlBhcnNlKGN1cnJlbnRMaXN0KSB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJlZCA9IGxpc3QuZmlsdGVyKFxuICAgICAgICAgICAgICAoc2Vzc2lvbjIpID0+IHNlc3Npb24yLmV4cGlyZXNBdCA+IG5vdyAmJiBzZXNzaW9uMi50b2tlbiAhPT0gdG9rZW5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBzb3J0ZWQgPSBmaWx0ZXJlZC5zb3J0KChhLCBiKSA9PiBhLmV4cGlyZXNBdCAtIGIuZXhwaXJlc0F0KTtcbiAgICAgICAgICAgIGNvbnN0IGZ1cnRoZXN0U2Vzc2lvbkV4cCA9IHNvcnRlZC5hdCgtMSk/LmV4cGlyZXNBdDtcbiAgICAgICAgICAgIGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwICYmIGZ1cnRoZXN0U2Vzc2lvbkV4cCAmJiBmdXJ0aGVzdFNlc3Npb25FeHAgPiBEYXRlLm5vdygpKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2Uuc2V0KFxuICAgICAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCxcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShmaWx0ZXJlZCksXG4gICAgICAgICAgICAgICAgTWF0aC5mbG9vcigoZnVydGhlc3RTZXNzaW9uRXhwIC0gbm93KSAvIDFlMylcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkFjdGl2ZSBzZXNzaW9ucyBsaXN0IG5vdCBmb3VuZCBpbiBzZWNvbmRhcnkgc3RvcmFnZVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUodG9rZW4pO1xuICAgICAgICBpZiAoIW9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSB8fCBjdHgub3B0aW9ucy5zZXNzaW9uPy5wcmVzZXJ2ZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidG9rZW5cIixcbiAgICAgICAgICAgIHZhbHVlOiB0b2tlblxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGVBY2NvdW50czogYXN5bmMgKHVzZXJJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlQWNjb3VudDogYXN5bmMgKGFjY291bnRJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogYWNjb3VudElkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZVNlc3Npb25zOiBhc3luYyAodXNlcklkT3JTZXNzaW9uVG9rZW5zLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBpZiAodHlwZW9mIHVzZXJJZE9yU2Vzc2lvblRva2VucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGNvbnN0IGFjdGl2ZVNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChcbiAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWRPclNlc3Npb25Ub2tlbnN9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhY3RpdmVTZXNzaW9uID8gc2FmZUpTT05QYXJzZShhY3RpdmVTZXNzaW9uKSA6IFtdO1xuICAgICAgICAgIGlmICghc2Vzc2lvbnMpIHJldHVybjtcbiAgICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb24gb2Ygc2Vzc2lvbnMpIHtcbiAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKHNlc3Npb24udG9rZW4pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb25Ub2tlbiBvZiB1c2VySWRPclNlc3Npb25Ub2tlbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgaWYgKHNlc3Npb24pIHtcbiAgICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgfHwgY3R4Lm9wdGlvbnMuc2Vzc2lvbj8ucHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogQXJyYXkuaXNBcnJheSh1c2VySWRPclNlc3Npb25Ub2tlbnMpID8gXCJ0b2tlblwiIDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRPclNlc3Npb25Ub2tlbnMsXG4gICAgICAgICAgICBvcGVyYXRvcjogQXJyYXkuaXNBcnJheSh1c2VySWRPclNlc3Npb25Ub2tlbnMpID8gXCJpblwiIDogdm9pZCAwXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGZpbmRPQXV0aFVzZXI6IGFzeW5jIChlbWFpbCwgYWNjb3VudElkLCBwcm92aWRlcklkLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IGFjY291bnRJZCxcbiAgICAgICAgICAgIGZpZWxkOiBcImFjY291bnRJZFwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KS50aGVuKChhY2NvdW50cykgPT4ge1xuICAgICAgICByZXR1cm4gYWNjb3VudHMuZmluZCgoYSkgPT4gYS5wcm92aWRlcklkID09PSBwcm92aWRlcklkKTtcbiAgICAgIH0pO1xuICAgICAgaWYgKGFjY291bnQpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogYWNjb3VudC51c2VySWQsXG4gICAgICAgICAgICAgIGZpZWxkOiBcImlkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYWNjb3VudHM6IFthY2NvdW50XVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgdXNlcjIgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAodXNlcjIpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHVzZXI6IHVzZXIyLFxuICAgICAgICAgICAgICBhY2NvdW50czogW2FjY291bnRdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kTWFueSh7XG4gICAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWQsXG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYWNjb3VudHM6IGFjY291bnRzIHx8IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgZmluZFVzZXJCeUVtYWlsOiBhc3luYyAoZW1haWwsIG9wdGlvbnMyLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB2YWx1ZTogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VyKSByZXR1cm4gbnVsbDtcbiAgICAgIGlmIChvcHRpb25zMj8uaW5jbHVkZUFjY291bnRzKSB7XG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogdXNlci5pZCxcbiAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgYWNjb3VudHNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXIsXG4gICAgICAgIGFjY291bnRzOiBbXVxuICAgICAgfTtcbiAgICB9LFxuICAgIGZpbmRVc2VyQnlJZDogYXN5bmMgKHVzZXJJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSxcbiAgICBsaW5rQWNjb3VudDogYXN5bmMgKGFjY291bnQsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IF9hY2NvdW50ID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5hY2NvdW50XG4gICAgICAgIH0sXG4gICAgICAgIFwiYWNjb3VudFwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gX2FjY291bnQ7XG4gICAgfSxcbiAgICB1cGRhdGVVc2VyOiBhc3luYyAodXNlcklkLCBkYXRhLCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwidXNlclwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICBhd2FpdCByZWZyZXNoVXNlclNlc3Npb25zKHVzZXIpO1xuICAgICAgYXdhaXQgcmVmcmVzaFVzZXJTZXNzaW9ucyh1c2VyKTtcbiAgICAgIHJldHVybiB1c2VyO1xuICAgIH0sXG4gICAgdXBkYXRlVXNlckJ5RW1haWw6IGFzeW5jIChlbWFpbCwgZGF0YSwgY29udGV4dCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgZGF0YSxcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCIsXG4gICAgICAgICAgICB2YWx1ZTogZW1haWwudG9Mb3dlckNhc2UoKVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJ1c2VyXCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgKTtcbiAgICAgIGF3YWl0IHJlZnJlc2hVc2VyU2Vzc2lvbnModXNlcik7XG4gICAgICBhd2FpdCByZWZyZXNoVXNlclNlc3Npb25zKHVzZXIpO1xuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSxcbiAgICB1cGRhdGVQYXNzd29yZDogYXN5bmMgKHVzZXJJZCwgcGFzc3dvcmQsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGF3YWl0IHVwZGF0ZU1hbnlXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICBwYXNzd29yZFxuICAgICAgICB9LFxuICAgICAgICBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogXCJjcmVkZW50aWFsXCJcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiYWNjb3VudFwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudHM6IGFzeW5jICh1c2VySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2NvdW50cztcbiAgICB9LFxuICAgIGZpbmRBY2NvdW50OiBhc3luYyAoYWNjb3VudElkLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJhY2NvdW50SWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBhY2NvdW50SWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudEJ5UHJvdmlkZXJJZDogYXN5bmMgKGFjY291bnRJZCwgcHJvdmlkZXJJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiYWNjb3VudElkXCIsXG4gICAgICAgICAgICB2YWx1ZTogYWNjb3VudElkXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogcHJvdmlkZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjb3VudDtcbiAgICB9LFxuICAgIGZpbmRBY2NvdW50QnlVc2VySWQ6IGFzeW5jICh1c2VySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICB1cGRhdGVBY2NvdW50OiBhc3luYyAoaWQsIGRhdGEsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFt7IGZpZWxkOiBcImlkXCIsIHZhbHVlOiBpZCB9XSxcbiAgICAgICAgXCJhY2NvdW50XCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgKTtcbiAgICAgIHJldHVybiBhY2NvdW50O1xuICAgIH0sXG4gICAgY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWU6IGFzeW5jIChkYXRhLCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIC4uLmRhdGFcbiAgICAgICAgfSxcbiAgICAgICAgXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0cnhBZGFwdGVyXG4gICAgICApO1xuICAgICAgcmV0dXJuIHZlcmlmaWNhdGlvbjtcbiAgICB9LFxuICAgIGZpbmRWZXJpZmljYXRpb25WYWx1ZTogYXN5bmMgKGlkZW50aWZpZXIsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KFxuICAgICAgICB7XG4gICAgICAgICAgbW9kZWw6IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwiaWRlbnRpZmllclwiLFxuICAgICAgICAgICAgICB2YWx1ZTogaWRlbnRpZmllclxuICAgICAgICAgICAgfVxuICAgICAgICAgIF0sXG4gICAgICAgICAgc29ydEJ5OiB7XG4gICAgICAgICAgICBmaWVsZDogXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgIGRpcmVjdGlvbjogXCJkZXNjXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGxpbWl0OiAxXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoIW9wdGlvbnMudmVyaWZpY2F0aW9uPy5kaXNhYmxlQ2xlYW51cCkge1xuICAgICAgICBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5kZWxldGVNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBmaWVsZDogXCJleHBpcmVzQXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICBvcGVyYXRvcjogXCJsdFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxhc3RWZXJpZmljYXRpb24gPSB2ZXJpZmljYXRpb25bMF07XG4gICAgICByZXR1cm4gbGFzdFZlcmlmaWNhdGlvbjtcbiAgICB9LFxuICAgIGRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogaWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlVmVyaWZpY2F0aW9uQnlJZGVudGlmaWVyOiBhc3luYyAoaWRlbnRpZmllciwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRlbnRpZmllclwiLFxuICAgICAgICAgICAgdmFsdWU6IGlkZW50aWZpZXJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdXBkYXRlVmVyaWZpY2F0aW9uVmFsdWU6IGFzeW5jIChpZCwgZGF0YSwgY29udGV4dCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbeyBmaWVsZDogXCJpZFwiLCB2YWx1ZTogaWQgfV0sXG4gICAgICAgIFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgKTtcbiAgICAgIHJldHVybiB2ZXJpZmljYXRpb247XG4gICAgfVxuICB9O1xufTtcblxuYXN5bmMgZnVuY3Rpb24gZ2V0QWRhcHRlcihvcHRpb25zKSB7XG4gIGlmICghb3B0aW9ucy5kYXRhYmFzZSkge1xuICAgIGNvbnN0IHRhYmxlcyA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gICAgY29uc3QgbWVtb3J5REIgPSBPYmplY3Qua2V5cyh0YWJsZXMpLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICAgIGFjY1trZXldID0gW107XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbiAgICBsb2dnZXIud2FybihcbiAgICAgIFwiTm8gZGF0YWJhc2UgY29uZmlndXJhdGlvbiBwcm92aWRlZC4gVXNpbmcgbWVtb3J5IGFkYXB0ZXIgaW4gZGV2ZWxvcG1lbnRcIlxuICAgICk7XG4gICAgcmV0dXJuIG1lbW9yeUFkYXB0ZXIobWVtb3J5REIpKG9wdGlvbnMpO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5kYXRhYmFzZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgcmV0dXJuIG9wdGlvbnMuZGF0YWJhc2Uob3B0aW9ucyk7XG4gIH1cbiAgY29uc3QgeyBreXNlbHksIGRhdGFiYXNlVHlwZSwgdHJhbnNhY3Rpb24gfSA9IGF3YWl0IGNyZWF0ZUt5c2VseUFkYXB0ZXIob3B0aW9ucyk7XG4gIGlmICgha3lzZWx5KSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIGRhdGFiYXNlIGFkYXB0ZXJcIik7XG4gIH1cbiAgcmV0dXJuIGt5c2VseUFkYXB0ZXIoa3lzZWx5LCB7XG4gICAgdHlwZTogZGF0YWJhc2VUeXBlIHx8IFwic3FsaXRlXCIsXG4gICAgZGVidWdMb2dzOiBcImRlYnVnTG9nc1wiIGluIG9wdGlvbnMuZGF0YWJhc2UgPyBvcHRpb25zLmRhdGFiYXNlLmRlYnVnTG9ncyA6IGZhbHNlLFxuICAgIHRyYW5zYWN0aW9uXG4gIH0pKG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gY29udmVydFRvREIoZmllbGRzLCB2YWx1ZXMpIHtcbiAgbGV0IHJlc3VsdCA9IHZhbHVlcy5pZCA/IHtcbiAgICBpZDogdmFsdWVzLmlkXG4gIH0gOiB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gZmllbGRzKSB7XG4gICAgY29uc3QgZmllbGQgPSBmaWVsZHNba2V5XTtcbiAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1trZXldO1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgcmVzdWx0W2ZpZWxkLmZpZWxkTmFtZSB8fCBrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRGcm9tREIoZmllbGRzLCB2YWx1ZXMpIHtcbiAgaWYgKCF2YWx1ZXMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBsZXQgcmVzdWx0ID0ge1xuICAgIGlkOiB2YWx1ZXMuaWRcbiAgfTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZmllbGRzKSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWVzW3ZhbHVlLmZpZWxkTmFtZSB8fCBrZXldO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGdldFNjaGVtYShjb25maWcpIHtcbiAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhjb25maWcpO1xuICBsZXQgc2NoZW1hID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIHRhYmxlcykge1xuICAgIGNvbnN0IHRhYmxlID0gdGFibGVzW2tleV07XG4gICAgY29uc3QgZmllbGRzID0gdGFibGUuZmllbGRzO1xuICAgIGxldCBhY3R1YWxGaWVsZHMgPSB7fTtcbiAgICBPYmplY3QuZW50cmllcyhmaWVsZHMpLmZvckVhY2goKFtrZXkyLCBmaWVsZF0pID0+IHtcbiAgICAgIGFjdHVhbEZpZWxkc1tmaWVsZC5maWVsZE5hbWUgfHwga2V5Ml0gPSBmaWVsZDtcbiAgICAgIGlmIChmaWVsZC5yZWZlcmVuY2VzKSB7XG4gICAgICAgIGNvbnN0IHJlZlRhYmxlID0gdGFibGVzW2ZpZWxkLnJlZmVyZW5jZXMubW9kZWxdO1xuICAgICAgICBpZiAocmVmVGFibGUpIHtcbiAgICAgICAgICBhY3R1YWxGaWVsZHNbZmllbGQuZmllbGROYW1lIHx8IGtleTJdLnJlZmVyZW5jZXMgPSB7XG4gICAgICAgICAgICAuLi5maWVsZC5yZWZlcmVuY2VzLFxuICAgICAgICAgICAgbW9kZWw6IHJlZlRhYmxlLm1vZGVsTmFtZSxcbiAgICAgICAgICAgIGZpZWxkOiBmaWVsZC5yZWZlcmVuY2VzLmZpZWxkXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChzY2hlbWFbdGFibGUubW9kZWxOYW1lXSkge1xuICAgICAgc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0uZmllbGRzID0ge1xuICAgICAgICAuLi5zY2hlbWFbdGFibGUubW9kZWxOYW1lXS5maWVsZHMsXG4gICAgICAgIC4uLmFjdHVhbEZpZWxkc1xuICAgICAgfTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBzY2hlbWFbdGFibGUubW9kZWxOYW1lXSA9IHtcbiAgICAgIGZpZWxkczogYWN0dWFsRmllbGRzLFxuICAgICAgb3JkZXI6IHRhYmxlLm9yZGVyIHx8IEluZmluaXR5XG4gICAgfTtcbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufVxuXG5jb25zdCBwb3N0Z3Jlc01hcCA9IHtcbiAgc3RyaW5nOiBbXCJjaGFyYWN0ZXIgdmFyeWluZ1wiLCBcInZhcmNoYXJcIiwgXCJ0ZXh0XCJdLFxuICBudW1iZXI6IFtcbiAgICBcImludDRcIixcbiAgICBcImludGVnZXJcIixcbiAgICBcImJpZ2ludFwiLFxuICAgIFwic21hbGxpbnRcIixcbiAgICBcIm51bWVyaWNcIixcbiAgICBcInJlYWxcIixcbiAgICBcImRvdWJsZSBwcmVjaXNpb25cIlxuICBdLFxuICBib29sZWFuOiBbXCJib29sXCIsIFwiYm9vbGVhblwiXSxcbiAgZGF0ZTogW1widGltZXN0YW1wdHpcIiwgXCJ0aW1lc3RhbXBcIiwgXCJkYXRlXCJdLFxuICBqc29uOiBbXCJqc29uXCIsIFwianNvbmJcIl1cbn07XG5jb25zdCBteXNxbE1hcCA9IHtcbiAgc3RyaW5nOiBbXCJ2YXJjaGFyXCIsIFwidGV4dFwiXSxcbiAgbnVtYmVyOiBbXG4gICAgXCJpbnRlZ2VyXCIsXG4gICAgXCJpbnRcIixcbiAgICBcImJpZ2ludFwiLFxuICAgIFwic21hbGxpbnRcIixcbiAgICBcImRlY2ltYWxcIixcbiAgICBcImZsb2F0XCIsXG4gICAgXCJkb3VibGVcIlxuICBdLFxuICBib29sZWFuOiBbXCJib29sZWFuXCIsIFwidGlueWludFwiXSxcbiAgZGF0ZTogW1widGltZXN0YW1wXCIsIFwiZGF0ZXRpbWVcIiwgXCJkYXRlXCJdLFxuICBqc29uOiBbXCJqc29uXCJdXG59O1xuY29uc3Qgc3FsaXRlTWFwID0ge1xuICBzdHJpbmc6IFtcIlRFWFRcIl0sXG4gIG51bWJlcjogW1wiSU5URUdFUlwiLCBcIlJFQUxcIl0sXG4gIGJvb2xlYW46IFtcIklOVEVHRVJcIiwgXCJCT09MRUFOXCJdLFxuICAvLyAwIG9yIDFcbiAgZGF0ZTogW1wiREFURVwiLCBcIklOVEVHRVJcIl0sXG4gIGpzb246IFtcIlRFWFRcIl1cbn07XG5jb25zdCBtc3NxbE1hcCA9IHtcbiAgc3RyaW5nOiBbXCJ2YXJjaGFyXCIsIFwibnZhcmNoYXJcIl0sXG4gIG51bWJlcjogW1wiaW50XCIsIFwiYmlnaW50XCIsIFwic21hbGxpbnRcIiwgXCJkZWNpbWFsXCIsIFwiZmxvYXRcIiwgXCJkb3VibGVcIl0sXG4gIGJvb2xlYW46IFtcImJpdFwiLCBcInNtYWxsaW50XCJdLFxuICBkYXRlOiBbXCJkYXRldGltZTJcIiwgXCJkYXRlXCIsIFwiZGF0ZXRpbWVcIl0sXG4gIGpzb246IFtcInZhcmNoYXJcIiwgXCJudmFyY2hhclwiXVxufTtcbmNvbnN0IG1hcCA9IHtcbiAgcG9zdGdyZXM6IHBvc3RncmVzTWFwLFxuICBteXNxbDogbXlzcWxNYXAsXG4gIHNxbGl0ZTogc3FsaXRlTWFwLFxuICBtc3NxbDogbXNzcWxNYXBcbn07XG5mdW5jdGlvbiBtYXRjaFR5cGUoY29sdW1uRGF0YVR5cGUsIGZpZWxkVHlwZSwgZGJUeXBlKSB7XG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZSh0eXBlKSB7XG4gICAgcmV0dXJuIHR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdChcIihcIilbMF0udHJpbSgpO1xuICB9XG4gIGlmIChmaWVsZFR5cGUgPT09IFwic3RyaW5nW11cIiB8fCBmaWVsZFR5cGUgPT09IFwibnVtYmVyW11cIikge1xuICAgIHJldHVybiBjb2x1bW5EYXRhVHlwZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwianNvblwiKTtcbiAgfVxuICBjb25zdCB0eXBlcyA9IG1hcFtkYlR5cGVdO1xuICBjb25zdCBleHBlY3RlZCA9IEFycmF5LmlzQXJyYXkoZmllbGRUeXBlKSA/IHR5cGVzW1wic3RyaW5nXCJdLm1hcCgodCkgPT4gdC50b0xvd2VyQ2FzZSgpKSA6IHR5cGVzW2ZpZWxkVHlwZV0ubWFwKCh0KSA9PiB0LnRvTG93ZXJDYXNlKCkpO1xuICByZXR1cm4gZXhwZWN0ZWQuaW5jbHVkZXMobm9ybWFsaXplKGNvbHVtbkRhdGFUeXBlKSk7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0Z3Jlc1NjaGVtYShkYikge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNxbGBTSE9XIHNlYXJjaF9wYXRoYC5leGVjdXRlKFxuICAgICAgZGJcbiAgICApO1xuICAgIGlmIChyZXN1bHQucm93c1swXT8uc2VhcmNoX3BhdGgpIHtcbiAgICAgIGNvbnN0IHNjaGVtYXMgPSByZXN1bHQucm93c1swXS5zZWFyY2hfcGF0aC5zcGxpdChcIixcIikubWFwKChzKSA9PiBzLnRyaW0oKSkubWFwKChzKSA9PiBzLnJlcGxhY2UoL15bXCInXXxbXCInXSQvZywgXCJcIikpLmZpbHRlcigocykgPT4gIXMuc3RhcnRzV2l0aChcIiRcIikpO1xuICAgICAgcmV0dXJuIHNjaGVtYXNbMF0gfHwgXCJwdWJsaWNcIjtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gIH1cbiAgcmV0dXJuIFwicHVibGljXCI7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRNaWdyYXRpb25zKGNvbmZpZykge1xuICBjb25zdCBiZXR0ZXJBdXRoU2NoZW1hID0gZ2V0U2NoZW1hKGNvbmZpZyk7XG4gIGNvbnN0IGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcihjb25maWcubG9nZ2VyKTtcbiAgbGV0IHsga3lzZWx5OiBkYiwgZGF0YWJhc2VUeXBlOiBkYlR5cGUgfSA9IGF3YWl0IGNyZWF0ZUt5c2VseUFkYXB0ZXIoY29uZmlnKTtcbiAgaWYgKCFkYlR5cGUpIHtcbiAgICBsb2dnZXIud2FybihcbiAgICAgIFwiQ291bGQgbm90IGRldGVybWluZSBkYXRhYmFzZSB0eXBlLCBkZWZhdWx0aW5nIHRvIHNxbGl0ZS4gUGxlYXNlIHByb3ZpZGUgYSB0eXBlIGluIHRoZSBkYXRhYmFzZSBvcHRpb25zIHRvIGF2b2lkIHRoaXMuXCJcbiAgICApO1xuICAgIGRiVHlwZSA9IFwic3FsaXRlXCI7XG4gIH1cbiAgaWYgKCFkYikge1xuICAgIGxvZ2dlci5lcnJvcihcbiAgICAgIFwiT25seSBreXNlbHkgYWRhcHRlciBpcyBzdXBwb3J0ZWQgZm9yIG1pZ3JhdGlvbnMuIFlvdSBjYW4gdXNlIGBnZW5lcmF0ZWAgY29tbWFuZCB0byBnZW5lcmF0ZSB0aGUgc2NoZW1hLCBpZiB5b3UncmUgdXNpbmcgYSBkaWZmZXJlbnQgYWRhcHRlci5cIlxuICAgICk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG4gIGxldCBjdXJyZW50U2NoZW1hID0gXCJwdWJsaWNcIjtcbiAgaWYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiKSB7XG4gICAgY3VycmVudFNjaGVtYSA9IGF3YWl0IGdldFBvc3RncmVzU2NoZW1hKGRiKTtcbiAgICBsb2dnZXIuZGVidWcoXG4gICAgICBgUG9zdGdyZVNRTCBtaWdyYXRpb246IFVzaW5nIHNjaGVtYSAnJHtjdXJyZW50U2NoZW1hfScgKGZyb20gc2VhcmNoX3BhdGgpYFxuICAgICk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNjaGVtYUNoZWNrID0gYXdhaXQgc3FsYFxuXHRcdFx0XHRTRUxFQ1Qgc2NoZW1hX25hbWUgXG5cdFx0XHRcdEZST00gaW5mb3JtYXRpb25fc2NoZW1hLnNjaGVtYXRhIFxuXHRcdFx0XHRXSEVSRSBzY2hlbWFfbmFtZSA9ICR7Y3VycmVudFNjaGVtYX1cblx0XHRcdGAuZXhlY3V0ZShkYik7XG4gICAgICBpZiAoIXNjaGVtYUNoZWNrLnJvd3NbMF0pIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgYFNjaGVtYSAnJHtjdXJyZW50U2NoZW1hfScgZG9lcyBub3QgZXhpc3QuIFRhYmxlcyB3aWxsIGJlIGluc3BlY3RlZCBmcm9tIGF2YWlsYWJsZSBzY2hlbWFzLiBDb25zaWRlciBjcmVhdGluZyB0aGUgc2NoZW1hIGZpcnN0IG9yIGNoZWNraW5nIHlvdXIgZGF0YWJhc2UgY29uZmlndXJhdGlvbi5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgYENvdWxkIG5vdCB2ZXJpZnkgc2NoZW1hIGV4aXN0ZW5jZTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgYWxsVGFibGVNZXRhZGF0YSA9IGF3YWl0IGRiLmludHJvc3BlY3Rpb24uZ2V0VGFibGVzKCk7XG4gIGxldCB0YWJsZU1ldGFkYXRhID0gYWxsVGFibGVNZXRhZGF0YTtcbiAgaWYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhYmxlc0luU2NoZW1hID0gYXdhaXQgc3FsYFxuXHRcdFx0XHRTRUxFQ1QgdGFibGVfbmFtZSBcblx0XHRcdFx0RlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIFxuXHRcdFx0XHRXSEVSRSB0YWJsZV9zY2hlbWEgPSAke2N1cnJlbnRTY2hlbWF9XG5cdFx0XHRcdEFORCB0YWJsZV90eXBlID0gJ0JBU0UgVEFCTEUnXG5cdFx0XHRgLmV4ZWN1dGUoZGIpO1xuICAgICAgY29uc3QgdGFibGVOYW1lc0luU2NoZW1hID0gbmV3IFNldChcbiAgICAgICAgdGFibGVzSW5TY2hlbWEucm93cy5tYXAoKHJvdykgPT4gcm93LnRhYmxlX25hbWUpXG4gICAgICApO1xuICAgICAgdGFibGVNZXRhZGF0YSA9IGFsbFRhYmxlTWV0YWRhdGEuZmlsdGVyKFxuICAgICAgICAodGFibGUpID0+IHRhYmxlLnNjaGVtYSA9PT0gY3VycmVudFNjaGVtYSAmJiB0YWJsZU5hbWVzSW5TY2hlbWEuaGFzKHRhYmxlLm5hbWUpXG4gICAgICApO1xuICAgICAgbG9nZ2VyLmRlYnVnKFxuICAgICAgICBgRm91bmQgJHt0YWJsZU1ldGFkYXRhLmxlbmd0aH0gdGFibGUocykgaW4gc2NoZW1hICcke2N1cnJlbnRTY2hlbWF9JzogJHt0YWJsZU1ldGFkYXRhLm1hcCgodCkgPT4gdC5uYW1lKS5qb2luKFwiLCBcIikgfHwgXCIobm9uZSlcIn1gXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIud2FybihcbiAgICAgICAgYENvdWxkIG5vdCBmaWx0ZXIgdGFibGVzIGJ5IHNjaGVtYS4gVXNpbmcgYWxsIGRpc2NvdmVyZWQgdGFibGVzLiBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgdG9CZUNyZWF0ZWQgPSBbXTtcbiAgY29uc3QgdG9CZUFkZGVkID0gW107XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGJldHRlckF1dGhTY2hlbWEpKSB7XG4gICAgY29uc3QgdGFibGUgPSB0YWJsZU1ldGFkYXRhLmZpbmQoKHQpID0+IHQubmFtZSA9PT0ga2V5KTtcbiAgICBpZiAoIXRhYmxlKSB7XG4gICAgICBjb25zdCB0SW5kZXggPSB0b0JlQ3JlYXRlZC5maW5kSW5kZXgoKHQpID0+IHQudGFibGUgPT09IGtleSk7XG4gICAgICBjb25zdCB0YWJsZURhdGEgPSB7XG4gICAgICAgIHRhYmxlOiBrZXksXG4gICAgICAgIGZpZWxkczogdmFsdWUuZmllbGRzLFxuICAgICAgICBvcmRlcjogdmFsdWUub3JkZXIgfHwgSW5maW5pdHlcbiAgICAgIH07XG4gICAgICBjb25zdCBpbnNlcnRJbmRleCA9IHRvQmVDcmVhdGVkLmZpbmRJbmRleChcbiAgICAgICAgKHQpID0+ICh0Lm9yZGVyIHx8IEluZmluaXR5KSA+IHRhYmxlRGF0YS5vcmRlclxuICAgICAgKTtcbiAgICAgIGlmIChpbnNlcnRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKHRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICB0b0JlQ3JlYXRlZC5wdXNoKHRhYmxlRGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9CZUNyZWF0ZWRbdEluZGV4XS5maWVsZHMgPSB7XG4gICAgICAgICAgICAuLi50b0JlQ3JlYXRlZFt0SW5kZXhdLmZpZWxkcyxcbiAgICAgICAgICAgIC4uLnZhbHVlLmZpZWxkc1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvQmVDcmVhdGVkLnNwbGljZShpbnNlcnRJbmRleCwgMCwgdGFibGVEYXRhKTtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBsZXQgdG9CZUFkZGVkRmllbGRzID0ge307XG4gICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModmFsdWUuZmllbGRzKSkge1xuICAgICAgY29uc3QgY29sdW1uID0gdGFibGUuY29sdW1ucy5maW5kKChjKSA9PiBjLm5hbWUgPT09IGZpZWxkTmFtZSk7XG4gICAgICBpZiAoIWNvbHVtbikge1xuICAgICAgICB0b0JlQWRkZWRGaWVsZHNbZmllbGROYW1lXSA9IGZpZWxkO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChtYXRjaFR5cGUoY29sdW1uLmRhdGFUeXBlLCBmaWVsZC50eXBlLCBkYlR5cGUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgYEZpZWxkICR7ZmllbGROYW1lfSBpbiB0YWJsZSAke2tleX0gaGFzIGEgZGlmZmVyZW50IHR5cGUgaW4gdGhlIGRhdGFiYXNlLiBFeHBlY3RlZCAke2ZpZWxkLnR5cGV9IGJ1dCBnb3QgJHtjb2x1bW4uZGF0YVR5cGV9LmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKE9iamVjdC5rZXlzKHRvQmVBZGRlZEZpZWxkcykubGVuZ3RoID4gMCkge1xuICAgICAgdG9CZUFkZGVkLnB1c2goe1xuICAgICAgICB0YWJsZToga2V5LFxuICAgICAgICBmaWVsZHM6IHRvQmVBZGRlZEZpZWxkcyxcbiAgICAgICAgb3JkZXI6IHZhbHVlLm9yZGVyIHx8IEluZmluaXR5XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgY29uc3QgbWlncmF0aW9ucyA9IFtdO1xuICBmdW5jdGlvbiBnZXRUeXBlKGZpZWxkLCBmaWVsZE5hbWUpIHtcbiAgICBjb25zdCB0eXBlID0gZmllbGQudHlwZTtcbiAgICBjb25zdCB0eXBlTWFwID0ge1xuICAgICAgc3RyaW5nOiB7XG4gICAgICAgIHNxbGl0ZTogXCJ0ZXh0XCIsXG4gICAgICAgIHBvc3RncmVzOiBcInRleHRcIixcbiAgICAgICAgbXlzcWw6IGZpZWxkLnVuaXF1ZSA/IFwidmFyY2hhcigyNTUpXCIgOiBmaWVsZC5yZWZlcmVuY2VzID8gXCJ2YXJjaGFyKDM2KVwiIDogXCJ0ZXh0XCIsXG4gICAgICAgIG1zc3FsOiBmaWVsZC51bmlxdWUgfHwgZmllbGQuc29ydGFibGUgPyBcInZhcmNoYXIoMjU1KVwiIDogZmllbGQucmVmZXJlbmNlcyA/IFwidmFyY2hhcigzNilcIiA6IChcbiAgICAgICAgICAvLyBtc3NxbCBkZXByZWNhdGVkIGB0ZXh0YCwgYW5kIHRoZSBhbHRlcm5hdGl2ZSBpcyBgdmFyY2hhcihtYXgpYC5cbiAgICAgICAgICAvLyBLeXNlbHkgdHlwZSBpbnRlcmZhY2UgZG9lc24ndCBzdXBwb3J0IGB0ZXh0YCwgc28gd2Ugc2V0IHRoaXMgdG8gYHZhcmNoYXIoODAwMClgIGFzXG4gICAgICAgICAgLy8gdGhhdCdzIHRoZSBtYXggbGVuZ3RoIGZvciBgdmFyY2hhcmBcbiAgICAgICAgICBcInZhcmNoYXIoODAwMClcIlxuICAgICAgICApXG4gICAgICB9LFxuICAgICAgYm9vbGVhbjoge1xuICAgICAgICBzcWxpdGU6IFwiaW50ZWdlclwiLFxuICAgICAgICBwb3N0Z3JlczogXCJib29sZWFuXCIsXG4gICAgICAgIG15c3FsOiBcImJvb2xlYW5cIixcbiAgICAgICAgbXNzcWw6IFwic21hbGxpbnRcIlxuICAgICAgfSxcbiAgICAgIG51bWJlcjoge1xuICAgICAgICBzcWxpdGU6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIixcbiAgICAgICAgcG9zdGdyZXM6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIixcbiAgICAgICAgbXlzcWw6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIixcbiAgICAgICAgbXNzcWw6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIlxuICAgICAgfSxcbiAgICAgIGRhdGU6IHtcbiAgICAgICAgc3FsaXRlOiBcImRhdGVcIixcbiAgICAgICAgcG9zdGdyZXM6IFwidGltZXN0YW1wdHpcIixcbiAgICAgICAgbXlzcWw6IFwidGltZXN0YW1wKDMpXCIsXG4gICAgICAgIG1zc3FsOiBzcWxgZGF0ZXRpbWUyKDMpYFxuICAgICAgfSxcbiAgICAgIGpzb246IHtcbiAgICAgICAgc3FsaXRlOiBcInRleHRcIixcbiAgICAgICAgcG9zdGdyZXM6IFwianNvbmJcIixcbiAgICAgICAgbXlzcWw6IFwianNvblwiLFxuICAgICAgICBtc3NxbDogXCJ2YXJjaGFyKDgwMDApXCJcbiAgICAgIH0sXG4gICAgICBpZDoge1xuICAgICAgICBwb3N0Z3JlczogY29uZmlnLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcInNlcmlhbFwiIDogXCJ0ZXh0XCIsXG4gICAgICAgIG15c3FsOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ2YXJjaGFyKDM2KVwiLFxuICAgICAgICBtc3NxbDogY29uZmlnLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcImludGVnZXJcIiA6IFwidmFyY2hhcigzNilcIixcbiAgICAgICAgc3FsaXRlOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ0ZXh0XCJcbiAgICAgIH0sXG4gICAgICBmb3JlaWduS2V5SWQ6IHtcbiAgICAgICAgcG9zdGdyZXM6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJpbnRlZ2VyXCIgOiBcInRleHRcIixcbiAgICAgICAgbXlzcWw6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJpbnRlZ2VyXCIgOiBcInZhcmNoYXIoMzYpXCIsXG4gICAgICAgIG1zc3FsOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ2YXJjaGFyKDM2KVwiLFxuICAgICAgICBzcWxpdGU6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJpbnRlZ2VyXCIgOiBcInRleHRcIlxuICAgICAgfVxuICAgIH07XG4gICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJpZFwiIHx8IGZpZWxkLnJlZmVyZW5jZXM/LmZpZWxkID09PSBcImlkXCIpIHtcbiAgICAgIGlmIChmaWVsZE5hbWUgPT09IFwiaWRcIikge1xuICAgICAgICByZXR1cm4gdHlwZU1hcC5pZFtkYlR5cGVdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHR5cGVNYXAuZm9yZWlnbktleUlkW2RiVHlwZV07XG4gICAgfVxuICAgIGlmIChkYlR5cGUgPT09IFwic3FsaXRlXCIgJiYgKHR5cGUgPT09IFwic3RyaW5nW11cIiB8fCB0eXBlID09PSBcIm51bWJlcltdXCIpKSB7XG4gICAgICByZXR1cm4gXCJ0ZXh0XCI7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSBcInN0cmluZ1tdXCIgfHwgdHlwZSA9PT0gXCJudW1iZXJbXVwiKSB7XG4gICAgICByZXR1cm4gXCJqc29uYlwiO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheSh0eXBlKSkge1xuICAgICAgcmV0dXJuIFwidGV4dFwiO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZU1hcFt0eXBlXVtkYlR5cGUgfHwgXCJzcWxpdGVcIl07XG4gIH1cbiAgaWYgKHRvQmVBZGRlZC5sZW5ndGgpIHtcbiAgICBmb3IgKGNvbnN0IHRhYmxlIG9mIHRvQmVBZGRlZCkge1xuICAgICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModGFibGUuZmllbGRzKSkge1xuICAgICAgICBjb25zdCB0eXBlID0gZ2V0VHlwZShmaWVsZCwgZmllbGROYW1lKTtcbiAgICAgICAgY29uc3QgZXhlYyA9IGRiLnNjaGVtYS5hbHRlclRhYmxlKHRhYmxlLnRhYmxlKS5hZGRDb2x1bW4oZmllbGROYW1lLCB0eXBlLCAoY29sKSA9PiB7XG4gICAgICAgICAgY29sID0gZmllbGQucmVxdWlyZWQgIT09IGZhbHNlID8gY29sLm5vdE51bGwoKSA6IGNvbDtcbiAgICAgICAgICBpZiAoZmllbGQucmVmZXJlbmNlcykge1xuICAgICAgICAgICAgY29sID0gY29sLnJlZmVyZW5jZXMoXG4gICAgICAgICAgICAgIGAke2ZpZWxkLnJlZmVyZW5jZXMubW9kZWx9LiR7ZmllbGQucmVmZXJlbmNlcy5maWVsZH1gXG4gICAgICAgICAgICApLm9uRGVsZXRlKGZpZWxkLnJlZmVyZW5jZXMub25EZWxldGUgfHwgXCJjYXNjYWRlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudW5pcXVlKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wudW5pcXVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSBcImRhdGVcIiAmJiB0eXBlb2YgZmllbGQuZGVmYXVsdFZhbHVlID09PSBcImZ1bmN0aW9uXCIgJiYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiIHx8IGRiVHlwZSA9PT0gXCJteXNxbFwiIHx8IGRiVHlwZSA9PT0gXCJtc3NxbFwiKSkge1xuICAgICAgICAgICAgaWYgKGRiVHlwZSA9PT0gXCJteXNxbFwiKSB7XG4gICAgICAgICAgICAgIGNvbCA9IGNvbC5kZWZhdWx0VG8oc3FsYENVUlJFTlRfVElNRVNUQU1QKDMpYCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb2wgPSBjb2wuZGVmYXVsdFRvKHNxbGBDVVJSRU5UX1RJTUVTVEFNUGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY29sO1xuICAgICAgICB9KTtcbiAgICAgICAgbWlncmF0aW9ucy5wdXNoKGV4ZWMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAodG9CZUNyZWF0ZWQubGVuZ3RoKSB7XG4gICAgZm9yIChjb25zdCB0YWJsZSBvZiB0b0JlQ3JlYXRlZCkge1xuICAgICAgbGV0IGRiVCA9IGRiLnNjaGVtYS5jcmVhdGVUYWJsZSh0YWJsZS50YWJsZSkuYWRkQ29sdW1uKFxuICAgICAgICBcImlkXCIsXG4gICAgICAgIGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gZGJUeXBlID09PSBcInBvc3RncmVzXCIgPyBcInNlcmlhbFwiIDogXCJpbnRlZ2VyXCIgOiBkYlR5cGUgPT09IFwibXlzcWxcIiB8fCBkYlR5cGUgPT09IFwibXNzcWxcIiA/IFwidmFyY2hhcigzNilcIiA6IFwidGV4dFwiLFxuICAgICAgICAoY29sKSA9PiB7XG4gICAgICAgICAgaWYgKGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICAgICAgICBpZiAoZGJUeXBlID09PSBcInBvc3RncmVzXCIgfHwgZGJUeXBlID09PSBcInNxbGl0ZVwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjb2wucHJpbWFyeUtleSgpLm5vdE51bGwoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGJUeXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNvbC5pZGVudGl0eSgpLnByaW1hcnlLZXkoKS5ub3ROdWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29sLmF1dG9JbmNyZW1lbnQoKS5wcmltYXJ5S2V5KCkubm90TnVsbCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY29sLnByaW1hcnlLZXkoKS5ub3ROdWxsKCk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIGZpZWxkXSBvZiBPYmplY3QuZW50cmllcyh0YWJsZS5maWVsZHMpKSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBnZXRUeXBlKGZpZWxkLCBmaWVsZE5hbWUpO1xuICAgICAgICBkYlQgPSBkYlQuYWRkQ29sdW1uKGZpZWxkTmFtZSwgdHlwZSwgKGNvbCkgPT4ge1xuICAgICAgICAgIGNvbCA9IGZpZWxkLnJlcXVpcmVkICE9PSBmYWxzZSA/IGNvbC5ub3ROdWxsKCkgOiBjb2w7XG4gICAgICAgICAgaWYgKGZpZWxkLnJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNvbCA9IGNvbC5yZWZlcmVuY2VzKGAke2ZpZWxkLnJlZmVyZW5jZXMubW9kZWx9LiR7ZmllbGQucmVmZXJlbmNlcy5maWVsZH1gKS5vbkRlbGV0ZShmaWVsZC5yZWZlcmVuY2VzLm9uRGVsZXRlIHx8IFwiY2FzY2FkZVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnVuaXF1ZSkge1xuICAgICAgICAgICAgY29sID0gY29sLnVuaXF1ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gXCJkYXRlXCIgJiYgdHlwZW9mIGZpZWxkLmRlZmF1bHRWYWx1ZSA9PT0gXCJmdW5jdGlvblwiICYmIChkYlR5cGUgPT09IFwicG9zdGdyZXNcIiB8fCBkYlR5cGUgPT09IFwibXlzcWxcIiB8fCBkYlR5cGUgPT09IFwibXNzcWxcIikpIHtcbiAgICAgICAgICAgIGlmIChkYlR5cGUgPT09IFwibXlzcWxcIikge1xuICAgICAgICAgICAgICBjb2wgPSBjb2wuZGVmYXVsdFRvKHNxbGBDVVJSRU5UX1RJTUVTVEFNUCgzKWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29sID0gY29sLmRlZmF1bHRUbyhzcWxgQ1VSUkVOVF9USU1FU1RBTVBgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNvbDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBtaWdyYXRpb25zLnB1c2goZGJUKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gcnVuTWlncmF0aW9ucygpIHtcbiAgICBmb3IgKGNvbnN0IG1pZ3JhdGlvbiBvZiBtaWdyYXRpb25zKSB7XG4gICAgICBhd2FpdCBtaWdyYXRpb24uZXhlY3V0ZSgpO1xuICAgIH1cbiAgfVxuICBhc3luYyBmdW5jdGlvbiBjb21waWxlTWlncmF0aW9ucygpIHtcbiAgICBjb25zdCBjb21waWxlZCA9IG1pZ3JhdGlvbnMubWFwKChtKSA9PiBtLmNvbXBpbGUoKS5zcWwpO1xuICAgIHJldHVybiBjb21waWxlZC5qb2luKFwiO1xcblxcblwiKSArIFwiO1wiO1xuICB9XG4gIHJldHVybiB7IHRvQmVDcmVhdGVkLCB0b0JlQWRkZWQsIHJ1bk1pZ3JhdGlvbnMsIGNvbXBpbGVNaWdyYXRpb25zIH07XG59XG5cbmV4cG9ydCB7IGdldEFkYXB0ZXIgYXMgYSwgY29udmVydFRvREIgYXMgYiwgY3JlYXRlSW50ZXJuYWxBZGFwdGVyIGFzIGMsIGNvbnZlcnRGcm9tREIgYXMgZCwgZ2V0TWlncmF0aW9ucyBhcyBlLCBnZXRTY2hlbWEgYXMgZiwgZ2V0V2l0aEhvb2tzIGFzIGcsIG1hdGNoVHlwZSBhcyBtIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   s: () => (/* binding */ safeJSONParse)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n\n\nfunction safeJSONParse(data) {\n  function reviver(_, value) {\n    if (typeof value === \"string\") {\n      const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z$/;\n      if (iso8601Regex.test(value)) {\n        const date = new Date(value);\n        if (!isNaN(date.getTime())) {\n          return date;\n        }\n      }\n    }\n    return value;\n  }\n  try {\n    if (typeof data !== \"string\") {\n      return data;\n    }\n    return JSON.parse(data, reviver);\n  } catch (e) {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error parsing JSON\", { error: e });\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQktFdEVwdDAubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQStDOztBQUUvQztBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osSUFBSSx5REFBTSwrQkFBK0IsVUFBVTtBQUNuRDtBQUNBO0FBQ0E7O0FBRThCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQktFdEVwdDAubWpzP2NmOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcblxuZnVuY3Rpb24gc2FmZUpTT05QYXJzZShkYXRhKSB7XG4gIGZ1bmN0aW9uIHJldml2ZXIoXywgdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBpc284NjAxUmVnZXggPSAvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9VFxcZHsyfTpcXGR7Mn06XFxkezJ9KD86XFwuXFxkKyk/WiQvO1xuICAgICAgaWYgKGlzbzg2MDFSZWdleC50ZXN0KHZhbHVlKSkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICAgICAgICBpZiAoIWlzTmFOKGRhdGUuZ2V0VGltZSgpKSkge1xuICAgICAgICAgIHJldHVybiBkYXRlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICB0cnkge1xuICAgIGlmICh0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEsIHJldml2ZXIpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgcGFyc2luZyBKU09OXCIsIHsgZXJyb3I6IGUgfSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IHsgc2FmZUpTT05QYXJzZSBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   m: () => (/* binding */ memoryAdapter)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n\n\n\nconst memoryAdapter = (db, config) => {\n  let lazyOptions = null;\n  let adapterCreator = (0,_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_1__.c)({\n    config: {\n      adapterId: \"memory\",\n      adapterName: \"Memory Adapter\",\n      usePlural: false,\n      debugLogs: config?.debugLogs || false,\n      customTransformInput(props) {\n        if (props.options.advanced?.database?.useNumberId && props.field === \"id\" && props.action === \"create\") {\n          return db[props.model].length + 1;\n        }\n        return props.data;\n      },\n      transaction: async (cb) => {\n        let clone = structuredClone(db);\n        try {\n          const r = await cb(adapterCreator(lazyOptions));\n          return r;\n        } catch (error) {\n          Object.keys(db).forEach((key) => {\n            db[key] = clone[key];\n          });\n          throw error;\n        }\n      }\n    },\n    adapter: ({ getFieldName, options, debugLog }) => {\n      function convertWhereClause(where, model) {\n        const table = db[model];\n        if (!table) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger.error(\n            `[MemoryAdapter] Model ${model} not found in the DB`,\n            Object.keys(db)\n          );\n          throw new Error(`Model ${model} not found`);\n        }\n        const evalClause = (record, clause) => {\n          const { field, value, operator } = clause;\n          switch (operator) {\n            case \"in\":\n              if (!Array.isArray(value)) {\n                throw new Error(\"Value must be an array\");\n              }\n              return value.includes(record[field]);\n            case \"not_in\":\n              if (!Array.isArray(value)) {\n                throw new Error(\"Value must be an array\");\n              }\n              return !value.includes(record[field]);\n            case \"contains\":\n              return record[field].includes(value);\n            case \"starts_with\":\n              return record[field].startsWith(value);\n            case \"ends_with\":\n              return record[field].endsWith(value);\n            case \"ne\":\n              return record[field] !== value;\n            case \"gt\":\n              return value != null && Boolean(record[field] > value);\n            case \"gte\":\n              return value != null && Boolean(record[field] >= value);\n            case \"lt\":\n              return value != null && Boolean(record[field] < value);\n            case \"lte\":\n              return value != null && Boolean(record[field] <= value);\n            default:\n              return record[field] === value;\n          }\n        };\n        return table.filter((record) => {\n          if (!where.length || where.length === 0) {\n            return true;\n          }\n          let result = evalClause(record, where[0]);\n          for (const clause of where) {\n            const clauseResult = evalClause(record, clause);\n            if (clause.connector === \"OR\") {\n              result = result || clauseResult;\n            } else {\n              result = result && clauseResult;\n            }\n          }\n          return result;\n        });\n      }\n      return {\n        create: async ({ model, data }) => {\n          if (options.advanced?.database?.useNumberId) {\n            data.id = db[model].length + 1;\n          }\n          if (!db[model]) {\n            db[model] = [];\n          }\n          db[model].push(data);\n          return data;\n        },\n        findOne: async ({ model, where }) => {\n          const res = convertWhereClause(where, model);\n          const record = res[0] || null;\n          return record;\n        },\n        findMany: async ({ model, where, sortBy, limit, offset }) => {\n          let table = db[model];\n          if (where) {\n            table = convertWhereClause(where, model);\n          }\n          if (sortBy) {\n            table = table.sort((a, b) => {\n              const field = getFieldName({ model, field: sortBy.field });\n              const aValue = a[field];\n              const bValue = b[field];\n              let comparison = 0;\n              if (aValue == null && bValue == null) {\n                comparison = 0;\n              } else if (aValue == null) {\n                comparison = -1;\n              } else if (bValue == null) {\n                comparison = 1;\n              } else if (typeof aValue === \"string\" && typeof bValue === \"string\") {\n                comparison = aValue.localeCompare(bValue);\n              } else if (aValue instanceof Date && bValue instanceof Date) {\n                comparison = aValue.getTime() - bValue.getTime();\n              } else if (typeof aValue === \"number\" && typeof bValue === \"number\") {\n                comparison = aValue - bValue;\n              } else if (typeof aValue === \"boolean\" && typeof bValue === \"boolean\") {\n                comparison = aValue === bValue ? 0 : aValue ? 1 : -1;\n              } else {\n                comparison = String(aValue).localeCompare(String(bValue));\n              }\n              return sortBy.direction === \"asc\" ? comparison : -comparison;\n            });\n          }\n          if (offset !== void 0) {\n            table = table.slice(offset);\n          }\n          if (limit !== void 0) {\n            table = table.slice(0, limit);\n          }\n          return table || [];\n        },\n        count: async ({ model, where }) => {\n          if (where) {\n            const filteredRecords = convertWhereClause(where, model);\n            return filteredRecords.length;\n          }\n          return db[model].length;\n        },\n        update: async ({ model, where, update }) => {\n          const res = convertWhereClause(where, model);\n          res.forEach((record) => {\n            Object.assign(record, update);\n          });\n          return res[0] || null;\n        },\n        delete: async ({ model, where }) => {\n          const table = db[model];\n          const res = convertWhereClause(where, model);\n          db[model] = table.filter((record) => !res.includes(record));\n        },\n        deleteMany: async ({ model, where }) => {\n          const table = db[model];\n          const res = convertWhereClause(where, model);\n          let count = 0;\n          db[model] = table.filter((record) => {\n            if (res.includes(record)) {\n              count++;\n              return false;\n            }\n            return !res.includes(record);\n          });\n          return count;\n        },\n        updateMany({ model, where, update }) {\n          const res = convertWhereClause(where, model);\n          res.forEach((record) => {\n            Object.assign(record, update);\n          });\n          return res[0] || null;\n        }\n      };\n    }\n  });\n  return (options) => {\n    lazyOptions = options;\n    return adapterCreator(options);\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQk5wSXdxNEMubWpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUErQztBQUN3Qjs7QUFFdkU7QUFDQTtBQUNBLHVCQUF1Qiw0REFBb0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxnQkFBZ0IsaUNBQWlDO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLFVBQVUseURBQU07QUFDaEIscUNBQXFDLE9BQU87QUFDNUM7QUFDQTtBQUNBLG1DQUFtQyxPQUFPO0FBQzFDO0FBQ0E7QUFDQSxrQkFBa0IseUJBQXlCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSx5QkFBeUIsYUFBYTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULDBCQUEwQixjQUFjO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCwyQkFBMkIscUNBQXFDO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyw0QkFBNEI7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCx3QkFBd0IsY0FBYztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHlCQUF5QixzQkFBc0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsU0FBUztBQUNULHlCQUF5QixjQUFjO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCw2QkFBNkIsY0FBYztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1QscUJBQXFCLHNCQUFzQjtBQUMzQztBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFOEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CTnBJd3E0Qy5tanM/ZmM1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVBZGFwdGVyRmFjdG9yeSB9IGZyb20gJy4vYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzJztcblxuY29uc3QgbWVtb3J5QWRhcHRlciA9IChkYiwgY29uZmlnKSA9PiB7XG4gIGxldCBsYXp5T3B0aW9ucyA9IG51bGw7XG4gIGxldCBhZGFwdGVyQ3JlYXRvciA9IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5KHtcbiAgICBjb25maWc6IHtcbiAgICAgIGFkYXB0ZXJJZDogXCJtZW1vcnlcIixcbiAgICAgIGFkYXB0ZXJOYW1lOiBcIk1lbW9yeSBBZGFwdGVyXCIsXG4gICAgICB1c2VQbHVyYWw6IGZhbHNlLFxuICAgICAgZGVidWdMb2dzOiBjb25maWc/LmRlYnVnTG9ncyB8fCBmYWxzZSxcbiAgICAgIGN1c3RvbVRyYW5zZm9ybUlucHV0KHByb3BzKSB7XG4gICAgICAgIGlmIChwcm9wcy5vcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgJiYgcHJvcHMuZmllbGQgPT09IFwiaWRcIiAmJiBwcm9wcy5hY3Rpb24gPT09IFwiY3JlYXRlXCIpIHtcbiAgICAgICAgICByZXR1cm4gZGJbcHJvcHMubW9kZWxdLmxlbmd0aCArIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3BzLmRhdGE7XG4gICAgICB9LFxuICAgICAgdHJhbnNhY3Rpb246IGFzeW5jIChjYikgPT4ge1xuICAgICAgICBsZXQgY2xvbmUgPSBzdHJ1Y3R1cmVkQ2xvbmUoZGIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHIgPSBhd2FpdCBjYihhZGFwdGVyQ3JlYXRvcihsYXp5T3B0aW9ucykpO1xuICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIE9iamVjdC5rZXlzKGRiKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIGRiW2tleV0gPSBjbG9uZVtrZXldO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhZGFwdGVyOiAoeyBnZXRGaWVsZE5hbWUsIG9wdGlvbnMsIGRlYnVnTG9nIH0pID0+IHtcbiAgICAgIGZ1bmN0aW9uIGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpIHtcbiAgICAgICAgY29uc3QgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICAgIGlmICghdGFibGUpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICBgW01lbW9yeUFkYXB0ZXJdIE1vZGVsICR7bW9kZWx9IG5vdCBmb3VuZCBpbiB0aGUgREJgLFxuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGIpXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1vZGVsICR7bW9kZWx9IG5vdCBmb3VuZGApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2YWxDbGF1c2UgPSAocmVjb3JkLCBjbGF1c2UpID0+IHtcbiAgICAgICAgICBjb25zdCB7IGZpZWxkLCB2YWx1ZSwgb3BlcmF0b3IgfSA9IGNsYXVzZTtcbiAgICAgICAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7XG4gICAgICAgICAgICBjYXNlIFwiaW5cIjpcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIG11c3QgYmUgYW4gYXJyYXlcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmluY2x1ZGVzKHJlY29yZFtmaWVsZF0pO1xuICAgICAgICAgICAgY2FzZSBcIm5vdF9pblwiOlxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgbXVzdCBiZSBhbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gIXZhbHVlLmluY2x1ZGVzKHJlY29yZFtmaWVsZF0pO1xuICAgICAgICAgICAgY2FzZSBcImNvbnRhaW5zXCI6XG4gICAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLmluY2x1ZGVzKHZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJzdGFydHNfd2l0aFwiOlxuICAgICAgICAgICAgICByZXR1cm4gcmVjb3JkW2ZpZWxkXS5zdGFydHNXaXRoKHZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJlbmRzX3dpdGhcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0uZW5kc1dpdGgodmFsdWUpO1xuICAgICAgICAgICAgY2FzZSBcIm5lXCI6XG4gICAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGNhc2UgXCJndFwiOlxuICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiBCb29sZWFuKHJlY29yZFtmaWVsZF0gPiB2YWx1ZSk7XG4gICAgICAgICAgICBjYXNlIFwiZ3RlXCI6XG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsICYmIEJvb2xlYW4ocmVjb3JkW2ZpZWxkXSA+PSB2YWx1ZSk7XG4gICAgICAgICAgICBjYXNlIFwibHRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgQm9vbGVhbihyZWNvcmRbZmllbGRdIDwgdmFsdWUpO1xuICAgICAgICAgICAgY2FzZSBcImx0ZVwiOlxuICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiBCb29sZWFuKHJlY29yZFtmaWVsZF0gPD0gdmFsdWUpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0gPT09IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiB7XG4gICAgICAgICAgaWYgKCF3aGVyZS5sZW5ndGggfHwgd2hlcmUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IHJlc3VsdCA9IGV2YWxDbGF1c2UocmVjb3JkLCB3aGVyZVswXSk7XG4gICAgICAgICAgZm9yIChjb25zdCBjbGF1c2Ugb2Ygd2hlcmUpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsYXVzZVJlc3VsdCA9IGV2YWxDbGF1c2UocmVjb3JkLCBjbGF1c2UpO1xuICAgICAgICAgICAgaWYgKGNsYXVzZS5jb25uZWN0b3IgPT09IFwiT1JcIikge1xuICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgfHwgY2xhdXNlUmVzdWx0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGNsYXVzZVJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjcmVhdGU6IGFzeW5jICh7IG1vZGVsLCBkYXRhIH0pID0+IHtcbiAgICAgICAgICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICAgICAgICBkYXRhLmlkID0gZGJbbW9kZWxdLmxlbmd0aCArIDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZGJbbW9kZWxdKSB7XG4gICAgICAgICAgICBkYlttb2RlbF0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGJbbW9kZWxdLnB1c2goZGF0YSk7XG4gICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIGZpbmRPbmU6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSB9KSA9PiB7XG4gICAgICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgICAgY29uc3QgcmVjb3JkID0gcmVzWzBdIHx8IG51bGw7XG4gICAgICAgICAgcmV0dXJuIHJlY29yZDtcbiAgICAgICAgfSxcbiAgICAgICAgZmluZE1hbnk6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSwgc29ydEJ5LCBsaW1pdCwgb2Zmc2V0IH0pID0+IHtcbiAgICAgICAgICBsZXQgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICAgICAgaWYgKHdoZXJlKSB7XG4gICAgICAgICAgICB0YWJsZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoc29ydEJ5KSB7XG4gICAgICAgICAgICB0YWJsZSA9IHRhYmxlLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHNvcnRCeS5maWVsZCB9KTtcbiAgICAgICAgICAgICAgY29uc3QgYVZhbHVlID0gYVtmaWVsZF07XG4gICAgICAgICAgICAgIGNvbnN0IGJWYWx1ZSA9IGJbZmllbGRdO1xuICAgICAgICAgICAgICBsZXQgY29tcGFyaXNvbiA9IDA7XG4gICAgICAgICAgICAgIGlmIChhVmFsdWUgPT0gbnVsbCAmJiBiVmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSAwO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IC0xO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IDE7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgYlZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IGFWYWx1ZS5sb2NhbGVDb21wYXJlKGJWYWx1ZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoYVZhbHVlIGluc3RhbmNlb2YgRGF0ZSAmJiBiVmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IGFWYWx1ZS5nZXRUaW1lKCkgLSBiVmFsdWUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhVmFsdWUgPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGJWYWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBhVmFsdWUgLSBiVmFsdWU7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFWYWx1ZSA9PT0gXCJib29sZWFuXCIgJiYgdHlwZW9mIGJWYWx1ZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gYVZhbHVlID09PSBiVmFsdWUgPyAwIDogYVZhbHVlID8gMSA6IC0xO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBTdHJpbmcoYVZhbHVlKS5sb2NhbGVDb21wYXJlKFN0cmluZyhiVmFsdWUpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gc29ydEJ5LmRpcmVjdGlvbiA9PT0gXCJhc2NcIiA/IGNvbXBhcmlzb24gOiAtY29tcGFyaXNvbjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob2Zmc2V0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHRhYmxlID0gdGFibGUuc2xpY2Uob2Zmc2V0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGxpbWl0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHRhYmxlID0gdGFibGUuc2xpY2UoMCwgbGltaXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGFibGUgfHwgW107XG4gICAgICAgIH0sXG4gICAgICAgIGNvdW50OiBhc3luYyAoeyBtb2RlbCwgd2hlcmUgfSkgPT4ge1xuICAgICAgICAgIGlmICh3aGVyZSkge1xuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRSZWNvcmRzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRSZWNvcmRzLmxlbmd0aDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRiW21vZGVsXS5sZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlLCB1cGRhdGUgfSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICAgIHJlcy5mb3JFYWNoKChyZWNvcmQpID0+IHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocmVjb3JkLCB1cGRhdGUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiByZXNbMF0gfHwgbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlOiBhc3luYyAoeyBtb2RlbCwgd2hlcmUgfSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICAgIGRiW21vZGVsXSA9IHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiAhcmVzLmluY2x1ZGVzKHJlY29yZCkpO1xuICAgICAgICB9LFxuICAgICAgICBkZWxldGVNYW55OiBhc3luYyAoeyBtb2RlbCwgd2hlcmUgfSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgZGJbbW9kZWxdID0gdGFibGUuZmlsdGVyKChyZWNvcmQpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXMuaW5jbHVkZXMocmVjb3JkKSkge1xuICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gIXJlcy5pbmNsdWRlcyhyZWNvcmQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjb3VudDtcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlTWFueSh7IG1vZGVsLCB3aGVyZSwgdXBkYXRlIH0pIHtcbiAgICAgICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgICByZXMuZm9yRWFjaCgocmVjb3JkKSA9PiB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHJlY29yZCwgdXBkYXRlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gcmVzWzBdIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIChvcHRpb25zKSA9PiB7XG4gICAgbGF6eU9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHJldHVybiBhZGFwdGVyQ3JlYXRvcihvcHRpb25zKTtcbiAgfTtcbn07XG5cbmV4cG9ydCB7IG1lbW9yeUFkYXB0ZXIgYXMgbSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ generateId)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n\n\nconst generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQlVQUFJYZksubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXdFOztBQUV4RTtBQUNBLFNBQVMsc0ZBQTJCO0FBQ3BDOztBQUUyQiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcz9hNzJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuXG5jb25zdCBnZW5lcmF0ZUlkID0gKHNpemUpID0+IHtcbiAgcmV0dXJuIGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvcihcImEtelwiLCBcIkEtWlwiLCBcIjAtOVwiKShzaXplIHx8IDMyKTtcbn07XG5cbmV4cG9ydCB7IGdlbmVyYXRlSWQgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: () => (/* binding */ changeEmail),\n/* harmony export */   B: () => (/* binding */ sendVerificationEmail),\n/* harmony export */   C: () => (/* binding */ verifyEmail),\n/* harmony export */   D: () => (/* binding */ resetPassword),\n/* harmony export */   E: () => (/* binding */ forgetPassword),\n/* harmony export */   F: () => (/* binding */ signInEmail),\n/* harmony export */   G: () => (/* binding */ signOut),\n/* harmony export */   H: () => (/* binding */ HIDE_METADATA),\n/* harmony export */   I: () => (/* binding */ callbackOAuth),\n/* harmony export */   J: () => (/* binding */ signInSocial),\n/* harmony export */   K: () => (/* binding */ sendVerificationEmailFn),\n/* harmony export */   L: () => (/* binding */ isSimpleRequest),\n/* harmony export */   a: () => (/* binding */ originCheckMiddleware),\n/* harmony export */   b: () => (/* binding */ ok),\n/* harmony export */   c: () => (/* binding */ createEmailVerificationToken),\n/* harmony export */   d: () => (/* binding */ decryptOAuthToken),\n/* harmony export */   e: () => (/* binding */ error),\n/* harmony export */   f: () => (/* binding */ accountInfo),\n/* harmony export */   g: () => (/* binding */ generateState),\n/* harmony export */   h: () => (/* binding */ handleOAuthUserInfo),\n/* harmony export */   i: () => (/* binding */ getAccessToken),\n/* harmony export */   j: () => (/* binding */ unlinkAccount),\n/* harmony export */   k: () => (/* binding */ deleteUserCallback),\n/* harmony export */   l: () => (/* binding */ listUserAccounts),\n/* harmony export */   m: () => (/* binding */ linkSocialAccount),\n/* harmony export */   n: () => (/* binding */ requestPasswordResetCallback),\n/* harmony export */   o: () => (/* binding */ originCheck),\n/* harmony export */   p: () => (/* binding */ parseState),\n/* harmony export */   q: () => (/* binding */ requestPasswordReset),\n/* harmony export */   r: () => (/* binding */ refreshToken),\n/* harmony export */   s: () => (/* binding */ setTokenUtil),\n/* harmony export */   t: () => (/* binding */ toAuthEndpoints),\n/* harmony export */   u: () => (/* binding */ updateUser),\n/* harmony export */   v: () => (/* binding */ forgetPasswordCallback),\n/* harmony export */   w: () => (/* binding */ wildcardMatch),\n/* harmony export */   x: () => (/* binding */ deleteUser),\n/* harmony export */   y: () => (/* binding */ setPassword),\n/* harmony export */   z: () => (/* binding */ changePassword)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./better-auth.DEBtROF9.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var jose_errors__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! jose/errors */ \"(rsc)/./node_modules/jose/dist/webapi/util/errors.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction escapeRegExpChar(char) {\n  if (char === \"-\" || char === \"^\" || char === \"$\" || char === \"+\" || char === \".\" || char === \"(\" || char === \")\" || char === \"|\" || char === \"[\" || char === \"]\" || char === \"{\" || char === \"}\" || char === \"*\" || char === \"?\" || char === \"\\\\\") {\n    return `\\\\${char}`;\n  } else {\n    return char;\n  }\n}\nfunction escapeRegExpString(str) {\n  let result = \"\";\n  for (let i = 0; i < str.length; i++) {\n    result += escapeRegExpChar(str[i]);\n  }\n  return result;\n}\nfunction transform(pattern, separator = true) {\n  if (Array.isArray(pattern)) {\n    let regExpPatterns = pattern.map((p) => `^${transform(p, separator)}$`);\n    return `(?:${regExpPatterns.join(\"|\")})`;\n  }\n  let separatorSplitter = \"\";\n  let separatorMatcher = \"\";\n  let wildcard = \".\";\n  if (separator === true) {\n    separatorSplitter = \"/\";\n    separatorMatcher = \"[/\\\\\\\\]\";\n    wildcard = \"[^/\\\\\\\\]\";\n  } else if (separator) {\n    separatorSplitter = separator;\n    separatorMatcher = escapeRegExpString(separatorSplitter);\n    if (separatorMatcher.length > 1) {\n      separatorMatcher = `(?:${separatorMatcher})`;\n      wildcard = `((?!${separatorMatcher}).)`;\n    } else {\n      wildcard = `[^${separatorMatcher}]`;\n    }\n  }\n  let requiredSeparator = separator ? `${separatorMatcher}+?` : \"\";\n  let optionalSeparator = separator ? `${separatorMatcher}*?` : \"\";\n  let segments = separator ? pattern.split(separatorSplitter) : [pattern];\n  let result = \"\";\n  for (let s = 0; s < segments.length; s++) {\n    let segment = segments[s];\n    let nextSegment = segments[s + 1];\n    let currentSeparator = \"\";\n    if (!segment && s > 0) {\n      continue;\n    }\n    if (separator) {\n      if (s === segments.length - 1) {\n        currentSeparator = optionalSeparator;\n      } else if (nextSegment !== \"**\") {\n        currentSeparator = requiredSeparator;\n      } else {\n        currentSeparator = \"\";\n      }\n    }\n    if (separator && segment === \"**\") {\n      if (currentSeparator) {\n        result += s === 0 ? \"\" : currentSeparator;\n        result += `(?:${wildcard}*?${currentSeparator})*?`;\n      }\n      continue;\n    }\n    for (let c = 0; c < segment.length; c++) {\n      let char = segment[c];\n      if (char === \"\\\\\") {\n        if (c < segment.length - 1) {\n          result += escapeRegExpChar(segment[c + 1]);\n          c++;\n        }\n      } else if (char === \"?\") {\n        result += wildcard;\n      } else if (char === \"*\") {\n        result += `${wildcard}*?`;\n      } else {\n        result += escapeRegExpChar(char);\n      }\n    }\n    result += currentSeparator;\n  }\n  return result;\n}\nfunction isMatch(regexp, sample) {\n  if (typeof sample !== \"string\") {\n    throw new TypeError(`Sample must be a string, but ${typeof sample} given`);\n  }\n  return regexp.test(sample);\n}\nfunction wildcardMatch(pattern, options) {\n  if (typeof pattern !== \"string\" && !Array.isArray(pattern)) {\n    throw new TypeError(\n      `The first argument must be a single pattern string or an array of patterns, but ${typeof pattern} given`\n    );\n  }\n  if (typeof options === \"string\" || typeof options === \"boolean\") {\n    options = { separator: options };\n  }\n  if (arguments.length === 2 && !(typeof options === \"undefined\" || typeof options === \"object\" && options !== null && !Array.isArray(options))) {\n    throw new TypeError(\n      `The second argument must be an options object or a string/boolean separator, but ${typeof options} given`\n    );\n  }\n  options = options || {};\n  if (options.separator === \"\\\\\") {\n    throw new Error(\n      \"\\\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead\"\n    );\n  }\n  let regexpPattern = transform(pattern, options.separator);\n  let regexp = new RegExp(`^${regexpPattern}$`, options.flags);\n  let fn = isMatch.bind(null, regexp);\n  fn.options = options;\n  fn.pattern = pattern;\n  fn.regexp = regexp;\n  return fn;\n}\n\nconst originCheckMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(async (ctx) => {\n  if (ctx.request?.method !== \"POST\" || !ctx.request) {\n    return;\n  }\n  const headers = ctx.request?.headers;\n  const request = ctx.request;\n  const { body, query, context } = ctx;\n  if (isSimpleRequest(headers) && !ctx.context.skipCSRFCheck) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: \"Invalid request\" });\n  }\n  const originHeader = headers?.get(\"origin\") || headers?.get(\"referer\") || \"\";\n  const callbackURL = body?.callbackURL || query?.callbackURL;\n  const redirectURL = body?.redirectTo;\n  const errorCallbackURL = body?.errorCallbackURL;\n  const newUserCallbackURL = body?.newUserCallbackURL;\n  const trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...await context.options.trustedOrigins?.(request) || []\n  ];\n  const useCookies = headers?.has(\"cookie\");\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      if (pattern.includes(\"://\")) {\n        return wildcardMatch(pattern)((0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) || url);\n      }\n      const host = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.b)(url);\n      if (!host) {\n        return false;\n      }\n      return wildcardMatch(pattern)(host);\n    }\n    const protocol = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.c)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(url)\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  if (useCookies && !ctx.context.skipCSRFCheck && !ctx.context.skipOriginCheck) {\n    if (!originHeader || originHeader === \"null\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: \"Missing or null Origin\" });\n    }\n    validateURL(originHeader, \"origin\");\n  }\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n  redirectURL && validateURL(redirectURL, \"redirectURL\");\n  errorCallbackURL && validateURL(errorCallbackURL, \"errorCallbackURL\");\n  newUserCallbackURL && validateURL(newUserCallbackURL, \"newUserCallbackURL\");\n});\nconst originCheck = (getValue) => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(async (ctx) => {\n  if (!ctx.request) {\n    return;\n  }\n  const { context } = ctx;\n  const callbackURL = getValue(ctx);\n  const trustedOrigins = Array.isArray(\n    context.options.trustedOrigins\n  ) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...await context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      if (pattern.includes(\"://\")) {\n        return wildcardMatch(pattern)((0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) || url);\n      }\n      const host = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.b)(url);\n      if (!host) {\n        return false;\n      }\n      return wildcardMatch(pattern)(host);\n    }\n    const protocol = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.c)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(\n        url\n      )\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  const callbacks = Array.isArray(callbackURL) ? callbackURL : [callbackURL];\n  for (const url of callbacks) {\n    validateURL(url, \"callbackURL\");\n  }\n});\nfunction isSimpleRequest(headers) {\n  const SIMPLE_HEADERS = [\n    \"accept\",\n    \"accept-language\",\n    \"content-language\",\n    \"content-type\"\n  ];\n  const SIMPLE_CONTENT_TYPES = [\n    \"application/x-www-form-urlencoded\",\n    \"multipart/form-data\",\n    \"text/plain\"\n  ];\n  for (const [key, value] of headers.entries()) {\n    if (!SIMPLE_HEADERS.includes(key.toLowerCase())) {\n      return false;\n    }\n    if (key.toLowerCase() === \"content-type\" && !SIMPLE_CONTENT_TYPES.includes(\n      value?.split(\";\")[0]?.trim()?.toLowerCase() || \"\"\n    )) {\n      return false;\n    }\n  }\n  return true;\n}\n\nasync function createEmailVerificationToken(secret, email, updateTo, expiresIn = 3600) {\n  const token = await (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__.signJWT)(\n    {\n      email: email.toLowerCase(),\n      updateTo\n    },\n    secret,\n    expiresIn\n  );\n  return token;\n}\nasync function sendVerificationEmailFn(ctx, user) {\n  if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n    ctx.context.logger.error(\"Verification email isn't enabled.\");\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"Verification email isn't enabled\"\n    });\n  }\n  const token = await createEmailVerificationToken(\n    ctx.context.secret,\n    user.email,\n    void 0,\n    ctx.context.options.emailVerification?.expiresIn\n  );\n  const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n  await ctx.context.options.emailVerification.sendVerificationEmail(\n    {\n      user,\n      url,\n      token\n    },\n    ctx.request\n  );\n}\nconst sendVerificationEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/send-verification-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.email().meta({\n        description: \"The email to send the verification email to\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to use for email verification callback\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a verification email to the user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  email: {\n                    type: \"string\",\n                    description: \"The email to send the verification email to\",\n                    example: \"user@example.com\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\",\n                    example: \"https://example.com/callback\",\n                    nullable: true\n                  }\n                },\n                required: [\"email\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the email was sent successfully\",\n                      example: true\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"400\": {\n            description: \"Bad Request\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\",\n                      description: \"Error message\",\n                      example: \"Verification email isn't enabled\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const { email } = ctx.body;\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (!session) {\n      const user = await ctx.context.internalAdapter.findUserByEmail(email);\n      if (!user) {\n        return ctx.json({\n          status: true\n        });\n      }\n      await sendVerificationEmailFn(ctx, user.user);\n      return ctx.json({\n        status: true\n      });\n    }\n    if (session?.user.emailVerified) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"You can only send a verification email to an unverified email\"\n      });\n    }\n    if (session?.user.email !== email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"You can only send a verification email to your own email\"\n      });\n    }\n    await sendVerificationEmailFn(ctx, session.user);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst verifyEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/verify-email\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to verify the email\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Verify the email of the user\",\n        parameters: [\n          {\n            name: \"token\",\n            in: \"query\",\n            description: \"The token to verify the email\",\n            required: true,\n            schema: {\n              type: \"string\"\n            }\n          },\n          {\n            name: \"callbackURL\",\n            in: \"query\",\n            description: \"The URL to redirect to after email verification\",\n            required: false,\n            schema: {\n              type: \"string\"\n            }\n          }\n        ],\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"User ID\"\n                        },\n                        email: {\n                          type: \"string\",\n                          description: \"User email\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"User name\"\n                        },\n                        image: {\n                          type: \"string\",\n                          description: \"User image URL\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Indicates if the user email is verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          description: \"User creation date\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          description: \"User update date\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"image\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    },\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the email was verified successfully\"\n                    }\n                  },\n                  required: [\"user\", \"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    function redirectOnError(error) {\n      if (ctx.query.callbackURL) {\n        if (ctx.query.callbackURL.includes(\"?\")) {\n          throw ctx.redirect(`${ctx.query.callbackURL}&error=${error}`);\n        }\n        throw ctx.redirect(`${ctx.query.callbackURL}?error=${error}`);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: error\n      });\n    }\n    const { token } = ctx.query;\n    let jwt;\n    try {\n      jwt = await (0,jose__WEBPACK_IMPORTED_MODULE_24__.jwtVerify)(\n        token,\n        new TextEncoder().encode(ctx.context.secret),\n        {\n          algorithms: [\"HS256\"]\n        }\n      );\n    } catch (e) {\n      if (e instanceof jose_errors__WEBPACK_IMPORTED_MODULE_25__.JWTExpired) {\n        return redirectOnError(\"token_expired\");\n      }\n      return redirectOnError(\"invalid_token\");\n    }\n    const schema = zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string().email(),\n      updateTo: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n    });\n    const parsed = schema.parse(jwt.payload);\n    const user = await ctx.context.internalAdapter.findUserByEmail(\n      parsed.email\n    );\n    if (!user) {\n      return redirectOnError(\"user_not_found\");\n    }\n    if (parsed.updateTo) {\n      const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n      if (!session) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      if (session.user.email !== parsed.email) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      const updatedUser2 = await ctx.context.internalAdapter.updateUserByEmail(\n        parsed.email,\n        {\n          email: parsed.updateTo,\n          emailVerified: false\n        },\n        ctx\n      );\n      const newToken = await createEmailVerificationToken(\n        ctx.context.secret,\n        parsed.updateTo\n      );\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: updatedUser2,\n          url: `${ctx.context.baseURL}/verify-email?token=${newToken}&callbackURL=${ctx.query.callbackURL || \"/\"}`,\n          token: newToken\n        },\n        ctx.request\n      );\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n        session: session.session,\n        user: {\n          ...session.user,\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      });\n      if (ctx.query.callbackURL) {\n        throw ctx.redirect(ctx.query.callbackURL);\n      }\n      return ctx.json({\n        status: true,\n        user: {\n          id: updatedUser2.id,\n          email: updatedUser2.email,\n          name: updatedUser2.name,\n          image: updatedUser2.image,\n          emailVerified: updatedUser2.emailVerified,\n          createdAt: updatedUser2.createdAt,\n          updatedAt: updatedUser2.updatedAt\n        }\n      });\n    }\n    if (ctx.context.options.emailVerification?.onEmailVerification) {\n      await ctx.context.options.emailVerification.onEmailVerification(\n        user.user,\n        ctx.request\n      );\n    }\n    const updatedUser = await ctx.context.internalAdapter.updateUserByEmail(\n      parsed.email,\n      {\n        emailVerified: true\n      },\n      ctx\n    );\n    if (ctx.context.options.emailVerification?.afterEmailVerification) {\n      await ctx.context.options.emailVerification.afterEmailVerification(\n        updatedUser,\n        ctx.request\n      );\n    }\n    if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n      const currentSession = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n      if (!currentSession || currentSession.user.email !== parsed.email) {\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx\n        );\n        if (!session) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n            message: \"Failed to create session\"\n          });\n        }\n        await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n          session,\n          user: {\n            ...user.user,\n            emailVerified: true\n          }\n        });\n      } else {\n        await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n          session: currentSession.session,\n          user: {\n            ...currentSession.user,\n            emailVerified: true\n          }\n        });\n      }\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL);\n    }\n    return ctx.json({\n      status: true,\n      user: null\n    });\n  }\n);\n\nconst HIDE_METADATA = {\n  isAction: false\n};\n\nasync function generateState(c, link) {\n  const callbackURL = c.body?.callbackURL || c.context.options.baseURL;\n  if (!callbackURL) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"callbackURL is required\"\n    });\n  }\n  const codeVerifier = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__.g)(128);\n  const state = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__.g)(32);\n  const stateCookie = c.context.createAuthCookie(\"state\", {\n    maxAge: 5 * 60 * 1e3\n    // 5 minutes\n  });\n  await c.setSignedCookie(\n    stateCookie.name,\n    state,\n    c.context.secret,\n    stateCookie.attributes\n  );\n  const data = JSON.stringify({\n    callbackURL,\n    codeVerifier,\n    errorURL: c.body?.errorCallbackURL,\n    newUserURL: c.body?.newUserCallbackURL,\n    link,\n    /**\n     * This is the actual expiry time of the state\n     */\n    expiresAt: Date.now() + 10 * 60 * 1e3,\n    requestSignUp: c.body?.requestSignUp\n  });\n  const expiresAt = /* @__PURE__ */ new Date();\n  expiresAt.setMinutes(expiresAt.getMinutes() + 10);\n  const verification = await c.context.internalAdapter.createVerificationValue(\n    {\n      value: data,\n      identifier: state,\n      expiresAt\n    },\n    c\n  );\n  if (!verification) {\n    c.context.logger.error(\n      \"Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database\"\n    );\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"Unable to create verification\"\n    });\n  }\n  return {\n    state: verification.identifier,\n    codeVerifier\n  };\n}\nasync function parseState(c) {\n  const state = c.query.state || c.body.state;\n  const data = await c.context.internalAdapter.findVerificationValue(state);\n  if (!data) {\n    c.context.logger.error(\"State Mismatch. Verification not found\", {\n      state\n    });\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=please_restart_the_process`);\n  }\n  const parsedData = zod__WEBPACK_IMPORTED_MODULE_23__.object({\n    callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n    codeVerifier: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n    errorURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n    newUserURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n    expiresAt: zod__WEBPACK_IMPORTED_MODULE_23__.number(),\n    link: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_23__.coerce.string()\n    }).optional(),\n    requestSignUp: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().optional()\n  }).parse(JSON.parse(data.value));\n  if (!parsedData.errorURL) {\n    parsedData.errorURL = `${c.context.baseURL}/error`;\n  }\n  const stateCookie = c.context.createAuthCookie(\"state\");\n  const stateCookieValue = await c.getSignedCookie(\n    stateCookie.name,\n    c.context.secret\n  );\n  const skipStateCookieCheck = c.context.oauthConfig?.skipStateCookieCheck;\n  if (!skipStateCookieCheck && (!stateCookieValue || stateCookieValue !== state)) {\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=state_mismatch`);\n  }\n  c.setCookie(stateCookie.name, \"\", {\n    maxAge: 0\n  });\n  if (parsedData.expiresAt < Date.now()) {\n    await c.context.internalAdapter.deleteVerificationValue(data.id);\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=please_restart_the_process`);\n  }\n  await c.context.internalAdapter.deleteVerificationValue(data.id);\n  return parsedData;\n}\n\nfunction decryptOAuthToken(token, ctx) {\n  if (!token) return token;\n  if (ctx.options.account?.encryptOAuthTokens) {\n    return (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__.symmetricDecrypt)({\n      key: ctx.secret,\n      data: token\n    });\n  }\n  return token;\n}\nfunction setTokenUtil(token, ctx) {\n  if (ctx.options.account?.encryptOAuthTokens && token) {\n    return (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__.symmetricEncrypt)({\n      key: ctx.secret,\n      data: token\n    });\n  }\n  return token;\n}\n\nasync function handleOAuthUserInfo(c, {\n  userInfo,\n  account,\n  callbackURL,\n  disableSignUp,\n  overrideUserInfo\n}) {\n  const dbUser = await c.context.internalAdapter.findOAuthUser(\n    userInfo.email.toLowerCase(),\n    account.accountId,\n    account.providerId\n  ).catch((e) => {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.error(\n      \"Better auth was unable to query your database.\\nError: \",\n      e\n    );\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=internal_server_error`);\n  });\n  let user = dbUser?.user;\n  let isRegister = !user;\n  if (dbUser) {\n    const hasBeenLinked = dbUser.accounts.find(\n      (a) => a.providerId === account.providerId && a.accountId === account.accountId\n    );\n    if (!hasBeenLinked) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        account.providerId\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.isDevelopment)()) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.warn(\n            `User already exist but account isn't linked to ${account.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`\n          );\n        }\n        return {\n          error: \"account not linked\",\n          data: null\n        };\n      }\n      try {\n        await c.context.internalAdapter.linkAccount(\n          {\n            providerId: account.providerId,\n            accountId: userInfo.id.toString(),\n            userId: dbUser.user.id,\n            accessToken: await setTokenUtil(account.accessToken, c.context),\n            refreshToken: await setTokenUtil(account.refreshToken, c.context),\n            idToken: account.idToken,\n            accessTokenExpiresAt: account.accessTokenExpiresAt,\n            refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n            scope: account.scope\n          },\n          c\n        );\n      } catch (e) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.error(\"Unable to link account\", e);\n        return {\n          error: \"unable to link account\",\n          data: null\n        };\n      }\n      if (userInfo.emailVerified && !dbUser.user.emailVerified && userInfo.email.toLowerCase() === dbUser.user.email) {\n        await c.context.internalAdapter.updateUser(dbUser.user.id, {\n          emailVerified: true\n        });\n      }\n    } else {\n      if (c.context.options.account?.updateAccountOnSignIn !== false) {\n        const updateData = Object.fromEntries(\n          Object.entries({\n            idToken: account.idToken,\n            accessToken: await setTokenUtil(account.accessToken, c.context),\n            refreshToken: await setTokenUtil(account.refreshToken, c.context),\n            accessTokenExpiresAt: account.accessTokenExpiresAt,\n            refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n            scope: account.scope\n          }).filter(([_, value]) => value !== void 0)\n        );\n        if (Object.keys(updateData).length > 0) {\n          await c.context.internalAdapter.updateAccount(\n            hasBeenLinked.id,\n            updateData,\n            c\n          );\n        }\n      }\n      if (userInfo.emailVerified && !dbUser.user.emailVerified && userInfo.email.toLowerCase() === dbUser.user.email) {\n        await c.context.internalAdapter.updateUser(dbUser.user.id, {\n          emailVerified: true\n        });\n      }\n    }\n    if (overrideUserInfo) {\n      const { id: _, ...restUserInfo } = userInfo;\n      await c.context.internalAdapter.updateUser(dbUser.user.id, {\n        ...restUserInfo,\n        email: userInfo.email.toLowerCase(),\n        emailVerified: userInfo.email.toLowerCase() === dbUser.user.email ? dbUser.user.emailVerified || userInfo.emailVerified : userInfo.emailVerified\n      });\n    }\n  } else {\n    if (disableSignUp) {\n      return {\n        error: \"signup disabled\",\n        data: null,\n        isRegister: false\n      };\n    }\n    try {\n      const { id: _, ...restUserInfo } = userInfo;\n      user = await c.context.internalAdapter.createOAuthUser(\n        {\n          ...restUserInfo,\n          email: userInfo.email.toLowerCase()\n        },\n        {\n          accessToken: await setTokenUtil(account.accessToken, c.context),\n          refreshToken: await setTokenUtil(account.refreshToken, c.context),\n          idToken: account.idToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope,\n          providerId: account.providerId,\n          accountId: userInfo.id.toString()\n        },\n        c\n      ).then((res) => res?.user);\n      if (!userInfo.emailVerified && user && c.context.options.emailVerification?.sendOnSignUp) {\n        const token = await createEmailVerificationToken(\n          c.context.secret,\n          user.email,\n          void 0,\n          c.context.options.emailVerification?.expiresIn\n        );\n        const url = `${c.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n        await c.context.options.emailVerification?.sendVerificationEmail?.(\n          {\n            user,\n            url,\n            token\n          },\n          c.request\n        );\n      }\n    } catch (e) {\n      _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.error(e);\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError) {\n        return {\n          error: e.message,\n          data: null,\n          isRegister: false\n        };\n      }\n      return {\n        error: \"unable to create user\",\n        data: null,\n        isRegister: false\n      };\n    }\n  }\n  if (!user) {\n    return {\n      error: \"unable to create user\",\n      data: null,\n      isRegister: false\n    };\n  }\n  const session = await c.context.internalAdapter.createSession(user.id, c);\n  if (!session) {\n    return {\n      error: \"unable to create session\",\n      data: null,\n      isRegister: false\n    };\n  }\n  return {\n    data: {\n      session,\n      user\n    },\n    error: null,\n    isRegister\n  };\n}\n\nconst signInSocial = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/sign-in/social\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * Callback URL to redirect to after the user\n       * has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Callback URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * callback url to redirect if the user is newly registered.\n       *\n       * useful if you have different routes for existing users and new users\n       */\n      newUserCallbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n      /**\n       * Callback url to redirect to if an error happens\n       *\n       * If it's initiated from the client sdk this defaults to\n       * the current url.\n       */\n      errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Callback URL to redirect to if an error happens\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_5__.SocialProviderListEnum,\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional(),\n      /**\n       * ID token from the provider\n       *\n       * This is used to sign in the user\n       * if the user is already signed in with the\n       * provider in the frontend.\n       *\n       * Only applicable if the provider supports\n       * it. Currently only `apple` and `google` is\n       * supported out of the box.\n       */\n      idToken: zod__WEBPACK_IMPORTED_MODULE_23__.optional(\n        zod__WEBPACK_IMPORTED_MODULE_23__.object({\n          /**\n           * ID token from the provider\n           */\n          token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"ID token from the provider\"\n          }),\n          /**\n           * The nonce used to generate the token\n           */\n          nonce: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"Nonce used to generate the token\"\n          }).optional(),\n          /**\n           * Access token from the provider\n           */\n          accessToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"Access token from the provider\"\n          }).optional(),\n          /**\n           * Refresh token from the provider\n           */\n          refreshToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"Refresh token from the provider\"\n          }).optional(),\n          /**\n           * Expiry date of the token\n           */\n          expiresAt: zod__WEBPACK_IMPORTED_MODULE_23__.number().meta({\n            description: \"Expiry date of the token\"\n          }).optional()\n        })\n      ),\n      scopes: zod__WEBPACK_IMPORTED_MODULE_23__.array(zod__WEBPACK_IMPORTED_MODULE_23__.string()).meta({\n        description: \"Array of scopes to request from the provider. This will override the default scopes passed.\"\n      }).optional(),\n      /**\n       * Explicitly request sign-up\n       *\n       * Should be used to allow sign up when\n       * disableImplicitSignUp for this provider is\n       * true\n       */\n      requestSignUp: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider\"\n      }).optional(),\n      /**\n       * The login hint to use for the authorization code request\n       */\n      loginHint: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The login hint to use for the authorization code request\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with a social provider\",\n        operationId: \"socialSignIn\",\n        responses: {\n          \"200\": {\n            description: \"Success - Returns either session details or redirect URL\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  // todo: we need support for multiple schema\n                  type: \"object\",\n                  description: \"Session response when idToken is provided\",\n                  properties: {\n                    redirect: {\n                      type: \"boolean\",\n                      enum: [false]\n                    },\n                    token: {\n                      type: \"string\",\n                      description: \"Session token\",\n                      url: {\n                        type: \"null\",\n                        nullable: true\n                      },\n                      user: {\n                        type: \"object\",\n                        properties: {\n                          id: { type: \"string\" },\n                          email: { type: \"string\" },\n                          name: {\n                            type: \"string\",\n                            nullable: true\n                          },\n                          image: {\n                            type: \"string\",\n                            nullable: true\n                          },\n                          emailVerified: {\n                            type: \"boolean\"\n                          },\n                          createdAt: {\n                            type: \"string\",\n                            format: \"date-time\"\n                          },\n                          updatedAt: {\n                            type: \"string\",\n                            format: \"date-time\"\n                          }\n                        },\n                        required: [\n                          \"id\",\n                          \"email\",\n                          \"emailVerified\",\n                          \"createdAt\",\n                          \"updatedAt\"\n                        ]\n                      }\n                    }\n                  },\n                  required: [\"redirect\", \"token\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n        });\n      }\n      const userInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!userInfo || !userInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n        });\n      }\n      if (!userInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const data = await handleOAuthUserInfo(c, {\n        userInfo: {\n          ...userInfo.user,\n          email: userInfo.user.email,\n          id: String(userInfo.user.id),\n          name: userInfo.user.name || \"\",\n          image: userInfo.user.image,\n          emailVerified: userInfo.user.emailVerified || false\n        },\n        account: {\n          providerId: provider.id,\n          accountId: String(userInfo.user.id),\n          accessToken: c.body.idToken.accessToken\n        },\n        callbackURL: c.body.callbackURL,\n        disableSignUp: provider.disableImplicitSignUp && !c.body.requestSignUp || provider.disableSignUp\n      });\n      if (data.error) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: data.error\n        });\n      }\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(c, data.data);\n      return c.json({\n        redirect: false,\n        token: data.data.session.token,\n        url: void 0,\n        user: {\n          id: data.data.user.id,\n          email: data.data.user.email,\n          name: data.data.user.name,\n          image: data.data.user.image,\n          emailVerified: data.data.user.emailVerified,\n          createdAt: data.data.user.createdAt,\n          updatedAt: data.data.user.updatedAt\n        }\n      });\n    }\n    const { codeVerifier, state } = await generateState(c);\n    const url = await provider.createAuthorizationURL({\n      state,\n      codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n      scopes: c.body.scopes,\n      loginHint: c.body.loginHint\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nconst signInEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/sign-in/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * Email of the user\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Email of the user\"\n      }),\n      /**\n       * Password of the user\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Password of the user\"\n      }),\n      /**\n       * Callback URL to use as a redirect for email\n       * verification and for possible redirects\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Callback URL to use as a redirect for email verification\"\n      }).optional(),\n      /**\n       * If this is false, the session will not be remembered\n       * @default true\n       */\n      rememberMe: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"If this is false, the session will not be remembered. Default is `true`.\"\n      }).default(true).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with email and password\",\n        responses: {\n          \"200\": {\n            description: \"Success - Returns either session details or redirect URL\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  // todo: we need support for multiple schema\n                  type: \"object\",\n                  description: \"Session response when idToken is provided\",\n                  properties: {\n                    redirect: {\n                      type: \"boolean\",\n                      enum: [false]\n                    },\n                    token: {\n                      type: \"string\",\n                      description: \"Session token\"\n                    },\n                    url: {\n                      type: \"null\",\n                      nullable: true\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: { type: \"string\" },\n                        email: { type: \"string\" },\n                        name: {\n                          type: \"string\",\n                          nullable: true\n                        },\n                        image: {\n                          type: \"string\",\n                          nullable: true\n                        },\n                        emailVerified: {\n                          type: \"boolean\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"redirect\", \"token\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options?.emailAndPassword?.enabled) {\n      ctx.context.logger.error(\n        \"Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password is not enabled\"\n      });\n    }\n    const { email, password } = ctx.body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_23__.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      await ctx.context.password.hash(password);\n      ctx.context.logger.error(\"User not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const credentialAccount = user.accounts.find(\n      (a) => a.providerId === \"credential\"\n    );\n    if (!credentialAccount) {\n      ctx.context.logger.error(\"Credential account not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const currentPassword = credentialAccount?.password;\n    if (!currentPassword) {\n      ctx.context.logger.error(\"Password not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const validPassword = await ctx.context.password.verify({\n      hash: currentPassword,\n      password\n    });\n    if (!validPassword) {\n      ctx.context.logger.error(\"Invalid password\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    if (ctx.context.options?.emailAndPassword?.requireEmailVerification && !user.user.emailVerified) {\n      if (!ctx.context.options?.emailVerification?.sendVerificationEmail) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n        });\n      }\n      if (ctx.context.options?.emailVerification?.sendOnSignIn) {\n        const token = await createEmailVerificationToken(\n          ctx.context.secret,\n          user.user.email,\n          void 0,\n          ctx.context.options.emailVerification?.expiresIn\n        );\n        const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n        await ctx.context.options.emailVerification.sendVerificationEmail(\n          {\n            user: user.user,\n            url,\n            token\n          },\n          ctx.request\n        );\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      user.user.id,\n      ctx,\n      ctx.body.rememberMe === false\n    );\n    if (!session) {\n      ctx.context.logger.error(\"Failed to create session\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(\n      ctx,\n      {\n        session,\n        user: user.user\n      },\n      ctx.body.rememberMe === false\n    );\n    return ctx.json({\n      redirect: !!ctx.body.callbackURL,\n      token: session.token,\n      url: ctx.body.callbackURL,\n      user: {\n        id: user.user.id,\n        email: user.user.email,\n        name: user.user.name,\n        image: user.user.image,\n        emailVerified: user.user.emailVerified,\n        createdAt: user.user.createdAt,\n        updatedAt: user.user.updatedAt\n      }\n    });\n  }\n);\n\nconst schema = zod__WEBPACK_IMPORTED_MODULE_23__.object({\n  code: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  error: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  device_id: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  error_description: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  state: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  user: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n});\nconst callbackOAuth = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/callback/:id\",\n  {\n    method: [\"GET\", \"POST\"],\n    body: schema.optional(),\n    query: schema.optional(),\n    metadata: HIDE_METADATA\n  },\n  async (c) => {\n    let queryOrBody;\n    const defaultErrorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    try {\n      if (c.method === \"GET\") {\n        queryOrBody = schema.parse(c.query);\n      } else if (c.method === \"POST\") {\n        queryOrBody = schema.parse(c.body);\n      } else {\n        throw new Error(\"Unsupported method\");\n      }\n    } catch (e) {\n      c.context.logger.error(\"INVALID_CALLBACK_REQUEST\", e);\n      throw c.redirect(`${defaultErrorURL}?error=invalid_callback_request`);\n    }\n    const { code, error, state, error_description, device_id } = queryOrBody;\n    if (!state) {\n      c.context.logger.error(\"State not found\", error);\n      const sep = defaultErrorURL.includes(\"?\") ? \"&\" : \"?\";\n      const url = `${defaultErrorURL}${sep}state=state_not_found`;\n      throw c.redirect(url);\n    }\n    const {\n      codeVerifier,\n      callbackURL,\n      link,\n      errorURL,\n      newUserURL,\n      requestSignUp\n    } = await parseState(c);\n    function redirectOnError(error2, description) {\n      const baseURL = errorURL ?? defaultErrorURL;\n      const params = new URLSearchParams({ error: error2 });\n      if (description) params.set(\"error_description\", description);\n      const sep = baseURL.includes(\"?\") ? \"&\" : \"?\";\n      const url = `${baseURL}${sep}${params.toString()}`;\n      throw c.redirect(url);\n    }\n    if (error) {\n      redirectOnError(error, error_description);\n    }\n    if (!code) {\n      c.context.logger.error(\"Code not found\");\n      throw redirectOnError(\"no_code\");\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.params.id\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Oauth provider with id\",\n        c.params.id,\n        \"not found\"\n      );\n      throw redirectOnError(\"oauth_provider_not_found\");\n    }\n    let tokens;\n    try {\n      tokens = await provider.validateAuthorizationCode({\n        code,\n        codeVerifier,\n        deviceId: device_id,\n        redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n      });\n    } catch (e) {\n      c.context.logger.error(\"\", e);\n      throw redirectOnError(\"invalid_code\");\n    }\n    const userInfo = await provider.getUserInfo({\n      ...tokens,\n      user: c.body?.user ? (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_6__.s)(c.body.user) : void 0\n    }).then((res) => res?.user);\n    if (!userInfo) {\n      c.context.logger.error(\"Unable to get user info\");\n      return redirectOnError(\"unable_to_get_user_info\");\n    }\n    if (!callbackURL) {\n      c.context.logger.error(\"No callback URL found\");\n      throw redirectOnError(\"no_callback_url\");\n    }\n    if (link) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        provider.id\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        c.context.logger.error(\"Unable to link account - untrusted provider\");\n        return redirectOnError(\"unable_to_link_account\");\n      }\n      if (userInfo.email !== link.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) {\n        return redirectOnError(\"email_doesn't_match\");\n      }\n      const existingAccount = await c.context.internalAdapter.findAccount(\n        String(userInfo.id)\n      );\n      if (existingAccount) {\n        if (existingAccount.userId.toString() !== link.userId.toString()) {\n          return redirectOnError(\"account_already_linked_to_different_user\");\n        }\n        const updateData = Object.fromEntries(\n          Object.entries({\n            accessToken: await setTokenUtil(tokens.accessToken, c.context),\n            refreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n            idToken: tokens.idToken,\n            accessTokenExpiresAt: tokens.accessTokenExpiresAt,\n            refreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n            scope: tokens.scopes?.join(\",\")\n          }).filter(([_, value]) => value !== void 0)\n        );\n        await c.context.internalAdapter.updateAccount(\n          existingAccount.id,\n          updateData\n        );\n      } else {\n        const newAccount = await c.context.internalAdapter.createAccount(\n          {\n            userId: link.userId,\n            providerId: provider.id,\n            accountId: String(userInfo.id),\n            ...tokens,\n            accessToken: await setTokenUtil(tokens.accessToken, c.context),\n            refreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n            scope: tokens.scopes?.join(\",\")\n          },\n          c\n        );\n        if (!newAccount) {\n          return redirectOnError(\"unable_to_link_account\");\n        }\n      }\n      let toRedirectTo2;\n      try {\n        const url = callbackURL;\n        toRedirectTo2 = url.toString();\n      } catch {\n        toRedirectTo2 = callbackURL;\n      }\n      throw c.redirect(toRedirectTo2);\n    }\n    if (!userInfo.email) {\n      c.context.logger.error(\n        \"Provider did not return email. This could be due to misconfiguration in the provider settings.\"\n      );\n      return redirectOnError(\"email_not_found\");\n    }\n    const result = await handleOAuthUserInfo(c, {\n      userInfo: {\n        ...userInfo,\n        id: String(userInfo.id),\n        email: userInfo.email,\n        name: userInfo.name || userInfo.email\n      },\n      account: {\n        providerId: provider.id,\n        accountId: String(userInfo.id),\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      },\n      callbackURL,\n      disableSignUp: provider.disableImplicitSignUp && !requestSignUp || provider.options?.disableSignUp,\n      overrideUserInfo: provider.options?.overrideUserInfoOnSignIn\n    });\n    if (result.error) {\n      c.context.logger.error(result.error.split(\" \").join(\"_\"));\n      return redirectOnError(result.error.split(\" \").join(\"_\"));\n    }\n    const { session, user } = result.data;\n    await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(c, {\n      session,\n      user\n    });\n    let toRedirectTo;\n    try {\n      const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n      toRedirectTo = url.toString();\n    } catch {\n      toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n    }\n    throw c.redirect(toRedirectTo);\n  }\n);\n\nconst signOut = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/sign-out\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Sign out the current user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessionCookieToken = await ctx.getSignedCookie(\n      ctx.context.authCookies.sessionToken.name,\n      ctx.context.secret\n    );\n    if (!sessionCookieToken) {\n      (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n    await ctx.context.internalAdapter.deleteSession(sessionCookieToken);\n    (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n    return ctx.json({\n      success: true\n    });\n  }\n);\n\nfunction redirectError(ctx, callbackURL, query) {\n  const url = callbackURL ? new URL(callbackURL, ctx.baseURL) : new URL(`${ctx.baseURL}/error`);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nfunction redirectCallback(ctx, callbackURL, query) {\n  const url = new URL(callbackURL, ctx.baseURL);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nconst requestPasswordReset = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/request-password-reset\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.email().meta({\n        description: \"The email address of the user to send a password reset email to\"\n      }),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    },\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json({\n        status: true,\n        message: \"If this email exists in our system, check your email for the reset link\"\n      });\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_8__.g)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_9__.g)(24);\n    await ctx.context.internalAdapter.createVerificationValue(\n      {\n        value: user.user.id,\n        identifier: `reset-password:${verificationToken}`,\n        expiresAt\n      },\n      ctx\n    );\n    const callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true,\n      message: \"If this email exists in our system, check your email for the reset link\"\n    });\n  }\n);\nconst forgetPassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/forget-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string().email().meta({\n        description: \"The email address of the user to send a password reset email to\"\n      }),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    },\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json({\n        status: true,\n        message: \"If this email exists in our system, check your email for the reset link\"\n      });\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_8__.g)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_9__.g)(24);\n    await ctx.context.internalAdapter.createVerificationValue(\n      {\n        value: user.user.id,\n        identifier: `reset-password:${verificationToken}`,\n        expiresAt\n      },\n      ctx\n    );\n    const callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst requestPasswordResetCallback = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/reset-password/:token\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect the user to reset their password\"\n      })\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Redirects the user to the callback URL with the token\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { token } = ctx.params;\n    const { callbackURL } = ctx.query;\n    if (!token || !callbackURL) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    const verification = await ctx.context.internalAdapter.findVerificationValue(\n      `reset-password:${token}`\n    );\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    throw ctx.redirect(redirectCallback(ctx.context, callbackURL, { token }));\n  }\n);\nconst forgetPasswordCallback = requestPasswordResetCallback;\nconst resetPassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/reset-password\",\n  {\n    method: \"POST\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n    }).optional(),\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The new password to set\"\n      }),\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to reset the password\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Reset the password for a user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token || ctx.query?.token;\n    if (!token) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const { newPassword } = ctx.body;\n    const minLength = ctx.context.password?.config.minPasswordLength;\n    const maxLength = ctx.context.password?.config.maxPasswordLength;\n    if (newPassword.length < minLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    if (newPassword.length > maxLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const id = `reset-password:${token}`;\n    const verification = await ctx.context.internalAdapter.findVerificationValue(id);\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const userId = verification.value;\n    const hashedPassword = await ctx.context.password.hash(newPassword);\n    const accounts = await ctx.context.internalAdapter.findAccounts(userId);\n    const account = accounts.find((ac) => ac.providerId === \"credential\");\n    if (!account) {\n      await ctx.context.internalAdapter.createAccount(\n        {\n          userId,\n          providerId: \"credential\",\n          password: hashedPassword,\n          accountId: userId\n        },\n        ctx\n      );\n    } else {\n      await ctx.context.internalAdapter.updatePassword(\n        userId,\n        hashedPassword,\n        ctx\n      );\n    }\n    await ctx.context.internalAdapter.deleteVerificationValue(verification.id);\n    if (ctx.context.options.emailAndPassword?.onPasswordReset) {\n      const user = await ctx.context.internalAdapter.findUserById(userId);\n      if (user) {\n        await ctx.context.options.emailAndPassword.onPasswordReset(\n          {\n            user\n          },\n          ctx.request\n        );\n      }\n    }\n    if (ctx.context.options.emailAndPassword?.revokeSessionsOnPasswordReset) {\n      await ctx.context.internalAdapter.deleteSessions(userId);\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\nconst updateUser = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/update-user\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.record(\n      zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Field name must be a string\"\n      }),\n      zod__WEBPACK_IMPORTED_MODULE_23__.any()\n    ),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Update the current user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The image of the user\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the update was successful\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const body = ctx.body;\n    if (body.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.EMAIL_CAN_NOT_BE_UPDATED\n      });\n    }\n    const { name, image, ...rest } = body;\n    const session = ctx.context.session;\n    const additionalFields = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_14__.d)(\n      ctx.context.options,\n      rest,\n      \"update\"\n    );\n    if (image === void 0 && name === void 0 && Object.keys(additionalFields).length === 0) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"No fields to update\"\n      });\n    }\n    const user = await ctx.context.internalAdapter.updateUser(\n      session.user.id,\n      {\n        name,\n        image,\n        ...additionalFields\n      },\n      ctx\n    );\n    await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n      session: session.session,\n      user\n    });\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst changePassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/change-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The new password to set\"\n      }),\n      /**\n       * The current password of the user\n       */\n      currentPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The current password is required\"\n      }),\n      /**\n       * revoke all sessions that are not the\n       * current one logged in by the user\n       */\n      revokeOtherSessions: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Must be a boolean value\"\n      }).optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e],\n    metadata: {\n      openapi: {\n        description: \"Change the password of the user\",\n        responses: {\n          \"200\": {\n            description: \"Password successfully changed\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\",\n                      nullable: true,\n                      // Only present if revokeOtherSessions is true\n                      description: \"New session token if other sessions were revoked\"\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"The unique identifier of the user\"\n                        },\n                        email: {\n                          type: \"string\",\n                          format: \"email\",\n                          description: \"The email address of the user\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"The name of the user\"\n                        },\n                        image: {\n                          type: \"string\",\n                          format: \"uri\",\n                          nullable: true,\n                          description: \"The profile image URL of the user\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Whether the email has been verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was created\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was last updated\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { newPassword, currentPassword, revokeOtherSessions } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    if (!account || !account.password) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n      });\n    }\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    const verify = await ctx.context.password.verify({\n      hash: account.password,\n      password: currentPassword\n    });\n    if (!verify) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_PASSWORD\n      });\n    }\n    await ctx.context.internalAdapter.updateAccount(account.id, {\n      password: passwordHash\n    });\n    let token = null;\n    if (revokeOtherSessions) {\n      await ctx.context.internalAdapter.deleteSessions(session.user.id);\n      const newSession = await ctx.context.internalAdapter.createSession(\n        session.user.id,\n        ctx\n      );\n      if (!newSession) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n        });\n      }\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n        session: newSession,\n        user: session.user\n      });\n      token = newSession.token;\n    }\n    return ctx.json({\n      token,\n      user: {\n        id: session.user.id,\n        email: session.user.email,\n        name: session.user.name,\n        image: session.user.image,\n        emailVerified: session.user.emailVerified,\n        createdAt: session.user.createdAt,\n        updatedAt: session.user.updatedAt\n      }\n    });\n  }\n);\nconst setPassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/set-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The new password to set is required\"\n      })\n    }),\n    metadata: {\n      SERVER_ONLY: true\n    },\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e]\n  },\n  async (ctx) => {\n    const { newPassword } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    if (!account) {\n      await ctx.context.internalAdapter.linkAccount(\n        {\n          userId: session.user.id,\n          providerId: \"credential\",\n          accountId: session.user.id,\n          password: passwordHash\n        },\n        ctx\n      );\n      return ctx.json({\n        status: true\n      });\n    }\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"user already has a password\"\n    });\n  }\n);\nconst deleteUser = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/delete-user\",\n  {\n    method: \"POST\",\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e],\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The callback URL to redirect to after the user is deleted\n       * this is only used on delete user callback\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The callback URL to redirect to after the user is deleted\"\n      }).optional(),\n      /**\n       * The password of the user. If the password isn't provided, session freshness\n       * will be checked.\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The password of the user is required to delete the user\"\n      }).optional(),\n      /**\n       * The token to delete the user. If the token is provided, the user will be deleted\n       */\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to delete the user is required\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Delete the user\",\n        responses: {\n          \"200\": {\n            description: \"User deletion processed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\",\n                      description: \"Indicates if the operation was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"User deleted\", \"Verification email sent\"],\n                      description: \"Status message of the deletion process\"\n                    }\n                  },\n                  required: [\"success\", \"message\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\");\n    }\n    const session = ctx.context.session;\n    if (ctx.body.password) {\n      const accounts = await ctx.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const account = accounts.find(\n        (account2) => account2.providerId === \"credential\" && account2.password\n      );\n      if (!account || !account.password) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n        });\n      }\n      const verify = await ctx.context.password.verify({\n        hash: account.password,\n        password: ctx.body.password\n      });\n      if (!verify) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_PASSWORD\n        });\n      }\n    }\n    if (ctx.body.token) {\n      await deleteUserCallback({\n        ...ctx,\n        query: {\n          token: ctx.body.token\n        }\n      });\n      return ctx.json({\n        success: true,\n        message: \"User deleted\"\n      });\n    }\n    if (ctx.context.options.user.deleteUser?.sendDeleteAccountVerification) {\n      const token = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__.g)(32, \"0-9\", \"a-z\");\n      await ctx.context.internalAdapter.createVerificationValue(\n        {\n          value: session.user.id,\n          identifier: `delete-account-${token}`,\n          expiresAt: new Date(\n            Date.now() + (ctx.context.options.user.deleteUser?.deleteTokenExpiresIn || 60 * 60 * 24) * 1e3\n          )\n        },\n        ctx\n      );\n      const url = `${ctx.context.baseURL}/delete-user/callback?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.user.deleteUser.sendDeleteAccountVerification(\n        {\n          user: session.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      return ctx.json({\n        success: true,\n        message: \"Verification email sent\"\n      });\n    }\n    if (!ctx.body.password && ctx.context.sessionConfig.freshAge !== 0) {\n      const currentAge = new Date(session.session.createdAt).getTime();\n      const freshAge = ctx.context.sessionConfig.freshAge * 1e3;\n      const now = Date.now();\n      if (now - currentAge > freshAge * 1e3) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.SESSION_EXPIRED\n        });\n      }\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nconst deleteUserCallback = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/delete-user/callback\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to verify the deletion request\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after deletion\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Callback to complete user deletion with verification token\",\n        responses: {\n          \"200\": {\n            description: \"User successfully deleted\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\",\n                      description: \"Indicates if the deletion was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"User deleted\"],\n                      description: \"Confirmation message\"\n                    }\n                  },\n                  required: [\"success\", \"message\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\");\n    }\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n      });\n    }\n    const token = await ctx.context.internalAdapter.findVerificationValue(\n      `delete-account-${ctx.query.token}`\n    );\n    if (!token || token.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    if (token.value !== session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n    (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL || \"/\");\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nconst changeEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/change-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      newEmail: zod__WEBPACK_IMPORTED_MODULE_23__.email().meta({\n        description: \"The new email address to set must be a valid email address\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e],\n    metadata: {\n      openapi: {\n        responses: {\n          \"200\": {\n            description: \"Email change request processed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the request was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"Email updated\", \"Verification email sent\"],\n                      description: \"Status message of the email change process\",\n                      nullable: true\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          },\n          \"422\": {\n            description: \"Unprocessable Entity. Email already exists\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.changeEmail?.enabled) {\n      ctx.context.logger.error(\"Change email is disabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Change email is disabled\"\n      });\n    }\n    const newEmail = ctx.body.newEmail.toLowerCase();\n    if (newEmail === ctx.context.session.user.email) {\n      ctx.context.logger.error(\"Email is the same\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Email is the same\"\n      });\n    }\n    const existingUser = await ctx.context.internalAdapter.findUserByEmail(newEmail);\n    if (existingUser) {\n      ctx.context.logger.error(\"Email already exists\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Couldn't update your email\"\n      });\n    }\n    if (ctx.context.session.user.emailVerified !== true) {\n      const existing = await ctx.context.internalAdapter.findUserByEmail(newEmail);\n      if (existing) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNPROCESSABLE_ENTITY\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL\n        });\n      }\n      await ctx.context.internalAdapter.updateUserByEmail(\n        ctx.context.session.user.email,\n        {\n          email: newEmail\n        },\n        ctx\n      );\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n        session: ctx.context.session.session,\n        user: {\n          ...ctx.context.session.user,\n          email: newEmail\n        }\n      });\n      if (ctx.context.options.emailVerification?.sendVerificationEmail) {\n        const token2 = await createEmailVerificationToken(\n          ctx.context.secret,\n          newEmail,\n          void 0,\n          ctx.context.options.emailVerification?.expiresIn\n        );\n        const url2 = `${ctx.context.baseURL}/verify-email?token=${token2}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n        await ctx.context.options.emailVerification.sendVerificationEmail(\n          {\n            user: {\n              ...ctx.context.session.user,\n              email: newEmail\n            },\n            url: url2,\n            token: token2\n          },\n          ctx.request\n        );\n      }\n      return ctx.json({\n        status: true\n      });\n    }\n    if (!ctx.context.options.user.changeEmail.sendChangeEmailVerification) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const token = await createEmailVerificationToken(\n      ctx.context.secret,\n      ctx.context.session.user.email,\n      newEmail,\n      ctx.context.options.emailVerification?.expiresIn\n    );\n    const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n    await ctx.context.options.user.changeEmail.sendChangeEmailVerification(\n      {\n        user: ctx.context.session.user,\n        newEmail,\n        url,\n        token\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\nfunction sanitize(input) {\n  return input.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\");\n}\nconst html = (errorCode = \"Unknown\") => `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Authentication Error</title>\n    <style>\n        :root {\n            --bg-color: #f8f9fa;\n            --text-color: #212529;\n            --accent-color: #000000;\n            --error-color: #dc3545;\n            --border-color: #e9ecef;\n        }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            line-height: 1.5;\n        }\n        .error-container {\n            background-color: #ffffff;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n            padding: 2.5rem;\n            text-align: center;\n            max-width: 90%;\n            width: 400px;\n        }\n        h1 {\n            color: var(--error-color);\n            font-size: 1.75rem;\n            margin-bottom: 1rem;\n            font-weight: 600;\n        }\n        p {\n            margin-bottom: 1.5rem;\n            color: #495057;\n        }\n        .btn {\n            background-color: var(--accent-color);\n            color: #ffffff;\n            text-decoration: none;\n            padding: 0.75rem 1.5rem;\n            border-radius: 6px;\n            transition: all 0.3s ease;\n            display: inline-block;\n            font-weight: 500;\n            border: 2px solid var(--accent-color);\n        }\n        .btn:hover {\n            background-color: #131721;\n        }\n        .error-code {\n            font-size: 0.875rem;\n            color: #6c757d;\n            margin-top: 1.5rem;\n            padding-top: 1.5rem;\n            border-top: 1px solid var(--border-color);\n        }\n        .icon {\n            font-size: 3rem;\n            margin-bottom: 1rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"error-container\">\n        <div class=\"icon\">\\u26A0\\uFE0F</div>\n        <h1>Better Auth Error</h1>\n        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>\n        <a href=\"/\" id=\"returnLink\" class=\"btn\">Return to Application</a>\n        <div class=\"error-code\">Error Code: <span id=\"errorCode\">${sanitize(\n  errorCode\n)}</span></div>\n    </div>\n</body>\n</html>`;\nconst error = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/error\",\n  {\n    method: \"GET\",\n    metadata: {\n      ...HIDE_METADATA,\n      openapi: {\n        description: \"Displays an error page\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"text/html\": {\n                schema: {\n                  type: \"string\",\n                  description: \"The HTML content of the error page\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const query = new URL(c.request?.url || \"\").searchParams.get(\"error\") || \"Unknown\";\n    return new Response(html(query), {\n      headers: {\n        \"Content-Type\": \"text/html\"\n      }\n    });\n  }\n);\n\nconst ok = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/ok\",\n  {\n    method: \"GET\",\n    metadata: {\n      ...HIDE_METADATA,\n      openapi: {\n        description: \"Check if the API is working\",\n        responses: {\n          \"200\": {\n            description: \"API is working\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    ok: {\n                      type: \"boolean\",\n                      description: \"Indicates if the API is working\"\n                    }\n                  },\n                  required: [\"ok\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    return ctx.json({\n      ok: true\n    });\n  }\n);\n\nconst listUserAccounts = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/list-accounts\",\n  {\n    method: \"GET\",\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      openapi: {\n        description: \"List all accounts linked to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      id: {\n                        type: \"string\"\n                      },\n                      providerId: {\n                        type: \"string\"\n                      },\n                      createdAt: {\n                        type: \"string\",\n                        format: \"date-time\"\n                      },\n                      updatedAt: {\n                        type: \"string\",\n                        format: \"date-time\"\n                      },\n                      accountId: {\n                        type: \"string\"\n                      },\n                      scopes: {\n                        type: \"array\",\n                        items: {\n                          type: \"string\"\n                        }\n                      }\n                    },\n                    required: [\n                      \"id\",\n                      \"providerId\",\n                      \"createdAt\",\n                      \"updatedAt\",\n                      \"accountId\",\n                      \"scopes\"\n                    ]\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const accounts = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    return c.json(\n      accounts.map((a) => ({\n        id: a.id,\n        providerId: a.providerId,\n        createdAt: a.createdAt,\n        updatedAt: a.updatedAt,\n        accountId: a.accountId,\n        scopes: a.scope?.split(\",\") || []\n      }))\n    );\n  }\n);\nconst linkSocialAccount = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/link-social\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * Callback URL to redirect to after the user has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use\n       */\n      provider: _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_5__.SocialProviderListEnum,\n      /**\n       * ID Token for direct authentication without redirect\n       */\n      idToken: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n        token: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n        nonce: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n        accessToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n        refreshToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n        scopes: zod__WEBPACK_IMPORTED_MODULE_23__.array(zod__WEBPACK_IMPORTED_MODULE_23__.string()).optional()\n      }).optional(),\n      /**\n       * Whether to allow sign up for new users\n       */\n      requestSignUp: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().optional(),\n      /**\n       * Additional scopes to request when linking the account.\n       * This is useful for requesting additional permissions when\n       * linking a social account compared to the initial authentication.\n       */\n      scopes: zod__WEBPACK_IMPORTED_MODULE_23__.array(zod__WEBPACK_IMPORTED_MODULE_23__.string()).meta({\n        description: \"Additional scopes to request from the provider\"\n      }).optional(),\n      /**\n       * The URL to redirect to if there is an error during the link process.\n       */\n      errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to if there is an error during the link process\"\n      }).optional(),\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      openapi: {\n        description: \"Link a social account to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    url: {\n                      type: \"string\",\n                      description: \"The authorization URL to redirect the user to\"\n                    },\n                    redirect: {\n                      type: \"boolean\",\n                      description: \"Indicates if the user should be redirected to the authorization URL\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n        });\n      }\n      const linkingUserInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!linkingUserInfo || !linkingUserInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n        });\n      }\n      const linkingUserId = String(linkingUserInfo.user.id);\n      if (!linkingUserInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const existingAccounts = await c.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const hasBeenLinked = existingAccounts.find(\n        (a) => a.providerId === provider.id && a.accountId === linkingUserId\n      );\n      if (hasBeenLinked) {\n        return c.json({\n          url: \"\",\n          // this is for type inference\n          status: true,\n          redirect: false\n        });\n      }\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(provider.id);\n      if (!isTrustedProvider && !linkingUserInfo.user.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: \"Account not linked - linking not allowed\"\n        });\n      }\n      if (linkingUserInfo.user.email !== session.user.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: \"Account not linked - different emails not allowed\"\n        });\n      }\n      try {\n        await c.context.internalAdapter.createAccount(\n          {\n            userId: session.user.id,\n            providerId: provider.id,\n            accountId: linkingUserId,\n            accessToken: c.body.idToken.accessToken,\n            idToken: token,\n            refreshToken: c.body.idToken.refreshToken,\n            scope: c.body.idToken.scopes?.join(\",\")\n          },\n          c\n        );\n      } catch (e) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"EXPECTATION_FAILED\", {\n          message: \"Account not linked - unable to create account\"\n        });\n      }\n      if (c.context.options.account?.accountLinking?.updateUserInfoOnLink === true) {\n        try {\n          await c.context.internalAdapter.updateUser(session.user.id, {\n            name: linkingUserInfo.user?.name,\n            image: linkingUserInfo.user?.image\n          });\n        } catch (e) {\n          console.warn(\"Could not update user - \" + e.toString());\n        }\n      }\n      return c.json({\n        url: \"\",\n        // this is for type inference\n        status: true,\n        redirect: false\n      });\n    }\n    const state = await generateState(c, {\n      userId: session.user.id,\n      email: session.user.email\n    });\n    const url = await provider.createAuthorizationURL({\n      state: state.state,\n      codeVerifier: state.codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n      scopes: c.body.scopes\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nconst unlinkAccount = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/unlink-account\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.f],\n    metadata: {\n      openapi: {\n        description: \"Unlink an account\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId } = ctx.body;\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      ctx.context.session.user.id\n    );\n    if (accounts.length === 1 && !ctx.context.options.account?.accountLinking?.allowUnlinkingAll) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_UNLINK_LAST_ACCOUNT\n      });\n    }\n    const accountExist = accounts.find(\n      (account) => accountId ? account.accountId === accountId && account.providerId === providerId : account.providerId === providerId\n    );\n    if (!accountExist) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.ACCOUNT_NOT_FOUND\n      });\n    }\n    await ctx.context.internalAdapter.deleteAccount(accountExist.id);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst getAccessToken = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/get-access-token\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The provider ID for the OAuth provider\"\n      }),\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The account ID associated with the refresh token\"\n      }).optional(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The user ID associated with the account\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Get a valid access token, doing a refresh if needed\",\n        responses: {\n          200: {\n            description: \"A Valid access token\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    tokenType: {\n                      type: \"string\"\n                    },\n                    idToken: {\n                      type: \"string\"\n                    },\n                    accessToken: {\n                      type: \"string\"\n                    },\n                    refreshToken: {\n                      type: \"string\"\n                    },\n                    accessTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    },\n                    refreshTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          400: {\n            description: \"Invalid refresh token or provider configuration\"\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId, userId } = ctx.body;\n    const req = ctx.request;\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (req && !session) {\n      throw ctx.error(\"UNAUTHORIZED\");\n    }\n    let resolvedUserId = session?.user?.id || userId;\n    if (!resolvedUserId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Either userId or session is required`\n      });\n    }\n    if (!ctx.context.socialProviders.find((p) => p.id === providerId)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} is not supported.`\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(resolvedUserId);\n    const account = accounts.find(\n      (acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId\n    );\n    if (!account) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} not found.`\n      });\n    }\n    try {\n      let newTokens = null;\n      const accessTokenExpired = account.accessTokenExpiresAt && new Date(account.accessTokenExpiresAt).getTime() - Date.now() < 5e3;\n      if (account.refreshToken && accessTokenExpired && provider.refreshAccessToken) {\n        newTokens = await provider.refreshAccessToken(\n          account.refreshToken\n        );\n        await ctx.context.internalAdapter.updateAccount(account.id, {\n          accessToken: await setTokenUtil(newTokens.accessToken, ctx.context),\n          accessTokenExpiresAt: newTokens.accessTokenExpiresAt,\n          refreshToken: await setTokenUtil(newTokens.refreshToken, ctx.context),\n          refreshTokenExpiresAt: newTokens.refreshTokenExpiresAt\n        });\n      }\n      const tokens = {\n        accessToken: await decryptOAuthToken(\n          newTokens?.accessToken ?? account.accessToken ?? \"\",\n          ctx.context\n        ),\n        accessTokenExpiresAt: newTokens?.accessTokenExpiresAt ?? account.accessTokenExpiresAt ?? void 0,\n        scopes: account.scope?.split(\",\") ?? [],\n        idToken: newTokens?.idToken ?? account.idToken ?? void 0\n      };\n      return ctx.json(tokens);\n    } catch (error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Failed to get a valid access token\",\n        cause: error\n      });\n    }\n  }\n);\nconst refreshToken = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/refresh-token\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The provider ID for the OAuth provider\"\n      }),\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The account ID associated with the refresh token\"\n      }).optional(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The user ID associated with the account\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Refresh the access token using a refresh token\",\n        responses: {\n          200: {\n            description: \"Access token refreshed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    tokenType: {\n                      type: \"string\"\n                    },\n                    idToken: {\n                      type: \"string\"\n                    },\n                    accessToken: {\n                      type: \"string\"\n                    },\n                    refreshToken: {\n                      type: \"string\"\n                    },\n                    accessTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    },\n                    refreshTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          400: {\n            description: \"Invalid refresh token or provider configuration\"\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId, userId } = ctx.body;\n    const req = ctx.request;\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (req && !session) {\n      throw ctx.error(\"UNAUTHORIZED\");\n    }\n    let resolvedUserId = session?.user?.id || userId;\n    if (!resolvedUserId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Either userId or session is required`\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(resolvedUserId);\n    const account = accounts.find(\n      (acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId\n    );\n    if (!account) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} not found.`\n      });\n    }\n    if (!provider.refreshAccessToken) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} does not support token refreshing.`\n      });\n    }\n    try {\n      const tokens = await provider.refreshAccessToken(\n        account.refreshToken\n      );\n      await ctx.context.internalAdapter.updateAccount(account.id, {\n        accessToken: await setTokenUtil(tokens.accessToken, ctx.context),\n        refreshToken: await setTokenUtil(tokens.refreshToken, ctx.context),\n        accessTokenExpiresAt: tokens.accessTokenExpiresAt,\n        refreshTokenExpiresAt: tokens.refreshTokenExpiresAt\n      });\n      return ctx.json(tokens);\n    } catch (error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Failed to refresh access token\",\n        cause: error\n      });\n    }\n  }\n);\nconst accountInfo = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/account-info\",\n  {\n    method: \"POST\",\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      openapi: {\n        description: \"Get the account info provided by the provider\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        name: {\n                          type: \"string\"\n                        },\n                        email: {\n                          type: \"string\"\n                        },\n                        image: {\n                          type: \"string\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\"\n                        }\n                      },\n                      required: [\"id\", \"emailVerified\"]\n                    },\n                    data: {\n                      type: \"object\",\n                      properties: {},\n                      additionalProperties: true\n                    }\n                  },\n                  required: [\"user\", \"data\"],\n                  additionalProperties: false\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The provider given account id for which to get the account info\"\n      })\n    })\n  },\n  async (ctx) => {\n    const account = await ctx.context.internalAdapter.findAccount(\n      ctx.body.accountId\n    );\n    if (!account || account.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === account.providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: `Provider account provider is ${account.providerId} but it is not configured`\n      });\n    }\n    const tokens = await getAccessToken({\n      ...ctx,\n      body: {\n        accountId: account.id,\n        providerId: account.providerId\n      },\n      returnHeaders: false\n    });\n    if (!tokens.accessToken) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Access token not found\"\n      });\n    }\n    const info = await provider.getUserInfo({\n      ...tokens,\n      accessToken: tokens.accessToken\n    });\n    return ctx.json(info);\n  }\n);\n\nconst defuReplaceArrays = (0,defu__WEBPACK_IMPORTED_MODULE_20__.createDefu)((obj, key, value) => {\n  if (Array.isArray(obj[key]) && Array.isArray(value)) {\n    obj[key] = value;\n    return true;\n  }\n});\nfunction toAuthEndpoints(endpoints, ctx) {\n  const api = {};\n  for (const [key, endpoint] of Object.entries(endpoints)) {\n    api[key] = async (context) => {\n      const authContext = await ctx;\n      let internalContext = {\n        ...context,\n        context: {\n          ...authContext,\n          returned: void 0,\n          responseHeaders: void 0,\n          session: null\n        },\n        path: endpoint.path,\n        headers: context?.headers ? new Headers(context?.headers) : void 0\n      };\n      const { beforeHooks, afterHooks } = getHooks(authContext);\n      const before = await runBeforeHooks(internalContext, beforeHooks);\n      if (\"context\" in before && before.context && typeof before.context === \"object\") {\n        const { headers, ...rest } = before.context;\n        if (headers) {\n          headers.forEach((value, key2) => {\n            internalContext.headers.set(key2, value);\n          });\n        }\n        internalContext = defuReplaceArrays(rest, internalContext);\n      } else if (before) {\n        return context?.asResponse ? (0,better_call__WEBPACK_IMPORTED_MODULE_1__.toResponse)(before, {\n          headers: context?.headers\n        }) : context?.returnHeaders ? {\n          headers: context?.headers,\n          response: before\n        } : before;\n      }\n      internalContext.asResponse = false;\n      internalContext.returnHeaders = true;\n      const result = await endpoint(internalContext).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError) {\n          return {\n            response: e,\n            headers: e.headers ? new Headers(e.headers) : null\n          };\n        }\n        throw e;\n      });\n      if (result && result instanceof Response) {\n        return result;\n      }\n      internalContext.context.returned = result.response;\n      internalContext.context.responseHeaders = result.headers;\n      const after = await runAfterHooks(internalContext, afterHooks);\n      if (after.response) {\n        result.response = after.response;\n      }\n      if (result.response instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError && (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.shouldPublishLog)(authContext.logger.level, \"debug\")) {\n        result.response.stack = result.response.errorStack;\n      }\n      if (result.response instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError && !context?.asResponse) {\n        throw result.response;\n      }\n      const response = context?.asResponse ? (0,better_call__WEBPACK_IMPORTED_MODULE_1__.toResponse)(result.response, {\n        headers: result.headers\n      }) : context?.returnHeaders ? {\n        headers: result.headers,\n        response: result.response\n      } : result.response;\n      return response;\n    };\n    api[key].path = endpoint.path;\n    api[key].options = endpoint.options;\n  }\n  return api;\n}\nasync function runBeforeHooks(context, hooks) {\n  let modifiedContext = {};\n  for (const hook of hooks) {\n    if (hook.matcher(context)) {\n      const result = await hook.handler({\n        ...context,\n        returnHeaders: false\n      }).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError && (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.shouldPublishLog)(context.context.logger.level, \"debug\")) {\n          e.stack = e.errorStack;\n        }\n        throw e;\n      });\n      if (result && typeof result === \"object\") {\n        if (\"context\" in result && typeof result.context === \"object\") {\n          const { headers, ...rest } = result.context;\n          if (headers instanceof Headers) {\n            if (modifiedContext.headers) {\n              headers.forEach((value, key) => {\n                modifiedContext.headers?.set(key, value);\n              });\n            } else {\n              modifiedContext.headers = headers;\n            }\n          }\n          modifiedContext = defuReplaceArrays(rest, modifiedContext);\n          continue;\n        }\n        return result;\n      }\n    }\n  }\n  return { context: modifiedContext };\n}\nasync function runAfterHooks(context, hooks) {\n  for (const hook of hooks) {\n    if (hook.matcher(context)) {\n      const result = await hook.handler(context).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError) {\n          if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.shouldPublishLog)(context.context.logger.level, \"debug\")) {\n            e.stack = e.errorStack;\n          }\n          return {\n            response: e,\n            headers: e.headers ? new Headers(e.headers) : null\n          };\n        }\n        throw e;\n      });\n      if (result.headers) {\n        result.headers.forEach((value, key) => {\n          if (!context.context.responseHeaders) {\n            context.context.responseHeaders = new Headers({\n              [key]: value\n            });\n          } else {\n            if (key.toLowerCase() === \"set-cookie\") {\n              context.context.responseHeaders.append(key, value);\n            } else {\n              context.context.responseHeaders.set(key, value);\n            }\n          }\n        });\n      }\n      if (result.response) {\n        context.context.returned = result.response;\n      }\n    }\n  }\n  return {\n    response: context.context.returned,\n    headers: context.context.responseHeaders\n  };\n}\nfunction getHooks(authContext) {\n  const plugins = authContext.options.plugins || [];\n  const beforeHooks = [];\n  const afterHooks = [];\n  if (authContext.options.hooks?.before) {\n    beforeHooks.push({\n      matcher: () => true,\n      handler: authContext.options.hooks.before\n    });\n  }\n  if (authContext.options.hooks?.after) {\n    afterHooks.push({\n      matcher: () => true,\n      handler: authContext.options.hooks.after\n    });\n  }\n  const pluginBeforeHooks = plugins.map((plugin) => {\n    if (plugin.hooks?.before) {\n      return plugin.hooks.before;\n    }\n  }).filter((plugin) => plugin !== void 0).flat();\n  const pluginAfterHooks = plugins.map((plugin) => {\n    if (plugin.hooks?.after) {\n      return plugin.hooks.after;\n    }\n  }).filter((plugin) => plugin !== void 0).flat();\n  pluginBeforeHooks.length && beforeHooks.push(...pluginBeforeHooks);\n  pluginAfterHooks.length && afterHooks.push(...pluginAfterHooks);\n  return {\n    beforeHooks,\n    afterHooks\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQlg5VUI4RVAubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBeUI7QUFDb0U7QUFDMUM7QUFDcUM7QUFDckQ7QUFDd0I7QUFDaUI7QUFDWjtBQUMwRjtBQUNoRztBQUNHO0FBQzVCO0FBQ0M7QUFDRDtBQUNFO0FBQ0Y7QUFDQTtBQUNEO0FBQ0E7QUFDdUM7QUFDTjtBQUNlO0FBQy9DO0FBQ0U7QUFDTDtBQUNkO0FBQ3NCO0FBQ0o7QUFDZ0Q7QUFDVTtBQUNuRDs7QUFFekM7QUFDQSxpTEFBaUwsZ0JBQWdCO0FBQ2pNLGdCQUFnQixLQUFLO0FBQ3JCLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGdCQUFnQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Qsd0JBQXdCO0FBQ3hFLGlCQUFpQix5QkFBeUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsaUJBQWlCO0FBQ2hELHdCQUF3QixpQkFBaUI7QUFDekMsTUFBTTtBQUNOLHNCQUFzQixpQkFBaUI7QUFDdkM7QUFDQTtBQUNBLHlDQUF5QyxpQkFBaUI7QUFDMUQseUNBQXlDLGlCQUFpQjtBQUMxRDtBQUNBO0FBQ0Esa0JBQWtCLHFCQUFxQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFNBQVMsSUFBSSxpQkFBaUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG9CQUFvQjtBQUN4QztBQUNB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXN6QiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkJYOVVCOEVQLm1qcz80MWRhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHogZnJvbSAnem9kJztcbmltcG9ydCB7IHMgYXMgc2V0U2Vzc2lvbkNvb2tpZSwgZCBhcyBkZWxldGVTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EOV92UVI4My5tanMnO1xuaW1wb3J0IHsgQVBJRXJyb3IsIHRvUmVzcG9uc2UgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBjcmVhdGVBdXRoTWlkZGxld2FyZSwgY3JlYXRlQXV0aEVuZHBvaW50IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvbWlkZGxld2FyZSc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0IHsgQkFTRV9FUlJPUl9DT0RFUyB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcbmltcG9ydCB7IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0gfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9zb2NpYWwtcHJvdmlkZXJzJztcbmltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0U2Vzc2lvbkZyb21DdHgsIGUgYXMgc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmUsIHMgYXMgc2Vzc2lvbk1pZGRsZXdhcmUsIGYgYXMgZnJlc2hTZXNzaW9uTWlkZGxld2FyZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguREVCdFJPRjkubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0RGF0ZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCB7IGcgYXMgZ2VuZXJhdGVJZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgand0VmVyaWZ5IH0gZnJvbSAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0IHsgZyBhcyBnZW5lcmF0ZVJhbmRvbVN0cmluZyB9IGZyb20gJy4vYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCB7IGQgYXMgcGFyc2VVc2VySW5wdXQgfSBmcm9tICcuL2JldHRlci1hdXRoLkN3ajlkdDZpLm1qcyc7XG5pbXBvcnQgeyBsb2dnZXIsIGlzRGV2ZWxvcG1lbnQsIHNob3VsZFB1Ymxpc2hMb2cgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaG1hYyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iaW5hcnknO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9kYic7XG5pbXBvcnQgJ2t5c2VseSc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL2RiL2FkYXB0ZXInO1xuaW1wb3J0IHsgY3JlYXRlRGVmdSB9IGZyb20gJ2RlZnUnO1xuaW1wb3J0IHsgc2lnbkpXVCwgc3ltbWV0cmljRW5jcnlwdCwgc3ltbWV0cmljRGVjcnlwdCB9IGZyb20gJy4uL2NyeXB0by9pbmRleC5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRPcmlnaW4sIGIgYXMgZ2V0SG9zdCwgYyBhcyBnZXRQcm90b2NvbCB9IGZyb20gJy4vYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzJztcbmltcG9ydCB7IEpXVEV4cGlyZWQgfSBmcm9tICdqb3NlL2Vycm9ycyc7XG5cbmZ1bmN0aW9uIGVzY2FwZVJlZ0V4cENoYXIoY2hhcikge1xuICBpZiAoY2hhciA9PT0gXCItXCIgfHwgY2hhciA9PT0gXCJeXCIgfHwgY2hhciA9PT0gXCIkXCIgfHwgY2hhciA9PT0gXCIrXCIgfHwgY2hhciA9PT0gXCIuXCIgfHwgY2hhciA9PT0gXCIoXCIgfHwgY2hhciA9PT0gXCIpXCIgfHwgY2hhciA9PT0gXCJ8XCIgfHwgY2hhciA9PT0gXCJbXCIgfHwgY2hhciA9PT0gXCJdXCIgfHwgY2hhciA9PT0gXCJ7XCIgfHwgY2hhciA9PT0gXCJ9XCIgfHwgY2hhciA9PT0gXCIqXCIgfHwgY2hhciA9PT0gXCI/XCIgfHwgY2hhciA9PT0gXCJcXFxcXCIpIHtcbiAgICByZXR1cm4gYFxcXFwke2NoYXJ9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY2hhcjtcbiAgfVxufVxuZnVuY3Rpb24gZXNjYXBlUmVnRXhwU3RyaW5nKHN0cikge1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICByZXN1bHQgKz0gZXNjYXBlUmVnRXhwQ2hhcihzdHJbaV0pO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm0ocGF0dGVybiwgc2VwYXJhdG9yID0gdHJ1ZSkge1xuICBpZiAoQXJyYXkuaXNBcnJheShwYXR0ZXJuKSkge1xuICAgIGxldCByZWdFeHBQYXR0ZXJucyA9IHBhdHRlcm4ubWFwKChwKSA9PiBgXiR7dHJhbnNmb3JtKHAsIHNlcGFyYXRvcil9JGApO1xuICAgIHJldHVybiBgKD86JHtyZWdFeHBQYXR0ZXJucy5qb2luKFwifFwiKX0pYDtcbiAgfVxuICBsZXQgc2VwYXJhdG9yU3BsaXR0ZXIgPSBcIlwiO1xuICBsZXQgc2VwYXJhdG9yTWF0Y2hlciA9IFwiXCI7XG4gIGxldCB3aWxkY2FyZCA9IFwiLlwiO1xuICBpZiAoc2VwYXJhdG9yID09PSB0cnVlKSB7XG4gICAgc2VwYXJhdG9yU3BsaXR0ZXIgPSBcIi9cIjtcbiAgICBzZXBhcmF0b3JNYXRjaGVyID0gXCJbL1xcXFxcXFxcXVwiO1xuICAgIHdpbGRjYXJkID0gXCJbXi9cXFxcXFxcXF1cIjtcbiAgfSBlbHNlIGlmIChzZXBhcmF0b3IpIHtcbiAgICBzZXBhcmF0b3JTcGxpdHRlciA9IHNlcGFyYXRvcjtcbiAgICBzZXBhcmF0b3JNYXRjaGVyID0gZXNjYXBlUmVnRXhwU3RyaW5nKHNlcGFyYXRvclNwbGl0dGVyKTtcbiAgICBpZiAoc2VwYXJhdG9yTWF0Y2hlci5sZW5ndGggPiAxKSB7XG4gICAgICBzZXBhcmF0b3JNYXRjaGVyID0gYCg/OiR7c2VwYXJhdG9yTWF0Y2hlcn0pYDtcbiAgICAgIHdpbGRjYXJkID0gYCgoPyEke3NlcGFyYXRvck1hdGNoZXJ9KS4pYDtcbiAgICB9IGVsc2Uge1xuICAgICAgd2lsZGNhcmQgPSBgW14ke3NlcGFyYXRvck1hdGNoZXJ9XWA7XG4gICAgfVxuICB9XG4gIGxldCByZXF1aXJlZFNlcGFyYXRvciA9IHNlcGFyYXRvciA/IGAke3NlcGFyYXRvck1hdGNoZXJ9Kz9gIDogXCJcIjtcbiAgbGV0IG9wdGlvbmFsU2VwYXJhdG9yID0gc2VwYXJhdG9yID8gYCR7c2VwYXJhdG9yTWF0Y2hlcn0qP2AgOiBcIlwiO1xuICBsZXQgc2VnbWVudHMgPSBzZXBhcmF0b3IgPyBwYXR0ZXJuLnNwbGl0KHNlcGFyYXRvclNwbGl0dGVyKSA6IFtwYXR0ZXJuXTtcbiAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gIGZvciAobGV0IHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspIHtcbiAgICBsZXQgc2VnbWVudCA9IHNlZ21lbnRzW3NdO1xuICAgIGxldCBuZXh0U2VnbWVudCA9IHNlZ21lbnRzW3MgKyAxXTtcbiAgICBsZXQgY3VycmVudFNlcGFyYXRvciA9IFwiXCI7XG4gICAgaWYgKCFzZWdtZW50ICYmIHMgPiAwKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHNlcGFyYXRvcikge1xuICAgICAgaWYgKHMgPT09IHNlZ21lbnRzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgY3VycmVudFNlcGFyYXRvciA9IG9wdGlvbmFsU2VwYXJhdG9yO1xuICAgICAgfSBlbHNlIGlmIChuZXh0U2VnbWVudCAhPT0gXCIqKlwiKSB7XG4gICAgICAgIGN1cnJlbnRTZXBhcmF0b3IgPSByZXF1aXJlZFNlcGFyYXRvcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRTZXBhcmF0b3IgPSBcIlwiO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoc2VwYXJhdG9yICYmIHNlZ21lbnQgPT09IFwiKipcIikge1xuICAgICAgaWYgKGN1cnJlbnRTZXBhcmF0b3IpIHtcbiAgICAgICAgcmVzdWx0ICs9IHMgPT09IDAgPyBcIlwiIDogY3VycmVudFNlcGFyYXRvcjtcbiAgICAgICAgcmVzdWx0ICs9IGAoPzoke3dpbGRjYXJkfSo/JHtjdXJyZW50U2VwYXJhdG9yfSkqP2A7XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCBzZWdtZW50Lmxlbmd0aDsgYysrKSB7XG4gICAgICBsZXQgY2hhciA9IHNlZ21lbnRbY107XG4gICAgICBpZiAoY2hhciA9PT0gXCJcXFxcXCIpIHtcbiAgICAgICAgaWYgKGMgPCBzZWdtZW50Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICByZXN1bHQgKz0gZXNjYXBlUmVnRXhwQ2hhcihzZWdtZW50W2MgKyAxXSk7XG4gICAgICAgICAgYysrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNoYXIgPT09IFwiP1wiKSB7XG4gICAgICAgIHJlc3VsdCArPSB3aWxkY2FyZDtcbiAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gXCIqXCIpIHtcbiAgICAgICAgcmVzdWx0ICs9IGAke3dpbGRjYXJkfSo/YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCArPSBlc2NhcGVSZWdFeHBDaGFyKGNoYXIpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQgKz0gY3VycmVudFNlcGFyYXRvcjtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gaXNNYXRjaChyZWdleHAsIHNhbXBsZSkge1xuICBpZiAodHlwZW9mIHNhbXBsZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFNhbXBsZSBtdXN0IGJlIGEgc3RyaW5nLCBidXQgJHt0eXBlb2Ygc2FtcGxlfSBnaXZlbmApO1xuICB9XG4gIHJldHVybiByZWdleHAudGVzdChzYW1wbGUpO1xufVxuZnVuY3Rpb24gd2lsZGNhcmRNYXRjaChwYXR0ZXJuLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgcGF0dGVybiAhPT0gXCJzdHJpbmdcIiAmJiAhQXJyYXkuaXNBcnJheShwYXR0ZXJuKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICBgVGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzaW5nbGUgcGF0dGVybiBzdHJpbmcgb3IgYW4gYXJyYXkgb2YgcGF0dGVybnMsIGJ1dCAke3R5cGVvZiBwYXR0ZXJufSBnaXZlbmBcbiAgICApO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJib29sZWFuXCIpIHtcbiAgICBvcHRpb25zID0geyBzZXBhcmF0b3I6IG9wdGlvbnMgfTtcbiAgfVxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiAhKHR5cGVvZiBvcHRpb25zID09PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiBvcHRpb25zID09PSBcIm9iamVjdFwiICYmIG9wdGlvbnMgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkob3B0aW9ucykpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgIGBUaGUgc2Vjb25kIGFyZ3VtZW50IG11c3QgYmUgYW4gb3B0aW9ucyBvYmplY3Qgb3IgYSBzdHJpbmcvYm9vbGVhbiBzZXBhcmF0b3IsIGJ1dCAke3R5cGVvZiBvcHRpb25zfSBnaXZlbmBcbiAgICApO1xuICB9XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBpZiAob3B0aW9ucy5zZXBhcmF0b3IgPT09IFwiXFxcXFwiKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJcXFxcIGlzIG5vdCBhIHZhbGlkIHNlcGFyYXRvciBiZWNhdXNlIGl0IGlzIHVzZWQgZm9yIGVzY2FwaW5nLiBUcnkgc2V0dGluZyB0aGUgc2VwYXJhdG9yIHRvIGB0cnVlYCBpbnN0ZWFkXCJcbiAgICApO1xuICB9XG4gIGxldCByZWdleHBQYXR0ZXJuID0gdHJhbnNmb3JtKHBhdHRlcm4sIG9wdGlvbnMuc2VwYXJhdG9yKTtcbiAgbGV0IHJlZ2V4cCA9IG5ldyBSZWdFeHAoYF4ke3JlZ2V4cFBhdHRlcm59JGAsIG9wdGlvbnMuZmxhZ3MpO1xuICBsZXQgZm4gPSBpc01hdGNoLmJpbmQobnVsbCwgcmVnZXhwKTtcbiAgZm4ub3B0aW9ucyA9IG9wdGlvbnM7XG4gIGZuLnBhdHRlcm4gPSBwYXR0ZXJuO1xuICBmbi5yZWdleHAgPSByZWdleHA7XG4gIHJldHVybiBmbjtcbn1cblxuY29uc3Qgb3JpZ2luQ2hlY2tNaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICBpZiAoY3R4LnJlcXVlc3Q/Lm1ldGhvZCAhPT0gXCJQT1NUXCIgfHwgIWN0eC5yZXF1ZXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGhlYWRlcnMgPSBjdHgucmVxdWVzdD8uaGVhZGVycztcbiAgY29uc3QgcmVxdWVzdCA9IGN0eC5yZXF1ZXN0O1xuICBjb25zdCB7IGJvZHksIHF1ZXJ5LCBjb250ZXh0IH0gPSBjdHg7XG4gIGlmIChpc1NpbXBsZVJlcXVlc3QoaGVhZGVycykgJiYgIWN0eC5jb250ZXh0LnNraXBDU1JGQ2hlY2spIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwgeyBtZXNzYWdlOiBcIkludmFsaWQgcmVxdWVzdFwiIH0pO1xuICB9XG4gIGNvbnN0IG9yaWdpbkhlYWRlciA9IGhlYWRlcnM/LmdldChcIm9yaWdpblwiKSB8fCBoZWFkZXJzPy5nZXQoXCJyZWZlcmVyXCIpIHx8IFwiXCI7XG4gIGNvbnN0IGNhbGxiYWNrVVJMID0gYm9keT8uY2FsbGJhY2tVUkwgfHwgcXVlcnk/LmNhbGxiYWNrVVJMO1xuICBjb25zdCByZWRpcmVjdFVSTCA9IGJvZHk/LnJlZGlyZWN0VG87XG4gIGNvbnN0IGVycm9yQ2FsbGJhY2tVUkwgPSBib2R5Py5lcnJvckNhbGxiYWNrVVJMO1xuICBjb25zdCBuZXdVc2VyQ2FsbGJhY2tVUkwgPSBib2R5Py5uZXdVc2VyQ2FsbGJhY2tVUkw7XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gQXJyYXkuaXNBcnJheShjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpID8gY29udGV4dC50cnVzdGVkT3JpZ2lucyA6IFtcbiAgICAuLi5jb250ZXh0LnRydXN0ZWRPcmlnaW5zLFxuICAgIC4uLmF3YWl0IGNvbnRleHQub3B0aW9ucy50cnVzdGVkT3JpZ2lucz8uKHJlcXVlc3QpIHx8IFtdXG4gIF07XG4gIGNvbnN0IHVzZUNvb2tpZXMgPSBoZWFkZXJzPy5oYXMoXCJjb29raWVcIik7XG4gIGNvbnN0IG1hdGNoZXNQYXR0ZXJuID0gKHVybCwgcGF0dGVybikgPT4ge1xuICAgIGlmICh1cmwuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBhdHRlcm4uaW5jbHVkZXMoXCIqXCIpKSB7XG4gICAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShnZXRPcmlnaW4odXJsKSB8fCB1cmwpO1xuICAgICAgfVxuICAgICAgY29uc3QgaG9zdCA9IGdldEhvc3QodXJsKTtcbiAgICAgIGlmICghaG9zdCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShob3N0KTtcbiAgICB9XG4gICAgY29uc3QgcHJvdG9jb2wgPSBnZXRQcm90b2NvbCh1cmwpO1xuICAgIHJldHVybiBwcm90b2NvbCA9PT0gXCJodHRwOlwiIHx8IHByb3RvY29sID09PSBcImh0dHBzOlwiIHx8ICFwcm90b2NvbCA/IHBhdHRlcm4gPT09IGdldE9yaWdpbih1cmwpIDogdXJsLnN0YXJ0c1dpdGgocGF0dGVybik7XG4gIH07XG4gIGNvbnN0IHZhbGlkYXRlVVJMID0gKHVybCwgbGFiZWwpID0+IHtcbiAgICBpZiAoIXVybCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc1RydXN0ZWRPcmlnaW4gPSB0cnVzdGVkT3JpZ2lucy5zb21lKFxuICAgICAgKG9yaWdpbikgPT4gbWF0Y2hlc1BhdHRlcm4odXJsLCBvcmlnaW4pIHx8IHVybD8uc3RhcnRzV2l0aChcIi9cIikgJiYgbGFiZWwgIT09IFwib3JpZ2luXCIgJiYgL15cXC8oPyFcXC98XFxcXHwlMmZ8JTVjKVtcXHdcXC0uXFwrL0BdKig/OlxcP1tcXHdcXC0uXFwrLz0mJUBdKik/JC8udGVzdCh1cmwpXG4gICAgKTtcbiAgICBpZiAoIWlzVHJ1c3RlZE9yaWdpbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGBJbnZhbGlkICR7bGFiZWx9OiAke3VybH1gKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKFxuICAgICAgICBgSWYgaXQncyBhIHZhbGlkIFVSTCwgcGxlYXNlIGFkZCAke3VybH0gdG8gdHJ1c3RlZE9yaWdpbnMgaW4geW91ciBhdXRoIGNvbmZpZ1xuYCxcbiAgICAgICAgYEN1cnJlbnQgbGlzdCBvZiB0cnVzdGVkT3JpZ2luczogJHt0cnVzdGVkT3JpZ2luc31gXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogYEludmFsaWQgJHtsYWJlbH1gIH0pO1xuICAgIH1cbiAgfTtcbiAgaWYgKHVzZUNvb2tpZXMgJiYgIWN0eC5jb250ZXh0LnNraXBDU1JGQ2hlY2sgJiYgIWN0eC5jb250ZXh0LnNraXBPcmlnaW5DaGVjaykge1xuICAgIGlmICghb3JpZ2luSGVhZGVyIHx8IG9yaWdpbkhlYWRlciA9PT0gXCJudWxsXCIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7IG1lc3NhZ2U6IFwiTWlzc2luZyBvciBudWxsIE9yaWdpblwiIH0pO1xuICAgIH1cbiAgICB2YWxpZGF0ZVVSTChvcmlnaW5IZWFkZXIsIFwib3JpZ2luXCIpO1xuICB9XG4gIGNhbGxiYWNrVVJMICYmIHZhbGlkYXRlVVJMKGNhbGxiYWNrVVJMLCBcImNhbGxiYWNrVVJMXCIpO1xuICByZWRpcmVjdFVSTCAmJiB2YWxpZGF0ZVVSTChyZWRpcmVjdFVSTCwgXCJyZWRpcmVjdFVSTFwiKTtcbiAgZXJyb3JDYWxsYmFja1VSTCAmJiB2YWxpZGF0ZVVSTChlcnJvckNhbGxiYWNrVVJMLCBcImVycm9yQ2FsbGJhY2tVUkxcIik7XG4gIG5ld1VzZXJDYWxsYmFja1VSTCAmJiB2YWxpZGF0ZVVSTChuZXdVc2VyQ2FsbGJhY2tVUkwsIFwibmV3VXNlckNhbGxiYWNrVVJMXCIpO1xufSk7XG5jb25zdCBvcmlnaW5DaGVjayA9IChnZXRWYWx1ZSkgPT4gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICBpZiAoIWN0eC5yZXF1ZXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHsgY29udGV4dCB9ID0gY3R4O1xuICBjb25zdCBjYWxsYmFja1VSTCA9IGdldFZhbHVlKGN0eCk7XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gQXJyYXkuaXNBcnJheShcbiAgICBjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnNcbiAgKSA/IGNvbnRleHQudHJ1c3RlZE9yaWdpbnMgOiBbXG4gICAgLi4uY29udGV4dC50cnVzdGVkT3JpZ2lucyxcbiAgICAuLi5hd2FpdCBjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnM/LihjdHgucmVxdWVzdCkgfHwgW11cbiAgXTtcbiAgY29uc3QgbWF0Y2hlc1BhdHRlcm4gPSAodXJsLCBwYXR0ZXJuKSA9PiB7XG4gICAgaWYgKHVybC5zdGFydHNXaXRoKFwiL1wiKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIipcIikpIHtcbiAgICAgIGlmIChwYXR0ZXJuLmluY2x1ZGVzKFwiOi8vXCIpKSB7XG4gICAgICAgIHJldHVybiB3aWxkY2FyZE1hdGNoKHBhdHRlcm4pKGdldE9yaWdpbih1cmwpIHx8IHVybCk7XG4gICAgICB9XG4gICAgICBjb25zdCBob3N0ID0gZ2V0SG9zdCh1cmwpO1xuICAgICAgaWYgKCFob3N0KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB3aWxkY2FyZE1hdGNoKHBhdHRlcm4pKGhvc3QpO1xuICAgIH1cbiAgICBjb25zdCBwcm90b2NvbCA9IGdldFByb3RvY29sKHVybCk7XG4gICAgcmV0dXJuIHByb3RvY29sID09PSBcImh0dHA6XCIgfHwgcHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgfHwgIXByb3RvY29sID8gcGF0dGVybiA9PT0gZ2V0T3JpZ2luKHVybCkgOiB1cmwuc3RhcnRzV2l0aChwYXR0ZXJuKTtcbiAgfTtcbiAgY29uc3QgdmFsaWRhdGVVUkwgPSAodXJsLCBsYWJlbCkgPT4ge1xuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGlzVHJ1c3RlZE9yaWdpbiA9IHRydXN0ZWRPcmlnaW5zLnNvbWUoXG4gICAgICAob3JpZ2luKSA9PiBtYXRjaGVzUGF0dGVybih1cmwsIG9yaWdpbikgfHwgdXJsPy5zdGFydHNXaXRoKFwiL1wiKSAmJiBsYWJlbCAhPT0gXCJvcmlnaW5cIiAmJiAvXlxcLyg/IVxcL3xcXFxcfCUyZnwlNWMpW1xcd1xcLS5cXCsvQF0qKD86XFw/W1xcd1xcLS5cXCsvPSYlQF0qKT8kLy50ZXN0KFxuICAgICAgICB1cmxcbiAgICAgIClcbiAgICApO1xuICAgIGlmICghaXNUcnVzdGVkT3JpZ2luKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoYEludmFsaWQgJHtsYWJlbH06ICR7dXJsfWApO1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmluZm8oXG4gICAgICAgIGBJZiBpdCdzIGEgdmFsaWQgVVJMLCBwbGVhc2UgYWRkICR7dXJsfSB0byB0cnVzdGVkT3JpZ2lucyBpbiB5b3VyIGF1dGggY29uZmlnXG5gLFxuICAgICAgICBgQ3VycmVudCBsaXN0IG9mIHRydXN0ZWRPcmlnaW5zOiAke3RydXN0ZWRPcmlnaW5zfWBcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwgeyBtZXNzYWdlOiBgSW52YWxpZCAke2xhYmVsfWAgfSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBjYWxsYmFja3MgPSBBcnJheS5pc0FycmF5KGNhbGxiYWNrVVJMKSA/IGNhbGxiYWNrVVJMIDogW2NhbGxiYWNrVVJMXTtcbiAgZm9yIChjb25zdCB1cmwgb2YgY2FsbGJhY2tzKSB7XG4gICAgdmFsaWRhdGVVUkwodXJsLCBcImNhbGxiYWNrVVJMXCIpO1xuICB9XG59KTtcbmZ1bmN0aW9uIGlzU2ltcGxlUmVxdWVzdChoZWFkZXJzKSB7XG4gIGNvbnN0IFNJTVBMRV9IRUFERVJTID0gW1xuICAgIFwiYWNjZXB0XCIsXG4gICAgXCJhY2NlcHQtbGFuZ3VhZ2VcIixcbiAgICBcImNvbnRlbnQtbGFuZ3VhZ2VcIixcbiAgICBcImNvbnRlbnQtdHlwZVwiXG4gIF07XG4gIGNvbnN0IFNJTVBMRV9DT05URU5UX1RZUEVTID0gW1xuICAgIFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXG4gICAgXCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIsXG4gICAgXCJ0ZXh0L3BsYWluXCJcbiAgXTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgaGVhZGVycy5lbnRyaWVzKCkpIHtcbiAgICBpZiAoIVNJTVBMRV9IRUFERVJTLmluY2x1ZGVzKGtleS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoa2V5LnRvTG93ZXJDYXNlKCkgPT09IFwiY29udGVudC10eXBlXCIgJiYgIVNJTVBMRV9DT05URU5UX1RZUEVTLmluY2x1ZGVzKFxuICAgICAgdmFsdWU/LnNwbGl0KFwiO1wiKVswXT8udHJpbSgpPy50b0xvd2VyQ2FzZSgpIHx8IFwiXCJcbiAgICApKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKHNlY3JldCwgZW1haWwsIHVwZGF0ZVRvLCBleHBpcmVzSW4gPSAzNjAwKSB7XG4gIGNvbnN0IHRva2VuID0gYXdhaXQgc2lnbkpXVChcbiAgICB7XG4gICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgIHVwZGF0ZVRvXG4gICAgfSxcbiAgICBzZWNyZXQsXG4gICAgZXhwaXJlc0luXG4gICk7XG4gIHJldHVybiB0b2tlbjtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNlbmRWZXJpZmljYXRpb25FbWFpbEZuKGN0eCwgdXNlcikge1xuICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCkge1xuICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgIHVzZXIuZW1haWwsXG4gICAgdm9pZCAwLFxuICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICApO1xuICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLnNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICB7XG4gICAgICB1c2VyLFxuICAgICAgdXJsLFxuICAgICAgdG9rZW5cbiAgICB9LFxuICAgIGN0eC5yZXF1ZXN0XG4gICk7XG59XG5jb25zdCBzZW5kVmVyaWZpY2F0aW9uRW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NlbmQtdmVyaWZpY2F0aW9uLWVtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIGVtYWlsOiB6LmVtYWlsKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCB0byBzZW5kIHRoZSB2ZXJpZmljYXRpb24gZW1haWwgdG9cIlxuICAgICAgfSksXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byB1c2UgZm9yIGVtYWlsIHZlcmlmaWNhdGlvbiBjYWxsYmFja1wiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2VuZCBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIHRvIHNlbmQgdGhlIHZlcmlmaWNhdGlvbiBlbWFpbCB0b1wiLFxuICAgICAgICAgICAgICAgICAgICBleGFtcGxlOiBcInVzZXJAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gdXNlIGZvciBlbWFpbCB2ZXJpZmljYXRpb24gY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgICAgICAgZXhhbXBsZTogXCJodHRwczovL2V4YW1wbGUuY29tL2NhbGxiYWNrXCIsXG4gICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wiZW1haWxcIl1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSBlbWFpbCB3YXMgc2VudCBzdWNjZXNzZnVsbHlcIixcbiAgICAgICAgICAgICAgICAgICAgICBleGFtcGxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiNDAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkJhZCBSZXF1ZXN0XCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFcnJvciBtZXNzYWdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZXhhbXBsZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWQuXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHNlbmRWZXJpZmljYXRpb25FbWFpbEZuKGN0eCwgdXNlci51c2VyKTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzZXNzaW9uPy51c2VyLmVtYWlsVmVyaWZpZWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJZb3UgY2FuIG9ubHkgc2VuZCBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byBhbiB1bnZlcmlmaWVkIGVtYWlsXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoc2Vzc2lvbj8udXNlci5lbWFpbCAhPT0gZW1haWwpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJZb3UgY2FuIG9ubHkgc2VuZCBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byB5b3VyIG93biBlbWFpbFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4oY3R4LCBzZXNzaW9uLnVzZXIpO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHZlcmlmeUVtYWlsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi92ZXJpZnktZW1haWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byB2ZXJpZnkgdGhlIGVtYWlsXCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZW1haWwgdmVyaWZpY2F0aW9uXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmlnaW5DaGVjaygoY3R4KSA9PiBjdHgucXVlcnkuY2FsbGJhY2tVUkwpXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJWZXJpZnkgdGhlIGVtYWlsIG9mIHRoZSB1c2VyXCIsXG4gICAgICAgIHBhcmFtZXRlcnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcInRva2VuXCIsXG4gICAgICAgICAgICBpbjogXCJxdWVyeVwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIHZlcmlmeSB0aGUgZW1haWxcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiY2FsbGJhY2tVUkxcIixcbiAgICAgICAgICAgIGluOiBcInF1ZXJ5XCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIGVtYWlsIHZlcmlmaWNhdGlvblwiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgSURcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgZW1haWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBuYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIGltYWdlIFVSTFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSB1c2VyIGVtYWlsIGlzIHZlcmlmaWVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBjcmVhdGlvbiBkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciB1cGRhdGUgZGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImltYWdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsVmVyaWZpZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiXG4gICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIGVtYWlsIHdhcyB2ZXJpZmllZCBzdWNjZXNzZnVsbHlcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInVzZXJcIiwgXCJzdGF0dXNcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBmdW5jdGlvbiByZWRpcmVjdE9uRXJyb3IoZXJyb3IpIHtcbiAgICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTC5pbmNsdWRlcyhcIj9cIikpIHtcbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMfSZlcnJvcj0ke2Vycm9yfWApO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9P2Vycm9yPSR7ZXJyb3J9YCk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBlcnJvclxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgdG9rZW4gfSA9IGN0eC5xdWVyeTtcbiAgICBsZXQgand0O1xuICAgIHRyeSB7XG4gICAgICBqd3QgPSBhd2FpdCBqd3RWZXJpZnkoXG4gICAgICAgIHRva2VuLFxuICAgICAgICBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoY3R4LmNvbnRleHQuc2VjcmV0KSxcbiAgICAgICAge1xuICAgICAgICAgIGFsZ29yaXRobXM6IFtcIkhTMjU2XCJdXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBKV1RFeHBpcmVkKSB7XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ0b2tlbl9leHBpcmVkXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImludmFsaWRfdG9rZW5cIik7XG4gICAgfVxuICAgIGNvbnN0IHNjaGVtYSA9IHoub2JqZWN0KHtcbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLmVtYWlsKCksXG4gICAgICB1cGRhdGVUbzogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSk7XG4gICAgY29uc3QgcGFyc2VkID0gc2NoZW1hLnBhcnNlKGp3dC5wYXlsb2FkKTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChcbiAgICAgIHBhcnNlZC5lbWFpbFxuICAgICk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidXNlcl9ub3RfZm91bmRcIik7XG4gICAgfVxuICAgIGlmIChwYXJzZWQudXBkYXRlVG8pIHtcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMfT9lcnJvcj11bmF1dGhvcml6ZWRgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hdXRob3JpemVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKHNlc3Npb24udXNlci5lbWFpbCAhPT0gcGFyc2VkLmVtYWlsKSB7XG4gICAgICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMfT9lcnJvcj11bmF1dGhvcml6ZWRgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hdXRob3JpemVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgdXBkYXRlZFVzZXIyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXJCeUVtYWlsKFxuICAgICAgICBwYXJzZWQuZW1haWwsXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogcGFyc2VkLnVwZGF0ZVRvLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGN0eFxuICAgICAgKTtcbiAgICAgIGNvbnN0IG5ld1Rva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICBwYXJzZWQudXBkYXRlVG9cbiAgICAgICk7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWw/LihcbiAgICAgICAge1xuICAgICAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyMixcbiAgICAgICAgICB1cmw6IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke25ld1Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5xdWVyeS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gLFxuICAgICAgICAgIHRva2VuOiBuZXdUb2tlblxuICAgICAgICB9LFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIC4uLnNlc3Npb24udXNlcixcbiAgICAgICAgICBlbWFpbDogcGFyc2VkLnVwZGF0ZVRvLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1cGRhdGVkVXNlcjIuaWQsXG4gICAgICAgICAgZW1haWw6IHVwZGF0ZWRVc2VyMi5lbWFpbCxcbiAgICAgICAgICBuYW1lOiB1cGRhdGVkVXNlcjIubmFtZSxcbiAgICAgICAgICBpbWFnZTogdXBkYXRlZFVzZXIyLmltYWdlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVwZGF0ZWRVc2VyMi5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogdXBkYXRlZFVzZXIyLmNyZWF0ZWRBdCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IHVwZGF0ZWRVc2VyMi51cGRhdGVkQXRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5vbkVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLm9uRW1haWxWZXJpZmljYXRpb24oXG4gICAgICAgIHVzZXIudXNlcixcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXJCeUVtYWlsKFxuICAgICAgcGFyc2VkLmVtYWlsLFxuICAgICAge1xuICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICB9LFxuICAgICAgY3R4XG4gICAgKTtcbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uYWZ0ZXJFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5hZnRlckVtYWlsVmVyaWZpY2F0aW9uKFxuICAgICAgICB1cGRhdGVkVXNlcixcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5hdXRvU2lnbkluQWZ0ZXJWZXJpZmljYXRpb24pIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgIGlmICghY3VycmVudFNlc3Npb24gfHwgY3VycmVudFNlc3Npb24udXNlci5lbWFpbCAhPT0gcGFyc2VkLmVtYWlsKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICB1c2VyLnVzZXIuaWQsXG4gICAgICAgICAgY3R4XG4gICAgICAgICk7XG4gICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvblwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIC4uLnVzZXIudXNlcixcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICBzZXNzaW9uOiBjdXJyZW50U2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIC4uLmN1cnJlbnRTZXNzaW9uLnVzZXIsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGN0eC5xdWVyeS5jYWxsYmFja1VSTCk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWUsXG4gICAgICB1c2VyOiBudWxsXG4gICAgfSk7XG4gIH1cbik7XG5cbmNvbnN0IEhJREVfTUVUQURBVEEgPSB7XG4gIGlzQWN0aW9uOiBmYWxzZVxufTtcblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTdGF0ZShjLCBsaW5rKSB7XG4gIGNvbnN0IGNhbGxiYWNrVVJMID0gYy5ib2R5Py5jYWxsYmFja1VSTCB8fCBjLmNvbnRleHQub3B0aW9ucy5iYXNlVVJMO1xuICBpZiAoIWNhbGxiYWNrVVJMKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJjYWxsYmFja1VSTCBpcyByZXF1aXJlZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgY29kZVZlcmlmaWVyID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMTI4KTtcbiAgY29uc3Qgc3RhdGUgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMik7XG4gIGNvbnN0IHN0YXRlQ29va2llID0gYy5jb250ZXh0LmNyZWF0ZUF1dGhDb29raWUoXCJzdGF0ZVwiLCB7XG4gICAgbWF4QWdlOiA1ICogNjAgKiAxZTNcbiAgICAvLyA1IG1pbnV0ZXNcbiAgfSk7XG4gIGF3YWl0IGMuc2V0U2lnbmVkQ29va2llKFxuICAgIHN0YXRlQ29va2llLm5hbWUsXG4gICAgc3RhdGUsXG4gICAgYy5jb250ZXh0LnNlY3JldCxcbiAgICBzdGF0ZUNvb2tpZS5hdHRyaWJ1dGVzXG4gICk7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgY2FsbGJhY2tVUkwsXG4gICAgY29kZVZlcmlmaWVyLFxuICAgIGVycm9yVVJMOiBjLmJvZHk/LmVycm9yQ2FsbGJhY2tVUkwsXG4gICAgbmV3VXNlclVSTDogYy5ib2R5Py5uZXdVc2VyQ2FsbGJhY2tVUkwsXG4gICAgbGluayxcbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIHRoZSBhY3R1YWwgZXhwaXJ5IHRpbWUgb2YgdGhlIHN0YXRlXG4gICAgICovXG4gICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgMTAgKiA2MCAqIDFlMyxcbiAgICByZXF1ZXN0U2lnblVwOiBjLmJvZHk/LnJlcXVlc3RTaWduVXBcbiAgfSk7XG4gIGNvbnN0IGV4cGlyZXNBdCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICBleHBpcmVzQXQuc2V0TWludXRlcyhleHBpcmVzQXQuZ2V0TWludXRlcygpICsgMTApO1xuICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgIHtcbiAgICAgIHZhbHVlOiBkYXRhLFxuICAgICAgaWRlbnRpZmllcjogc3RhdGUsXG4gICAgICBleHBpcmVzQXRcbiAgICB9LFxuICAgIGNcbiAgKTtcbiAgaWYgKCF2ZXJpZmljYXRpb24pIHtcbiAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgXCJVbmFibGUgdG8gY3JlYXRlIHZlcmlmaWNhdGlvbi4gTWFrZSBzdXJlIHRoZSBkYXRhYmFzZSBhZGFwdGVyIGlzIHByb3Blcmx5IHdvcmtpbmcgYW5kIHRoZXJlIGlzIGEgdmVyaWZpY2F0aW9uIHRhYmxlIGluIHRoZSBkYXRhYmFzZVwiXG4gICAgKTtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gY3JlYXRlIHZlcmlmaWNhdGlvblwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzdGF0ZTogdmVyaWZpY2F0aW9uLmlkZW50aWZpZXIsXG4gICAgY29kZVZlcmlmaWVyXG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiBwYXJzZVN0YXRlKGMpIHtcbiAgY29uc3Qgc3RhdGUgPSBjLnF1ZXJ5LnN0YXRlIHx8IGMuYm9keS5zdGF0ZTtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKHN0YXRlKTtcbiAgaWYgKCFkYXRhKSB7XG4gICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlN0YXRlIE1pc21hdGNoLiBWZXJpZmljYXRpb24gbm90IGZvdW5kXCIsIHtcbiAgICAgIHN0YXRlXG4gICAgfSk7XG4gICAgY29uc3QgZXJyb3JVUkwgPSBjLmNvbnRleHQub3B0aW9ucy5vbkFQSUVycm9yPy5lcnJvclVSTCB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICAgIHRocm93IGMucmVkaXJlY3QoYCR7ZXJyb3JVUkx9P2Vycm9yPXBsZWFzZV9yZXN0YXJ0X3RoZV9wcm9jZXNzYCk7XG4gIH1cbiAgY29uc3QgcGFyc2VkRGF0YSA9IHoub2JqZWN0KHtcbiAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKSxcbiAgICBjb2RlVmVyaWZpZXI6IHouc3RyaW5nKCksXG4gICAgZXJyb3JVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBuZXdVc2VyVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgZXhwaXJlc0F0OiB6Lm51bWJlcigpLFxuICAgIGxpbms6IHoub2JqZWN0KHtcbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLFxuICAgICAgdXNlcklkOiB6LmNvZXJjZS5zdHJpbmcoKVxuICAgIH0pLm9wdGlvbmFsKCksXG4gICAgcmVxdWVzdFNpZ25VcDogei5ib29sZWFuKCkub3B0aW9uYWwoKVxuICB9KS5wYXJzZShKU09OLnBhcnNlKGRhdGEudmFsdWUpKTtcbiAgaWYgKCFwYXJzZWREYXRhLmVycm9yVVJMKSB7XG4gICAgcGFyc2VkRGF0YS5lcnJvclVSTCA9IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gIH1cbiAgY29uc3Qgc3RhdGVDb29raWUgPSBjLmNvbnRleHQuY3JlYXRlQXV0aENvb2tpZShcInN0YXRlXCIpO1xuICBjb25zdCBzdGF0ZUNvb2tpZVZhbHVlID0gYXdhaXQgYy5nZXRTaWduZWRDb29raWUoXG4gICAgc3RhdGVDb29raWUubmFtZSxcbiAgICBjLmNvbnRleHQuc2VjcmV0XG4gICk7XG4gIGNvbnN0IHNraXBTdGF0ZUNvb2tpZUNoZWNrID0gYy5jb250ZXh0Lm9hdXRoQ29uZmlnPy5za2lwU3RhdGVDb29raWVDaGVjaztcbiAgaWYgKCFza2lwU3RhdGVDb29raWVDaGVjayAmJiAoIXN0YXRlQ29va2llVmFsdWUgfHwgc3RhdGVDb29raWVWYWx1ZSAhPT0gc3RhdGUpKSB7XG4gICAgY29uc3QgZXJyb3JVUkwgPSBjLmNvbnRleHQub3B0aW9ucy5vbkFQSUVycm9yPy5lcnJvclVSTCB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICAgIHRocm93IGMucmVkaXJlY3QoYCR7ZXJyb3JVUkx9P2Vycm9yPXN0YXRlX21pc21hdGNoYCk7XG4gIH1cbiAgYy5zZXRDb29raWUoc3RhdGVDb29raWUubmFtZSwgXCJcIiwge1xuICAgIG1heEFnZTogMFxuICB9KTtcbiAgaWYgKHBhcnNlZERhdGEuZXhwaXJlc0F0IDwgRGF0ZS5ub3coKSkge1xuICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoZGF0YS5pZCk7XG4gICAgY29uc3QgZXJyb3JVUkwgPSBjLmNvbnRleHQub3B0aW9ucy5vbkFQSUVycm9yPy5lcnJvclVSTCB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICAgIHRocm93IGMucmVkaXJlY3QoYCR7ZXJyb3JVUkx9P2Vycm9yPXBsZWFzZV9yZXN0YXJ0X3RoZV9wcm9jZXNzYCk7XG4gIH1cbiAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShkYXRhLmlkKTtcbiAgcmV0dXJuIHBhcnNlZERhdGE7XG59XG5cbmZ1bmN0aW9uIGRlY3J5cHRPQXV0aFRva2VuKHRva2VuLCBjdHgpIHtcbiAgaWYgKCF0b2tlbikgcmV0dXJuIHRva2VuO1xuICBpZiAoY3R4Lm9wdGlvbnMuYWNjb3VudD8uZW5jcnlwdE9BdXRoVG9rZW5zKSB7XG4gICAgcmV0dXJuIHN5bW1ldHJpY0RlY3J5cHQoe1xuICAgICAga2V5OiBjdHguc2VjcmV0LFxuICAgICAgZGF0YTogdG9rZW5cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdG9rZW47XG59XG5mdW5jdGlvbiBzZXRUb2tlblV0aWwodG9rZW4sIGN0eCkge1xuICBpZiAoY3R4Lm9wdGlvbnMuYWNjb3VudD8uZW5jcnlwdE9BdXRoVG9rZW5zICYmIHRva2VuKSB7XG4gICAgcmV0dXJuIHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgICAga2V5OiBjdHguc2VjcmV0LFxuICAgICAgZGF0YTogdG9rZW5cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdG9rZW47XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZU9BdXRoVXNlckluZm8oYywge1xuICB1c2VySW5mbyxcbiAgYWNjb3VudCxcbiAgY2FsbGJhY2tVUkwsXG4gIGRpc2FibGVTaWduVXAsXG4gIG92ZXJyaWRlVXNlckluZm9cbn0pIHtcbiAgY29uc3QgZGJVc2VyID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kT0F1dGhVc2VyKFxuICAgIHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgYWNjb3VudC5hY2NvdW50SWQsXG4gICAgYWNjb3VudC5wcm92aWRlcklkXG4gICkuY2F0Y2goKGUpID0+IHtcbiAgICBsb2dnZXIuZXJyb3IoXG4gICAgICBcIkJldHRlciBhdXRoIHdhcyB1bmFibGUgdG8gcXVlcnkgeW91ciBkYXRhYmFzZS5cXG5FcnJvcjogXCIsXG4gICAgICBlXG4gICAgKTtcbiAgICBjb25zdCBlcnJvclVSTCA9IGMuY29udGV4dC5vcHRpb25zLm9uQVBJRXJyb3I/LmVycm9yVVJMIHx8IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gICAgdGhyb3cgYy5yZWRpcmVjdChgJHtlcnJvclVSTH0/ZXJyb3I9aW50ZXJuYWxfc2VydmVyX2Vycm9yYCk7XG4gIH0pO1xuICBsZXQgdXNlciA9IGRiVXNlcj8udXNlcjtcbiAgbGV0IGlzUmVnaXN0ZXIgPSAhdXNlcjtcbiAgaWYgKGRiVXNlcikge1xuICAgIGNvbnN0IGhhc0JlZW5MaW5rZWQgPSBkYlVzZXIuYWNjb3VudHMuZmluZChcbiAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IGFjY291bnQucHJvdmlkZXJJZCAmJiBhLmFjY291bnRJZCA9PT0gYWNjb3VudC5hY2NvdW50SWRcbiAgICApO1xuICAgIGlmICghaGFzQmVlbkxpbmtlZCkge1xuICAgICAgY29uc3QgdHJ1c3RlZFByb3ZpZGVycyA9IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzO1xuICAgICAgY29uc3QgaXNUcnVzdGVkUHJvdmlkZXIgPSB0cnVzdGVkUHJvdmlkZXJzPy5pbmNsdWRlcyhcbiAgICAgICAgYWNjb3VudC5wcm92aWRlcklkXG4gICAgICApO1xuICAgICAgaWYgKCFpc1RydXN0ZWRQcm92aWRlciAmJiAhdXNlckluZm8uZW1haWxWZXJpZmllZCB8fCBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uZW5hYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGlzRGV2ZWxvcG1lbnQoKSkge1xuICAgICAgICAgIGxvZ2dlci53YXJuKFxuICAgICAgICAgICAgYFVzZXIgYWxyZWFkeSBleGlzdCBidXQgYWNjb3VudCBpc24ndCBsaW5rZWQgdG8gJHthY2NvdW50LnByb3ZpZGVySWR9LiBUbyByZWFkIG1vcmUgYWJvdXQgaG93IGFjY291bnQgbGlua2luZyB3b3JrcyBpbiBCZXR0ZXIgQXV0aCBzZWUgaHR0cHM6Ly93d3cuYmV0dGVyLWF1dGguY29tL2RvY3MvY29uY2VwdHMvdXNlcnMtYWNjb3VudHMjYWNjb3VudC1saW5raW5nLmBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZXJyb3I6IFwiYWNjb3VudCBub3QgbGlua2VkXCIsXG4gICAgICAgICAgZGF0YTogbnVsbFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudChcbiAgICAgICAgICB7XG4gICAgICAgICAgICBwcm92aWRlcklkOiBhY2NvdW50LnByb3ZpZGVySWQsXG4gICAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLmlkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICB1c2VySWQ6IGRiVXNlci51c2VyLmlkLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChhY2NvdW50LmFjY2Vzc1Rva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5yZWZyZXNoVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgICBpZFRva2VuOiBhY2NvdW50LmlkVG9rZW4sXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5yZWZyZXNoVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICBzY29wZTogYWNjb3VudC5zY29wZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgY1xuICAgICAgICApO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJVbmFibGUgdG8gbGluayBhY2NvdW50XCIsIGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBcInVuYWJsZSB0byBsaW5rIGFjY291bnRcIixcbiAgICAgICAgICBkYXRhOiBudWxsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAodXNlckluZm8uZW1haWxWZXJpZmllZCAmJiAhZGJVc2VyLnVzZXIuZW1haWxWZXJpZmllZCAmJiB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpID09PSBkYlVzZXIudXNlci5lbWFpbCkge1xuICAgICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoZGJVc2VyLnVzZXIuaWQsIHtcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8udXBkYXRlQWNjb3VudE9uU2lnbkluICE9PSBmYWxzZSkge1xuICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHtcbiAgICAgICAgICAgIGlkVG9rZW46IGFjY291bnQuaWRUb2tlbixcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGVcbiAgICAgICAgICB9KS5maWx0ZXIoKFtfLCB2YWx1ZV0pID0+IHZhbHVlICE9PSB2b2lkIDApXG4gICAgICAgICk7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh1cGRhdGVEYXRhKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVBY2NvdW50KFxuICAgICAgICAgICAgaGFzQmVlbkxpbmtlZC5pZCxcbiAgICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgICBjXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgJiYgIWRiVXNlci51c2VyLmVtYWlsVmVyaWZpZWQgJiYgdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSA9PT0gZGJVc2VyLnVzZXIuZW1haWwpIHtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKGRiVXNlci51c2VyLmlkLCB7XG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG92ZXJyaWRlVXNlckluZm8pIHtcbiAgICAgIGNvbnN0IHsgaWQ6IF8sIC4uLnJlc3RVc2VySW5mbyB9ID0gdXNlckluZm87XG4gICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoZGJVc2VyLnVzZXIuaWQsIHtcbiAgICAgICAgLi4ucmVzdFVzZXJJbmZvLFxuICAgICAgICBlbWFpbDogdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSA9PT0gZGJVc2VyLnVzZXIuZW1haWwgPyBkYlVzZXIudXNlci5lbWFpbFZlcmlmaWVkIHx8IHVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgOiB1c2VySW5mby5lbWFpbFZlcmlmaWVkXG4gICAgICB9KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGRpc2FibGVTaWduVXApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yOiBcInNpZ251cCBkaXNhYmxlZFwiLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgICAgfTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgaWQ6IF8sIC4uLnJlc3RVc2VySW5mbyB9ID0gdXNlckluZm87XG4gICAgICB1c2VyID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVPQXV0aFVzZXIoXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5yZXN0VXNlckluZm8sXG4gICAgICAgICAgZW1haWw6IHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKClcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChhY2NvdW50LnJlZnJlc2hUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICBpZFRva2VuOiBhY2NvdW50LmlkVG9rZW4sXG4gICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiBhY2NvdW50LnJlZnJlc2hUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICBzY29wZTogYWNjb3VudC5zY29wZSxcbiAgICAgICAgICBwcm92aWRlcklkOiBhY2NvdW50LnByb3ZpZGVySWQsXG4gICAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZC50b1N0cmluZygpXG4gICAgICAgIH0sXG4gICAgICAgIGNcbiAgICAgICkudGhlbigocmVzKSA9PiByZXM/LnVzZXIpO1xuICAgICAgaWYgKCF1c2VySW5mby5lbWFpbFZlcmlmaWVkICYmIHVzZXIgJiYgYy5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRPblNpZ25VcCkge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgICAgYy5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICB1c2VyLmVtYWlsLFxuICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICBjLmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke2MuY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtjYWxsYmFja1VSTH1gO1xuICAgICAgICBhd2FpdCBjLmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsPy4oXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHRva2VuXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjLnJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoZSk7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZXJyb3I6IGUubWVzc2FnZSxcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlcnJvcjogXCJ1bmFibGUgdG8gY3JlYXRlIHVzZXJcIixcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiB7XG4gICAgICBlcnJvcjogXCJ1bmFibGUgdG8gY3JlYXRlIHVzZXJcIixcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgIH07XG4gIH1cbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbih1c2VyLmlkLCBjKTtcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiBcInVuYWJsZSB0byBjcmVhdGUgc2Vzc2lvblwiLFxuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb24sXG4gICAgICB1c2VyXG4gICAgfSxcbiAgICBlcnJvcjogbnVsbCxcbiAgICBpc1JlZ2lzdGVyXG4gIH07XG59XG5cbmNvbnN0IHNpZ25JblNvY2lhbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2lnbi1pbi9zb2NpYWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBDYWxsYmFjayBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHVzZXJcbiAgICAgICAqIGhhcyBzaWduZWQgaW4uXG4gICAgICAgKi9cbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDYWxsYmFjayBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHVzZXIgaGFzIHNpZ25lZCBpblwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBjYWxsYmFjayB1cmwgdG8gcmVkaXJlY3QgaWYgdGhlIHVzZXIgaXMgbmV3bHkgcmVnaXN0ZXJlZC5cbiAgICAgICAqXG4gICAgICAgKiB1c2VmdWwgaWYgeW91IGhhdmUgZGlmZmVyZW50IHJvdXRlcyBmb3IgZXhpc3RpbmcgdXNlcnMgYW5kIG5ldyB1c2Vyc1xuICAgICAgICovXG4gICAgICBuZXdVc2VyQ2FsbGJhY2tVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgdXJsIHRvIHJlZGlyZWN0IHRvIGlmIGFuIGVycm9yIGhhcHBlbnNcbiAgICAgICAqXG4gICAgICAgKiBJZiBpdCdzIGluaXRpYXRlZCBmcm9tIHRoZSBjbGllbnQgc2RrIHRoaXMgZGVmYXVsdHMgdG9cbiAgICAgICAqIHRoZSBjdXJyZW50IHVybC5cbiAgICAgICAqL1xuICAgICAgZXJyb3JDYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIGFuIGVycm9yIGhhcHBlbnNcIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT0F1dGgyIHByb3ZpZGVyIHRvIHVzZWBcbiAgICAgICAqL1xuICAgICAgcHJvdmlkZXI6IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0sXG4gICAgICAvKipcbiAgICAgICAqIERpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlclxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIGhhbmRsZSB0aGUgcmVkaXJlY3Rpb25cbiAgICAgICAqIHlvdXJzZWxmIGxpa2UgaW4gYSBwb3B1cCBvciBhIGRpZmZlcmVudCB0YWIuXG4gICAgICAgKi9cbiAgICAgIGRpc2FibGVSZWRpcmVjdDogei5ib29sZWFuKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlci4gVXNlZnVsIGZvciBoYW5kbGluZyB0aGUgcmVkaXJlY3Rpb24geW91cnNlbGZcIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogSUQgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAqXG4gICAgICAgKiBUaGlzIGlzIHVzZWQgdG8gc2lnbiBpbiB0aGUgdXNlclxuICAgICAgICogaWYgdGhlIHVzZXIgaXMgYWxyZWFkeSBzaWduZWQgaW4gd2l0aCB0aGVcbiAgICAgICAqIHByb3ZpZGVyIGluIHRoZSBmcm9udGVuZC5cbiAgICAgICAqXG4gICAgICAgKiBPbmx5IGFwcGxpY2FibGUgaWYgdGhlIHByb3ZpZGVyIHN1cHBvcnRzXG4gICAgICAgKiBpdC4gQ3VycmVudGx5IG9ubHkgYGFwcGxlYCBhbmQgYGdvb2dsZWAgaXNcbiAgICAgICAqIHN1cHBvcnRlZCBvdXQgb2YgdGhlIGJveC5cbiAgICAgICAqL1xuICAgICAgaWRUb2tlbjogei5vcHRpb25hbChcbiAgICAgICAgei5vYmplY3Qoe1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIElEIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXG4gICAgICAgICAgICovXG4gICAgICAgICAgdG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICAgICAgfSksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogVGhlIG5vbmNlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIHRva2VuXG4gICAgICAgICAgICovXG4gICAgICAgICAgbm9uY2U6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJOb25jZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSB0b2tlblwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBBY2Nlc3MgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBhY2Nlc3NUb2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkFjY2VzcyB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBSZWZyZXNoIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXG4gICAgICAgICAgICovXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUmVmcmVzaCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBFeHBpcnkgZGF0ZSBvZiB0aGUgdG9rZW5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBleHBpcmVzQXQ6IHoubnVtYmVyKCkubWV0YSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFeHBpcnkgZGF0ZSBvZiB0aGUgdG9rZW5cIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICBzY29wZXM6IHouYXJyYXkoei5zdHJpbmcoKSkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkFycmF5IG9mIHNjb3BlcyB0byByZXF1ZXN0IGZyb20gdGhlIHByb3ZpZGVyLiBUaGlzIHdpbGwgb3ZlcnJpZGUgdGhlIGRlZmF1bHQgc2NvcGVzIHBhc3NlZC5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogRXhwbGljaXRseSByZXF1ZXN0IHNpZ24tdXBcbiAgICAgICAqXG4gICAgICAgKiBTaG91bGQgYmUgdXNlZCB0byBhbGxvdyBzaWduIHVwIHdoZW5cbiAgICAgICAqIGRpc2FibGVJbXBsaWNpdFNpZ25VcCBmb3IgdGhpcyBwcm92aWRlciBpc1xuICAgICAgICogdHJ1ZVxuICAgICAgICovXG4gICAgICByZXF1ZXN0U2lnblVwOiB6LmJvb2xlYW4oKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRXhwbGljaXRseSByZXF1ZXN0IHNpZ24tdXAuIFVzZWZ1bCB3aGVuIGRpc2FibGVJbXBsaWNpdFNpZ25VcCBpcyB0cnVlIGZvciB0aGlzIHByb3ZpZGVyXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBsb2dpbiBoaW50IHRvIHVzZSBmb3IgdGhlIGF1dGhvcml6YXRpb24gY29kZSByZXF1ZXN0XG4gICAgICAgKi9cbiAgICAgIGxvZ2luSGludDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGxvZ2luIGhpbnQgdG8gdXNlIGZvciB0aGUgYXV0aG9yaXphdGlvbiBjb2RlIHJlcXVlc3RcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gaW4gd2l0aCBhIHNvY2lhbCBwcm92aWRlclwiLFxuICAgICAgICBvcGVyYXRpb25JZDogXCJzb2NpYWxTaWduSW5cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2VzcyAtIFJldHVybnMgZWl0aGVyIHNlc3Npb24gZGV0YWlscyBvciByZWRpcmVjdCBVUkxcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIC8vIHRvZG86IHdlIG5lZWQgc3VwcG9ydCBmb3IgbXVsdGlwbGUgc2NoZW1hXG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2Vzc2lvbiByZXNwb25zZSB3aGVuIGlkVG9rZW4gaXMgcHJvdmlkZWRcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbZmFsc2VdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXNzaW9uIHRva2VuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm51bGxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxWZXJpZmllZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInJlZGlyZWN0XCIsIFwidG9rZW5cIiwgXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gYy5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IGMuYm9keS5wcm92aWRlclxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJQcm92aWRlciBub3QgZm91bmQuIE1ha2Ugc3VyZSB0byBhZGQgdGhlIHByb3ZpZGVyIGluIHlvdXIgYXV0aCBjb25maWdcIixcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUFJPVklERVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGMuYm9keS5pZFRva2VuKSB7XG4gICAgICBpZiAoIXByb3ZpZGVyLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIlByb3ZpZGVyIGRvZXMgbm90IHN1cHBvcnQgaWQgdG9rZW4gdmVyaWZpY2F0aW9uXCIsXG4gICAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklEX1RPS0VOX05PVF9TVVBQT1JURURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB7IHRva2VuLCBub25jZSB9ID0gYy5ib2R5LmlkVG9rZW47XG4gICAgICBjb25zdCB2YWxpZCA9IGF3YWl0IHByb3ZpZGVyLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIGlmICghdmFsaWQpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkludmFsaWQgaWQgdG9rZW5cIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlckluZm8gPSBhd2FpdCBwcm92aWRlci5nZXRVc2VySW5mbyh7XG4gICAgICAgIGlkVG9rZW46IHRva2VuLFxuICAgICAgICBhY2Nlc3NUb2tlbjogYy5ib2R5LmlkVG9rZW4uYWNjZXNzVG9rZW4sXG4gICAgICAgIHJlZnJlc2hUb2tlbjogYy5ib2R5LmlkVG9rZW4ucmVmcmVzaFRva2VuXG4gICAgICB9KTtcbiAgICAgIGlmICghdXNlckluZm8gfHwgIXVzZXJJbmZvPy51c2VyKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IHVzZXIgaW5mb1wiLCB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfVVNFUl9JTkZPXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKCF1c2VySW5mby51c2VyLmVtYWlsKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VyIGVtYWlsIG5vdCBmb3VuZFwiLCB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfRU1BSUxfTk9UX0ZPVU5EXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGhhbmRsZU9BdXRoVXNlckluZm8oYywge1xuICAgICAgICB1c2VySW5mbzoge1xuICAgICAgICAgIC4uLnVzZXJJbmZvLnVzZXIsXG4gICAgICAgICAgZW1haWw6IHVzZXJJbmZvLnVzZXIuZW1haWwsXG4gICAgICAgICAgaWQ6IFN0cmluZyh1c2VySW5mby51c2VyLmlkKSxcbiAgICAgICAgICBuYW1lOiB1c2VySW5mby51c2VyLm5hbWUgfHwgXCJcIixcbiAgICAgICAgICBpbWFnZTogdXNlckluZm8udXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby51c2VyLmVtYWlsVmVyaWZpZWQgfHwgZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgYWNjb3VudDoge1xuICAgICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICAgIGFjY291bnRJZDogU3RyaW5nKHVzZXJJbmZvLnVzZXIuaWQpLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlblxuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFja1VSTDogYy5ib2R5LmNhbGxiYWNrVVJMLFxuICAgICAgICBkaXNhYmxlU2lnblVwOiBwcm92aWRlci5kaXNhYmxlSW1wbGljaXRTaWduVXAgJiYgIWMuYm9keS5yZXF1ZXN0U2lnblVwIHx8IHByb3ZpZGVyLmRpc2FibGVTaWduVXBcbiAgICAgIH0pO1xuICAgICAgaWYgKGRhdGEuZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBkYXRhLmVycm9yXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjLCBkYXRhLmRhdGEpO1xuICAgICAgcmV0dXJuIGMuanNvbih7XG4gICAgICAgIHJlZGlyZWN0OiBmYWxzZSxcbiAgICAgICAgdG9rZW46IGRhdGEuZGF0YS5zZXNzaW9uLnRva2VuLFxuICAgICAgICB1cmw6IHZvaWQgMCxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBkYXRhLmRhdGEudXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogZGF0YS5kYXRhLnVzZXIuZW1haWwsXG4gICAgICAgICAgbmFtZTogZGF0YS5kYXRhLnVzZXIubmFtZSxcbiAgICAgICAgICBpbWFnZTogZGF0YS5kYXRhLnVzZXIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZGF0YS5kYXRhLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGRhdGEuZGF0YS51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IGRhdGEuZGF0YS51c2VyLnVwZGF0ZWRBdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBjb2RlVmVyaWZpZXIsIHN0YXRlIH0gPSBhd2FpdCBnZW5lcmF0ZVN0YXRlKGMpO1xuICAgIGNvbnN0IHVybCA9IGF3YWl0IHByb3ZpZGVyLmNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGUsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSTogYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2NhbGxiYWNrLyR7cHJvdmlkZXIuaWR9YCxcbiAgICAgIHNjb3BlczogYy5ib2R5LnNjb3BlcyxcbiAgICAgIGxvZ2luSGludDogYy5ib2R5LmxvZ2luSGludFxuICAgIH0pO1xuICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgdXJsOiB1cmwudG9TdHJpbmcoKSxcbiAgICAgIHJlZGlyZWN0OiAhYy5ib2R5LmRpc2FibGVSZWRpcmVjdFxuICAgIH0pO1xuICB9XG4pO1xuY29uc3Qgc2lnbkluRW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NpZ24taW4vZW1haWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBFbWFpbCBvZiB0aGUgdXNlclxuICAgICAgICovXG4gICAgICBlbWFpbDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgb2YgdGhlIHVzZXJcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIFBhc3N3b3JkIG9mIHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIHBhc3N3b3JkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJQYXNzd29yZCBvZiB0aGUgdXNlclwiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgVVJMIHRvIHVzZSBhcyBhIHJlZGlyZWN0IGZvciBlbWFpbFxuICAgICAgICogdmVyaWZpY2F0aW9uIGFuZCBmb3IgcG9zc2libGUgcmVkaXJlY3RzXG4gICAgICAgKi9cbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDYWxsYmFjayBVUkwgdG8gdXNlIGFzIGEgcmVkaXJlY3QgZm9yIGVtYWlsIHZlcmlmaWNhdGlvblwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBJZiB0aGlzIGlzIGZhbHNlLCB0aGUgc2Vzc2lvbiB3aWxsIG5vdCBiZSByZW1lbWJlcmVkXG4gICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgKi9cbiAgICAgIHJlbWVtYmVyTWU6IHouYm9vbGVhbigpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJJZiB0aGlzIGlzIGZhbHNlLCB0aGUgc2Vzc2lvbiB3aWxsIG5vdCBiZSByZW1lbWJlcmVkLiBEZWZhdWx0IGlzIGB0cnVlYC5cIlxuICAgICAgfSkuZGVmYXVsdCh0cnVlKS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZFwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzIC0gUmV0dXJucyBlaXRoZXIgc2Vzc2lvbiBkZXRhaWxzIG9yIHJlZGlyZWN0IFVSTFwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgLy8gdG9kbzogd2UgbmVlZCBzdXBwb3J0IGZvciBtdWx0aXBsZSBzY2hlbWFcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXNzaW9uIHJlc3BvbnNlIHdoZW4gaWRUb2tlbiBpcyBwcm92aWRlZFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGVudW06IFtmYWxzZV1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlc3Npb24gdG9rZW5cIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm51bGxcIixcbiAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsVmVyaWZpZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiXG4gICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInJlZGlyZWN0XCIsIFwidG9rZW5cIiwgXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbEFuZFBhc3N3b3JkPy5lbmFibGVkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiRW1haWwgYW5kIHBhc3N3b3JkIGlzIG5vdCBlbmFibGVkLiBNYWtlIHN1cmUgdG8gZW5hYmxlIGl0IGluIHRoZSBvcHRpb25zIG9uIHlvdSBgYXV0aC50c2AgZmlsZS4gQ2hlY2sgYGh0dHBzOi8vYmV0dGVyLWF1dGguY29tL2RvY3MvYXV0aGVudGljYXRpb24vZW1haWwtcGFzc3dvcmRgIGZvciBtb3JlIVwiXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGFuZCBwYXNzd29yZCBpcyBub3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IGlzVmFsaWRFbWFpbCA9IHouc3RyaW5nKCkuZW1haWwoKS5zYWZlUGFyc2UoZW1haWwpO1xuICAgIGlmICghaXNWYWxpZEVtYWlsLnN1Y2Nlc3MpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwsIHtcbiAgICAgIGluY2x1ZGVBY2NvdW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGlmICghdXNlcikge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChwYXNzd29yZCk7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VyIG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSB1c2VyLmFjY291bnRzLmZpbmQoXG4gICAgICAoYSkgPT4gYS5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIlxuICAgICk7XG4gICAgaWYgKCFjcmVkZW50aWFsQWNjb3VudCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiQ3JlZGVudGlhbCBhY2NvdW50IG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3VycmVudFBhc3N3b3JkID0gY3JlZGVudGlhbEFjY291bnQ/LnBhc3N3b3JkO1xuICAgIGlmICghY3VycmVudFBhc3N3b3JkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHZhbGlkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgICAgcGFzc3dvcmRcbiAgICB9KTtcbiAgICBpZiAoIXZhbGlkUGFzc3dvcmQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkludmFsaWQgcGFzc3dvcmRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucz8uZW1haWxBbmRQYXNzd29yZD8ucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uICYmICF1c2VyLnVzZXIuZW1haWxWZXJpZmllZCkge1xuICAgICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5FTUFJTF9OT1RfVkVSSUZJRURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucz8uZW1haWxWZXJpZmljYXRpb24/LnNlbmRPblNpZ25Jbikge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIHVzZXIudXNlci5lbWFpbCxcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXI6IHVzZXIudXNlcixcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHRva2VuXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5FTUFJTF9OT1RfVkVSSUZJRURcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICB1c2VyLnVzZXIuaWQsXG4gICAgICBjdHgsXG4gICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoXG4gICAgICBjdHgsXG4gICAgICB7XG4gICAgICAgIHNlc3Npb24sXG4gICAgICAgIHVzZXI6IHVzZXIudXNlclxuICAgICAgfSxcbiAgICAgIGN0eC5ib2R5LnJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgcmVkaXJlY3Q6ICEhY3R4LmJvZHkuY2FsbGJhY2tVUkwsXG4gICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgIHVybDogY3R4LmJvZHkuY2FsbGJhY2tVUkwsXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiB1c2VyLnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiB1c2VyLnVzZXIuZW1haWwsXG4gICAgICAgIG5hbWU6IHVzZXIudXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogdXNlci51c2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgY3JlYXRlZEF0OiB1c2VyLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IHVzZXIudXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcblxuY29uc3Qgc2NoZW1hID0gei5vYmplY3Qoe1xuICBjb2RlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGVycm9yOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGRldmljZV9pZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBlcnJvcl9kZXNjcmlwdGlvbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBzdGF0ZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB1c2VyOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xuY29uc3QgY2FsbGJhY2tPQXV0aCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2FsbGJhY2svOmlkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFtcIkdFVFwiLCBcIlBPU1RcIl0sXG4gICAgYm9keTogc2NoZW1hLm9wdGlvbmFsKCksXG4gICAgcXVlcnk6IHNjaGVtYS5vcHRpb25hbCgpLFxuICAgIG1ldGFkYXRhOiBISURFX01FVEFEQVRBXG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgbGV0IHF1ZXJ5T3JCb2R5O1xuICAgIGNvbnN0IGRlZmF1bHRFcnJvclVSTCA9IGMuY29udGV4dC5vcHRpb25zLm9uQVBJRXJyb3I/LmVycm9yVVJMIHx8IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChjLm1ldGhvZCA9PT0gXCJHRVRcIikge1xuICAgICAgICBxdWVyeU9yQm9keSA9IHNjaGVtYS5wYXJzZShjLnF1ZXJ5KTtcbiAgICAgIH0gZWxzZSBpZiAoYy5tZXRob2QgPT09IFwiUE9TVFwiKSB7XG4gICAgICAgIHF1ZXJ5T3JCb2R5ID0gc2NoZW1hLnBhcnNlKGMuYm9keSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbnN1cHBvcnRlZCBtZXRob2RcIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIklOVkFMSURfQ0FMTEJBQ0tfUkVRVUVTVFwiLCBlKTtcbiAgICAgIHRocm93IGMucmVkaXJlY3QoYCR7ZGVmYXVsdEVycm9yVVJMfT9lcnJvcj1pbnZhbGlkX2NhbGxiYWNrX3JlcXVlc3RgKTtcbiAgICB9XG4gICAgY29uc3QgeyBjb2RlLCBlcnJvciwgc3RhdGUsIGVycm9yX2Rlc2NyaXB0aW9uLCBkZXZpY2VfaWQgfSA9IHF1ZXJ5T3JCb2R5O1xuICAgIGlmICghc3RhdGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJTdGF0ZSBub3QgZm91bmRcIiwgZXJyb3IpO1xuICAgICAgY29uc3Qgc2VwID0gZGVmYXVsdEVycm9yVVJMLmluY2x1ZGVzKFwiP1wiKSA/IFwiJlwiIDogXCI/XCI7XG4gICAgICBjb25zdCB1cmwgPSBgJHtkZWZhdWx0RXJyb3JVUkx9JHtzZXB9c3RhdGU9c3RhdGVfbm90X2ZvdW5kYDtcbiAgICAgIHRocm93IGMucmVkaXJlY3QodXJsKTtcbiAgICB9XG4gICAgY29uc3Qge1xuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgY2FsbGJhY2tVUkwsXG4gICAgICBsaW5rLFxuICAgICAgZXJyb3JVUkwsXG4gICAgICBuZXdVc2VyVVJMLFxuICAgICAgcmVxdWVzdFNpZ25VcFxuICAgIH0gPSBhd2FpdCBwYXJzZVN0YXRlKGMpO1xuICAgIGZ1bmN0aW9uIHJlZGlyZWN0T25FcnJvcihlcnJvcjIsIGRlc2NyaXB0aW9uKSB7XG4gICAgICBjb25zdCBiYXNlVVJMID0gZXJyb3JVUkwgPz8gZGVmYXVsdEVycm9yVVJMO1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7IGVycm9yOiBlcnJvcjIgfSk7XG4gICAgICBpZiAoZGVzY3JpcHRpb24pIHBhcmFtcy5zZXQoXCJlcnJvcl9kZXNjcmlwdGlvblwiLCBkZXNjcmlwdGlvbik7XG4gICAgICBjb25zdCBzZXAgPSBiYXNlVVJMLmluY2x1ZGVzKFwiP1wiKSA/IFwiJlwiIDogXCI/XCI7XG4gICAgICBjb25zdCB1cmwgPSBgJHtiYXNlVVJMfSR7c2VwfSR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcbiAgICAgIHRocm93IGMucmVkaXJlY3QodXJsKTtcbiAgICB9XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZWRpcmVjdE9uRXJyb3IoZXJyb3IsIGVycm9yX2Rlc2NyaXB0aW9uKTtcbiAgICB9XG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiQ29kZSBub3QgZm91bmRcIik7XG4gICAgICB0aHJvdyByZWRpcmVjdE9uRXJyb3IoXCJub19jb2RlXCIpO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLnBhcmFtcy5pZFxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJPYXV0aCBwcm92aWRlciB3aXRoIGlkXCIsXG4gICAgICAgIGMucGFyYW1zLmlkLFxuICAgICAgICBcIm5vdCBmb3VuZFwiXG4gICAgICApO1xuICAgICAgdGhyb3cgcmVkaXJlY3RPbkVycm9yKFwib2F1dGhfcHJvdmlkZXJfbm90X2ZvdW5kXCIpO1xuICAgIH1cbiAgICBsZXQgdG9rZW5zO1xuICAgIHRyeSB7XG4gICAgICB0b2tlbnMgPSBhd2FpdCBwcm92aWRlci52YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBkZXZpY2VJZDogZGV2aWNlX2lkLFxuICAgICAgICByZWRpcmVjdFVSSTogYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2NhbGxiYWNrLyR7cHJvdmlkZXIuaWR9YFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlwiLCBlKTtcbiAgICAgIHRocm93IHJlZGlyZWN0T25FcnJvcihcImludmFsaWRfY29kZVwiKTtcbiAgICB9XG4gICAgY29uc3QgdXNlckluZm8gPSBhd2FpdCBwcm92aWRlci5nZXRVc2VySW5mbyh7XG4gICAgICAuLi50b2tlbnMsXG4gICAgICB1c2VyOiBjLmJvZHk/LnVzZXIgPyBzYWZlSlNPTlBhcnNlKGMuYm9keS51c2VyKSA6IHZvaWQgMFxuICAgIH0pLnRoZW4oKHJlcykgPT4gcmVzPy51c2VyKTtcbiAgICBpZiAoIXVzZXJJbmZvKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVW5hYmxlIHRvIGdldCB1c2VyIGluZm9cIik7XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hYmxlX3RvX2dldF91c2VyX2luZm9cIik7XG4gICAgfVxuICAgIGlmICghY2FsbGJhY2tVUkwpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJObyBjYWxsYmFjayBVUkwgZm91bmRcIik7XG4gICAgICB0aHJvdyByZWRpcmVjdE9uRXJyb3IoXCJub19jYWxsYmFja191cmxcIik7XG4gICAgfVxuICAgIGlmIChsaW5rKSB7XG4gICAgICBjb25zdCB0cnVzdGVkUHJvdmlkZXJzID0gYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnRydXN0ZWRQcm92aWRlcnM7XG4gICAgICBjb25zdCBpc1RydXN0ZWRQcm92aWRlciA9IHRydXN0ZWRQcm92aWRlcnM/LmluY2x1ZGVzKFxuICAgICAgICBwcm92aWRlci5pZFxuICAgICAgKTtcbiAgICAgIGlmICghaXNUcnVzdGVkUHJvdmlkZXIgJiYgIXVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgfHwgYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmVuYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVbmFibGUgdG8gbGluayBhY2NvdW50IC0gdW50cnVzdGVkIHByb3ZpZGVyXCIpO1xuICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hYmxlX3RvX2xpbmtfYWNjb3VudFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICh1c2VySW5mby5lbWFpbCAhPT0gbGluay5lbWFpbCAmJiBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uYWxsb3dEaWZmZXJlbnRFbWFpbHMgIT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImVtYWlsX2RvZXNuJ3RfbWF0Y2hcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBleGlzdGluZ0FjY291bnQgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50KFxuICAgICAgICBTdHJpbmcodXNlckluZm8uaWQpXG4gICAgICApO1xuICAgICAgaWYgKGV4aXN0aW5nQWNjb3VudCkge1xuICAgICAgICBpZiAoZXhpc3RpbmdBY2NvdW50LnVzZXJJZC50b1N0cmluZygpICE9PSBsaW5rLnVzZXJJZC50b1N0cmluZygpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImFjY291bnRfYWxyZWFkeV9saW5rZWRfdG9fZGlmZmVyZW50X3VzZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgICBPYmplY3QuZW50cmllcyh7XG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKHRva2Vucy5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKHRva2Vucy5yZWZyZXNoVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgICBpZFRva2VuOiB0b2tlbnMuaWRUb2tlbixcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB0b2tlbnMuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHRva2Vucy5yZWZyZXNoVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICBzY29wZTogdG9rZW5zLnNjb3Blcz8uam9pbihcIixcIilcbiAgICAgICAgICB9KS5maWx0ZXIoKFtfLCB2YWx1ZV0pID0+IHZhbHVlICE9PSB2b2lkIDApXG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChcbiAgICAgICAgICBleGlzdGluZ0FjY291bnQuaWQsXG4gICAgICAgICAgdXBkYXRlRGF0YVxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbmV3QWNjb3VudCA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlQWNjb3VudChcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VySWQ6IGxpbmsudXNlcklkLFxuICAgICAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIuaWQsXG4gICAgICAgICAgICBhY2NvdW50SWQ6IFN0cmluZyh1c2VySW5mby5pZCksXG4gICAgICAgICAgICAuLi50b2tlbnMsXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKHRva2Vucy5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKHRva2Vucy5yZWZyZXNoVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgICBzY29wZTogdG9rZW5zLnNjb3Blcz8uam9pbihcIixcIilcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFuZXdBY2NvdW50KSB7XG4gICAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYWJsZV90b19saW5rX2FjY291bnRcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGxldCB0b1JlZGlyZWN0VG8yO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXJsID0gY2FsbGJhY2tVUkw7XG4gICAgICAgIHRvUmVkaXJlY3RUbzIgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICB0b1JlZGlyZWN0VG8yID0gY2FsbGJhY2tVUkw7XG4gICAgICB9XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KHRvUmVkaXJlY3RUbzIpO1xuICAgIH1cbiAgICBpZiAoIXVzZXJJbmZvLmVtYWlsKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlByb3ZpZGVyIGRpZCBub3QgcmV0dXJuIGVtYWlsLiBUaGlzIGNvdWxkIGJlIGR1ZSB0byBtaXNjb25maWd1cmF0aW9uIGluIHRoZSBwcm92aWRlciBzZXR0aW5ncy5cIlxuICAgICAgKTtcbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJlbWFpbF9ub3RfZm91bmRcIik7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZU9BdXRoVXNlckluZm8oYywge1xuICAgICAgdXNlckluZm86IHtcbiAgICAgICAgLi4udXNlckluZm8sXG4gICAgICAgIGlkOiBTdHJpbmcodXNlckluZm8uaWQpLFxuICAgICAgICBlbWFpbDogdXNlckluZm8uZW1haWwsXG4gICAgICAgIG5hbWU6IHVzZXJJbmZvLm5hbWUgfHwgdXNlckluZm8uZW1haWxcbiAgICAgIH0sXG4gICAgICBhY2NvdW50OiB7XG4gICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICBhY2NvdW50SWQ6IFN0cmluZyh1c2VySW5mby5pZCksXG4gICAgICAgIC4uLnRva2VucyxcbiAgICAgICAgc2NvcGU6IHRva2Vucy5zY29wZXM/LmpvaW4oXCIsXCIpXG4gICAgICB9LFxuICAgICAgY2FsbGJhY2tVUkwsXG4gICAgICBkaXNhYmxlU2lnblVwOiBwcm92aWRlci5kaXNhYmxlSW1wbGljaXRTaWduVXAgJiYgIXJlcXVlc3RTaWduVXAgfHwgcHJvdmlkZXIub3B0aW9ucz8uZGlzYWJsZVNpZ25VcCxcbiAgICAgIG92ZXJyaWRlVXNlckluZm86IHByb3ZpZGVyLm9wdGlvbnM/Lm92ZXJyaWRlVXNlckluZm9PblNpZ25JblxuICAgIH0pO1xuICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IocmVzdWx0LmVycm9yLnNwbGl0KFwiIFwiKS5qb2luKFwiX1wiKSk7XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKHJlc3VsdC5lcnJvci5zcGxpdChcIiBcIikuam9pbihcIl9cIikpO1xuICAgIH1cbiAgICBjb25zdCB7IHNlc3Npb24sIHVzZXIgfSA9IHJlc3VsdC5kYXRhO1xuICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoYywge1xuICAgICAgc2Vzc2lvbixcbiAgICAgIHVzZXJcbiAgICB9KTtcbiAgICBsZXQgdG9SZWRpcmVjdFRvO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cmwgPSByZXN1bHQuaXNSZWdpc3RlciA/IG5ld1VzZXJVUkwgfHwgY2FsbGJhY2tVUkwgOiBjYWxsYmFja1VSTDtcbiAgICAgIHRvUmVkaXJlY3RUbyA9IHVybC50b1N0cmluZygpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgdG9SZWRpcmVjdFRvID0gcmVzdWx0LmlzUmVnaXN0ZXIgPyBuZXdVc2VyVVJMIHx8IGNhbGxiYWNrVVJMIDogY2FsbGJhY2tVUkw7XG4gICAgfVxuICAgIHRocm93IGMucmVkaXJlY3QodG9SZWRpcmVjdFRvKTtcbiAgfVxuKTtcblxuY29uc3Qgc2lnbk91dCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2lnbi1vdXRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBvdXQgdGhlIGN1cnJlbnQgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb25Db29raWVUb2tlbiA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZSxcbiAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICk7XG4gICAgaWYgKCFzZXNzaW9uQ29va2llVG9rZW4pIHtcbiAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihzZXNzaW9uQ29va2llVG9rZW4pO1xuICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG5mdW5jdGlvbiByZWRpcmVjdEVycm9yKGN0eCwgY2FsbGJhY2tVUkwsIHF1ZXJ5KSB7XG4gIGNvbnN0IHVybCA9IGNhbGxiYWNrVVJMID8gbmV3IFVSTChjYWxsYmFja1VSTCwgY3R4LmJhc2VVUkwpIDogbmV3IFVSTChgJHtjdHguYmFzZVVSTH0vZXJyb3JgKTtcbiAgaWYgKHF1ZXJ5KVxuICAgIE9iamVjdC5lbnRyaWVzKHF1ZXJ5KS5mb3JFYWNoKChbaywgdl0pID0+IHVybC5zZWFyY2hQYXJhbXMuc2V0KGssIHYpKTtcbiAgcmV0dXJuIHVybC5ocmVmO1xufVxuZnVuY3Rpb24gcmVkaXJlY3RDYWxsYmFjayhjdHgsIGNhbGxiYWNrVVJMLCBxdWVyeSkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGNhbGxiYWNrVVJMLCBjdHguYmFzZVVSTCk7XG4gIGlmIChxdWVyeSlcbiAgICBPYmplY3QuZW50cmllcyhxdWVyeSkuZm9yRWFjaCgoW2ssIHZdKSA9PiB1cmwuc2VhcmNoUGFyYW1zLnNldChrLCB2KSk7XG4gIHJldHVybiB1cmwuaHJlZjtcbn1cbmNvbnN0IHJlcXVlc3RQYXNzd29yZFJlc2V0ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXF1ZXN0LXBhc3N3b3JkLXJlc2V0XCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvLlxuICAgICAgICovXG4gICAgICBlbWFpbDogei5lbWFpbCgpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgYWRkcmVzcyBvZiB0aGUgdXNlciB0byBzZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG9cIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmQuXG4gICAgICAgKiBJZiB0aGUgdG9rZW4gaXNuJ3QgdmFsaWQgb3IgZXhwaXJlZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/XG4gICAgICAgKiBlcnJvcj1JTlZBTElEX1RPS0VOYC4gSWYgdGhlIHRva2VuIGlzIHZhbGlkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9cbiAgICAgICAqIHRva2VuPVZBTElEX1RPS0VOXG4gICAgICAgKi9cbiAgICAgIHJlZGlyZWN0VG86IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmQuIElmIHRoZSB0b2tlbiBpc24ndCB2YWxpZCBvciBleHBpcmVkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9lcnJvcj1JTlZBTElEX1RPS0VOYC4gSWYgdGhlIHRva2VuIGlzIHZhbGlkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD90b2tlbj1WQUxJRF9UT0tFTlwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uc2VuZFJlc2V0UGFzc3dvcmQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJSZXNldCBwYXNzd29yZCBpc24ndCBlbmFibGVkLlBsZWFzZSBwYXNzIGFuIGVtYWlsQW5kUGFzc3dvcmQuc2VuZFJlc2V0UGFzc3dvcmQgZnVuY3Rpb24gaW4geW91ciBhdXRoIGNvbmZpZyFcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJSZXNldCBwYXNzd29yZCBpc24ndCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsLCByZWRpcmVjdFRvIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCwge1xuICAgICAgaW5jbHVkZUFjY291bnRzOiB0cnVlXG4gICAgfSk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJSZXNldCBQYXNzd29yZDogVXNlciBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogXCJJZiB0aGlzIGVtYWlsIGV4aXN0cyBpbiBvdXIgc3lzdGVtLCBjaGVjayB5b3VyIGVtYWlsIGZvciB0aGUgcmVzZXQgbGlua1wiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgZGVmYXVsdEV4cGlyZXNJbiA9IDYwICogNjAgKiAxO1xuICAgIGNvbnN0IGV4cGlyZXNBdCA9IGdldERhdGUoXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQucmVzZXRQYXNzd29yZFRva2VuRXhwaXJlc0luIHx8IGRlZmF1bHRFeHBpcmVzSW4sXG4gICAgICBcInNlY1wiXG4gICAgKTtcbiAgICBjb25zdCB2ZXJpZmljYXRpb25Ub2tlbiA9IGdlbmVyYXRlSWQoMjQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIHtcbiAgICAgICAgdmFsdWU6IHVzZXIudXNlci5pZCxcbiAgICAgICAgaWRlbnRpZmllcjogYHJlc2V0LXBhc3N3b3JkOiR7dmVyaWZpY2F0aW9uVG9rZW59YCxcbiAgICAgICAgZXhwaXJlc0F0XG4gICAgICB9LFxuICAgICAgY3R4XG4gICAgKTtcbiAgICBjb25zdCBjYWxsYmFja1VSTCA9IHJlZGlyZWN0VG8gPyBlbmNvZGVVUklDb21wb25lbnQocmVkaXJlY3RUbykgOiBcIlwiO1xuICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3Jlc2V0LXBhc3N3b3JkLyR7dmVyaWZpY2F0aW9uVG9rZW59P2NhbGxiYWNrVVJMPSR7Y2FsbGJhY2tVUkx9YDtcbiAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQuc2VuZFJlc2V0UGFzc3dvcmQoXG4gICAgICB7XG4gICAgICAgIHVzZXI6IHVzZXIudXNlcixcbiAgICAgICAgdXJsLFxuICAgICAgICB0b2tlbjogdmVyaWZpY2F0aW9uVG9rZW5cbiAgICAgIH0sXG4gICAgICBjdHgucmVxdWVzdFxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IFwiSWYgdGhpcyBlbWFpbCBleGlzdHMgaW4gb3VyIHN5c3RlbSwgY2hlY2sgeW91ciBlbWFpbCBmb3IgdGhlIHJlc2V0IGxpbmtcIlxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgZm9yZ2V0UGFzc3dvcmQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2ZvcmdldC1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyIHRvIHNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0by5cbiAgICAgICAqL1xuICAgICAgZW1haWw6IHouc3RyaW5nKCkuZW1haWwoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHJlc2V0IHRoZWlyIHBhc3N3b3JkLlxuICAgICAgICogSWYgdGhlIHRva2VuIGlzbid0IHZhbGlkIG9yIGV4cGlyZWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP1xuICAgICAgICogZXJyb3I9SU5WQUxJRF9UT0tFTmAuIElmIHRoZSB0b2tlbiBpcyB2YWxpZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/XG4gICAgICAgKiB0b2tlbj1WQUxJRF9UT0tFTlxuICAgICAgICovXG4gICAgICByZWRpcmVjdFRvOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHJlc2V0IHRoZWlyIHBhc3N3b3JkLiBJZiB0aGUgdG9rZW4gaXNuJ3QgdmFsaWQgb3IgZXhwaXJlZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/ZXJyb3I9SU5WQUxJRF9UT0tFTmAuIElmIHRoZSB0b2tlbiBpcyB2YWxpZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/dG9rZW49VkFMSURfVE9LRU5cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnNlbmRSZXNldFBhc3N3b3JkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUmVzZXQgcGFzc3dvcmQgaXNuJ3QgZW5hYmxlZC5QbGVhc2UgcGFzcyBhbiBlbWFpbEFuZFBhc3N3b3JkLnNlbmRSZXNldFBhc3N3b3JkIGZ1bmN0aW9uIGluIHlvdXIgYXV0aCBjb25maWchXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiUmVzZXQgcGFzc3dvcmQgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCwgcmVkaXJlY3RUbyB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwsIHtcbiAgICAgIGluY2x1ZGVBY2NvdW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGlmICghdXNlcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUmVzZXQgUGFzc3dvcmQ6IFVzZXIgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiSWYgdGhpcyBlbWFpbCBleGlzdHMgaW4gb3VyIHN5c3RlbSwgY2hlY2sgeW91ciBlbWFpbCBmb3IgdGhlIHJlc2V0IGxpbmtcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGRlZmF1bHRFeHBpcmVzSW4gPSA2MCAqIDYwICogMTtcbiAgICBjb25zdCBleHBpcmVzQXQgPSBnZXREYXRlKFxuICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnJlc2V0UGFzc3dvcmRUb2tlbkV4cGlyZXNJbiB8fCBkZWZhdWx0RXhwaXJlc0luLFxuICAgICAgXCJzZWNcIlxuICAgICk7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uVG9rZW4gPSBnZW5lcmF0ZUlkKDI0KTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICB7XG4gICAgICAgIHZhbHVlOiB1c2VyLnVzZXIuaWQsXG4gICAgICAgIGlkZW50aWZpZXI6IGByZXNldC1wYXNzd29yZDoke3ZlcmlmaWNhdGlvblRva2VufWAsXG4gICAgICAgIGV4cGlyZXNBdFxuICAgICAgfSxcbiAgICAgIGN0eFxuICAgICk7XG4gICAgY29uc3QgY2FsbGJhY2tVUkwgPSByZWRpcmVjdFRvID8gZW5jb2RlVVJJQ29tcG9uZW50KHJlZGlyZWN0VG8pIDogXCJcIjtcbiAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9yZXNldC1wYXNzd29yZC8ke3ZlcmlmaWNhdGlvblRva2VufT9jYWxsYmFja1VSTD0ke2NhbGxiYWNrVVJMfWA7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnNlbmRSZXNldFBhc3N3b3JkKFxuICAgICAge1xuICAgICAgICB1c2VyOiB1c2VyLnVzZXIsXG4gICAgICAgIHVybCxcbiAgICAgICAgdG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICB9LFxuICAgICAgY3R4LnJlcXVlc3RcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHJlcXVlc3RQYXNzd29yZFJlc2V0Q2FsbGJhY2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jlc2V0LXBhc3N3b3JkLzp0b2tlblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlZGlyZWN0cyB0aGUgdXNlciB0byB0aGUgY2FsbGJhY2sgVVJMIHdpdGggdGhlIHRva2VuXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gY3R4LnBhcmFtcztcbiAgICBjb25zdCB7IGNhbGxiYWNrVVJMIH0gPSBjdHgucXVlcnk7XG4gICAgaWYgKCF0b2tlbiB8fCAhY2FsbGJhY2tVUkwpIHtcbiAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgcmVkaXJlY3RFcnJvcihjdHguY29udGV4dCwgY2FsbGJhY2tVUkwsIHsgZXJyb3I6IFwiSU5WQUxJRF9UT0tFTlwiIH0pXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgYHJlc2V0LXBhc3N3b3JkOiR7dG9rZW59YFxuICAgICk7XG4gICAgaWYgKCF2ZXJpZmljYXRpb24gfHwgdmVyaWZpY2F0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgIHJlZGlyZWN0RXJyb3IoY3R4LmNvbnRleHQsIGNhbGxiYWNrVVJMLCB7IGVycm9yOiBcIklOVkFMSURfVE9LRU5cIiB9KVxuICAgICAgKTtcbiAgICB9XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KHJlZGlyZWN0Q2FsbGJhY2soY3R4LmNvbnRleHQsIGNhbGxiYWNrVVJMLCB7IHRva2VuIH0pKTtcbiAgfVxuKTtcbmNvbnN0IGZvcmdldFBhc3N3b3JkQ2FsbGJhY2sgPSByZXF1ZXN0UGFzc3dvcmRSZXNldENhbGxiYWNrO1xuY29uc3QgcmVzZXRQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVzZXQtcGFzc3dvcmRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KS5vcHRpb25hbCgpLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG5ld1Bhc3N3b3JkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmV3IHBhc3N3b3JkIHRvIHNldFwiXG4gICAgICB9KSxcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gcmVzZXQgdGhlIHBhc3N3b3JkXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXNldCB0aGUgcGFzc3dvcmQgZm9yIGEgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgdG9rZW4gPSBjdHguYm9keS50b2tlbiB8fCBjdHgucXVlcnk/LnRva2VuO1xuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgbWluTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQ/LmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBjb25zdCBtYXhMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZD8uY29uZmlnLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX0xPTkdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBpZCA9IGByZXNldC1wYXNzd29yZDoke3Rva2VufWA7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShpZCk7XG4gICAgaWYgKCF2ZXJpZmljYXRpb24gfHwgdmVyaWZpY2F0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHVzZXJJZCA9IHZlcmlmaWNhdGlvbi52YWx1ZTtcbiAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2gobmV3UGFzc3dvcmQpO1xuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyh1c2VySWQpO1xuICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKChhYykgPT4gYWMucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIpO1xuICAgIGlmICghYWNjb3VudCkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgcHJvdmlkZXJJZDogXCJjcmVkZW50aWFsXCIsXG4gICAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxuICAgICAgICAgIGFjY291bnRJZDogdXNlcklkXG4gICAgICAgIH0sXG4gICAgICAgIGN0eFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVBhc3N3b3JkKFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIGhhc2hlZFBhc3N3b3JkLFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZSh2ZXJpZmljYXRpb24uaWQpO1xuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm9uUGFzc3dvcmRSZXNldCkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQodXNlcklkKTtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5vblBhc3N3b3JkUmVzZXQoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlclxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmV2b2tlU2Vzc2lvbnNPblBhc3N3b3JkUmVzZXQpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyh1c2VySWQpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5cbmNvbnN0IHVwZGF0ZVVzZXIgPSAoKSA9PiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3VwZGF0ZS11c2VyXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoucmVjb3JkKFxuICAgICAgei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRmllbGQgbmFtZSBtdXN0IGJlIGEgc3RyaW5nXCJcbiAgICAgIH0pLFxuICAgICAgei5hbnkoKVxuICAgICksXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICAkSW5mZXI6IHtcbiAgICAgICAgYm9keToge31cbiAgICAgIH0sXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlVwZGF0ZSB0aGUgY3VycmVudCB1c2VyXCIsXG4gICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgaW1hZ2Ugb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSB1cGRhdGUgd2FzIHN1Y2Nlc3NmdWxcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgYm9keSA9IGN0eC5ib2R5O1xuICAgIGlmIChib2R5LmVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRU1BSUxfQ0FOX05PVF9CRV9VUERBVEVEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBuYW1lLCBpbWFnZSwgLi4ucmVzdCB9ID0gYm9keTtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhZGRpdGlvbmFsRmllbGRzID0gcGFyc2VVc2VySW5wdXQoXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLFxuICAgICAgcmVzdCxcbiAgICAgIFwidXBkYXRlXCJcbiAgICApO1xuICAgIGlmIChpbWFnZSA9PT0gdm9pZCAwICYmIG5hbWUgPT09IHZvaWQgMCAmJiBPYmplY3Qua2V5cyhhZGRpdGlvbmFsRmllbGRzKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJObyBmaWVsZHMgdG8gdXBkYXRlXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoXG4gICAgICBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICB7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGltYWdlLFxuICAgICAgICAuLi5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9LFxuICAgICAgY3R4XG4gICAgKTtcbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgc2Vzc2lvbjogc2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgdXNlclxuICAgIH0pO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IGNoYW5nZVBhc3N3b3JkID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9jaGFuZ2UtcGFzc3dvcmRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgbmV3IHBhc3N3b3JkIHRvIHNldFxuICAgICAgICovXG4gICAgICBuZXdQYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBjdXJyZW50IHBhc3N3b3JkIG9mIHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIGN1cnJlbnRQYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGN1cnJlbnQgcGFzc3dvcmQgaXMgcmVxdWlyZWRcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIHJldm9rZSBhbGwgc2Vzc2lvbnMgdGhhdCBhcmUgbm90IHRoZVxuICAgICAgICogY3VycmVudCBvbmUgbG9nZ2VkIGluIGJ5IHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIHJldm9rZU90aGVyU2Vzc2lvbnM6IHouYm9vbGVhbigpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJNdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZVwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoYW5nZSB0aGUgcGFzc3dvcmQgb2YgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUGFzc3dvcmQgc3VjY2Vzc2Z1bGx5IGNoYW5nZWRcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHByZXNlbnQgaWYgcmV2b2tlT3RoZXJTZXNzaW9ucyBpcyB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTmV3IHNlc3Npb24gdG9rZW4gaWYgb3RoZXIgc2Vzc2lvbnMgd2VyZSByZXZva2VkXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJ1cmlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm9maWxlIGltYWdlIFVSTCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiV2hldGhlciB0aGUgZW1haWwgaGFzIGJlZW4gdmVyaWZpZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZW4gdGhlIHVzZXIgd2FzIGNyZWF0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZW4gdGhlIHVzZXIgd2FzIGxhc3QgdXBkYXRlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsVmVyaWZpZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiXG4gICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInVzZXJcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IG5ld1Bhc3N3b3JkLCBjdXJyZW50UGFzc3dvcmQsIHJldm9rZU90aGVyU2Vzc2lvbnMgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IG1pblBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1pblBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPCBtaW5QYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIHNob3J0XCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19TSE9SVFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1heFBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPiBtYXhQYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIGxvbmdcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX0xPTkdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKFxuICAgICAgKGFjY291bnQyKSA9PiBhY2NvdW50Mi5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIiAmJiBhY2NvdW50Mi5wYXNzd29yZFxuICAgICk7XG4gICAgaWYgKCFhY2NvdW50IHx8ICFhY2NvdW50LnBhc3N3b3JkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuQ1JFREVOVElBTF9BQ0NPVU5UX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2gobmV3UGFzc3dvcmQpO1xuICAgIGNvbnN0IHZlcmlmeSA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgICBoYXNoOiBhY2NvdW50LnBhc3N3b3JkLFxuICAgICAgcGFzc3dvcmQ6IGN1cnJlbnRQYXNzd29yZFxuICAgIH0pO1xuICAgIGlmICghdmVyaWZ5KSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVBY2NvdW50KGFjY291bnQuaWQsIHtcbiAgICAgIHBhc3N3b3JkOiBwYXNzd29yZEhhc2hcbiAgICB9KTtcbiAgICBsZXQgdG9rZW4gPSBudWxsO1xuICAgIGlmIChyZXZva2VPdGhlclNlc3Npb25zKSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICBpZiAoIW5ld1Nlc3Npb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfU0VTU0lPTlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgIHNlc3Npb246IG5ld1Nlc3Npb24sXG4gICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgfSk7XG4gICAgICB0b2tlbiA9IG5ld1Nlc3Npb24udG9rZW47XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICB0b2tlbixcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgaWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCxcbiAgICAgICAgbmFtZTogc2Vzc2lvbi51c2VyLm5hbWUsXG4gICAgICAgIGltYWdlOiBzZXNzaW9uLnVzZXIuaW1hZ2UsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHNlc3Npb24udXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICBjcmVhdGVkQXQ6IHNlc3Npb24udXNlci5jcmVhdGVkQXQsXG4gICAgICAgIHVwZGF0ZWRBdDogc2Vzc2lvbi51c2VyLnVwZGF0ZWRBdFxuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xuY29uc3Qgc2V0UGFzc3dvcmQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NldC1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XG4gICAgICAgKi9cbiAgICAgIG5ld1Bhc3N3b3JkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmV3IHBhc3N3b3JkIHRvIHNldCBpcyByZXF1aXJlZFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBTRVJWRVJfT05MWTogdHJ1ZVxuICAgIH0sXG4gICAgdXNlOiBbc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmVdXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IG5ld1Bhc3N3b3JkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoIDwgbWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBzaG9ydFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoID4gbWF4UGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBsb25nXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2NvdW50MikgPT4gYWNjb3VudDIucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIgJiYgYWNjb3VudDIucGFzc3dvcmRcbiAgICApO1xuICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2gobmV3UGFzc3dvcmQpO1xuICAgIGlmICghYWNjb3VudCkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpbmtBY2NvdW50KFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgcHJvdmlkZXJJZDogXCJjcmVkZW50aWFsXCIsXG4gICAgICAgICAgYWNjb3VudElkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkSGFzaFxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcInVzZXIgYWxyZWFkeSBoYXMgYSBwYXNzd29yZFwiXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBkZWxldGVVc2VyID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9kZWxldGUtdXNlclwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICB1c2U6IFtzZW5zaXRpdmVTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgY2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGlzIGRlbGV0ZWRcbiAgICAgICAqIHRoaXMgaXMgb25seSB1c2VkIG9uIGRlbGV0ZSB1c2VyIGNhbGxiYWNrXG4gICAgICAgKi9cbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgY2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGlzIGRlbGV0ZWRcIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyLiBJZiB0aGUgcGFzc3dvcmQgaXNuJ3QgcHJvdmlkZWQsIHNlc3Npb24gZnJlc2huZXNzXG4gICAgICAgKiB3aWxsIGJlIGNoZWNrZWQuXG4gICAgICAgKi9cbiAgICAgIHBhc3N3b3JkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcGFzc3dvcmQgb2YgdGhlIHVzZXIgaXMgcmVxdWlyZWQgdG8gZGVsZXRlIHRoZSB1c2VyXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSB0b2tlbiB0byBkZWxldGUgdGhlIHVzZXIuIElmIHRoZSB0b2tlbiBpcyBwcm92aWRlZCwgdGhlIHVzZXIgd2lsbCBiZSBkZWxldGVkXG4gICAgICAgKi9cbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gZGVsZXRlIHRoZSB1c2VyIGlzIHJlcXVpcmVkXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJEZWxldGUgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBkZWxldGlvbiBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5XCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWxcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbXCJVc2VyIGRlbGV0ZWRcIiwgXCJWZXJpZmljYXRpb24gZW1haWwgc2VudFwiXSxcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdGF0dXMgbWVzc2FnZSBvZiB0aGUgZGVsZXRpb24gcHJvY2Vzc1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3VjY2Vzc1wiLCBcIm1lc3NhZ2VcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uZGVsZXRlVXNlcj8uZW5hYmxlZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIkRlbGV0ZSB1c2VyIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gdGhlIG9wdGlvbnNcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgaWYgKGN0eC5ib2R5LnBhc3N3b3JkKSB7XG4gICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKFxuICAgICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiICYmIGFjY291bnQyLnBhc3N3b3JkXG4gICAgICApO1xuICAgICAgaWYgKCFhY2NvdW50IHx8ICFhY2NvdW50LnBhc3N3b3JkKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkNSRURFTlRJQUxfQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB2ZXJpZnkgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgICBoYXNoOiBhY2NvdW50LnBhc3N3b3JkLFxuICAgICAgICBwYXNzd29yZDogY3R4LmJvZHkucGFzc3dvcmRcbiAgICAgIH0pO1xuICAgICAgaWYgKCF2ZXJpZnkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9QQVNTV09SRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGN0eC5ib2R5LnRva2VuKSB7XG4gICAgICBhd2FpdCBkZWxldGVVc2VyQ2FsbGJhY2soe1xuICAgICAgICAuLi5jdHgsXG4gICAgICAgIHF1ZXJ5OiB7XG4gICAgICAgICAgdG9rZW46IGN0eC5ib2R5LnRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogXCJVc2VyIGRlbGV0ZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uc2VuZERlbGV0ZUFjY291bnRWZXJpZmljYXRpb24pIHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIsIFwiMC05XCIsIFwiYS16XCIpO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICB7XG4gICAgICAgICAgdmFsdWU6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICBpZGVudGlmaWVyOiBgZGVsZXRlLWFjY291bnQtJHt0b2tlbn1gLFxuICAgICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoXG4gICAgICAgICAgICBEYXRlLm5vdygpICsgKGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5kZWxldGVUb2tlbkV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQpICogMWUzXG4gICAgICAgICAgKVxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9kZWxldGUtdXNlci9jYWxsYmFjaz90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlci5zZW5kRGVsZXRlQWNjb3VudFZlcmlmaWNhdGlvbihcbiAgICAgICAge1xuICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlcixcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgdG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBzZW50XCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWN0eC5ib2R5LnBhc3N3b3JkICYmIGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZnJlc2hBZ2UgIT09IDApIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRBZ2UgPSBuZXcgRGF0ZShzZXNzaW9uLnNlc3Npb24uY3JlYXRlZEF0KS5nZXRUaW1lKCk7XG4gICAgICBjb25zdCBmcmVzaEFnZSA9IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZnJlc2hBZ2UgKiAxZTM7XG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgaWYgKG5vdyAtIGN1cnJlbnRBZ2UgPiBmcmVzaEFnZSAqIDFlMykge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5TRVNTSU9OX0VYUElSRURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGJlZm9yZURlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5iZWZvcmVEZWxldGU7XG4gICAgaWYgKGJlZm9yZURlbGV0ZSkge1xuICAgICAgYXdhaXQgYmVmb3JlRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVXNlcihzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVBY2NvdW50cyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICBjb25zdCBhZnRlckRlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5hZnRlckRlbGV0ZTtcbiAgICBpZiAoYWZ0ZXJEZWxldGUpIHtcbiAgICAgIGF3YWl0IGFmdGVyRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IFwiVXNlciBkZWxldGVkXCJcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IGRlbGV0ZVVzZXJDYWxsYmFjayA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZGVsZXRlLXVzZXIvY2FsbGJhY2tcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byB2ZXJpZnkgdGhlIGRlbGV0aW9uIHJlcXVlc3RcIlxuICAgICAgfSksXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciBkZWxldGlvblwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbb3JpZ2luQ2hlY2soKGN0eCkgPT4gY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgdG8gY29tcGxldGUgdXNlciBkZWxldGlvbiB3aXRoIHZlcmlmaWNhdGlvbiB0b2tlblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHN1Y2Nlc3NmdWxseSBkZWxldGVkXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSBkZWxldGlvbiB3YXMgc3VjY2Vzc2Z1bFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGVudW06IFtcIlVzZXIgZGVsZXRlZFwiXSxcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJDb25maXJtYXRpb24gbWVzc2FnZVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3VjY2Vzc1wiLCBcIm1lc3NhZ2VcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uZGVsZXRlVXNlcj8uZW5hYmxlZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIkRlbGV0ZSB1c2VyIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gdGhlIG9wdGlvbnNcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfVVNFUl9JTkZPXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgYGRlbGV0ZS1hY2NvdW50LSR7Y3R4LnF1ZXJ5LnRva2VufWBcbiAgICApO1xuICAgIGlmICghdG9rZW4gfHwgdG9rZW4uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBiZWZvcmVEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYmVmb3JlRGVsZXRlO1xuICAgIGlmIChiZWZvcmVEZWxldGUpIHtcbiAgICAgIGF3YWl0IGJlZm9yZURlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudHMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUodG9rZW4uaWQpO1xuICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICBjb25zdCBhZnRlckRlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5hZnRlckRlbGV0ZTtcbiAgICBpZiAoYWZ0ZXJEZWxldGUpIHtcbiAgICAgIGF3YWl0IGFmdGVyRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMIHx8IFwiL1wiKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZFwiXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBjaGFuZ2VFbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2hhbmdlLWVtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG5ld0VtYWlsOiB6LmVtYWlsKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgZW1haWwgYWRkcmVzcyB0byBzZXQgbXVzdCBiZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3NcIlxuICAgICAgfSksXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciBlbWFpbCB2ZXJpZmljYXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3NlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBjaGFuZ2UgcmVxdWVzdCBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5XCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIHJlcXVlc3Qgd2FzIHN1Y2Nlc3NmdWxcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbXCJFbWFpbCB1cGRhdGVkXCIsIFwiVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3RhdHVzIG1lc3NhZ2Ugb2YgdGhlIGVtYWlsIGNoYW5nZSBwcm9jZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJzdGF0dXNcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiNDIyXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVucHJvY2Vzc2FibGUgRW50aXR5LiBFbWFpbCBhbHJlYWR5IGV4aXN0c1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy51c2VyPy5jaGFuZ2VFbWFpbD8uZW5hYmxlZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiQ2hhbmdlIGVtYWlsIGlzIGRpc2FibGVkLlwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJDaGFuZ2UgZW1haWwgaXMgZGlzYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG5ld0VtYWlsID0gY3R4LmJvZHkubmV3RW1haWwudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAobmV3RW1haWwgPT09IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5lbWFpbCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRW1haWwgaXMgdGhlIHNhbWVcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRW1haWwgaXMgdGhlIHNhbWVcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwobmV3RW1haWwpO1xuICAgIGlmIChleGlzdGluZ1VzZXIpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkVtYWlsIGFscmVhZHkgZXhpc3RzXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkNvdWxkbid0IHVwZGF0ZSB5b3VyIGVtYWlsXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsVmVyaWZpZWQgIT09IHRydWUpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChuZXdFbWFpbCk7XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9BTFJFQURZX0VYSVNUU19VU0VfQU5PVEhFUl9FTUFJTFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyQnlFbWFpbChcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgICB7XG4gICAgICAgICAgZW1haWw6IG5ld0VtYWlsXG4gICAgICAgIH0sXG4gICAgICAgIGN0eFxuICAgICAgKTtcbiAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgIHNlc3Npb246IGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIC4uLmN0eC5jb250ZXh0LnNlc3Npb24udXNlcixcbiAgICAgICAgICBlbWFpbDogbmV3RW1haWxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKSB7XG4gICAgICAgIGNvbnN0IHRva2VuMiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIG5ld0VtYWlsLFxuICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgdXJsMiA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VuMn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLnNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgIC4uLmN0eC5jb250ZXh0LnNlc3Npb24udXNlcixcbiAgICAgICAgICAgICAgZW1haWw6IG5ld0VtYWlsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXJsOiB1cmwyLFxuICAgICAgICAgICAgdG9rZW46IHRva2VuMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmNoYW5nZUVtYWlsLnNlbmRDaGFuZ2VFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWQuXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICBuZXdFbWFpbCxcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICk7XG4gICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuY2hhbmdlRW1haWwuc2VuZENoYW5nZUVtYWlsVmVyaWZpY2F0aW9uKFxuICAgICAge1xuICAgICAgICB1c2VyOiBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIsXG4gICAgICAgIG5ld0VtYWlsLFxuICAgICAgICB1cmwsXG4gICAgICAgIHRva2VuXG4gICAgICB9LFxuICAgICAgY3R4LnJlcXVlc3RcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcblxuZnVuY3Rpb24gc2FuaXRpemUoaW5wdXQpIHtcbiAgcmV0dXJuIGlucHV0LnJlcGxhY2UoLyYvZywgXCImYW1wO1wiKS5yZXBsYWNlKC88L2csIFwiJmx0O1wiKS5yZXBsYWNlKC8+L2csIFwiJmd0O1wiKS5yZXBsYWNlKC9cIi9nLCBcIiZxdW90O1wiKS5yZXBsYWNlKC8nL2csIFwiJiMzOTtcIik7XG59XG5jb25zdCBodG1sID0gKGVycm9yQ29kZSA9IFwiVW5rbm93blwiKSA9PiBgPCFET0NUWVBFIGh0bWw+XG48aHRtbCBsYW5nPVwiZW5cIj5cbjxoZWFkPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPlxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XG4gICAgPHRpdGxlPkF1dGhlbnRpY2F0aW9uIEVycm9yPC90aXRsZT5cbiAgICA8c3R5bGU+XG4gICAgICAgIDpyb290IHtcbiAgICAgICAgICAgIC0tYmctY29sb3I6ICNmOGY5ZmE7XG4gICAgICAgICAgICAtLXRleHQtY29sb3I6ICMyMTI1Mjk7XG4gICAgICAgICAgICAtLWFjY2VudC1jb2xvcjogIzAwMDAwMDtcbiAgICAgICAgICAgIC0tZXJyb3ItY29sb3I6ICNkYzM1NDU7XG4gICAgICAgICAgICAtLWJvcmRlci1jb2xvcjogI2U5ZWNlZjtcbiAgICAgICAgfVxuICAgICAgICBib2R5IHtcbiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICdTZWdvZSBVSScsIFJvYm90bywgJ0hlbHZldGljYSBOZXVlJywgQXJpYWwsIHNhbnMtc2VyaWY7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iZy1jb2xvcik7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgaGVpZ2h0OiAxMDB2aDtcbiAgICAgICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7XG4gICAgICAgIH1cbiAgICAgICAgLmVycm9yLWNvbnRhaW5lciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMDUpO1xuICAgICAgICAgICAgcGFkZGluZzogMi41cmVtO1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgbWF4LXdpZHRoOiA5MCU7XG4gICAgICAgICAgICB3aWR0aDogNDAwcHg7XG4gICAgICAgIH1cbiAgICAgICAgaDEge1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS43NXJlbTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG4gICAgICAgICAgICBmb250LXdlaWdodDogNjAwO1xuICAgICAgICB9XG4gICAgICAgIHAge1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMS41cmVtO1xuICAgICAgICAgICAgY29sb3I6ICM0OTUwNTc7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0biB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpO1xuICAgICAgICAgICAgY29sb3I6ICNmZmZmZmY7XG4gICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gICAgICAgICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7XG4gICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYWNjZW50LWNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICAuYnRuOmhvdmVyIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxMzE3MjE7XG4gICAgICAgIH1cbiAgICAgICAgLmVycm9yLWNvZGUge1xuICAgICAgICAgICAgZm9udC1zaXplOiAwLjg3NXJlbTtcbiAgICAgICAgICAgIGNvbG9yOiAjNmM3NTdkO1xuICAgICAgICAgICAgbWFyZ2luLXRvcDogMS41cmVtO1xuICAgICAgICAgICAgcGFkZGluZy10b3A6IDEuNXJlbTtcbiAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIC5pY29uIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogM3JlbTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG4gICAgICAgIH1cbiAgICA8L3N0eWxlPlxuPC9oZWFkPlxuPGJvZHk+XG4gICAgPGRpdiBjbGFzcz1cImVycm9yLWNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaWNvblwiPlxcdTI2QTBcXHVGRTBGPC9kaXY+XG4gICAgICAgIDxoMT5CZXR0ZXIgQXV0aCBFcnJvcjwvaDE+XG4gICAgICAgIDxwPldlIGVuY291bnRlcmVkIGFuIGlzc3VlIHdoaWxlIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2UgdHJ5IGFnYWluIG9yIGNvbnRhY3QgdGhlIGFwcGxpY2F0aW9uIG93bmVyIGlmIHRoZSBwcm9ibGVtIHBlcnNpc3RzLjwvcD5cbiAgICAgICAgPGEgaHJlZj1cIi9cIiBpZD1cInJldHVybkxpbmtcIiBjbGFzcz1cImJ0blwiPlJldHVybiB0byBBcHBsaWNhdGlvbjwvYT5cbiAgICAgICAgPGRpdiBjbGFzcz1cImVycm9yLWNvZGVcIj5FcnJvciBDb2RlOiA8c3BhbiBpZD1cImVycm9yQ29kZVwiPiR7c2FuaXRpemUoXG4gIGVycm9yQ29kZVxuKX08L3NwYW4+PC9kaXY+XG4gICAgPC9kaXY+XG48L2JvZHk+XG48L2h0bWw+YDtcbmNvbnN0IGVycm9yID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9lcnJvclwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICAuLi5ISURFX01FVEFEQVRBLFxuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNwbGF5cyBhbiBlcnJvciBwYWdlXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJ0ZXh0L2h0bWxcIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBIVE1MIGNvbnRlbnQgb2YgdGhlIGVycm9yIHBhZ2VcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGMpID0+IHtcbiAgICBjb25zdCBxdWVyeSA9IG5ldyBVUkwoYy5yZXF1ZXN0Py51cmwgfHwgXCJcIikuc2VhcmNoUGFyYW1zLmdldChcImVycm9yXCIpIHx8IFwiVW5rbm93blwiO1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoaHRtbChxdWVyeSksIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJ0ZXh0L2h0bWxcIlxuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xuXG5jb25zdCBvayA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb2tcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uSElERV9NRVRBREFUQSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2hlY2sgaWYgdGhlIEFQSSBpcyB3b3JraW5nXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkFQSSBpcyB3b3JraW5nXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBvazoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgQVBJIGlzIHdvcmtpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcIm9rXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIG9rOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5cbmNvbnN0IGxpc3RVc2VyQWNjb3VudHMgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2xpc3QtYWNjb3VudHNcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCBhbGwgYWNjb3VudHMgbGlua2VkIHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgc2NvcGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICBcInByb3ZpZGVySWRcIixcbiAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIFwidXBkYXRlZEF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50SWRcIixcbiAgICAgICAgICAgICAgICAgICAgICBcInNjb3Blc1wiXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGMuY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIHJldHVybiBjLmpzb24oXG4gICAgICBhY2NvdW50cy5tYXAoKGEpID0+ICh7XG4gICAgICAgIGlkOiBhLmlkLFxuICAgICAgICBwcm92aWRlcklkOiBhLnByb3ZpZGVySWQsXG4gICAgICAgIGNyZWF0ZWRBdDogYS5jcmVhdGVkQXQsXG4gICAgICAgIHVwZGF0ZWRBdDogYS51cGRhdGVkQXQsXG4gICAgICAgIGFjY291bnRJZDogYS5hY2NvdW50SWQsXG4gICAgICAgIHNjb3BlczogYS5zY29wZT8uc3BsaXQoXCIsXCIpIHx8IFtdXG4gICAgICB9KSlcbiAgICApO1xuICB9XG4pO1xuY29uc3QgbGlua1NvY2lhbEFjY291bnQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2xpbmstc29jaWFsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGhhcyBzaWduZWQgaW4uXG4gICAgICAgKi9cbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGhhcyBzaWduZWQgaW5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT0F1dGgyIHByb3ZpZGVyIHRvIHVzZVxuICAgICAgICovXG4gICAgICBwcm92aWRlcjogU29jaWFsUHJvdmlkZXJMaXN0RW51bSxcbiAgICAgIC8qKlxuICAgICAgICogSUQgVG9rZW4gZm9yIGRpcmVjdCBhdXRoZW50aWNhdGlvbiB3aXRob3V0IHJlZGlyZWN0XG4gICAgICAgKi9cbiAgICAgIGlkVG9rZW46IHoub2JqZWN0KHtcbiAgICAgICAgdG9rZW46IHouc3RyaW5nKCksXG4gICAgICAgIG5vbmNlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAgIGFjY2Vzc1Rva2VuOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAgIHJlZnJlc2hUb2tlbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICBzY29wZXM6IHouYXJyYXkoei5zdHJpbmcoKSkub3B0aW9uYWwoKVxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogV2hldGhlciB0byBhbGxvdyBzaWduIHVwIGZvciBuZXcgdXNlcnNcbiAgICAgICAqL1xuICAgICAgcmVxdWVzdFNpZ25VcDogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogQWRkaXRpb25hbCBzY29wZXMgdG8gcmVxdWVzdCB3aGVuIGxpbmtpbmcgdGhlIGFjY291bnQuXG4gICAgICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3IgcmVxdWVzdGluZyBhZGRpdGlvbmFsIHBlcm1pc3Npb25zIHdoZW5cbiAgICAgICAqIGxpbmtpbmcgYSBzb2NpYWwgYWNjb3VudCBjb21wYXJlZCB0byB0aGUgaW5pdGlhbCBhdXRoZW50aWNhdGlvbi5cbiAgICAgICAqL1xuICAgICAgc2NvcGVzOiB6LmFycmF5KHouc3RyaW5nKCkpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJBZGRpdGlvbmFsIHNjb3BlcyB0byByZXF1ZXN0IGZyb20gdGhlIHByb3ZpZGVyXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gaWYgdGhlcmUgaXMgYW4gZXJyb3IgZHVyaW5nIHRoZSBsaW5rIHByb2Nlc3MuXG4gICAgICAgKi9cbiAgICAgIGVycm9yQ2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gaWYgdGhlcmUgaXMgYW4gZXJyb3IgZHVyaW5nIHRoZSBsaW5rIHByb2Nlc3NcIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogRGlzYWJsZSBhdXRvbWF0aWMgcmVkaXJlY3Rpb24gdG8gdGhlIHByb3ZpZGVyXG4gICAgICAgKlxuICAgICAgICogVGhpcyBpcyB1c2VmdWwgaWYgeW91IHdhbnQgdG8gaGFuZGxlIHRoZSByZWRpcmVjdGlvblxuICAgICAgICogeW91cnNlbGYgbGlrZSBpbiBhIHBvcHVwIG9yIGEgZGlmZmVyZW50IHRhYi5cbiAgICAgICAqL1xuICAgICAgZGlzYWJsZVJlZGlyZWN0OiB6LmJvb2xlYW4oKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBhdXRvbWF0aWMgcmVkaXJlY3Rpb24gdG8gdGhlIHByb3ZpZGVyLiBVc2VmdWwgZm9yIGhhbmRsaW5nIHRoZSByZWRpcmVjdGlvbiB5b3Vyc2VsZlwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpbmsgYSBzb2NpYWwgYWNjb3VudCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBhdXRob3JpemF0aW9uIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0b1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSB1c2VyIHNob3VsZCBiZSByZWRpcmVjdGVkIHRvIHRoZSBhdXRob3JpemF0aW9uIFVSTFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wicmVkaXJlY3RcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGMuY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gYy5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IGMuYm9keS5wcm92aWRlclxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJQcm92aWRlciBub3QgZm91bmQuIE1ha2Ugc3VyZSB0byBhZGQgdGhlIHByb3ZpZGVyIGluIHlvdXIgYXV0aCBjb25maWdcIixcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUFJPVklERVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGMuYm9keS5pZFRva2VuKSB7XG4gICAgICBpZiAoIXByb3ZpZGVyLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIlByb3ZpZGVyIGRvZXMgbm90IHN1cHBvcnQgaWQgdG9rZW4gdmVyaWZpY2F0aW9uXCIsXG4gICAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklEX1RPS0VOX05PVF9TVVBQT1JURURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB7IHRva2VuLCBub25jZSB9ID0gYy5ib2R5LmlkVG9rZW47XG4gICAgICBjb25zdCB2YWxpZCA9IGF3YWl0IHByb3ZpZGVyLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIGlmICghdmFsaWQpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkludmFsaWQgaWQgdG9rZW5cIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgbGlua2luZ1VzZXJJbmZvID0gYXdhaXQgcHJvdmlkZXIuZ2V0VXNlckluZm8oe1xuICAgICAgICBpZFRva2VuOiB0b2tlbixcbiAgICAgICAgYWNjZXNzVG9rZW46IGMuYm9keS5pZFRva2VuLmFjY2Vzc1Rva2VuLFxuICAgICAgICByZWZyZXNoVG9rZW46IGMuYm9keS5pZFRva2VuLnJlZnJlc2hUb2tlblxuICAgICAgfSk7XG4gICAgICBpZiAoIWxpbmtpbmdVc2VySW5mbyB8fCAhbGlua2luZ1VzZXJJbmZvPy51c2VyKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IHVzZXIgaW5mb1wiLCB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfVVNFUl9JTkZPXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgbGlua2luZ1VzZXJJZCA9IFN0cmluZyhsaW5raW5nVXNlckluZm8udXNlci5pZCk7XG4gICAgICBpZiAoIWxpbmtpbmdVc2VySW5mby51c2VyLmVtYWlsKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VyIGVtYWlsIG5vdCBmb3VuZFwiLCB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfRU1BSUxfTk9UX0ZPVU5EXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgZXhpc3RpbmdBY2NvdW50cyA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICAgICk7XG4gICAgICBjb25zdCBoYXNCZWVuTGlua2VkID0gZXhpc3RpbmdBY2NvdW50cy5maW5kKFxuICAgICAgICAoYSkgPT4gYS5wcm92aWRlcklkID09PSBwcm92aWRlci5pZCAmJiBhLmFjY291bnRJZCA9PT0gbGlua2luZ1VzZXJJZFxuICAgICAgKTtcbiAgICAgIGlmIChoYXNCZWVuTGlua2VkKSB7XG4gICAgICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgICAgIHVybDogXCJcIixcbiAgICAgICAgICAvLyB0aGlzIGlzIGZvciB0eXBlIGluZmVyZW5jZVxuICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICByZWRpcmVjdDogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB0cnVzdGVkUHJvdmlkZXJzID0gYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnRydXN0ZWRQcm92aWRlcnM7XG4gICAgICBjb25zdCBpc1RydXN0ZWRQcm92aWRlciA9IHRydXN0ZWRQcm92aWRlcnM/LmluY2x1ZGVzKHByb3ZpZGVyLmlkKTtcbiAgICAgIGlmICghaXNUcnVzdGVkUHJvdmlkZXIgJiYgIWxpbmtpbmdVc2VySW5mby51c2VyLmVtYWlsVmVyaWZpZWQgfHwgYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmVuYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJBY2NvdW50IG5vdCBsaW5rZWQgLSBsaW5raW5nIG5vdCBhbGxvd2VkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAobGlua2luZ1VzZXJJbmZvLnVzZXIuZW1haWwgIT09IHNlc3Npb24udXNlci5lbWFpbCAmJiBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uYWxsb3dEaWZmZXJlbnRFbWFpbHMgIT09IHRydWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcIkFjY291bnQgbm90IGxpbmtlZCAtIGRpZmZlcmVudCBlbWFpbHMgbm90IGFsbG93ZWRcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlQWNjb3VudChcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICAgICAgYWNjb3VudElkOiBsaW5raW5nVXNlcklkLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW46IGMuYm9keS5pZFRva2VuLmFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgaWRUb2tlbjogdG9rZW4sXG4gICAgICAgICAgICByZWZyZXNoVG9rZW46IGMuYm9keS5pZFRva2VuLnJlZnJlc2hUb2tlbixcbiAgICAgICAgICAgIHNjb3BlOiBjLmJvZHkuaWRUb2tlbi5zY29wZXM/LmpvaW4oXCIsXCIpXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjXG4gICAgICAgICk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkVYUEVDVEFUSU9OX0ZBSUxFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJBY2NvdW50IG5vdCBsaW5rZWQgLSB1bmFibGUgdG8gY3JlYXRlIGFjY291bnRcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8udXBkYXRlVXNlckluZm9PbkxpbmsgPT09IHRydWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkLCB7XG4gICAgICAgICAgICBuYW1lOiBsaW5raW5nVXNlckluZm8udXNlcj8ubmFtZSxcbiAgICAgICAgICAgIGltYWdlOiBsaW5raW5nVXNlckluZm8udXNlcj8uaW1hZ2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCB1cGRhdGUgdXNlciAtIFwiICsgZS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGMuanNvbih7XG4gICAgICAgIHVybDogXCJcIixcbiAgICAgICAgLy8gdGhpcyBpcyBmb3IgdHlwZSBpbmZlcmVuY2VcbiAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICByZWRpcmVjdDogZmFsc2VcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IGdlbmVyYXRlU3RhdGUoYywge1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBlbWFpbDogc2Vzc2lvbi51c2VyLmVtYWlsXG4gICAgfSk7XG4gICAgY29uc3QgdXJsID0gYXdhaXQgcHJvdmlkZXIuY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICBzdGF0ZTogc3RhdGUuc3RhdGUsXG4gICAgICBjb2RlVmVyaWZpZXI6IHN0YXRlLmNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJOiBgJHtjLmNvbnRleHQuYmFzZVVSTH0vY2FsbGJhY2svJHtwcm92aWRlci5pZH1gLFxuICAgICAgc2NvcGVzOiBjLmJvZHkuc2NvcGVzXG4gICAgfSk7XG4gICAgcmV0dXJuIGMuanNvbih7XG4gICAgICB1cmw6IHVybC50b1N0cmluZygpLFxuICAgICAgcmVkaXJlY3Q6ICFjLmJvZHkuZGlzYWJsZVJlZGlyZWN0XG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCB1bmxpbmtBY2NvdW50ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi91bmxpbmstYWNjb3VudFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpLFxuICAgICAgYWNjb3VudElkOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtmcmVzaFNlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJVbmxpbmsgYW4gYWNjb3VudFwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBwcm92aWRlcklkLCBhY2NvdW50SWQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgaWYgKGFjY291bnRzLmxlbmd0aCA9PT0gMSAmJiAhY3R4LmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uYWxsb3dVbmxpbmtpbmdBbGwpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fVU5MSU5LX0xBU1RfQUNDT1VOVFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRFeGlzdCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjb3VudCkgPT4gYWNjb3VudElkID8gYWNjb3VudC5hY2NvdW50SWQgPT09IGFjY291bnRJZCAmJiBhY2NvdW50LnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWQgOiBhY2NvdW50LnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghYWNjb3VudEV4aXN0KSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudChhY2NvdW50RXhpc3QuaWQpO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IGdldEFjY2Vzc1Rva2VuID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9nZXQtYWNjZXNzLXRva2VuXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHByb3ZpZGVySWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm92aWRlciBJRCBmb3IgdGhlIE9BdXRoIHByb3ZpZGVyXCJcbiAgICAgIH0pLFxuICAgICAgYWNjb3VudElkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgYWNjb3VudCBJRCBhc3NvY2lhdGVkIHdpdGggdGhlIHJlZnJlc2ggdG9rZW5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIHVzZXJJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgSUQgYXNzb2NpYXRlZCB3aXRoIHRoZSBhY2NvdW50XCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgYSB2YWxpZCBhY2Nlc3MgdG9rZW4sIGRvaW5nIGEgcmVmcmVzaCBpZiBuZWVkZWRcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBIFZhbGlkIGFjY2VzcyB0b2tlblwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdG9rZW5UeXBlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpZFRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIDQwMDoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW52YWxpZCByZWZyZXNoIHRva2VuIG9yIHByb3ZpZGVyIGNvbmZpZ3VyYXRpb25cIlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHsgcHJvdmlkZXJJZCwgYWNjb3VudElkLCB1c2VySWQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHJlcSA9IGN0eC5yZXF1ZXN0O1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmIChyZXEgJiYgIXNlc3Npb24pIHtcbiAgICAgIHRocm93IGN0eC5lcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICB9XG4gICAgbGV0IHJlc29sdmVkVXNlcklkID0gc2Vzc2lvbj8udXNlcj8uaWQgfHwgdXNlcklkO1xuICAgIGlmICghcmVzb2x2ZWRVc2VySWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYEVpdGhlciB1c2VySWQgb3Igc2Vzc2lvbiBpcyByZXF1aXJlZGBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWN0eC5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKChwKSA9PiBwLmlkID09PSBwcm92aWRlcklkKSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBgUHJvdmlkZXIgJHtwcm92aWRlcklkfSBpcyBub3Qgc3VwcG9ydGVkLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMocmVzb2x2ZWRVc2VySWQpO1xuICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKFxuICAgICAgKGFjYykgPT4gYWNjb3VudElkID8gYWNjLmlkID09PSBhY2NvdW50SWQgJiYgYWNjLnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWQgOiBhY2MucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXJJZFxuICAgICk7XG4gICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQWNjb3VudCBub3QgZm91bmRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHByb3ZpZGVyID0gY3R4LmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gcHJvdmlkZXJJZFxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBgUHJvdmlkZXIgJHtwcm92aWRlcklkfSBub3QgZm91bmQuYFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBsZXQgbmV3VG9rZW5zID0gbnVsbDtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuRXhwaXJlZCA9IGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQgJiYgbmV3IERhdGUoYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCkuZ2V0VGltZSgpIC0gRGF0ZS5ub3coKSA8IDVlMztcbiAgICAgIGlmIChhY2NvdW50LnJlZnJlc2hUb2tlbiAmJiBhY2Nlc3NUb2tlbkV4cGlyZWQgJiYgcHJvdmlkZXIucmVmcmVzaEFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIG5ld1Rva2VucyA9IGF3YWl0IHByb3ZpZGVyLnJlZnJlc2hBY2Nlc3NUb2tlbihcbiAgICAgICAgICBhY2NvdW50LnJlZnJlc2hUb2tlblxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChhY2NvdW50LmlkLCB7XG4gICAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChuZXdUb2tlbnMuYWNjZXNzVG9rZW4sIGN0eC5jb250ZXh0KSxcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogbmV3VG9rZW5zLmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKG5ld1Rva2Vucy5yZWZyZXNoVG9rZW4sIGN0eC5jb250ZXh0KSxcbiAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IG5ld1Rva2Vucy5yZWZyZXNoVG9rZW5FeHBpcmVzQXRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB0b2tlbnMgPSB7XG4gICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBkZWNyeXB0T0F1dGhUb2tlbihcbiAgICAgICAgICBuZXdUb2tlbnM/LmFjY2Vzc1Rva2VuID8/IGFjY291bnQuYWNjZXNzVG9rZW4gPz8gXCJcIixcbiAgICAgICAgICBjdHguY29udGV4dFxuICAgICAgICApLFxuICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogbmV3VG9rZW5zPy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA/PyBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0ID8/IHZvaWQgMCxcbiAgICAgICAgc2NvcGVzOiBhY2NvdW50LnNjb3BlPy5zcGxpdChcIixcIikgPz8gW10sXG4gICAgICAgIGlkVG9rZW46IG5ld1Rva2Vucz8uaWRUb2tlbiA/PyBhY2NvdW50LmlkVG9rZW4gPz8gdm9pZCAwXG4gICAgICB9O1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHRva2Vucyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gZ2V0IGEgdmFsaWQgYWNjZXNzIHRva2VuXCIsXG4gICAgICAgIGNhdXNlOiBlcnJvclxuICAgICAgfSk7XG4gICAgfVxuICB9XG4pO1xuY29uc3QgcmVmcmVzaFRva2VuID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZWZyZXNoLXRva2VuXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHByb3ZpZGVySWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm92aWRlciBJRCBmb3IgdGhlIE9BdXRoIHByb3ZpZGVyXCJcbiAgICAgIH0pLFxuICAgICAgYWNjb3VudElkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgYWNjb3VudCBJRCBhc3NvY2lhdGVkIHdpdGggdGhlIHJlZnJlc2ggdG9rZW5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIHVzZXJJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgSUQgYXNzb2NpYXRlZCB3aXRoIHRoZSBhY2NvdW50XCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZWZyZXNoIHRoZSBhY2Nlc3MgdG9rZW4gdXNpbmcgYSByZWZyZXNoIHRva2VuXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQWNjZXNzIHRva2VuIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHlcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuVHlwZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICA0MDA6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkludmFsaWQgcmVmcmVzaCB0b2tlbiBvciBwcm92aWRlciBjb25maWd1cmF0aW9uXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IHByb3ZpZGVySWQsIGFjY291bnRJZCwgdXNlcklkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCByZXEgPSBjdHgucmVxdWVzdDtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAocmVxICYmICFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBjdHguZXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIGxldCByZXNvbHZlZFVzZXJJZCA9IHNlc3Npb24/LnVzZXI/LmlkIHx8IHVzZXJJZDtcbiAgICBpZiAoIXJlc29sdmVkVXNlcklkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGBFaXRoZXIgdXNlcklkIG9yIHNlc3Npb24gaXMgcmVxdWlyZWRgXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKHJlc29sdmVkVXNlcklkKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2MpID0+IGFjY291bnRJZCA/IGFjYy5pZCA9PT0gYWNjb3VudElkICYmIGFjYy5wcm92aWRlcklkID09PSBwcm92aWRlcklkIDogYWNjLnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY291bnQgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGN0eC5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gbm90IGZvdW5kLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIXByb3ZpZGVyLnJlZnJlc2hBY2Nlc3NUb2tlbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBgUHJvdmlkZXIgJHtwcm92aWRlcklkfSBkb2VzIG5vdCBzdXBwb3J0IHRva2VuIHJlZnJlc2hpbmcuYFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCBwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW4oXG4gICAgICAgIGFjY291bnQucmVmcmVzaFRva2VuXG4gICAgICApO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZUFjY291bnQoYWNjb3VudC5pZCwge1xuICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKHRva2Vucy5hY2Nlc3NUb2tlbiwgY3R4LmNvbnRleHQpLFxuICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMucmVmcmVzaFRva2VuLCBjdHguY29udGV4dCksXG4gICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB0b2tlbnMuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogdG9rZW5zLnJlZnJlc2hUb2tlbkV4cGlyZXNBdFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24odG9rZW5zKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byByZWZyZXNoIGFjY2VzcyB0b2tlblwiLFxuICAgICAgICBjYXVzZTogZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuKTtcbmNvbnN0IGFjY291bnRJbmZvID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9hY2NvdW50LWluZm9cIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkdldCB0aGUgYWNjb3VudCBpbmZvIHByb3ZpZGVkIGJ5IHRoZSBwcm92aWRlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wiaWRcIiwgXCJlbWFpbFZlcmlmaWVkXCJdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1widXNlclwiLCBcImRhdGFcIl0sXG4gICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHByb3ZpZGVyIGdpdmVuIGFjY291bnQgaWQgZm9yIHdoaWNoIHRvIGdldCB0aGUgYWNjb3VudCBpbmZvXCJcbiAgICAgIH0pXG4gICAgfSlcbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnQoXG4gICAgICBjdHguYm9keS5hY2NvdW50SWRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCB8fCBhY2NvdW50LnVzZXJJZCAhPT0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQWNjb3VudCBub3QgZm91bmRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHByb3ZpZGVyID0gY3R4LmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gYWNjb3VudC5wcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICBtZXNzYWdlOiBgUHJvdmlkZXIgYWNjb3VudCBwcm92aWRlciBpcyAke2FjY291bnQucHJvdmlkZXJJZH0gYnV0IGl0IGlzIG5vdCBjb25maWd1cmVkYFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHRva2VucyA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKHtcbiAgICAgIC4uLmN0eCxcbiAgICAgIGJvZHk6IHtcbiAgICAgICAgYWNjb3VudElkOiBhY2NvdW50LmlkLFxuICAgICAgICBwcm92aWRlcklkOiBhY2NvdW50LnByb3ZpZGVySWRcbiAgICAgIH0sXG4gICAgICByZXR1cm5IZWFkZXJzOiBmYWxzZVxuICAgIH0pO1xuICAgIGlmICghdG9rZW5zLmFjY2Vzc1Rva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQWNjZXNzIHRva2VuIG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgaW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHtcbiAgICAgIC4uLnRva2VucyxcbiAgICAgIGFjY2Vzc1Rva2VuOiB0b2tlbnMuYWNjZXNzVG9rZW5cbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oaW5mbyk7XG4gIH1cbik7XG5cbmNvbnN0IGRlZnVSZXBsYWNlQXJyYXlzID0gY3JlYXRlRGVmdSgob2JqLCBrZXksIHZhbHVlKSA9PiB7XG4gIGlmIChBcnJheS5pc0FycmF5KG9ialtrZXldKSAmJiBBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn0pO1xuZnVuY3Rpb24gdG9BdXRoRW5kcG9pbnRzKGVuZHBvaW50cywgY3R4KSB7XG4gIGNvbnN0IGFwaSA9IHt9O1xuICBmb3IgKGNvbnN0IFtrZXksIGVuZHBvaW50XSBvZiBPYmplY3QuZW50cmllcyhlbmRwb2ludHMpKSB7XG4gICAgYXBpW2tleV0gPSBhc3luYyAoY29udGV4dCkgPT4ge1xuICAgICAgY29uc3QgYXV0aENvbnRleHQgPSBhd2FpdCBjdHg7XG4gICAgICBsZXQgaW50ZXJuYWxDb250ZXh0ID0ge1xuICAgICAgICAuLi5jb250ZXh0LFxuICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgLi4uYXV0aENvbnRleHQsXG4gICAgICAgICAgcmV0dXJuZWQ6IHZvaWQgMCxcbiAgICAgICAgICByZXNwb25zZUhlYWRlcnM6IHZvaWQgMCxcbiAgICAgICAgICBzZXNzaW9uOiBudWxsXG4gICAgICAgIH0sXG4gICAgICAgIHBhdGg6IGVuZHBvaW50LnBhdGgsXG4gICAgICAgIGhlYWRlcnM6IGNvbnRleHQ/LmhlYWRlcnMgPyBuZXcgSGVhZGVycyhjb250ZXh0Py5oZWFkZXJzKSA6IHZvaWQgMFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHsgYmVmb3JlSG9va3MsIGFmdGVySG9va3MgfSA9IGdldEhvb2tzKGF1dGhDb250ZXh0KTtcbiAgICAgIGNvbnN0IGJlZm9yZSA9IGF3YWl0IHJ1bkJlZm9yZUhvb2tzKGludGVybmFsQ29udGV4dCwgYmVmb3JlSG9va3MpO1xuICAgICAgaWYgKFwiY29udGV4dFwiIGluIGJlZm9yZSAmJiBiZWZvcmUuY29udGV4dCAmJiB0eXBlb2YgYmVmb3JlLmNvbnRleHQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgY29uc3QgeyBoZWFkZXJzLCAuLi5yZXN0IH0gPSBiZWZvcmUuY29udGV4dDtcbiAgICAgICAgaWYgKGhlYWRlcnMpIHtcbiAgICAgICAgICBoZWFkZXJzLmZvckVhY2goKHZhbHVlLCBrZXkyKSA9PiB7XG4gICAgICAgICAgICBpbnRlcm5hbENvbnRleHQuaGVhZGVycy5zZXQoa2V5MiwgdmFsdWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGludGVybmFsQ29udGV4dCA9IGRlZnVSZXBsYWNlQXJyYXlzKHJlc3QsIGludGVybmFsQ29udGV4dCk7XG4gICAgICB9IGVsc2UgaWYgKGJlZm9yZSkge1xuICAgICAgICByZXR1cm4gY29udGV4dD8uYXNSZXNwb25zZSA/IHRvUmVzcG9uc2UoYmVmb3JlLCB7XG4gICAgICAgICAgaGVhZGVyczogY29udGV4dD8uaGVhZGVyc1xuICAgICAgICB9KSA6IGNvbnRleHQ/LnJldHVybkhlYWRlcnMgPyB7XG4gICAgICAgICAgaGVhZGVyczogY29udGV4dD8uaGVhZGVycyxcbiAgICAgICAgICByZXNwb25zZTogYmVmb3JlXG4gICAgICAgIH0gOiBiZWZvcmU7XG4gICAgICB9XG4gICAgICBpbnRlcm5hbENvbnRleHQuYXNSZXNwb25zZSA9IGZhbHNlO1xuICAgICAgaW50ZXJuYWxDb250ZXh0LnJldHVybkhlYWRlcnMgPSB0cnVlO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZW5kcG9pbnQoaW50ZXJuYWxDb250ZXh0KS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3BvbnNlOiBlLFxuICAgICAgICAgICAgaGVhZGVyczogZS5oZWFkZXJzID8gbmV3IEhlYWRlcnMoZS5oZWFkZXJzKSA6IG51bGxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0IGluc3RhbmNlb2YgUmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkID0gcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmVzcG9uc2VIZWFkZXJzID0gcmVzdWx0LmhlYWRlcnM7XG4gICAgICBjb25zdCBhZnRlciA9IGF3YWl0IHJ1bkFmdGVySG9va3MoaW50ZXJuYWxDb250ZXh0LCBhZnRlckhvb2tzKTtcbiAgICAgIGlmIChhZnRlci5yZXNwb25zZSkge1xuICAgICAgICByZXN1bHQucmVzcG9uc2UgPSBhZnRlci5yZXNwb25zZTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXN1bHQucmVzcG9uc2UgaW5zdGFuY2VvZiBBUElFcnJvciAmJiBzaG91bGRQdWJsaXNoTG9nKGF1dGhDb250ZXh0LmxvZ2dlci5sZXZlbCwgXCJkZWJ1Z1wiKSkge1xuICAgICAgICByZXN1bHQucmVzcG9uc2Uuc3RhY2sgPSByZXN1bHQucmVzcG9uc2UuZXJyb3JTdGFjaztcbiAgICAgIH1cbiAgICAgIGlmIChyZXN1bHQucmVzcG9uc2UgaW5zdGFuY2VvZiBBUElFcnJvciAmJiAhY29udGV4dD8uYXNSZXNwb25zZSkge1xuICAgICAgICB0aHJvdyByZXN1bHQucmVzcG9uc2U7XG4gICAgICB9XG4gICAgICBjb25zdCByZXNwb25zZSA9IGNvbnRleHQ/LmFzUmVzcG9uc2UgPyB0b1Jlc3BvbnNlKHJlc3VsdC5yZXNwb25zZSwge1xuICAgICAgICBoZWFkZXJzOiByZXN1bHQuaGVhZGVyc1xuICAgICAgfSkgOiBjb250ZXh0Py5yZXR1cm5IZWFkZXJzID8ge1xuICAgICAgICBoZWFkZXJzOiByZXN1bHQuaGVhZGVycyxcbiAgICAgICAgcmVzcG9uc2U6IHJlc3VsdC5yZXNwb25zZVxuICAgICAgfSA6IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9O1xuICAgIGFwaVtrZXldLnBhdGggPSBlbmRwb2ludC5wYXRoO1xuICAgIGFwaVtrZXldLm9wdGlvbnMgPSBlbmRwb2ludC5vcHRpb25zO1xuICB9XG4gIHJldHVybiBhcGk7XG59XG5hc3luYyBmdW5jdGlvbiBydW5CZWZvcmVIb29rcyhjb250ZXh0LCBob29rcykge1xuICBsZXQgbW9kaWZpZWRDb250ZXh0ID0ge307XG4gIGZvciAoY29uc3QgaG9vayBvZiBob29rcykge1xuICAgIGlmIChob29rLm1hdGNoZXIoY29udGV4dCkpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhvb2suaGFuZGxlcih7XG4gICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgIHJldHVybkhlYWRlcnM6IGZhbHNlXG4gICAgICB9KS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yICYmIHNob3VsZFB1Ymxpc2hMb2coY29udGV4dC5jb250ZXh0LmxvZ2dlci5sZXZlbCwgXCJkZWJ1Z1wiKSkge1xuICAgICAgICAgIGUuc3RhY2sgPSBlLmVycm9yU3RhY2s7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH0pO1xuICAgICAgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIGlmIChcImNvbnRleHRcIiBpbiByZXN1bHQgJiYgdHlwZW9mIHJlc3VsdC5jb250ZXh0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgY29uc3QgeyBoZWFkZXJzLCAuLi5yZXN0IH0gPSByZXN1bHQuY29udGV4dDtcbiAgICAgICAgICBpZiAoaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMpIHtcbiAgICAgICAgICAgIGlmIChtb2RpZmllZENvbnRleHQuaGVhZGVycykge1xuICAgICAgICAgICAgICBoZWFkZXJzLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBtb2RpZmllZENvbnRleHQuaGVhZGVycz8uc2V0KGtleSwgdmFsdWUpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1vZGlmaWVkQ29udGV4dC5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgbW9kaWZpZWRDb250ZXh0ID0gZGVmdVJlcGxhY2VBcnJheXMocmVzdCwgbW9kaWZpZWRDb250ZXh0KTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4geyBjb250ZXh0OiBtb2RpZmllZENvbnRleHQgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJ1bkFmdGVySG9va3MoY29udGV4dCwgaG9va3MpIHtcbiAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzKSB7XG4gICAgaWYgKGhvb2subWF0Y2hlcihjb250ZXh0KSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaG9vay5oYW5kbGVyKGNvbnRleHQpLmNhdGNoKChlKSA9PiB7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgICBpZiAoc2hvdWxkUHVibGlzaExvZyhjb250ZXh0LmNvbnRleHQubG9nZ2VyLmxldmVsLCBcImRlYnVnXCIpKSB7XG4gICAgICAgICAgICBlLnN0YWNrID0gZS5lcnJvclN0YWNrO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzcG9uc2U6IGUsXG4gICAgICAgICAgICBoZWFkZXJzOiBlLmhlYWRlcnMgPyBuZXcgSGVhZGVycyhlLmhlYWRlcnMpIDogbnVsbFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH0pO1xuICAgICAgaWYgKHJlc3VsdC5oZWFkZXJzKSB7XG4gICAgICAgIHJlc3VsdC5oZWFkZXJzLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcbiAgICAgICAgICBpZiAoIWNvbnRleHQuY29udGV4dC5yZXNwb25zZUhlYWRlcnMpIHtcbiAgICAgICAgICAgIGNvbnRleHQuY29udGV4dC5yZXNwb25zZUhlYWRlcnMgPSBuZXcgSGVhZGVycyh7XG4gICAgICAgICAgICAgIFtrZXldOiB2YWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrZXkudG9Mb3dlckNhc2UoKSA9PT0gXCJzZXQtY29va2llXCIpIHtcbiAgICAgICAgICAgICAgY29udGV4dC5jb250ZXh0LnJlc3BvbnNlSGVhZGVycy5hcHBlbmQoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb250ZXh0LmNvbnRleHQucmVzcG9uc2VIZWFkZXJzLnNldChrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3VsdC5yZXNwb25zZSkge1xuICAgICAgICBjb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSByZXN1bHQucmVzcG9uc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgcmVzcG9uc2U6IGNvbnRleHQuY29udGV4dC5yZXR1cm5lZCxcbiAgICBoZWFkZXJzOiBjb250ZXh0LmNvbnRleHQucmVzcG9uc2VIZWFkZXJzXG4gIH07XG59XG5mdW5jdGlvbiBnZXRIb29rcyhhdXRoQ29udGV4dCkge1xuICBjb25zdCBwbHVnaW5zID0gYXV0aENvbnRleHQub3B0aW9ucy5wbHVnaW5zIHx8IFtdO1xuICBjb25zdCBiZWZvcmVIb29rcyA9IFtdO1xuICBjb25zdCBhZnRlckhvb2tzID0gW107XG4gIGlmIChhdXRoQ29udGV4dC5vcHRpb25zLmhvb2tzPy5iZWZvcmUpIHtcbiAgICBiZWZvcmVIb29rcy5wdXNoKHtcbiAgICAgIG1hdGNoZXI6ICgpID0+IHRydWUsXG4gICAgICBoYW5kbGVyOiBhdXRoQ29udGV4dC5vcHRpb25zLmhvb2tzLmJlZm9yZVxuICAgIH0pO1xuICB9XG4gIGlmIChhdXRoQ29udGV4dC5vcHRpb25zLmhvb2tzPy5hZnRlcikge1xuICAgIGFmdGVySG9va3MucHVzaCh7XG4gICAgICBtYXRjaGVyOiAoKSA9PiB0cnVlLFxuICAgICAgaGFuZGxlcjogYXV0aENvbnRleHQub3B0aW9ucy5ob29rcy5hZnRlclxuICAgIH0pO1xuICB9XG4gIGNvbnN0IHBsdWdpbkJlZm9yZUhvb2tzID0gcGx1Z2lucy5tYXAoKHBsdWdpbikgPT4ge1xuICAgIGlmIChwbHVnaW4uaG9va3M/LmJlZm9yZSkge1xuICAgICAgcmV0dXJuIHBsdWdpbi5ob29rcy5iZWZvcmU7XG4gICAgfVxuICB9KS5maWx0ZXIoKHBsdWdpbikgPT4gcGx1Z2luICE9PSB2b2lkIDApLmZsYXQoKTtcbiAgY29uc3QgcGx1Z2luQWZ0ZXJIb29rcyA9IHBsdWdpbnMubWFwKChwbHVnaW4pID0+IHtcbiAgICBpZiAocGx1Z2luLmhvb2tzPy5hZnRlcikge1xuICAgICAgcmV0dXJuIHBsdWdpbi5ob29rcy5hZnRlcjtcbiAgICB9XG4gIH0pLmZpbHRlcigocGx1Z2luKSA9PiBwbHVnaW4gIT09IHZvaWQgMCkuZmxhdCgpO1xuICBwbHVnaW5CZWZvcmVIb29rcy5sZW5ndGggJiYgYmVmb3JlSG9va3MucHVzaCguLi5wbHVnaW5CZWZvcmVIb29rcyk7XG4gIHBsdWdpbkFmdGVySG9va3MubGVuZ3RoICYmIGFmdGVySG9va3MucHVzaCguLi5wbHVnaW5BZnRlckhvb2tzKTtcbiAgcmV0dXJuIHtcbiAgICBiZWZvcmVIb29rcyxcbiAgICBhZnRlckhvb2tzXG4gIH07XG59XG5cbmV4cG9ydCB7IGNoYW5nZUVtYWlsIGFzIEEsIHNlbmRWZXJpZmljYXRpb25FbWFpbCBhcyBCLCB2ZXJpZnlFbWFpbCBhcyBDLCByZXNldFBhc3N3b3JkIGFzIEQsIGZvcmdldFBhc3N3b3JkIGFzIEUsIHNpZ25JbkVtYWlsIGFzIEYsIHNpZ25PdXQgYXMgRywgSElERV9NRVRBREFUQSBhcyBILCBjYWxsYmFja09BdXRoIGFzIEksIHNpZ25JblNvY2lhbCBhcyBKLCBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbiBhcyBLLCBpc1NpbXBsZVJlcXVlc3QgYXMgTCwgb3JpZ2luQ2hlY2tNaWRkbGV3YXJlIGFzIGEsIG9rIGFzIGIsIGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4gYXMgYywgZGVjcnlwdE9BdXRoVG9rZW4gYXMgZCwgZXJyb3IgYXMgZSwgYWNjb3VudEluZm8gYXMgZiwgZ2VuZXJhdGVTdGF0ZSBhcyBnLCBoYW5kbGVPQXV0aFVzZXJJbmZvIGFzIGgsIGdldEFjY2Vzc1Rva2VuIGFzIGksIHVubGlua0FjY291bnQgYXMgaiwgZGVsZXRlVXNlckNhbGxiYWNrIGFzIGssIGxpc3RVc2VyQWNjb3VudHMgYXMgbCwgbGlua1NvY2lhbEFjY291bnQgYXMgbSwgcmVxdWVzdFBhc3N3b3JkUmVzZXRDYWxsYmFjayBhcyBuLCBvcmlnaW5DaGVjayBhcyBvLCBwYXJzZVN0YXRlIGFzIHAsIHJlcXVlc3RQYXNzd29yZFJlc2V0IGFzIHEsIHJlZnJlc2hUb2tlbiBhcyByLCBzZXRUb2tlblV0aWwgYXMgcywgdG9BdXRoRW5kcG9pbnRzIGFzIHQsIHVwZGF0ZVVzZXIgYXMgdSwgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjayBhcyB2LCB3aWxkY2FyZE1hdGNoIGFzIHcsIGRlbGV0ZVVzZXIgYXMgeCwgc2V0UGFzc3dvcmQgYXMgeSwgY2hhbmdlUGFzc3dvcmQgYXMgeiB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createKyselyAdapter),\n/* harmony export */   g: () => (/* binding */ getKyselyDatabaseType),\n/* harmony export */   k: () => (/* binding */ kyselyAdapter)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/mssql/mssql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/kysely.js\");\n/* harmony import */ var _better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n\n\n\nfunction getKyselyDatabaseType(db) {\n  if (!db) {\n    return null;\n  }\n  if (\"dialect\" in db) {\n    return getKyselyDatabaseType(db.dialect);\n  }\n  if (\"createDriver\" in db) {\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_1__.SqliteDialect) {\n      return \"sqlite\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_2__.MysqlDialect) {\n      return \"mysql\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_3__.PostgresDialect) {\n      return \"postgres\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_4__.MssqlDialect) {\n      return \"mssql\";\n    }\n  }\n  if (\"aggregate\" in db) {\n    return \"sqlite\";\n  }\n  if (\"getConnection\" in db) {\n    return \"mysql\";\n  }\n  if (\"connect\" in db) {\n    return \"postgres\";\n  }\n  if (\"fileControl\" in db) {\n    return \"sqlite\";\n  }\n  if (\"open\" in db && \"close\" in db && \"prepare\" in db) {\n    return \"sqlite\";\n  }\n  return null;\n}\nconst createKyselyAdapter = async (config) => {\n  const db = config.database;\n  if (!db) {\n    return {\n      kysely: null,\n      databaseType: null,\n      transaction: void 0\n    };\n  }\n  if (\"db\" in db) {\n    return {\n      kysely: db.db,\n      databaseType: db.type,\n      transaction: db.transaction\n    };\n  }\n  if (\"dialect\" in db) {\n    return {\n      kysely: new kysely__WEBPACK_IMPORTED_MODULE_5__.Kysely({ dialect: db.dialect }),\n      databaseType: db.type,\n      transaction: db.transaction\n    };\n  }\n  let dialect = void 0;\n  const databaseType = getKyselyDatabaseType(db);\n  if (\"createDriver\" in db) {\n    dialect = db;\n  }\n  if (\"aggregate\" in db && !(\"createSession\" in db)) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_1__.SqliteDialect({\n      database: db\n    });\n  }\n  if (\"getConnection\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_2__.MysqlDialect(db);\n  }\n  if (\"connect\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_3__.PostgresDialect({\n      pool: db\n    });\n  }\n  if (\"fileControl\" in db) {\n    const { BunSqliteDialect } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/better-auth\").then(__webpack_require__.bind(__webpack_require__, /*! ../chunks/bun-sqlite-dialect.mjs */ \"(rsc)/./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs\"));\n    dialect = new BunSqliteDialect({\n      database: db\n    });\n  }\n  if (\"createSession\" in db && typeof window === \"undefined\") {\n    let DatabaseSync = void 0;\n    try {\n      let nodeSqlite = \"node:sqlite\";\n      ({ DatabaseSync } = await import(\n        /* @vite-ignore */\n        /* webpackIgnore: true */\n        nodeSqlite\n      ));\n    } catch (error) {\n      if (error !== null && typeof error === \"object\" && \"code\" in error && error.code !== \"ERR_UNKNOWN_BUILTIN_MODULE\") {\n        throw error;\n      }\n    }\n    if (DatabaseSync && db instanceof DatabaseSync) {\n      const { NodeSqliteDialect } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/better-auth\").then(__webpack_require__.bind(__webpack_require__, /*! ../chunks/node-sqlite-dialect.mjs */ \"(rsc)/./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs\"));\n      dialect = new NodeSqliteDialect({\n        database: db\n      });\n    }\n  }\n  return {\n    kysely: dialect ? new kysely__WEBPACK_IMPORTED_MODULE_5__.Kysely({ dialect }) : null,\n    databaseType,\n    transaction: void 0\n  };\n};\n\nconst kyselyAdapter = (db, config) => {\n  let lazyOptions = null;\n  const createCustomAdapter = (db2) => {\n    return ({ getFieldName, schema, getDefaultModelName }) => {\n      const withReturning = async (values, builder, model, where) => {\n        let res;\n        if (config?.type === \"mysql\") {\n          await builder.execute();\n          const field = values.id ? \"id\" : where.length > 0 && where[0]?.field ? where[0].field : \"id\";\n          if (!values.id && where.length === 0) {\n            res = await db2.selectFrom(model).selectAll().orderBy(getFieldName({ model, field }), \"desc\").limit(1).executeTakeFirst();\n            return res;\n          }\n          const value = values[field] || where[0]?.value;\n          res = await db2.selectFrom(model).selectAll().orderBy(getFieldName({ model, field }), \"desc\").where(getFieldName({ model, field }), \"=\", value).limit(1).executeTakeFirst();\n          return res;\n        }\n        if (config?.type === \"mssql\") {\n          res = await builder.outputAll(\"inserted\").executeTakeFirst();\n          return res;\n        }\n        res = await builder.returningAll().executeTakeFirst();\n        return res;\n      };\n      function transformValueToDB(value, model, field) {\n        if (field === \"id\") {\n          return value;\n        }\n        const { type = \"sqlite\" } = config || {};\n        let f = schema[model]?.fields[field];\n        if (!f) {\n          f = Object.values(schema).find((f2) => f2.modelName === model);\n        }\n        if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null && value !== void 0) {\n          return value ? 1 : 0;\n        }\n        if (f.type === \"date\" && value && value instanceof Date) {\n          if (type === \"sqlite\") return value.toISOString();\n          return value;\n        }\n        return value;\n      }\n      function transformValueFromDB(value) {\n        function transformObject(obj) {\n          for (const key in obj) {\n            if (!Object.prototype.hasOwnProperty.call(obj, key)) continue;\n            const field = obj[key];\n            if (field instanceof Date && config?.type === \"mysql\") ; else if (typeof field === \"object\" && field !== null) {\n              transformObject(field);\n            }\n          }\n        }\n        if (Array.isArray(value)) {\n          for (let i = 0; i < value.length; i++) {\n            const item = value[i];\n            if (typeof item === \"object\" && item !== null) {\n              transformObject(item);\n            }\n          }\n        } else if (typeof value === \"object\" && value !== null) {\n          transformObject(value);\n        }\n        return value;\n      }\n      function convertWhereClause(model, w) {\n        if (!w)\n          return {\n            and: null,\n            or: null\n          };\n        const conditions = {\n          and: [],\n          or: []\n        };\n        w.forEach((condition) => {\n          let {\n            field: _field,\n            value,\n            operator = \"=\",\n            connector = \"AND\"\n          } = condition;\n          const field = getFieldName({ model, field: _field });\n          value = transformValueToDB(value, model, _field);\n          const expr = (eb) => {\n            if (operator.toLowerCase() === \"in\") {\n              return eb(field, \"in\", Array.isArray(value) ? value : [value]);\n            }\n            if (operator.toLowerCase() === \"not_in\") {\n              return eb(\n                field,\n                \"not in\",\n                Array.isArray(value) ? value : [value]\n              );\n            }\n            if (operator === \"contains\") {\n              return eb(field, \"like\", `%${value}%`);\n            }\n            if (operator === \"starts_with\") {\n              return eb(field, \"like\", `${value}%`);\n            }\n            if (operator === \"ends_with\") {\n              return eb(field, \"like\", `%${value}`);\n            }\n            if (operator === \"eq\") {\n              return eb(field, \"=\", value);\n            }\n            if (operator === \"ne\") {\n              return eb(field, \"<>\", value);\n            }\n            if (operator === \"gt\") {\n              return eb(field, \">\", value);\n            }\n            if (operator === \"gte\") {\n              return eb(field, \">=\", value);\n            }\n            if (operator === \"lt\") {\n              return eb(field, \"<\", value);\n            }\n            if (operator === \"lte\") {\n              return eb(field, \"<=\", value);\n            }\n            return eb(field, operator, value);\n          };\n          if (connector === \"OR\") {\n            conditions.or.push(expr);\n          } else {\n            conditions.and.push(expr);\n          }\n        });\n        return {\n          and: conditions.and.length ? conditions.and : null,\n          or: conditions.or.length ? conditions.or : null\n        };\n      }\n      return {\n        async create({ data, model }) {\n          const builder = db2.insertInto(model).values(data);\n          const returned = await withReturning(data, builder, model, []);\n          return transformValueFromDB(returned);\n        },\n        async findOne({ model, where, select }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.selectFrom(model).selectAll();\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          const res = await query.executeTakeFirst();\n          if (!res) return null;\n          return transformValueFromDB(res);\n        },\n        async findMany({ model, where, limit, offset, sortBy }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.selectFrom(model);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          if (config?.type === \"mssql\") {\n            if (!offset) {\n              query = query.top(limit || 100);\n            }\n          } else {\n            query = query.limit(limit || 100);\n          }\n          if (sortBy) {\n            query = query.orderBy(\n              getFieldName({ model, field: sortBy.field }),\n              sortBy.direction\n            );\n          }\n          if (offset) {\n            if (config?.type === \"mssql\") {\n              if (!sortBy) {\n                query = query.orderBy(getFieldName({ model, field: \"id\" }));\n              }\n              query = query.offset(offset).fetch(limit || 100);\n            } else {\n              query = query.offset(offset);\n            }\n          }\n          const res = await query.selectAll().execute();\n          if (!res) return [];\n          return transformValueFromDB(res);\n        },\n        async update({ model, where, update: values }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.updateTable(model).set(values);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          return transformValueFromDB(\n            await withReturning(values, query, model, where)\n          );\n        },\n        async updateMany({ model, where, update: values }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.updateTable(model).set(values);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          const res = await query.execute();\n          return res.length;\n        },\n        async count({ model, where }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.selectFrom(model).select(db2.fn.count(\"id\").as(\"count\"));\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          const res = await query.execute();\n          if (typeof res[0].count === \"number\") {\n            return res[0].count;\n          }\n          if (typeof res[0].count === \"bigint\") {\n            return Number(res[0].count);\n          }\n          return parseInt(res[0].count);\n        },\n        async delete({ model, where }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.deleteFrom(model);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          await query.execute();\n        },\n        async deleteMany({ model, where }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.deleteFrom(model);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          return (await query.execute()).length;\n        },\n        options: config\n      };\n    };\n  };\n  let adapterOptions = null;\n  adapterOptions = {\n    config: {\n      adapterId: \"kysely\",\n      adapterName: \"Kysely Adapter\",\n      usePlural: config?.usePlural,\n      debugLogs: config?.debugLogs,\n      supportsBooleans: config?.type === \"sqlite\" || config?.type === \"mssql\" || config?.type === \"mysql\" || !config?.type ? false : true,\n      supportsDates: config?.type === \"sqlite\" || config?.type === \"mssql\" || !config?.type ? false : true,\n      supportsJSON: false,\n      transaction: config?.transaction ?? false ? (cb) => db.transaction().execute((trx) => {\n        const adapter2 = (0,_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c)({\n          config: adapterOptions.config,\n          adapter: createCustomAdapter(trx)\n        })(lazyOptions);\n        return cb(adapter2);\n      }) : false\n    },\n    adapter: createCustomAdapter(db)\n  };\n  const adapter = (0,_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c)(adapterOptions);\n  return (options) => {\n    lazyOptions = options;\n    return adapter(options);\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ0JUUzJPelgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUE0RjtBQUNyQjs7QUFFdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpREFBYTtBQUNuQztBQUNBO0FBQ0Esc0JBQXNCLGdEQUFZO0FBQ2xDO0FBQ0E7QUFDQSxzQkFBc0IsbURBQWU7QUFDckM7QUFDQTtBQUNBLHNCQUFzQixnREFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDBDQUFNLEdBQUcscUJBQXFCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGlEQUFhO0FBQy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxrQkFBa0IsZ0RBQVk7QUFDOUI7QUFDQTtBQUNBLGtCQUFrQixtREFBZTtBQUNqQztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWSxtQkFBbUIsUUFBUSxxT0FBMEM7QUFDakY7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxlQUFlO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9CQUFvQixRQUFRLHVPQUEyQztBQUNyRjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwwQ0FBTSxHQUFHLFNB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDREQUFvQjtBQUM3QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0Esa0JBQWtCLDREQUFvQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVvRiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkNCVFMyT3pYLm1qcz82YjI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNxbGl0ZURpYWxlY3QsIE15c3FsRGlhbGVjdCwgUG9zdGdyZXNEaWFsZWN0LCBNc3NxbERpYWxlY3QsIEt5c2VseSB9IGZyb20gJ2t5c2VseSc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZUFkYXB0ZXJGYWN0b3J5IH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5FQnhLZVZOWi5tanMnO1xuXG5mdW5jdGlvbiBnZXRLeXNlbHlEYXRhYmFzZVR5cGUoZGIpIHtcbiAgaWYgKCFkYikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmIChcImRpYWxlY3RcIiBpbiBkYikge1xuICAgIHJldHVybiBnZXRLeXNlbHlEYXRhYmFzZVR5cGUoZGIuZGlhbGVjdCk7XG4gIH1cbiAgaWYgKFwiY3JlYXRlRHJpdmVyXCIgaW4gZGIpIHtcbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBTcWxpdGVEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJzcWxpdGVcIjtcbiAgICB9XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgTXlzcWxEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJteXNxbFwiO1xuICAgIH1cbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBQb3N0Z3Jlc0RpYWxlY3QpIHtcbiAgICAgIHJldHVybiBcInBvc3RncmVzXCI7XG4gICAgfVxuICAgIGlmIChkYiBpbnN0YW5jZW9mIE1zc3FsRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwibXNzcWxcIjtcbiAgICB9XG4gIH1cbiAgaWYgKFwiYWdncmVnYXRlXCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJzcWxpdGVcIjtcbiAgfVxuICBpZiAoXCJnZXRDb25uZWN0aW9uXCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJteXNxbFwiO1xuICB9XG4gIGlmIChcImNvbm5lY3RcIiBpbiBkYikge1xuICAgIHJldHVybiBcInBvc3RncmVzXCI7XG4gIH1cbiAgaWYgKFwiZmlsZUNvbnRyb2xcIiBpbiBkYikge1xuICAgIHJldHVybiBcInNxbGl0ZVwiO1xuICB9XG4gIGlmIChcIm9wZW5cIiBpbiBkYiAmJiBcImNsb3NlXCIgaW4gZGIgJiYgXCJwcmVwYXJlXCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJzcWxpdGVcIjtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbmNvbnN0IGNyZWF0ZUt5c2VseUFkYXB0ZXIgPSBhc3luYyAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGRiID0gY29uZmlnLmRhdGFiYXNlO1xuICBpZiAoIWRiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGt5c2VseTogbnVsbCxcbiAgICAgIGRhdGFiYXNlVHlwZTogbnVsbCxcbiAgICAgIHRyYW5zYWN0aW9uOiB2b2lkIDBcbiAgICB9O1xuICB9XG4gIGlmIChcImRiXCIgaW4gZGIpIHtcbiAgICByZXR1cm4ge1xuICAgICAga3lzZWx5OiBkYi5kYixcbiAgICAgIGRhdGFiYXNlVHlwZTogZGIudHlwZSxcbiAgICAgIHRyYW5zYWN0aW9uOiBkYi50cmFuc2FjdGlvblxuICAgIH07XG4gIH1cbiAgaWYgKFwiZGlhbGVjdFwiIGluIGRiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGt5c2VseTogbmV3IEt5c2VseSh7IGRpYWxlY3Q6IGRiLmRpYWxlY3QgfSksXG4gICAgICBkYXRhYmFzZVR5cGU6IGRiLnR5cGUsXG4gICAgICB0cmFuc2FjdGlvbjogZGIudHJhbnNhY3Rpb25cbiAgICB9O1xuICB9XG4gIGxldCBkaWFsZWN0ID0gdm9pZCAwO1xuICBjb25zdCBkYXRhYmFzZVR5cGUgPSBnZXRLeXNlbHlEYXRhYmFzZVR5cGUoZGIpO1xuICBpZiAoXCJjcmVhdGVEcml2ZXJcIiBpbiBkYikge1xuICAgIGRpYWxlY3QgPSBkYjtcbiAgfVxuICBpZiAoXCJhZ2dyZWdhdGVcIiBpbiBkYiAmJiAhKFwiY3JlYXRlU2Vzc2lvblwiIGluIGRiKSkge1xuICAgIGRpYWxlY3QgPSBuZXcgU3FsaXRlRGlhbGVjdCh7XG4gICAgICBkYXRhYmFzZTogZGJcbiAgICB9KTtcbiAgfVxuICBpZiAoXCJnZXRDb25uZWN0aW9uXCIgaW4gZGIpIHtcbiAgICBkaWFsZWN0ID0gbmV3IE15c3FsRGlhbGVjdChkYik7XG4gIH1cbiAgaWYgKFwiY29ubmVjdFwiIGluIGRiKSB7XG4gICAgZGlhbGVjdCA9IG5ldyBQb3N0Z3Jlc0RpYWxlY3Qoe1xuICAgICAgcG9vbDogZGJcbiAgICB9KTtcbiAgfVxuICBpZiAoXCJmaWxlQ29udHJvbFwiIGluIGRiKSB7XG4gICAgY29uc3QgeyBCdW5TcWxpdGVEaWFsZWN0IH0gPSBhd2FpdCBpbXBvcnQoJy4uL2NodW5rcy9idW4tc3FsaXRlLWRpYWxlY3QubWpzJyk7XG4gICAgZGlhbGVjdCA9IG5ldyBCdW5TcWxpdGVEaWFsZWN0KHtcbiAgICAgIGRhdGFiYXNlOiBkYlxuICAgIH0pO1xuICB9XG4gIGlmIChcImNyZWF0ZVNlc3Npb25cIiBpbiBkYiAmJiB0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgbGV0IERhdGFiYXNlU3luYyA9IHZvaWQgMDtcbiAgICB0cnkge1xuICAgICAgbGV0IG5vZGVTcWxpdGUgPSBcIm5vZGU6c3FsaXRlXCI7XG4gICAgICAoeyBEYXRhYmFzZVN5bmMgfSA9IGF3YWl0IGltcG9ydChcbiAgICAgICAgLyogQHZpdGUtaWdub3JlICovXG4gICAgICAgIC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi9cbiAgICAgICAgbm9kZVNxbGl0ZVxuICAgICAgKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciAhPT0gbnVsbCAmJiB0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgJiYgXCJjb2RlXCIgaW4gZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gXCJFUlJfVU5LTk9XTl9CVUlMVElOX01PRFVMRVwiKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoRGF0YWJhc2VTeW5jICYmIGRiIGluc3RhbmNlb2YgRGF0YWJhc2VTeW5jKSB7XG4gICAgICBjb25zdCB7IE5vZGVTcWxpdGVEaWFsZWN0IH0gPSBhd2FpdCBpbXBvcnQoJy4uL2NodW5rcy9ub2RlLXNxbGl0ZS1kaWFsZWN0Lm1qcycpO1xuICAgICAgZGlhbGVjdCA9IG5ldyBOb2RlU3FsaXRlRGlhbGVjdCh7XG4gICAgICAgIGRhdGFiYXNlOiBkYlxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAga3lzZWx5OiBkaWFsZWN0ID8gbmV3IEt5c2VseSh7IGRpYWxlY3QgfSkgOiBudWxsLFxuICAgIGRhdGFiYXNlVHlwZSxcbiAgICB0cmFuc2FjdGlvbjogdm9pZCAwXG4gIH07XG59O1xuXG5jb25zdCBreXNlbHlBZGFwdGVyID0gKGRiLCBjb25maWcpID0+IHtcbiAgbGV0IGxhenlPcHRpb25zID0gbnVsbDtcbiAgY29uc3QgY3JlYXRlQ3VzdG9tQWRhcHRlciA9IChkYjIpID0+IHtcbiAgICByZXR1cm4gKHsgZ2V0RmllbGROYW1lLCBzY2hlbWEsIGdldERlZmF1bHRNb2RlbE5hbWUgfSkgPT4ge1xuICAgICAgY29uc3Qgd2l0aFJldHVybmluZyA9IGFzeW5jICh2YWx1ZXMsIGJ1aWxkZXIsIG1vZGVsLCB3aGVyZSkgPT4ge1xuICAgICAgICBsZXQgcmVzO1xuICAgICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm15c3FsXCIpIHtcbiAgICAgICAgICBhd2FpdCBidWlsZGVyLmV4ZWN1dGUoKTtcbiAgICAgICAgICBjb25zdCBmaWVsZCA9IHZhbHVlcy5pZCA/IFwiaWRcIiA6IHdoZXJlLmxlbmd0aCA+IDAgJiYgd2hlcmVbMF0/LmZpZWxkID8gd2hlcmVbMF0uZmllbGQgOiBcImlkXCI7XG4gICAgICAgICAgaWYgKCF2YWx1ZXMuaWQgJiYgd2hlcmUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXMgPSBhd2FpdCBkYjIuc2VsZWN0RnJvbShtb2RlbCkuc2VsZWN0QWxsKCkub3JkZXJCeShnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQgfSksIFwiZGVzY1wiKS5saW1pdCgxKS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tmaWVsZF0gfHwgd2hlcmVbMF0/LnZhbHVlO1xuICAgICAgICAgIHJlcyA9IGF3YWl0IGRiMi5zZWxlY3RGcm9tKG1vZGVsKS5zZWxlY3RBbGwoKS5vcmRlckJ5KGdldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZCB9KSwgXCJkZXNjXCIpLndoZXJlKGdldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZCB9KSwgXCI9XCIsIHZhbHVlKS5saW1pdCgxKS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgICByZXMgPSBhd2FpdCBidWlsZGVyLm91dHB1dEFsbChcImluc2VydGVkXCIpLmV4ZWN1dGVUYWtlRmlyc3QoKTtcbiAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgICAgIHJlcyA9IGF3YWl0IGJ1aWxkZXIucmV0dXJuaW5nQWxsKCkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfTtcbiAgICAgIGZ1bmN0aW9uIHRyYW5zZm9ybVZhbHVlVG9EQih2YWx1ZSwgbW9kZWwsIGZpZWxkKSB7XG4gICAgICAgIGlmIChmaWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgdHlwZSA9IFwic3FsaXRlXCIgfSA9IGNvbmZpZyB8fCB7fTtcbiAgICAgICAgbGV0IGYgPSBzY2hlbWFbbW9kZWxdPy5maWVsZHNbZmllbGRdO1xuICAgICAgICBpZiAoIWYpIHtcbiAgICAgICAgICBmID0gT2JqZWN0LnZhbHVlcyhzY2hlbWEpLmZpbmQoKGYyKSA9PiBmMi5tb2RlbE5hbWUgPT09IG1vZGVsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZi50eXBlID09PSBcImJvb2xlYW5cIiAmJiAodHlwZSA9PT0gXCJzcWxpdGVcIiB8fCB0eXBlID09PSBcIm1zc3FsXCIpICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWUgPyAxIDogMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZi50eXBlID09PSBcImRhdGVcIiAmJiB2YWx1ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICBpZiAodHlwZSA9PT0gXCJzcWxpdGVcIikgcmV0dXJuIHZhbHVlLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHRyYW5zZm9ybVZhbHVlRnJvbURCKHZhbHVlKSB7XG4gICAgICAgIGZ1bmN0aW9uIHRyYW5zZm9ybU9iamVjdChvYmopIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgY29udGludWU7XG4gICAgICAgICAgICBjb25zdCBmaWVsZCA9IG9ialtrZXldO1xuICAgICAgICAgICAgaWYgKGZpZWxkIGluc3RhbmNlb2YgRGF0ZSAmJiBjb25maWc/LnR5cGUgPT09IFwibXlzcWxcIikgOyBlbHNlIGlmICh0eXBlb2YgZmllbGQgPT09IFwib2JqZWN0XCIgJiYgZmllbGQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtT2JqZWN0KGZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHZhbHVlW2ldO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSBcIm9iamVjdFwiICYmIGl0ZW0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtT2JqZWN0KGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICB0cmFuc2Zvcm1PYmplY3QodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgdykge1xuICAgICAgICBpZiAoIXcpXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFuZDogbnVsbCxcbiAgICAgICAgICAgIG9yOiBudWxsXG4gICAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHtcbiAgICAgICAgICBhbmQ6IFtdLFxuICAgICAgICAgIG9yOiBbXVxuICAgICAgICB9O1xuICAgICAgICB3LmZvckVhY2goKGNvbmRpdGlvbikgPT4ge1xuICAgICAgICAgIGxldCB7XG4gICAgICAgICAgICBmaWVsZDogX2ZpZWxkLFxuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBvcGVyYXRvciA9IFwiPVwiLFxuICAgICAgICAgICAgY29ubmVjdG9yID0gXCJBTkRcIlxuICAgICAgICAgIH0gPSBjb25kaXRpb247XG4gICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IF9maWVsZCB9KTtcbiAgICAgICAgICB2YWx1ZSA9IHRyYW5zZm9ybVZhbHVlVG9EQih2YWx1ZSwgbW9kZWwsIF9maWVsZCk7XG4gICAgICAgICAgY29uc3QgZXhwciA9IChlYikgPT4ge1xuICAgICAgICAgICAgaWYgKG9wZXJhdG9yLnRvTG93ZXJDYXNlKCkgPT09IFwiaW5cIikge1xuICAgICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiaW5cIiwgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yLnRvTG93ZXJDYXNlKCkgPT09IFwibm90X2luXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKFxuICAgICAgICAgICAgICAgIGZpZWxkLFxuICAgICAgICAgICAgICAgIFwibm90IGluXCIsXG4gICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV1cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJjb250YWluc1wiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCJsaWtlXCIsIGAlJHt2YWx1ZX0lYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwic3RhcnRzX3dpdGhcIikge1xuICAgICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwibGlrZVwiLCBgJHt2YWx1ZX0lYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZW5kc193aXRoXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcImxpa2VcIiwgYCUke3ZhbHVlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImVxXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIj1cIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcIm5lXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIjw+XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJndFwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI+XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJndGVcIikge1xuICAgICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPj1cIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImx0XCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIjxcIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImx0ZVwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8PVwiLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIG9wZXJhdG9yLCB2YWx1ZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAoY29ubmVjdG9yID09PSBcIk9SXCIpIHtcbiAgICAgICAgICAgIGNvbmRpdGlvbnMub3IucHVzaChleHByKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uZGl0aW9ucy5hbmQucHVzaChleHByKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFuZDogY29uZGl0aW9ucy5hbmQubGVuZ3RoID8gY29uZGl0aW9ucy5hbmQgOiBudWxsLFxuICAgICAgICAgIG9yOiBjb25kaXRpb25zLm9yLmxlbmd0aCA/IGNvbmRpdGlvbnMub3IgOiBudWxsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhc3luYyBjcmVhdGUoeyBkYXRhLCBtb2RlbCB9KSB7XG4gICAgICAgICAgY29uc3QgYnVpbGRlciA9IGRiMi5pbnNlcnRJbnRvKG1vZGVsKS52YWx1ZXMoZGF0YSk7XG4gICAgICAgICAgY29uc3QgcmV0dXJuZWQgPSBhd2FpdCB3aXRoUmV0dXJuaW5nKGRhdGEsIGJ1aWxkZXIsIG1vZGVsLCBbXSk7XG4gICAgICAgICAgcmV0dXJuIHRyYW5zZm9ybVZhbHVlRnJvbURCKHJldHVybmVkKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgZmluZE9uZSh7IG1vZGVsLCB3aGVyZSwgc2VsZWN0IH0pIHtcbiAgICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICAgIGxldCBxdWVyeSA9IGRiMi5zZWxlY3RGcm9tKG1vZGVsKS5zZWxlY3RBbGwoKTtcbiAgICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICAgICAgaWYgKCFyZXMpIHJldHVybiBudWxsO1xuICAgICAgICAgIHJldHVybiB0cmFuc2Zvcm1WYWx1ZUZyb21EQihyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBmaW5kTWFueSh7IG1vZGVsLCB3aGVyZSwgbGltaXQsIG9mZnNldCwgc29ydEJ5IH0pIHtcbiAgICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICAgIGxldCBxdWVyeSA9IGRiMi5zZWxlY3RGcm9tKG1vZGVsKTtcbiAgICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgICAgIGlmICghb2Zmc2V0KSB7XG4gICAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkudG9wKGxpbWl0IHx8IDEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkubGltaXQobGltaXQgfHwgMTAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHNvcnRCeSkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5vcmRlckJ5KFxuICAgICAgICAgICAgICBnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHNvcnRCeS5maWVsZCB9KSxcbiAgICAgICAgICAgICAgc29ydEJ5LmRpcmVjdGlvblxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJtc3NxbFwiKSB7XG4gICAgICAgICAgICAgIGlmICghc29ydEJ5KSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5vcmRlckJ5KGdldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZDogXCJpZFwiIH0pKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9mZnNldChvZmZzZXQpLmZldGNoKGxpbWl0IHx8IDEwMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9mZnNldChvZmZzZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeS5zZWxlY3RBbGwoKS5leGVjdXRlKCk7XG4gICAgICAgICAgaWYgKCFyZXMpIHJldHVybiBbXTtcbiAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtVmFsdWVGcm9tREIocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgdXBkYXRlKHsgbW9kZWwsIHdoZXJlLCB1cGRhdGU6IHZhbHVlcyB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIudXBkYXRlVGFibGUobW9kZWwpLnNldCh2YWx1ZXMpO1xuICAgICAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcikge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0cmFuc2Zvcm1WYWx1ZUZyb21EQihcbiAgICAgICAgICAgIGF3YWl0IHdpdGhSZXR1cm5pbmcodmFsdWVzLCBxdWVyeSwgbW9kZWwsIHdoZXJlKVxuICAgICAgICAgICk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHVwZGF0ZU1hbnkoeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZTogdmFsdWVzIH0pIHtcbiAgICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICAgIGxldCBxdWVyeSA9IGRiMi51cGRhdGVUYWJsZShtb2RlbCkuc2V0KHZhbHVlcyk7XG4gICAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZSgpO1xuICAgICAgICAgIHJldHVybiByZXMubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBjb3VudCh7IG1vZGVsLCB3aGVyZSB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIuc2VsZWN0RnJvbShtb2RlbCkuc2VsZWN0KGRiMi5mbi5jb3VudChcImlkXCIpLmFzKFwiY291bnRcIikpO1xuICAgICAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcikge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICAgICAgICBpZiAodHlwZW9mIHJlc1swXS5jb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgcmV0dXJuIHJlc1swXS5jb3VudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiByZXNbMF0uY291bnQgPT09IFwiYmlnaW50XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIocmVzWzBdLmNvdW50KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHJlc1swXS5jb3VudCk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIGRlbGV0ZSh7IG1vZGVsLCB3aGVyZSB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIuZGVsZXRlRnJvbShtb2RlbCk7XG4gICAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgcXVlcnkuZXhlY3V0ZSgpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBkZWxldGVNYW55KHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICAgIGxldCBxdWVyeSA9IGRiMi5kZWxldGVGcm9tKG1vZGVsKTtcbiAgICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gKGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKSkubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBvcHRpb25zOiBjb25maWdcbiAgICAgIH07XG4gICAgfTtcbiAgfTtcbiAgbGV0IGFkYXB0ZXJPcHRpb25zID0gbnVsbDtcbiAgYWRhcHRlck9wdGlvbnMgPSB7XG4gICAgY29uZmlnOiB7XG4gICAgICBhZGFwdGVySWQ6IFwia3lzZWx5XCIsXG4gICAgICBhZGFwdGVyTmFtZTogXCJLeXNlbHkgQWRhcHRlclwiLFxuICAgICAgdXNlUGx1cmFsOiBjb25maWc/LnVzZVBsdXJhbCxcbiAgICAgIGRlYnVnTG9nczogY29uZmlnPy5kZWJ1Z0xvZ3MsXG4gICAgICBzdXBwb3J0c0Jvb2xlYW5zOiBjb25maWc/LnR5cGUgPT09IFwic3FsaXRlXCIgfHwgY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIgfHwgY29uZmlnPy50eXBlID09PSBcIm15c3FsXCIgfHwgIWNvbmZpZz8udHlwZSA/IGZhbHNlIDogdHJ1ZSxcbiAgICAgIHN1cHBvcnRzRGF0ZXM6IGNvbmZpZz8udHlwZSA9PT0gXCJzcWxpdGVcIiB8fCBjb25maWc/LnR5cGUgPT09IFwibXNzcWxcIiB8fCAhY29uZmlnPy50eXBlID8gZmFsc2UgOiB0cnVlLFxuICAgICAgc3VwcG9ydHNKU09OOiBmYWxzZSxcbiAgICAgIHRyYW5zYWN0aW9uOiBjb25maWc/LnRyYW5zYWN0aW9uID8/IGZhbHNlID8gKGNiKSA9PiBkYi50cmFuc2FjdGlvbigpLmV4ZWN1dGUoKHRyeCkgPT4ge1xuICAgICAgICBjb25zdCBhZGFwdGVyMiA9IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5KHtcbiAgICAgICAgICBjb25maWc6IGFkYXB0ZXJPcHRpb25zLmNvbmZpZyxcbiAgICAgICAgICBhZGFwdGVyOiBjcmVhdGVDdXN0b21BZGFwdGVyKHRyeClcbiAgICAgICAgfSkobGF6eU9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gY2IoYWRhcHRlcjIpO1xuICAgICAgfSkgOiBmYWxzZVxuICAgIH0sXG4gICAgYWRhcHRlcjogY3JlYXRlQ3VzdG9tQWRhcHRlcihkYilcbiAgfTtcbiAgY29uc3QgYWRhcHRlciA9IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5KGFkYXB0ZXJPcHRpb25zKTtcbiAgcmV0dXJuIChvcHRpb25zKSA9PiB7XG4gICAgbGF6eU9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHJldHVybiBhZGFwdGVyKG9wdGlvbnMpO1xuICB9O1xufTtcblxuZXhwb3J0IHsgY3JlYXRlS3lzZWx5QWRhcHRlciBhcyBjLCBnZXRLeXNlbHlEYXRhYmFzZVR5cGUgYXMgZywga3lzZWx5QWRhcHRlciBhcyBrIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   b: () => (/* binding */ betterAuth)\n/* harmony export */ });\n/* harmony import */ var _api_index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../api/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/api/index.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BG42OQGC.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs\");\n/* harmony import */ var _better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.YwDQhoPc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/telemetry */ \"(rsc)/./node_modules/@better-auth/telemetry/dist/index.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./better-auth.CBTS2OzX.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst DEFAULT_SECRET = \"better-auth-secret-123456789\";\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === \"object\" || typeof obj === \"function\") && typeof obj.then === \"function\";\n}\n\nconst init = async (options) => {\n  const adapter = await (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.a)(options);\n  const plugins = options.plugins || [];\n  const internalPlugins = getInternalPlugins(options);\n  const logger = (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.createLogger)(options.logger);\n  const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.a)(options.baseURL, options.basePath);\n  const secret = options.secret || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.env.BETTER_AUTH_SECRET || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.env.AUTH_SECRET || DEFAULT_SECRET;\n  if (secret === DEFAULT_SECRET) {\n    if (_better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.isProduction) {\n      logger.error(\n        \"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\"\n      );\n    }\n  }\n  options = {\n    ...options,\n    secret,\n    baseURL: baseURL ? new URL(baseURL).origin : \"\",\n    basePath: options.basePath || \"/api/auth\",\n    plugins: plugins.concat(internalPlugins)\n  };\n  (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.checkEndpointConflicts)(options, logger);\n  const cookies = (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(options);\n  const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_5__.g)(options);\n  const providers = Object.entries(\n    options.socialProviders || {}\n  ).map(([key, config]) => {\n    if (config == null) {\n      return null;\n    }\n    if (config.enabled === false) {\n      return null;\n    }\n    if (!config.clientId) {\n      logger.warn(\n        `Social provider ${key} is missing clientId or clientSecret`\n      );\n    }\n    const provider = _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_9__.socialProviders[key](config);\n    provider.disableImplicitSignUp = config.disableImplicitSignUp;\n    return provider;\n  }).filter((x) => x !== null);\n  const generateIdFunc = ({ model, size }) => {\n    if (typeof options.advanced?.generateId === \"function\") {\n      return options.advanced.generateId({ model, size });\n    }\n    if (typeof options?.advanced?.database?.generateId === \"function\") {\n      return options.advanced.database.generateId({ model, size });\n    }\n    return (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(size);\n  };\n  const { publish } = await (0,_better_auth_telemetry__WEBPACK_IMPORTED_MODULE_17__.createTelemetry)(options, {\n    adapter: adapter.id,\n    database: typeof options.database === \"function\" ? \"adapter\" : (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_19__.g)(options.database) || \"unknown\"\n  });\n  let ctx = {\n    appName: options.appName || \"Better Auth\",\n    socialProviders: providers,\n    options,\n    tables,\n    trustedOrigins: getTrustedOrigins(options),\n    baseURL: baseURL || \"\",\n    sessionConfig: {\n      updateAge: options.session?.updateAge !== void 0 ? options.session.updateAge : 24 * 60 * 60,\n      // 24 hours\n      expiresIn: options.session?.expiresIn || 60 * 60 * 24 * 7,\n      // 7 days\n      freshAge: options.session?.freshAge === void 0 ? 60 * 60 * 24 : options.session.freshAge\n    },\n    secret,\n    rateLimit: {\n      ...options.rateLimit,\n      enabled: options.rateLimit?.enabled ?? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.isProduction,\n      window: options.rateLimit?.window || 10,\n      max: options.rateLimit?.max || 100,\n      storage: options.rateLimit?.storage || (options.secondaryStorage ? \"secondary-storage\" : \"memory\")\n    },\n    authCookies: cookies,\n    logger,\n    generateId: generateIdFunc,\n    session: null,\n    secondaryStorage: options.secondaryStorage,\n    password: {\n      hash: options.emailAndPassword?.password?.hash || _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.hashPassword,\n      verify: options.emailAndPassword?.password?.verify || _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.verifyPassword,\n      config: {\n        minPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n        maxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128\n      },\n      checkPassword: _better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_14__.c\n    },\n    setNewSession(session) {\n      this.newSession = session;\n    },\n    newSession: null,\n    adapter,\n    internalAdapter: (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.c)(adapter, {\n      options,\n      logger,\n      hooks: options.databaseHooks ? [options.databaseHooks] : []}),\n    createAuthCookie: (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_7__.c)(options),\n    async runMigrations() {\n      if (!options.database || \"updateMany\" in options.database) {\n        throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError(\n          \"Database is not provided or it's an adapter. Migrations are only supported with a database instance.\"\n        );\n      }\n      const { runMigrations } = await (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.e)(options);\n      await runMigrations();\n    },\n    publishTelemetry: publish,\n    skipCSRFCheck: !!options.advanced?.disableCSRFCheck,\n    skipOriginCheck: options.advanced?.disableOriginCheck !== void 0 ? options.advanced.disableOriginCheck : (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.isTest)() ? true : false\n  };\n  const initOrPromise = runPluginInit(ctx);\n  let context;\n  if (isPromise(initOrPromise)) {\n    ({ context } = await initOrPromise);\n  } else {\n    ({ context } = initOrPromise);\n  }\n  return context;\n};\nasync function runPluginInit(ctx) {\n  let options = ctx.options;\n  const plugins = options.plugins || [];\n  let context = ctx;\n  const dbHooks = [];\n  for (const plugin of plugins) {\n    if (plugin.init) {\n      let initPromise = plugin.init(context);\n      let result;\n      if (isPromise(initPromise)) {\n        result = await initPromise;\n      } else {\n        result = initPromise;\n      }\n      if (typeof result === \"object\") {\n        if (result.options) {\n          const { databaseHooks, ...restOpts } = result.options;\n          if (databaseHooks) {\n            dbHooks.push(databaseHooks);\n          }\n          options = (0,defu__WEBPACK_IMPORTED_MODULE_1__.defu)(options, restOpts);\n        }\n        if (result.context) {\n          context = {\n            ...context,\n            ...result.context\n          };\n        }\n      }\n    }\n  }\n  dbHooks.push(options.databaseHooks);\n  context.internalAdapter = (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.c)(ctx.adapter, {\n    options,\n    logger: ctx.logger,\n    hooks: dbHooks.filter((u) => u !== void 0),\n    generateId: ctx.generateId\n  });\n  context.options = options;\n  return { context };\n}\nfunction getInternalPlugins(options) {\n  const plugins = [];\n  if (options.advanced?.crossSubDomainCookies?.enabled) ;\n  return plugins;\n}\nfunction getTrustedOrigins(options) {\n  const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.a)(options.baseURL, options.basePath);\n  if (!baseURL) {\n    return [];\n  }\n  const trustedOrigins = [new URL(baseURL).origin];\n  if (options.trustedOrigins && Array.isArray(options.trustedOrigins)) {\n    trustedOrigins.push(...options.trustedOrigins);\n  }\n  const envTrustedOrigins = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.env.BETTER_AUTH_TRUSTED_ORIGINS;\n  if (envTrustedOrigins) {\n    trustedOrigins.push(...envTrustedOrigins.split(\",\"));\n  }\n  if (trustedOrigins.filter((x) => !x).length) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError(\n      \"A provided trusted origin is invalid, make sure your trusted origins list is properly defined.\"\n    );\n  }\n  return trustedOrigins;\n}\n\nconst betterAuth = (options) => {\n  const authContext = init(options);\n  const { api } = (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(authContext, options);\n  const errorCodes = options.plugins?.reduce((acc, plugin) => {\n    if (plugin.$ERROR_CODES) {\n      return {\n        ...acc,\n        ...plugin.$ERROR_CODES\n      };\n    }\n    return acc;\n  }, {});\n  return {\n    handler: async (request) => {\n      const ctx = await authContext;\n      const basePath = ctx.options.basePath || \"/api/auth\";\n      if (!ctx.options.baseURL) {\n        const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.a)(void 0, basePath, request);\n        if (baseURL) {\n          ctx.baseURL = baseURL;\n          ctx.options.baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.g)(ctx.baseURL) || void 0;\n        } else {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError(\n            \"Could not get base URL from request. Please provide a valid base URL.\"\n          );\n        }\n      }\n      ctx.trustedOrigins = [\n        ...options.trustedOrigins ? Array.isArray(options.trustedOrigins) ? options.trustedOrigins : await options.trustedOrigins(request) : [],\n        ctx.options.baseURL\n      ];\n      const { handler } = (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.router)(ctx, options);\n      return handler(request);\n    },\n    api,\n    options,\n    $context: authContext,\n    $Infer: {},\n    $ERROR_CODES: {\n      ...errorCodes,\n      ..._better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BASE_ERROR_CODES\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ0R4MVBvTk8ubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFnRjtBQUNwRDtBQUN1QztBQUNyQztBQUMrRTtBQUM3QztBQUNuRDtBQUNRO0FBQ2lFO0FBQ047QUFDWDtBQUNSO0FBQzVCO0FBQ0M7QUFDRDtBQUNFO0FBQ3JCO0FBQ3NCO0FBQzRCO0FBQ2E7QUFDRDtBQUNuQjtBQUNuQjtBQUNrQzs7QUFFeEU7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esd0JBQXdCLDREQUFVO0FBQ2xDO0FBQ0E7QUFDQSxpQkFBaUIsbUVBQVk7QUFDN0Isa0JBQWtCLDZEQUFVO0FBQzVCLG1DQUFtQyxzREFBRyx1QkFBdUIsc0RBQUc7QUFDaEU7QUFDQSxRQUFRLCtEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsc0VBQXNCO0FBQ3hCLGtCQUFrQiw0REFBVTtBQUM1QixpQkFBaUIsNERBQWE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixLQUFLO0FBQ2hDO0FBQ0E7QUFDQSxxQkFBcUIsK0VBQWU7QUFDcEM7QUFDQTtBQUNBLEdBQUc7QUFDSCw0QkFBNEIsYUFBYTtBQUN6QztBQUNBLDJDQUEyQyxhQUFhO0FBQ3hEO0FBQ0E7QUFDQSxvREFBb0QsYUFBYTtBQUNqRTtBQUNBLFdBQVcsNkRBQVU7QUFDckI7QUFDQSxVQUFVLFVBQVUsUUFBUSx3RUFBZTtBQUMzQztBQUNBLG1FQUFtRSw2REFBcUI7QUFDeEYsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QywrREFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELDJEQUFZO0FBQ3BFLDREQUE0RCw2REFBYztBQUMxRTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsbUJBQW1CO0FBQ25CLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxxQkFBcUIsNERBQXFCO0FBQzFDO0FBQ0E7QUFDQSxrRUFBa0U7QUFDbEUsc0JBQXNCLDREQUFrQjtBQUN4QztBQUNBO0FBQ0Esa0JBQWtCLHFFQUFlO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLGNBQWMsZ0JBQWdCLFFBQVEsNERBQWE7QUFDbkQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDZHQUE2Ryw2REFBTTtBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sVUFBVTtBQUNqQixJQUFJO0FBQ0osT0FBTyxVQUFVO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkJBQTZCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwQ0FBSTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDREQUFxQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw2REFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixzREFBRztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMscUVBQWU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVSxNQUFNLEVBQUUsNERBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsSUFBSTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkRBQVU7QUFDbEM7QUFDQTtBQUNBLGdDQUFnQyw2REFBUztBQUN6QyxVQUFVO0FBQ1Ysb0JBQW9CLHFFQUFlO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFVBQVUsRUFBRSxzREFBTTtBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBLFNBQVMsc0VBQWdCO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFMkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DRHgxUG9OTy5tanM/YTQwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGVja0VuZHBvaW50Q29uZmxpY3RzLCBnZXRFbmRwb2ludHMsIHJvdXRlciB9IGZyb20gJy4uL2FwaS9pbmRleC5tanMnO1xuaW1wb3J0IHsgZGVmdSB9IGZyb20gJ2RlZnUnO1xuaW1wb3J0IHsgdmVyaWZ5UGFzc3dvcmQsIGhhc2hQYXNzd29yZCB9IGZyb20gJy4uL2NyeXB0by9pbmRleC5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9kYic7XG5pbXBvcnQgeyBhIGFzIGdldEFkYXB0ZXIsIGMgYXMgY3JlYXRlSW50ZXJuYWxBZGFwdGVyLCBlIGFzIGdldE1pZ3JhdGlvbnMgfSBmcm9tICcuL2JldHRlci1hdXRoLkJHNDJPUUdDLm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdldEF1dGhUYWJsZXMgfSBmcm9tICcuL2JldHRlci1hdXRoLnBRamVSa3pOLm1qcyc7XG5pbXBvcnQgJ3pvZCc7XG5pbXBvcnQgJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGcgYXMgZ2V0Q29va2llcywgYyBhcyBjcmVhdGVDb29raWVHZXR0ZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLkQ5X3ZRUjgzLm1qcyc7XG5pbXBvcnQgeyBjcmVhdGVMb2dnZXIsIGVudiwgaXNQcm9kdWN0aW9uLCBpc1Rlc3QgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0IHsgc29jaWFsUHJvdmlkZXJzIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvc29jaWFsLXByb3ZpZGVycyc7XG5pbXBvcnQgeyBnIGFzIGdlbmVyYXRlSWQgfSBmcm9tICcuL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJy4vYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCB7IGMgYXMgY2hlY2tQYXNzd29yZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QmFzZVVSTCwgZyBhcyBnZXRPcmlnaW4gfSBmcm9tICcuL2JldHRlci1hdXRoLkRSM1I1d2RVLm1qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IsIEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgeyBjcmVhdGVUZWxlbWV0cnkgfSBmcm9tICdAYmV0dGVyLWF1dGgvdGVsZW1ldHJ5JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGIvYWRhcHRlcic7XG5pbXBvcnQgeyBnIGFzIGdldEt5c2VseURhdGFiYXNlVHlwZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ0JUUzJPelgubWpzJztcblxuY29uc3QgREVGQVVMVF9TRUNSRVQgPSBcImJldHRlci1hdXRoLXNlY3JldC0xMjM0NTY3ODlcIjtcblxuZnVuY3Rpb24gaXNQcm9taXNlKG9iaikge1xuICByZXR1cm4gISFvYmogJiYgKHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIG9iaiA9PT0gXCJmdW5jdGlvblwiKSAmJiB0eXBlb2Ygb2JqLnRoZW4gPT09IFwiZnVuY3Rpb25cIjtcbn1cblxuY29uc3QgaW5pdCA9IGFzeW5jIChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGFkYXB0ZXIgPSBhd2FpdCBnZXRBZGFwdGVyKG9wdGlvbnMpO1xuICBjb25zdCBwbHVnaW5zID0gb3B0aW9ucy5wbHVnaW5zIHx8IFtdO1xuICBjb25zdCBpbnRlcm5hbFBsdWdpbnMgPSBnZXRJbnRlcm5hbFBsdWdpbnMob3B0aW9ucyk7XG4gIGNvbnN0IGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcihvcHRpb25zLmxvZ2dlcik7XG4gIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKG9wdGlvbnMuYmFzZVVSTCwgb3B0aW9ucy5iYXNlUGF0aCk7XG4gIGNvbnN0IHNlY3JldCA9IG9wdGlvbnMuc2VjcmV0IHx8IGVudi5CRVRURVJfQVVUSF9TRUNSRVQgfHwgZW52LkFVVEhfU0VDUkVUIHx8IERFRkFVTFRfU0VDUkVUO1xuICBpZiAoc2VjcmV0ID09PSBERUZBVUxUX1NFQ1JFVCkge1xuICAgIGlmIChpc1Byb2R1Y3Rpb24pIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJZb3UgYXJlIHVzaW5nIHRoZSBkZWZhdWx0IHNlY3JldC4gUGxlYXNlIHNldCBgQkVUVEVSX0FVVEhfU0VDUkVUYCBpbiB5b3VyIGVudmlyb25tZW50IHZhcmlhYmxlcyBvciBwYXNzIGBzZWNyZXRgIGluIHlvdXIgYXV0aCBjb25maWcuXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIG9wdGlvbnMgPSB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBzZWNyZXQsXG4gICAgYmFzZVVSTDogYmFzZVVSTCA/IG5ldyBVUkwoYmFzZVVSTCkub3JpZ2luIDogXCJcIixcbiAgICBiYXNlUGF0aDogb3B0aW9ucy5iYXNlUGF0aCB8fCBcIi9hcGkvYXV0aFwiLFxuICAgIHBsdWdpbnM6IHBsdWdpbnMuY29uY2F0KGludGVybmFsUGx1Z2lucylcbiAgfTtcbiAgY2hlY2tFbmRwb2ludENvbmZsaWN0cyhvcHRpb25zLCBsb2dnZXIpO1xuICBjb25zdCBjb29raWVzID0gZ2V0Q29va2llcyhvcHRpb25zKTtcbiAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgY29uc3QgcHJvdmlkZXJzID0gT2JqZWN0LmVudHJpZXMoXG4gICAgb3B0aW9ucy5zb2NpYWxQcm92aWRlcnMgfHwge31cbiAgKS5tYXAoKFtrZXksIGNvbmZpZ10pID0+IHtcbiAgICBpZiAoY29uZmlnID09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLmVuYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKCFjb25maWcuY2xpZW50SWQpIHtcbiAgICAgIGxvZ2dlci53YXJuKFxuICAgICAgICBgU29jaWFsIHByb3ZpZGVyICR7a2V5fSBpcyBtaXNzaW5nIGNsaWVudElkIG9yIGNsaWVudFNlY3JldGBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHByb3ZpZGVyID0gc29jaWFsUHJvdmlkZXJzW2tleV0oY29uZmlnKTtcbiAgICBwcm92aWRlci5kaXNhYmxlSW1wbGljaXRTaWduVXAgPSBjb25maWcuZGlzYWJsZUltcGxpY2l0U2lnblVwO1xuICAgIHJldHVybiBwcm92aWRlcjtcbiAgfSkuZmlsdGVyKCh4KSA9PiB4ICE9PSBudWxsKTtcbiAgY29uc3QgZ2VuZXJhdGVJZEZ1bmMgPSAoeyBtb2RlbCwgc2l6ZSB9KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmFkdmFuY2VkPy5nZW5lcmF0ZUlkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmFkdmFuY2VkLmdlbmVyYXRlSWQoeyBtb2RlbCwgc2l6ZSB9KTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zPy5hZHZhbmNlZD8uZGF0YWJhc2U/LmdlbmVyYXRlSWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuYWR2YW5jZWQuZGF0YWJhc2UuZ2VuZXJhdGVJZCh7IG1vZGVsLCBzaXplIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZ2VuZXJhdGVJZChzaXplKTtcbiAgfTtcbiAgY29uc3QgeyBwdWJsaXNoIH0gPSBhd2FpdCBjcmVhdGVUZWxlbWV0cnkob3B0aW9ucywge1xuICAgIGFkYXB0ZXI6IGFkYXB0ZXIuaWQsXG4gICAgZGF0YWJhc2U6IHR5cGVvZiBvcHRpb25zLmRhdGFiYXNlID09PSBcImZ1bmN0aW9uXCIgPyBcImFkYXB0ZXJcIiA6IGdldEt5c2VseURhdGFiYXNlVHlwZShvcHRpb25zLmRhdGFiYXNlKSB8fCBcInVua25vd25cIlxuICB9KTtcbiAgbGV0IGN0eCA9IHtcbiAgICBhcHBOYW1lOiBvcHRpb25zLmFwcE5hbWUgfHwgXCJCZXR0ZXIgQXV0aFwiLFxuICAgIHNvY2lhbFByb3ZpZGVyczogcHJvdmlkZXJzLFxuICAgIG9wdGlvbnMsXG4gICAgdGFibGVzLFxuICAgIHRydXN0ZWRPcmlnaW5zOiBnZXRUcnVzdGVkT3JpZ2lucyhvcHRpb25zKSxcbiAgICBiYXNlVVJMOiBiYXNlVVJMIHx8IFwiXCIsXG4gICAgc2Vzc2lvbkNvbmZpZzoge1xuICAgICAgdXBkYXRlQWdlOiBvcHRpb25zLnNlc3Npb24/LnVwZGF0ZUFnZSAhPT0gdm9pZCAwID8gb3B0aW9ucy5zZXNzaW9uLnVwZGF0ZUFnZSA6IDI0ICogNjAgKiA2MCxcbiAgICAgIC8vIDI0IGhvdXJzXG4gICAgICBleHBpcmVzSW46IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luIHx8IDYwICogNjAgKiAyNCAqIDcsXG4gICAgICAvLyA3IGRheXNcbiAgICAgIGZyZXNoQWdlOiBvcHRpb25zLnNlc3Npb24/LmZyZXNoQWdlID09PSB2b2lkIDAgPyA2MCAqIDYwICogMjQgOiBvcHRpb25zLnNlc3Npb24uZnJlc2hBZ2VcbiAgICB9LFxuICAgIHNlY3JldCxcbiAgICByYXRlTGltaXQ6IHtcbiAgICAgIC4uLm9wdGlvbnMucmF0ZUxpbWl0LFxuICAgICAgZW5hYmxlZDogb3B0aW9ucy5yYXRlTGltaXQ/LmVuYWJsZWQgPz8gaXNQcm9kdWN0aW9uLFxuICAgICAgd2luZG93OiBvcHRpb25zLnJhdGVMaW1pdD8ud2luZG93IHx8IDEwLFxuICAgICAgbWF4OiBvcHRpb25zLnJhdGVMaW1pdD8ubWF4IHx8IDEwMCxcbiAgICAgIHN0b3JhZ2U6IG9wdGlvbnMucmF0ZUxpbWl0Py5zdG9yYWdlIHx8IChvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2UgPyBcInNlY29uZGFyeS1zdG9yYWdlXCIgOiBcIm1lbW9yeVwiKVxuICAgIH0sXG4gICAgYXV0aENvb2tpZXM6IGNvb2tpZXMsXG4gICAgbG9nZ2VyLFxuICAgIGdlbmVyYXRlSWQ6IGdlbmVyYXRlSWRGdW5jLFxuICAgIHNlc3Npb246IG51bGwsXG4gICAgc2Vjb25kYXJ5U3RvcmFnZTogb3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlLFxuICAgIHBhc3N3b3JkOiB7XG4gICAgICBoYXNoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnBhc3N3b3JkPy5oYXNoIHx8IGhhc2hQYXNzd29yZCxcbiAgICAgIHZlcmlmeTogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5wYXNzd29yZD8udmVyaWZ5IHx8IHZlcmlmeVBhc3N3b3JkLFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIG1pblBhc3N3b3JkTGVuZ3RoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm1pblBhc3N3b3JkTGVuZ3RoIHx8IDgsXG4gICAgICAgIG1heFBhc3N3b3JkTGVuZ3RoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm1heFBhc3N3b3JkTGVuZ3RoIHx8IDEyOFxuICAgICAgfSxcbiAgICAgIGNoZWNrUGFzc3dvcmRcbiAgICB9LFxuICAgIHNldE5ld1Nlc3Npb24oc2Vzc2lvbikge1xuICAgICAgdGhpcy5uZXdTZXNzaW9uID0gc2Vzc2lvbjtcbiAgICB9LFxuICAgIG5ld1Nlc3Npb246IG51bGwsXG4gICAgYWRhcHRlcixcbiAgICBpbnRlcm5hbEFkYXB0ZXI6IGNyZWF0ZUludGVybmFsQWRhcHRlcihhZGFwdGVyLCB7XG4gICAgICBvcHRpb25zLFxuICAgICAgbG9nZ2VyLFxuICAgICAgaG9va3M6IG9wdGlvbnMuZGF0YWJhc2VIb29rcyA/IFtvcHRpb25zLmRhdGFiYXNlSG9va3NdIDogW119KSxcbiAgICBjcmVhdGVBdXRoQ29va2llOiBjcmVhdGVDb29raWVHZXR0ZXIob3B0aW9ucyksXG4gICAgYXN5bmMgcnVuTWlncmF0aW9ucygpIHtcbiAgICAgIGlmICghb3B0aW9ucy5kYXRhYmFzZSB8fCBcInVwZGF0ZU1hbnlcIiBpbiBvcHRpb25zLmRhdGFiYXNlKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgXCJEYXRhYmFzZSBpcyBub3QgcHJvdmlkZWQgb3IgaXQncyBhbiBhZGFwdGVyLiBNaWdyYXRpb25zIGFyZSBvbmx5IHN1cHBvcnRlZCB3aXRoIGEgZGF0YWJhc2UgaW5zdGFuY2UuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgcnVuTWlncmF0aW9ucyB9ID0gYXdhaXQgZ2V0TWlncmF0aW9ucyhvcHRpb25zKTtcbiAgICAgIGF3YWl0IHJ1bk1pZ3JhdGlvbnMoKTtcbiAgICB9LFxuICAgIHB1Ymxpc2hUZWxlbWV0cnk6IHB1Ymxpc2gsXG4gICAgc2tpcENTUkZDaGVjazogISFvcHRpb25zLmFkdmFuY2VkPy5kaXNhYmxlQ1NSRkNoZWNrLFxuICAgIHNraXBPcmlnaW5DaGVjazogb3B0aW9ucy5hZHZhbmNlZD8uZGlzYWJsZU9yaWdpbkNoZWNrICE9PSB2b2lkIDAgPyBvcHRpb25zLmFkdmFuY2VkLmRpc2FibGVPcmlnaW5DaGVjayA6IGlzVGVzdCgpID8gdHJ1ZSA6IGZhbHNlXG4gIH07XG4gIGNvbnN0IGluaXRPclByb21pc2UgPSBydW5QbHVnaW5Jbml0KGN0eCk7XG4gIGxldCBjb250ZXh0O1xuICBpZiAoaXNQcm9taXNlKGluaXRPclByb21pc2UpKSB7XG4gICAgKHsgY29udGV4dCB9ID0gYXdhaXQgaW5pdE9yUHJvbWlzZSk7XG4gIH0gZWxzZSB7XG4gICAgKHsgY29udGV4dCB9ID0gaW5pdE9yUHJvbWlzZSk7XG4gIH1cbiAgcmV0dXJuIGNvbnRleHQ7XG59O1xuYXN5bmMgZnVuY3Rpb24gcnVuUGx1Z2luSW5pdChjdHgpIHtcbiAgbGV0IG9wdGlvbnMgPSBjdHgub3B0aW9ucztcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgbGV0IGNvbnRleHQgPSBjdHg7XG4gIGNvbnN0IGRiSG9va3MgPSBbXTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2YgcGx1Z2lucykge1xuICAgIGlmIChwbHVnaW4uaW5pdCkge1xuICAgICAgbGV0IGluaXRQcm9taXNlID0gcGx1Z2luLmluaXQoY29udGV4dCk7XG4gICAgICBsZXQgcmVzdWx0O1xuICAgICAgaWYgKGlzUHJvbWlzZShpbml0UHJvbWlzZSkpIHtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgaW5pdFByb21pc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBpbml0UHJvbWlzZTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIGlmIChyZXN1bHQub3B0aW9ucykge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YWJhc2VIb29rcywgLi4ucmVzdE9wdHMgfSA9IHJlc3VsdC5vcHRpb25zO1xuICAgICAgICAgIGlmIChkYXRhYmFzZUhvb2tzKSB7XG4gICAgICAgICAgICBkYkhvb2tzLnB1c2goZGF0YWJhc2VIb29rcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIG9wdGlvbnMgPSBkZWZ1KG9wdGlvbnMsIHJlc3RPcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0LmNvbnRleHQpIHtcbiAgICAgICAgICBjb250ZXh0ID0ge1xuICAgICAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgICAgIC4uLnJlc3VsdC5jb250ZXh0XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBkYkhvb2tzLnB1c2gob3B0aW9ucy5kYXRhYmFzZUhvb2tzKTtcbiAgY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIgPSBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIoY3R4LmFkYXB0ZXIsIHtcbiAgICBvcHRpb25zLFxuICAgIGxvZ2dlcjogY3R4LmxvZ2dlcixcbiAgICBob29rczogZGJIb29rcy5maWx0ZXIoKHUpID0+IHUgIT09IHZvaWQgMCksXG4gICAgZ2VuZXJhdGVJZDogY3R4LmdlbmVyYXRlSWRcbiAgfSk7XG4gIGNvbnRleHQub3B0aW9ucyA9IG9wdGlvbnM7XG4gIHJldHVybiB7IGNvbnRleHQgfTtcbn1cbmZ1bmN0aW9uIGdldEludGVybmFsUGx1Z2lucyhvcHRpb25zKSB7XG4gIGNvbnN0IHBsdWdpbnMgPSBbXTtcbiAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uZW5hYmxlZCkgO1xuICByZXR1cm4gcGx1Z2lucztcbn1cbmZ1bmN0aW9uIGdldFRydXN0ZWRPcmlnaW5zKG9wdGlvbnMpIHtcbiAgY29uc3QgYmFzZVVSTCA9IGdldEJhc2VVUkwob3B0aW9ucy5iYXNlVVJMLCBvcHRpb25zLmJhc2VQYXRoKTtcbiAgaWYgKCFiYXNlVVJMKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gW25ldyBVUkwoYmFzZVVSTCkub3JpZ2luXTtcbiAgaWYgKG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMgJiYgQXJyYXkuaXNBcnJheShvcHRpb25zLnRydXN0ZWRPcmlnaW5zKSkge1xuICAgIHRydXN0ZWRPcmlnaW5zLnB1c2goLi4ub3B0aW9ucy50cnVzdGVkT3JpZ2lucyk7XG4gIH1cbiAgY29uc3QgZW52VHJ1c3RlZE9yaWdpbnMgPSBlbnYuQkVUVEVSX0FVVEhfVFJVU1RFRF9PUklHSU5TO1xuICBpZiAoZW52VHJ1c3RlZE9yaWdpbnMpIHtcbiAgICB0cnVzdGVkT3JpZ2lucy5wdXNoKC4uLmVudlRydXN0ZWRPcmlnaW5zLnNwbGl0KFwiLFwiKSk7XG4gIH1cbiAgaWYgKHRydXN0ZWRPcmlnaW5zLmZpbHRlcigoeCkgPT4gIXgpLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICBcIkEgcHJvdmlkZWQgdHJ1c3RlZCBvcmlnaW4gaXMgaW52YWxpZCwgbWFrZSBzdXJlIHlvdXIgdHJ1c3RlZCBvcmlnaW5zIGxpc3QgaXMgcHJvcGVybHkgZGVmaW5lZC5cIlxuICAgICk7XG4gIH1cbiAgcmV0dXJuIHRydXN0ZWRPcmlnaW5zO1xufVxuXG5jb25zdCBiZXR0ZXJBdXRoID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgYXV0aENvbnRleHQgPSBpbml0KG9wdGlvbnMpO1xuICBjb25zdCB7IGFwaSB9ID0gZ2V0RW5kcG9pbnRzKGF1dGhDb250ZXh0LCBvcHRpb25zKTtcbiAgY29uc3QgZXJyb3JDb2RlcyA9IG9wdGlvbnMucGx1Z2lucz8ucmVkdWNlKChhY2MsIHBsdWdpbikgPT4ge1xuICAgIGlmIChwbHVnaW4uJEVSUk9SX0NPREVTKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5hY2MsXG4gICAgICAgIC4uLnBsdWdpbi4kRVJST1JfQ09ERVNcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgcmV0dXJuIHtcbiAgICBoYW5kbGVyOiBhc3luYyAocmVxdWVzdCkgPT4ge1xuICAgICAgY29uc3QgY3R4ID0gYXdhaXQgYXV0aENvbnRleHQ7XG4gICAgICBjb25zdCBiYXNlUGF0aCA9IGN0eC5vcHRpb25zLmJhc2VQYXRoIHx8IFwiL2FwaS9hdXRoXCI7XG4gICAgICBpZiAoIWN0eC5vcHRpb25zLmJhc2VVUkwpIHtcbiAgICAgICAgY29uc3QgYmFzZVVSTCA9IGdldEJhc2VVUkwodm9pZCAwLCBiYXNlUGF0aCwgcmVxdWVzdCk7XG4gICAgICAgIGlmIChiYXNlVVJMKSB7XG4gICAgICAgICAgY3R4LmJhc2VVUkwgPSBiYXNlVVJMO1xuICAgICAgICAgIGN0eC5vcHRpb25zLmJhc2VVUkwgPSBnZXRPcmlnaW4oY3R4LmJhc2VVUkwpIHx8IHZvaWQgMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgXCJDb3VsZCBub3QgZ2V0IGJhc2UgVVJMIGZyb20gcmVxdWVzdC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBiYXNlIFVSTC5cIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGN0eC50cnVzdGVkT3JpZ2lucyA9IFtcbiAgICAgICAgLi4ub3B0aW9ucy50cnVzdGVkT3JpZ2lucyA/IEFycmF5LmlzQXJyYXkob3B0aW9ucy50cnVzdGVkT3JpZ2lucykgPyBvcHRpb25zLnRydXN0ZWRPcmlnaW5zIDogYXdhaXQgb3B0aW9ucy50cnVzdGVkT3JpZ2lucyhyZXF1ZXN0KSA6IFtdLFxuICAgICAgICBjdHgub3B0aW9ucy5iYXNlVVJMXG4gICAgICBdO1xuICAgICAgY29uc3QgeyBoYW5kbGVyIH0gPSByb3V0ZXIoY3R4LCBvcHRpb25zKTtcbiAgICAgIHJldHVybiBoYW5kbGVyKHJlcXVlc3QpO1xuICAgIH0sXG4gICAgYXBpLFxuICAgIG9wdGlvbnMsXG4gICAgJGNvbnRleHQ6IGF1dGhDb250ZXh0LFxuICAgICRJbmZlcjoge30sXG4gICAgJEVSUk9SX0NPREVTOiB7XG4gICAgICAuLi5lcnJvckNvZGVzLFxuICAgICAgLi4uQkFTRV9FUlJPUl9DT0RFU1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IGJldHRlckF1dGggYXMgYiB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getDate)\n/* harmony export */ });\nconst getDate = (span, unit = \"ms\") => {\n  return new Date(Date.now() + (unit === \"sec\" ? span * 1e3 : span));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzPzhiMDIiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0RGF0ZSA9IChzcGFuLCB1bml0ID0gXCJtc1wiKSA9PiB7XG4gIHJldHVybiBuZXcgRGF0ZShEYXRlLm5vdygpICsgKHVuaXQgPT09IFwic2VjXCIgPyBzcGFuICogMWUzIDogc3BhbikpO1xufTtcblxuZXhwb3J0IHsgZ2V0RGF0ZSBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getIp)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n\n\n\nfunction getIp(req, options) {\n  if (options.advanced?.ipAddress?.disableIpTracking) {\n    return null;\n  }\n  if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest)()) {\n    return \"127.0.0.1\";\n  }\n  if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isDevelopment)()) {\n    return \"127.0.0.1\";\n  }\n  const headers = \"headers\" in req ? req.headers : req;\n  const defaultHeaders = [\"x-forwarded-for\"];\n  const ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders || defaultHeaders;\n  for (const key of ipHeaders) {\n    const value = \"get\" in headers ? headers.get(key) : headers[key];\n    if (typeof value === \"string\") {\n      const ip = value.split(\",\")[0].trim();\n      if (isValidIP(ip)) {\n        return ip;\n      }\n    }\n  }\n  return null;\n}\nfunction isValidIP(ip) {\n  const ipv4 = zod__WEBPACK_IMPORTED_MODULE_1__.ipv4().safeParse(ip);\n  if (ipv4.success) {\n    return true;\n  }\n  const ipv6 = zod__WEBPACK_IMPORTED_MODULE_1__.ipv6().safeParse(ip);\n  if (ipv6.success) {\n    return true;\n  }\n  return false;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ2xINXIzTkgubWpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4RDtBQUN0Qzs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLDZEQUFNO0FBQ1o7QUFDQTtBQUNBLE1BQU0sb0VBQWE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUscUNBQU07QUFDckI7QUFDQTtBQUNBO0FBQ0EsZUFBZSxxQ0FBTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVzQiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkNsSDVyM05ILm1qcz8wZTEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzVGVzdCwgaXNEZXZlbG9wbWVudCB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuZnVuY3Rpb24gZ2V0SXAocmVxLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmRpc2FibGVJcFRyYWNraW5nKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKGlzVGVzdCgpKSB7XG4gICAgcmV0dXJuIFwiMTI3LjAuMC4xXCI7XG4gIH1cbiAgaWYgKGlzRGV2ZWxvcG1lbnQoKSkge1xuICAgIHJldHVybiBcIjEyNy4wLjAuMVwiO1xuICB9XG4gIGNvbnN0IGhlYWRlcnMgPSBcImhlYWRlcnNcIiBpbiByZXEgPyByZXEuaGVhZGVycyA6IHJlcTtcbiAgY29uc3QgZGVmYXVsdEhlYWRlcnMgPSBbXCJ4LWZvcndhcmRlZC1mb3JcIl07XG4gIGNvbnN0IGlwSGVhZGVycyA9IG9wdGlvbnMuYWR2YW5jZWQ/LmlwQWRkcmVzcz8uaXBBZGRyZXNzSGVhZGVycyB8fCBkZWZhdWx0SGVhZGVycztcbiAgZm9yIChjb25zdCBrZXkgb2YgaXBIZWFkZXJzKSB7XG4gICAgY29uc3QgdmFsdWUgPSBcImdldFwiIGluIGhlYWRlcnMgPyBoZWFkZXJzLmdldChrZXkpIDogaGVhZGVyc1trZXldO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGNvbnN0IGlwID0gdmFsdWUuc3BsaXQoXCIsXCIpWzBdLnRyaW0oKTtcbiAgICAgIGlmIChpc1ZhbGlkSVAoaXApKSB7XG4gICAgICAgIHJldHVybiBpcDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBpc1ZhbGlkSVAoaXApIHtcbiAgY29uc3QgaXB2NCA9IHouaXB2NCgpLnNhZmVQYXJzZShpcCk7XG4gIGlmIChpcHY0LnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBjb25zdCBpcHY2ID0gei5pcHY2KCkuc2FmZVBhcnNlKGlwKTtcbiAgaWYgKGlwdjYuc3VjY2Vzcykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IHsgZ2V0SXAgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ parseAccountOutput),\n/* harmony export */   b: () => (/* binding */ parseSessionOutput),\n/* harmony export */   c: () => (/* binding */ parseInputData),\n/* harmony export */   d: () => (/* binding */ parseUserInput),\n/* harmony export */   e: () => (/* binding */ parseAdditionalUserInput),\n/* harmony export */   f: () => (/* binding */ parseAccountInput),\n/* harmony export */   g: () => (/* binding */ parseSessionInput),\n/* harmony export */   m: () => (/* binding */ mergeSchema),\n/* harmony export */   p: () => (/* binding */ parseUserOutput)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n\n\nconst cache = /* @__PURE__ */ new WeakMap();\nfunction parseOutputData(data, schema) {\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in data) {\n    const field = fields[key];\n    if (!field) {\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (field.returned === false) {\n      continue;\n    }\n    parsedData[key] = data[key];\n  }\n  return parsedData;\n}\nfunction getAllFields(options, table) {\n  if (!cache.has(options)) {\n    cache.set(options, /* @__PURE__ */ new Map());\n  }\n  const tableCache = cache.get(options);\n  if (tableCache.has(table)) {\n    return tableCache.get(table);\n  }\n  let schema = {\n    ...table === \"user\" ? options.user?.additionalFields : {},\n    ...table === \"session\" ? options.session?.additionalFields : {}\n  };\n  for (const plugin of options.plugins || []) {\n    if (plugin.schema && plugin.schema[table]) {\n      schema = {\n        ...schema,\n        ...plugin.schema[table].fields\n      };\n    }\n  }\n  cache.get(options).set(table, schema);\n  return schema;\n}\nfunction parseUserOutput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseOutputData(user, { fields: schema });\n}\nfunction parseAccountOutput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseOutputData(account, { fields: schema });\n}\nfunction parseSessionOutput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseOutputData(session, { fields: schema });\n}\nfunction parseInputData(data, schema) {\n  const action = schema.action || \"create\";\n  const fields = schema.fields;\n  const parsedData = Object.assign(\n    /* @__PURE__ */ Object.create(null),\n    null\n  );\n  for (const key in fields) {\n    if (key in data) {\n      if (fields[key].input === false) {\n        if (fields[key].defaultValue !== void 0) {\n          if (action !== \"update\") {\n            parsedData[key] = fields[key].defaultValue;\n            continue;\n          }\n        }\n        if (data[key]) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n            message: `${key} is not allowed to be set`\n          });\n        }\n        continue;\n      }\n      if (fields[key].validator?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].validator.input.parse(data[key]);\n        continue;\n      }\n      if (fields[key].transform?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].transform?.input(data[key]);\n        continue;\n      }\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (fields[key].defaultValue !== void 0 && action === \"create\") {\n      parsedData[key] = fields[key].defaultValue;\n      continue;\n    }\n    if (fields[key].required && action === \"create\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: `${key} is required`\n      });\n    }\n  }\n  return parsedData;\n}\nfunction parseUserInput(options, user = {}, action) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user, { fields: schema, action });\n}\nfunction parseAdditionalUserInput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema });\n}\nfunction parseAccountInput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseInputData(account, { fields: schema });\n}\nfunction parseSessionInput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseInputData(session, { fields: schema });\n}\nfunction mergeSchema(schema, newSchema) {\n  if (!newSchema) {\n    return schema;\n  }\n  for (const table in newSchema) {\n    const newModelName = newSchema[table]?.modelName;\n    if (newModelName) {\n      schema[table].modelName = newModelName;\n    }\n    for (const field in schema[table].fields) {\n      const newField = newSchema[table]?.fields?.[field];\n      if (!newField) {\n        continue;\n      }\n      schema[table].fields[field].fieldName = newField;\n    }\n  }\n  return schema;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ3dqOWR0NmkubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBdUM7O0FBRXZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGdCQUFnQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0JBQWdCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnQkFBZ0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGlEQUFRO0FBQzVCLHdCQUF3QixLQUFLO0FBQzdCLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QixvQkFBb0IsS0FBSztBQUN6QixPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQSxnQ0FBZ0Msd0JBQXdCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxJQUFJLGdCQUFnQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsZ0JBQWdCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxnQkFBZ0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNk4iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5Dd2o5ZHQ2aS5tanM/ZmRlYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcblxuY29uc3QgY2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbmZ1bmN0aW9uIHBhcnNlT3V0cHV0RGF0YShkYXRhLCBzY2hlbWEpIHtcbiAgY29uc3QgZmllbGRzID0gc2NoZW1hLmZpZWxkcztcbiAgY29uc3QgcGFyc2VkRGF0YSA9IHt9O1xuICBmb3IgKGNvbnN0IGtleSBpbiBkYXRhKSB7XG4gICAgY29uc3QgZmllbGQgPSBmaWVsZHNba2V5XTtcbiAgICBpZiAoIWZpZWxkKSB7XG4gICAgICBwYXJzZWREYXRhW2tleV0gPSBkYXRhW2tleV07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGZpZWxkLnJldHVybmVkID09PSBmYWxzZSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHBhcnNlZERhdGFba2V5XSA9IGRhdGFba2V5XTtcbiAgfVxuICByZXR1cm4gcGFyc2VkRGF0YTtcbn1cbmZ1bmN0aW9uIGdldEFsbEZpZWxkcyhvcHRpb25zLCB0YWJsZSkge1xuICBpZiAoIWNhY2hlLmhhcyhvcHRpb25zKSkge1xuICAgIGNhY2hlLnNldChvcHRpb25zLCAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKTtcbiAgfVxuICBjb25zdCB0YWJsZUNhY2hlID0gY2FjaGUuZ2V0KG9wdGlvbnMpO1xuICBpZiAodGFibGVDYWNoZS5oYXModGFibGUpKSB7XG4gICAgcmV0dXJuIHRhYmxlQ2FjaGUuZ2V0KHRhYmxlKTtcbiAgfVxuICBsZXQgc2NoZW1hID0ge1xuICAgIC4uLnRhYmxlID09PSBcInVzZXJcIiA/IG9wdGlvbnMudXNlcj8uYWRkaXRpb25hbEZpZWxkcyA6IHt9LFxuICAgIC4uLnRhYmxlID09PSBcInNlc3Npb25cIiA/IG9wdGlvbnMuc2Vzc2lvbj8uYWRkaXRpb25hbEZpZWxkcyA6IHt9XG4gIH07XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIG9wdGlvbnMucGx1Z2lucyB8fCBbXSkge1xuICAgIGlmIChwbHVnaW4uc2NoZW1hICYmIHBsdWdpbi5zY2hlbWFbdGFibGVdKSB7XG4gICAgICBzY2hlbWEgPSB7XG4gICAgICAgIC4uLnNjaGVtYSxcbiAgICAgICAgLi4ucGx1Z2luLnNjaGVtYVt0YWJsZV0uZmllbGRzXG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBjYWNoZS5nZXQob3B0aW9ucykuc2V0KHRhYmxlLCBzY2hlbWEpO1xuICByZXR1cm4gc2NoZW1hO1xufVxuZnVuY3Rpb24gcGFyc2VVc2VyT3V0cHV0KG9wdGlvbnMsIHVzZXIpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwidXNlclwiKTtcbiAgcmV0dXJuIHBhcnNlT3V0cHV0RGF0YSh1c2VyLCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VBY2NvdW50T3V0cHV0KG9wdGlvbnMsIGFjY291bnQpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwiYWNjb3VudFwiKTtcbiAgcmV0dXJuIHBhcnNlT3V0cHV0RGF0YShhY2NvdW50LCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VTZXNzaW9uT3V0cHV0KG9wdGlvbnMsIHNlc3Npb24pIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwic2Vzc2lvblwiKTtcbiAgcmV0dXJuIHBhcnNlT3V0cHV0RGF0YShzZXNzaW9uLCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VJbnB1dERhdGEoZGF0YSwgc2NoZW1hKSB7XG4gIGNvbnN0IGFjdGlvbiA9IHNjaGVtYS5hY3Rpb24gfHwgXCJjcmVhdGVcIjtcbiAgY29uc3QgZmllbGRzID0gc2NoZW1hLmZpZWxkcztcbiAgY29uc3QgcGFyc2VkRGF0YSA9IE9iamVjdC5hc3NpZ24oXG4gICAgLyogQF9fUFVSRV9fICovIE9iamVjdC5jcmVhdGUobnVsbCksXG4gICAgbnVsbFxuICApO1xuICBmb3IgKGNvbnN0IGtleSBpbiBmaWVsZHMpIHtcbiAgICBpZiAoa2V5IGluIGRhdGEpIHtcbiAgICAgIGlmIChmaWVsZHNba2V5XS5pbnB1dCA9PT0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGZpZWxkc1trZXldLmRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgaWYgKGFjdGlvbiAhPT0gXCJ1cGRhdGVcIikge1xuICAgICAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhW2tleV0pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICBtZXNzYWdlOiBgJHtrZXl9IGlzIG5vdCBhbGxvd2VkIHRvIGJlIHNldGBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWVsZHNba2V5XS52YWxpZGF0b3I/LmlucHV0ICYmIGRhdGFba2V5XSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHBhcnNlZERhdGFba2V5XSA9IGZpZWxkc1trZXldLnZhbGlkYXRvci5pbnB1dC5wYXJzZShkYXRhW2tleV0pO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWVsZHNba2V5XS50cmFuc2Zvcm0/LmlucHV0ICYmIGRhdGFba2V5XSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHBhcnNlZERhdGFba2V5XSA9IGZpZWxkc1trZXldLnRyYW5zZm9ybT8uaW5wdXQoZGF0YVtrZXldKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBwYXJzZWREYXRhW2tleV0gPSBkYXRhW2tleV07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGZpZWxkc1trZXldLmRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwICYmIGFjdGlvbiA9PT0gXCJjcmVhdGVcIikge1xuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZHNba2V5XS5yZXF1aXJlZCAmJiBhY3Rpb24gPT09IFwiY3JlYXRlXCIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYCR7a2V5fSBpcyByZXF1aXJlZGBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyc2VkRGF0YTtcbn1cbmZ1bmN0aW9uIHBhcnNlVXNlcklucHV0KG9wdGlvbnMsIHVzZXIgPSB7fSwgYWN0aW9uKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInVzZXJcIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YSh1c2VyLCB7IGZpZWxkczogc2NoZW1hLCBhY3Rpb24gfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFkZGl0aW9uYWxVc2VySW5wdXQob3B0aW9ucywgdXNlcikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEodXNlciB8fCB7fSwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlQWNjb3VudElucHV0KG9wdGlvbnMsIGFjY291bnQpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwiYWNjb3VudFwiKTtcbiAgcmV0dXJuIHBhcnNlSW5wdXREYXRhKGFjY291bnQsIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZVNlc3Npb25JbnB1dChvcHRpb25zLCBzZXNzaW9uKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInNlc3Npb25cIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YShzZXNzaW9uLCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gbWVyZ2VTY2hlbWEoc2NoZW1hLCBuZXdTY2hlbWEpIHtcbiAgaWYgKCFuZXdTY2hlbWEpIHtcbiAgICByZXR1cm4gc2NoZW1hO1xuICB9XG4gIGZvciAoY29uc3QgdGFibGUgaW4gbmV3U2NoZW1hKSB7XG4gICAgY29uc3QgbmV3TW9kZWxOYW1lID0gbmV3U2NoZW1hW3RhYmxlXT8ubW9kZWxOYW1lO1xuICAgIGlmIChuZXdNb2RlbE5hbWUpIHtcbiAgICAgIHNjaGVtYVt0YWJsZV0ubW9kZWxOYW1lID0gbmV3TW9kZWxOYW1lO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGZpZWxkIGluIHNjaGVtYVt0YWJsZV0uZmllbGRzKSB7XG4gICAgICBjb25zdCBuZXdGaWVsZCA9IG5ld1NjaGVtYVt0YWJsZV0/LmZpZWxkcz8uW2ZpZWxkXTtcbiAgICAgIGlmICghbmV3RmllbGQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBzY2hlbWFbdGFibGVdLmZpZWxkc1tmaWVsZF0uZmllbGROYW1lID0gbmV3RmllbGQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBzY2hlbWE7XG59XG5cbmV4cG9ydCB7IHBhcnNlQWNjb3VudE91dHB1dCBhcyBhLCBwYXJzZVNlc3Npb25PdXRwdXQgYXMgYiwgcGFyc2VJbnB1dERhdGEgYXMgYywgcGFyc2VVc2VySW5wdXQgYXMgZCwgcGFyc2VBZGRpdGlvbmFsVXNlcklucHV0IGFzIGUsIHBhcnNlQWNjb3VudElucHV0IGFzIGYsIHBhcnNlU2Vzc2lvbklucHV0IGFzIGcsIG1lcmdlU2NoZW1hIGFzIG0sIHBhcnNlVXNlck91dHB1dCBhcyBwIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ capitalizeFirstLetter)\n/* harmony export */ });\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRC0yQ21Fd3oubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7O0FBRXNDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRC0yQ21Fd3oubWpzPzdmZjAiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cikge1xuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpO1xufVxuXG5leHBvcnQgeyBjYXBpdGFsaXplRmlyc3RMZXR0ZXIgYXMgYyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ setCookieCache),\n/* harmony export */   b: () => (/* binding */ getSessionCookie),\n/* harmony export */   c: () => (/* binding */ createCookieGetter),\n/* harmony export */   d: () => (/* binding */ deleteSessionCookie),\n/* harmony export */   e: () => (/* binding */ getCookieCache),\n/* harmony export */   g: () => (/* binding */ getCookies),\n/* harmony export */   m: () => (/* binding */ ms),\n/* harmony export */   p: () => (/* binding */ parseCookies),\n/* harmony export */   s: () => (/* binding */ setSessionCookie)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n\n\n\n\n\n\n\n\n\n\n//#region src/index.ts\nconst s = 1e3;\nconst m = s * 60;\nconst h = m * 60;\nconst d = h * 24;\nconst w = d * 7;\nconst y = d * 365.25;\nconst mo = y / 12;\nfunction ms(value, options) {\n\tif (typeof value === \"string\") return parse(value);\n\telse if (typeof value === \"number\") return format(value);\n\tthrow new Error(`Value provided to ms() must be a string or number. value=${JSON.stringify(value)}`);\n}\n/**\n* Parse the given string and return milliseconds.\n*\n* @param str - A string to parse to milliseconds\n* @returns The parsed value in milliseconds, or `NaN` if the string can't be\n* parsed\n*/\nfunction parse(str) {\n\tif (typeof str !== \"string\" || str.length === 0 || str.length > 100) throw new Error(`Value provided to ms.parse() must be a string with length between 1 and 99. value=${JSON.stringify(str)}`);\n\tconst match = /^(?<value>-?\\d*\\.?\\d+) *(?<unit>milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)?$/i.exec(str);\n\tif (!match?.groups) return NaN;\n\tconst { value, unit = \"ms\" } = match.groups;\n\tconst n = parseFloat(value);\n\tconst matchUnit = unit.toLowerCase();\n\t/* istanbul ignore next - istanbul doesn't understand, but thankfully the TypeScript the exhaustiveness check in the default case keeps us type safe here */\n\tswitch (matchUnit) {\n\t\tcase \"years\":\n\t\tcase \"year\":\n\t\tcase \"yrs\":\n\t\tcase \"yr\":\n\t\tcase \"y\": return n * y;\n\t\tcase \"months\":\n\t\tcase \"month\":\n\t\tcase \"mo\": return n * mo;\n\t\tcase \"weeks\":\n\t\tcase \"week\":\n\t\tcase \"w\": return n * w;\n\t\tcase \"days\":\n\t\tcase \"day\":\n\t\tcase \"d\": return n * d;\n\t\tcase \"hours\":\n\t\tcase \"hour\":\n\t\tcase \"hrs\":\n\t\tcase \"hr\":\n\t\tcase \"h\": return n * h;\n\t\tcase \"minutes\":\n\t\tcase \"minute\":\n\t\tcase \"mins\":\n\t\tcase \"min\":\n\t\tcase \"m\": return n * m;\n\t\tcase \"seconds\":\n\t\tcase \"second\":\n\t\tcase \"secs\":\n\t\tcase \"sec\":\n\t\tcase \"s\": return n * s;\n\t\tcase \"milliseconds\":\n\t\tcase \"millisecond\":\n\t\tcase \"msecs\":\n\t\tcase \"msec\":\n\t\tcase \"ms\": return n;\n\t\tdefault: throw new Error(`Unknown unit \"${matchUnit}\" provided to ms.parse(). value=${JSON.stringify(str)}`);\n\t}\n}\n/**\n* Short format for `ms`.\n*/\nfunction fmtShort(ms$1) {\n\tconst msAbs = Math.abs(ms$1);\n\tif (msAbs >= y) return `${Math.round(ms$1 / y)}y`;\n\tif (msAbs >= mo) return `${Math.round(ms$1 / mo)}mo`;\n\tif (msAbs >= w) return `${Math.round(ms$1 / w)}w`;\n\tif (msAbs >= d) return `${Math.round(ms$1 / d)}d`;\n\tif (msAbs >= h) return `${Math.round(ms$1 / h)}h`;\n\tif (msAbs >= m) return `${Math.round(ms$1 / m)}m`;\n\tif (msAbs >= s) return `${Math.round(ms$1 / s)}s`;\n\treturn `${ms$1}ms`;\n}\n/**\n* Format the given integer as a string.\n*\n* @param ms - milliseconds\n* @param options - Options for the conversion\n* @returns The formatted string\n*/\nfunction format(ms$1, options) {\n\tif (typeof ms$1 !== \"number\" || !Number.isFinite(ms$1)) throw new Error(\"Value provided to ms.format() must be of type number.\");\n\treturn fmtShort(ms$1);\n}\n\nfunction createCookieGetter(options) {\n  const secure = options.advanced?.useSecureCookies !== void 0 ? options.advanced?.useSecureCookies : options.baseURL !== void 0 ? options.baseURL.startsWith(\"https://\") ? true : false : _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__.isProduction;\n  const secureCookiePrefix = secure ? \"__Secure-\" : \"\";\n  const crossSubdomainEnabled = !!options.advanced?.crossSubDomainCookies?.enabled;\n  const domain = crossSubdomainEnabled ? options.advanced?.crossSubDomainCookies?.domain || (options.baseURL ? new URL(options.baseURL).hostname : void 0) : void 0;\n  if (crossSubdomainEnabled && !domain) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__.BetterAuthError(\n      \"baseURL is required when crossSubdomainCookies are enabled\"\n    );\n  }\n  function createCookie(cookieName, overrideAttributes = {}) {\n    const prefix = options.advanced?.cookiePrefix || \"better-auth\";\n    const name = options.advanced?.cookies?.[cookieName]?.name || `${prefix}.${cookieName}`;\n    const attributes = options.advanced?.cookies?.[cookieName]?.attributes;\n    return {\n      name: `${secureCookiePrefix}${name}`,\n      attributes: {\n        secure: !!secureCookiePrefix,\n        sameSite: \"lax\",\n        path: \"/\",\n        httpOnly: true,\n        ...crossSubdomainEnabled ? { domain } : {},\n        ...options.advanced?.defaultCookieAttributes,\n        ...overrideAttributes,\n        ...attributes\n      }\n    };\n  }\n  return createCookie;\n}\nfunction getCookies(options) {\n  const createCookie = createCookieGetter(options);\n  const sessionMaxAge = options.session?.expiresIn || ms(\"7d\") / 1e3;\n  const sessionToken = createCookie(\"session_token\", {\n    maxAge: sessionMaxAge\n  });\n  const sessionData = createCookie(\"session_data\", {\n    maxAge: options.session?.cookieCache?.maxAge || 60 * 5\n  });\n  const dontRememberToken = createCookie(\"dont_remember\");\n  return {\n    sessionToken: {\n      name: sessionToken.name,\n      options: sessionToken.attributes\n    },\n    /**\n     * This cookie is used to store the session data in the cookie\n     * This is useful for when you want to cache the session in the cookie\n     */\n    sessionData: {\n      name: sessionData.name,\n      options: sessionData.attributes\n    },\n    dontRememberToken: {\n      name: dontRememberToken.name,\n      options: dontRememberToken.attributes\n    }\n  };\n}\nasync function setCookieCache(ctx, session, dontRememberMe) {\n  const shouldStoreSessionDataInCookie = ctx.context.options.session?.cookieCache?.enabled;\n  if (shouldStoreSessionDataInCookie) {\n    const filteredSession = Object.entries(session.session).reduce(\n      (acc, [key, value]) => {\n        const fieldConfig = ctx.context.options.session?.additionalFields?.[key];\n        if (!fieldConfig || fieldConfig.returned !== false) {\n          acc[key] = value;\n        }\n        return acc;\n      },\n      {}\n    );\n    const sessionData = { session: filteredSession, user: session.user };\n    const options = {\n      ...ctx.context.authCookies.sessionData.options,\n      maxAge: dontRememberMe ? void 0 : ctx.context.authCookies.sessionData.options.maxAge\n    };\n    const expiresAtDate = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options.maxAge || 60, \"sec\").getTime();\n    const data = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64Url.encode(\n      JSON.stringify({\n        session: sessionData,\n        expiresAt: expiresAtDate,\n        signature: await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n          ctx.context.secret,\n          JSON.stringify({\n            ...sessionData,\n            expiresAt: expiresAtDate\n          })\n        )\n      }),\n      {\n        padding: false\n      }\n    );\n    if (data.length > 4093) {\n      ctx.context?.logger?.error(\n        `Session data exceeds cookie size limit (${data.length} bytes > 4093 bytes). Consider reducing session data size or disabling cookie cache. Session will not be cached in cookie.`\n      );\n      return;\n    }\n    ctx.setCookie(ctx.context.authCookies.sessionData.name, data, options);\n  }\n}\nasync function setSessionCookie(ctx, session, dontRememberMe, overrides) {\n  const dontRememberMeCookie = await ctx.getSignedCookie(\n    ctx.context.authCookies.dontRememberToken.name,\n    ctx.context.secret\n  );\n  dontRememberMe = dontRememberMe !== void 0 ? dontRememberMe : !!dontRememberMeCookie;\n  const options = ctx.context.authCookies.sessionToken.options;\n  const maxAge = dontRememberMe ? void 0 : ctx.context.sessionConfig.expiresIn;\n  await ctx.setSignedCookie(\n    ctx.context.authCookies.sessionToken.name,\n    session.session.token,\n    ctx.context.secret,\n    {\n      ...options,\n      maxAge,\n      ...overrides\n    }\n  );\n  if (dontRememberMe) {\n    await ctx.setSignedCookie(\n      ctx.context.authCookies.dontRememberToken.name,\n      \"true\",\n      ctx.context.secret,\n      ctx.context.authCookies.dontRememberToken.options\n    );\n  }\n  await setCookieCache(ctx, session, dontRememberMe);\n  ctx.context.setNewSession(session);\n  if (ctx.context.options.secondaryStorage) {\n    await ctx.context.secondaryStorage?.set(\n      session.session.token,\n      JSON.stringify({\n        user: session.user,\n        session: session.session\n      }),\n      Math.floor(\n        (new Date(session.session.expiresAt).getTime() - Date.now()) / 1e3\n      )\n    );\n  }\n}\nfunction deleteSessionCookie(ctx, skipDontRememberMe) {\n  ctx.setCookie(ctx.context.authCookies.sessionToken.name, \"\", {\n    ...ctx.context.authCookies.sessionToken.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.sessionData.name, \"\", {\n    ...ctx.context.authCookies.sessionData.options,\n    maxAge: 0\n  });\n  if (!skipDontRememberMe) {\n    ctx.setCookie(ctx.context.authCookies.dontRememberToken.name, \"\", {\n      ...ctx.context.authCookies.dontRememberToken.options,\n      maxAge: 0\n    });\n  }\n}\nfunction parseCookies(cookieHeader) {\n  const cookies = cookieHeader.split(\"; \");\n  const cookieMap = /* @__PURE__ */ new Map();\n  cookies.forEach((cookie) => {\n    const [name, value] = cookie.split(\"=\");\n    cookieMap.set(name, value);\n  });\n  return cookieMap;\n}\nconst getSessionCookie = (request, config) => {\n  if (config?.cookiePrefix) {\n    if (config.cookieName) {\n      config.cookiePrefix = `${config.cookiePrefix}-`;\n    } else {\n      config.cookiePrefix = `${config.cookiePrefix}.`;\n    }\n  }\n  const headers = \"headers\" in request ? request.headers : request;\n  const req = request instanceof Request ? request : void 0;\n  (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_6__.a)(req?.url, config?.path, req);\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_token\", cookiePrefix = \"better-auth.\" } = config || {};\n  const name = `${cookiePrefix}${cookieName}`;\n  const secureCookieName = `__Secure-${name}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionToken = parsedCookie.get(name) || parsedCookie.get(secureCookieName);\n  if (sessionToken) {\n    return sessionToken;\n  }\n  return null;\n};\nconst getCookieCache = async (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_data\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = config?.isSecure !== void 0 ? config.isSecure ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}` : _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__.isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionData = parsedCookie.get(name);\n  if (sessionData) {\n    const sessionDataPayload = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_5__.s)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64Url.decode(sessionData)));\n    if (!sessionDataPayload) {\n      return null;\n    }\n    const secret = config?.secret || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__.env.BETTER_AUTH_SECRET;\n    if (!secret) {\n      throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__.BetterAuthError(\n        \"getCookieCache requires a secret to be provided. Either pass it as an option or set the BETTER_AUTH_SECRET environment variable\"\n      );\n    }\n    const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n      secret,\n      JSON.stringify({\n        ...sessionDataPayload.session,\n        expiresAt: sessionDataPayload.expiresAt\n      }),\n      sessionDataPayload.signature\n    );\n    if (!isValid) {\n      return null;\n    }\n    return sessionDataPayload.session;\n  }\n  return null;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRDlfdlFSODMubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUEwRDtBQUNBO0FBQ0E7QUFDSjtBQUNEO0FBQ1c7QUFDSDtBQUNWO0FBQ2Y7O0FBRXBDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsc0JBQXNCO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJLQUEySyxvQkFBb0I7QUFDL0w7QUFDQTtBQUNBLFNBQVMscUJBQXFCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsVUFBVSxrQ0FBa0Msb0JBQW9CO0FBQzVHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHFCQUFxQjtBQUNoRCw0QkFBNEIsc0JBQXNCO0FBQ2xELDJCQUEyQixxQkFBcUI7QUFDaEQsMkJBQTJCLHFCQUFxQjtBQUNoRCwyQkFBMkIscUJBQXFCO0FBQ2hELDJCQUEyQixxQkFBcUI7QUFDaEQsMkJBQTJCLHFCQUFxQjtBQUNoRCxXQUFXLEtBQUs7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMkxBQTJMLCtEQUFZO0FBQ3ZNO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxvRUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQSxxRUFBcUUsT0FBTyxHQUFHLFdBQVc7QUFDMUY7QUFDQTtBQUNBLGVBQWUsbUJBQW1CLEVBQUUsS0FBSztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFNBQVMsSUFBSTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw0REFBTztBQUNqQyxpQkFBaUIsZ0VBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLG1FQUFVO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixvQkFBb0I7QUFDbkQsTUFBTTtBQUNOLCtCQUErQixvQkFBb0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLDREQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDhEQUE4RDtBQUN4RSxrQkFBa0IsYUFBYSxFQUFFLFdBQVc7QUFDNUMsdUNBQXVDLEtBQUs7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDREQUE0RDtBQUN0RSwyRUFBMkUsYUFBYSxHQUFHLFdBQVcsT0FBTyxhQUFhLEdBQUcsV0FBVyxJQUFJLCtEQUFZLGVBQWUsYUFBYSxHQUFHLFdBQVcsT0FBTyxhQUFhLEdBQUcsV0FBVztBQUNwTztBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsNERBQWEsQ0FBQyw2REFBTSxRQUFRLGdFQUFTO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxzREFBRztBQUN4QztBQUNBLGdCQUFnQixvRUFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUVBQVU7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVrTSIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkQ5X3ZRUjgzLm1qcz83NzlmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcbmltcG9ydCB7IGcgYXMgZ2V0RGF0ZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCB7IGlzUHJvZHVjdGlvbiwgZW52IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCB7IGJhc2U2NFVybCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgY3JlYXRlSE1BQyB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QmFzZVVSTCB9IGZyb20gJy4vYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzJztcbmltcG9ydCB7IGJpbmFyeSB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iaW5hcnknO1xuaW1wb3J0ICcuL2JldHRlci1hdXRoLkloOEM3NlZvLm1qcyc7XG5cbi8vI3JlZ2lvbiBzcmMvaW5kZXgudHNcbmNvbnN0IHMgPSAxZTM7XG5jb25zdCBtID0gcyAqIDYwO1xuY29uc3QgaCA9IG0gKiA2MDtcbmNvbnN0IGQgPSBoICogMjQ7XG5jb25zdCB3ID0gZCAqIDc7XG5jb25zdCB5ID0gZCAqIDM2NS4yNTtcbmNvbnN0IG1vID0geSAvIDEyO1xuZnVuY3Rpb24gbXModmFsdWUsIG9wdGlvbnMpIHtcblx0aWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHBhcnNlKHZhbHVlKTtcblx0ZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSByZXR1cm4gZm9ybWF0KHZhbHVlKTtcblx0dGhyb3cgbmV3IEVycm9yKGBWYWx1ZSBwcm92aWRlZCB0byBtcygpIG11c3QgYmUgYSBzdHJpbmcgb3IgbnVtYmVyLiB2YWx1ZT0ke0pTT04uc3RyaW5naWZ5KHZhbHVlKX1gKTtcbn1cbi8qKlxuKiBQYXJzZSB0aGUgZ2l2ZW4gc3RyaW5nIGFuZCByZXR1cm4gbWlsbGlzZWNvbmRzLlxuKlxuKiBAcGFyYW0gc3RyIC0gQSBzdHJpbmcgdG8gcGFyc2UgdG8gbWlsbGlzZWNvbmRzXG4qIEByZXR1cm5zIFRoZSBwYXJzZWQgdmFsdWUgaW4gbWlsbGlzZWNvbmRzLCBvciBgTmFOYCBpZiB0aGUgc3RyaW5nIGNhbid0IGJlXG4qIHBhcnNlZFxuKi9cbmZ1bmN0aW9uIHBhcnNlKHN0cikge1xuXHRpZiAodHlwZW9mIHN0ciAhPT0gXCJzdHJpbmdcIiB8fCBzdHIubGVuZ3RoID09PSAwIHx8IHN0ci5sZW5ndGggPiAxMDApIHRocm93IG5ldyBFcnJvcihgVmFsdWUgcHJvdmlkZWQgdG8gbXMucGFyc2UoKSBtdXN0IGJlIGEgc3RyaW5nIHdpdGggbGVuZ3RoIGJldHdlZW4gMSBhbmQgOTkuIHZhbHVlPSR7SlNPTi5zdHJpbmdpZnkoc3RyKX1gKTtcblx0Y29uc3QgbWF0Y2ggPSAvXig/PHZhbHVlPi0/XFxkKlxcLj9cXGQrKSAqKD88dW5pdD5taWxsaXNlY29uZHM/fG1zZWNzP3xtc3xzZWNvbmRzP3xzZWNzP3xzfG1pbnV0ZXM/fG1pbnM/fG18aG91cnM/fGhycz98aHxkYXlzP3xkfHdlZWtzP3x3fG1vbnRocz98bW98eWVhcnM/fHlycz98eSk/JC9pLmV4ZWMoc3RyKTtcblx0aWYgKCFtYXRjaD8uZ3JvdXBzKSByZXR1cm4gTmFOO1xuXHRjb25zdCB7IHZhbHVlLCB1bml0ID0gXCJtc1wiIH0gPSBtYXRjaC5ncm91cHM7XG5cdGNvbnN0IG4gPSBwYXJzZUZsb2F0KHZhbHVlKTtcblx0Y29uc3QgbWF0Y2hVbml0ID0gdW5pdC50b0xvd2VyQ2FzZSgpO1xuXHQvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAtIGlzdGFuYnVsIGRvZXNuJ3QgdW5kZXJzdGFuZCwgYnV0IHRoYW5rZnVsbHkgdGhlIFR5cGVTY3JpcHQgdGhlIGV4aGF1c3RpdmVuZXNzIGNoZWNrIGluIHRoZSBkZWZhdWx0IGNhc2Uga2VlcHMgdXMgdHlwZSBzYWZlIGhlcmUgKi9cblx0c3dpdGNoIChtYXRjaFVuaXQpIHtcblx0XHRjYXNlIFwieWVhcnNcIjpcblx0XHRjYXNlIFwieWVhclwiOlxuXHRcdGNhc2UgXCJ5cnNcIjpcblx0XHRjYXNlIFwieXJcIjpcblx0XHRjYXNlIFwieVwiOiByZXR1cm4gbiAqIHk7XG5cdFx0Y2FzZSBcIm1vbnRoc1wiOlxuXHRcdGNhc2UgXCJtb250aFwiOlxuXHRcdGNhc2UgXCJtb1wiOiByZXR1cm4gbiAqIG1vO1xuXHRcdGNhc2UgXCJ3ZWVrc1wiOlxuXHRcdGNhc2UgXCJ3ZWVrXCI6XG5cdFx0Y2FzZSBcIndcIjogcmV0dXJuIG4gKiB3O1xuXHRcdGNhc2UgXCJkYXlzXCI6XG5cdFx0Y2FzZSBcImRheVwiOlxuXHRcdGNhc2UgXCJkXCI6IHJldHVybiBuICogZDtcblx0XHRjYXNlIFwiaG91cnNcIjpcblx0XHRjYXNlIFwiaG91clwiOlxuXHRcdGNhc2UgXCJocnNcIjpcblx0XHRjYXNlIFwiaHJcIjpcblx0XHRjYXNlIFwiaFwiOiByZXR1cm4gbiAqIGg7XG5cdFx0Y2FzZSBcIm1pbnV0ZXNcIjpcblx0XHRjYXNlIFwibWludXRlXCI6XG5cdFx0Y2FzZSBcIm1pbnNcIjpcblx0XHRjYXNlIFwibWluXCI6XG5cdFx0Y2FzZSBcIm1cIjogcmV0dXJuIG4gKiBtO1xuXHRcdGNhc2UgXCJzZWNvbmRzXCI6XG5cdFx0Y2FzZSBcInNlY29uZFwiOlxuXHRcdGNhc2UgXCJzZWNzXCI6XG5cdFx0Y2FzZSBcInNlY1wiOlxuXHRcdGNhc2UgXCJzXCI6IHJldHVybiBuICogcztcblx0XHRjYXNlIFwibWlsbGlzZWNvbmRzXCI6XG5cdFx0Y2FzZSBcIm1pbGxpc2Vjb25kXCI6XG5cdFx0Y2FzZSBcIm1zZWNzXCI6XG5cdFx0Y2FzZSBcIm1zZWNcIjpcblx0XHRjYXNlIFwibXNcIjogcmV0dXJuIG47XG5cdFx0ZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHVuaXQgXCIke21hdGNoVW5pdH1cIiBwcm92aWRlZCB0byBtcy5wYXJzZSgpLiB2YWx1ZT0ke0pTT04uc3RyaW5naWZ5KHN0cil9YCk7XG5cdH1cbn1cbi8qKlxuKiBTaG9ydCBmb3JtYXQgZm9yIGBtc2AuXG4qL1xuZnVuY3Rpb24gZm10U2hvcnQobXMkMSkge1xuXHRjb25zdCBtc0FicyA9IE1hdGguYWJzKG1zJDEpO1xuXHRpZiAobXNBYnMgPj0geSkgcmV0dXJuIGAke01hdGgucm91bmQobXMkMSAvIHkpfXlgO1xuXHRpZiAobXNBYnMgPj0gbW8pIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBtbyl9bW9gO1xuXHRpZiAobXNBYnMgPj0gdykgcmV0dXJuIGAke01hdGgucm91bmQobXMkMSAvIHcpfXdgO1xuXHRpZiAobXNBYnMgPj0gZCkgcmV0dXJuIGAke01hdGgucm91bmQobXMkMSAvIGQpfWRgO1xuXHRpZiAobXNBYnMgPj0gaCkgcmV0dXJuIGAke01hdGgucm91bmQobXMkMSAvIGgpfWhgO1xuXHRpZiAobXNBYnMgPj0gbSkgcmV0dXJuIGAke01hdGgucm91bmQobXMkMSAvIG0pfW1gO1xuXHRpZiAobXNBYnMgPj0gcykgcmV0dXJuIGAke01hdGgucm91bmQobXMkMSAvIHMpfXNgO1xuXHRyZXR1cm4gYCR7bXMkMX1tc2A7XG59XG4vKipcbiogRm9ybWF0IHRoZSBnaXZlbiBpbnRlZ2VyIGFzIGEgc3RyaW5nLlxuKlxuKiBAcGFyYW0gbXMgLSBtaWxsaXNlY29uZHNcbiogQHBhcmFtIG9wdGlvbnMgLSBPcHRpb25zIGZvciB0aGUgY29udmVyc2lvblxuKiBAcmV0dXJucyBUaGUgZm9ybWF0dGVkIHN0cmluZ1xuKi9cbmZ1bmN0aW9uIGZvcm1hdChtcyQxLCBvcHRpb25zKSB7XG5cdGlmICh0eXBlb2YgbXMkMSAhPT0gXCJudW1iZXJcIiB8fCAhTnVtYmVyLmlzRmluaXRlKG1zJDEpKSB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBwcm92aWRlZCB0byBtcy5mb3JtYXQoKSBtdXN0IGJlIG9mIHR5cGUgbnVtYmVyLlwiKTtcblx0cmV0dXJuIGZtdFNob3J0KG1zJDEpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDb29raWVHZXR0ZXIob3B0aW9ucykge1xuICBjb25zdCBzZWN1cmUgPSBvcHRpb25zLmFkdmFuY2VkPy51c2VTZWN1cmVDb29raWVzICE9PSB2b2lkIDAgPyBvcHRpb25zLmFkdmFuY2VkPy51c2VTZWN1cmVDb29raWVzIDogb3B0aW9ucy5iYXNlVVJMICE9PSB2b2lkIDAgPyBvcHRpb25zLmJhc2VVUkwuc3RhcnRzV2l0aChcImh0dHBzOi8vXCIpID8gdHJ1ZSA6IGZhbHNlIDogaXNQcm9kdWN0aW9uO1xuICBjb25zdCBzZWN1cmVDb29raWVQcmVmaXggPSBzZWN1cmUgPyBcIl9fU2VjdXJlLVwiIDogXCJcIjtcbiAgY29uc3QgY3Jvc3NTdWJkb21haW5FbmFibGVkID0gISFvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmVuYWJsZWQ7XG4gIGNvbnN0IGRvbWFpbiA9IGNyb3NzU3ViZG9tYWluRW5hYmxlZCA/IG9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uZG9tYWluIHx8IChvcHRpb25zLmJhc2VVUkwgPyBuZXcgVVJMKG9wdGlvbnMuYmFzZVVSTCkuaG9zdG5hbWUgOiB2b2lkIDApIDogdm9pZCAwO1xuICBpZiAoY3Jvc3NTdWJkb21haW5FbmFibGVkICYmICFkb21haW4pIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgXCJiYXNlVVJMIGlzIHJlcXVpcmVkIHdoZW4gY3Jvc3NTdWJkb21haW5Db29raWVzIGFyZSBlbmFibGVkXCJcbiAgICApO1xuICB9XG4gIGZ1bmN0aW9uIGNyZWF0ZUNvb2tpZShjb29raWVOYW1lLCBvdmVycmlkZUF0dHJpYnV0ZXMgPSB7fSkge1xuICAgIGNvbnN0IHByZWZpeCA9IG9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZVByZWZpeCB8fCBcImJldHRlci1hdXRoXCI7XG4gICAgY29uc3QgbmFtZSA9IG9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZXM/Lltjb29raWVOYW1lXT8ubmFtZSB8fCBgJHtwcmVmaXh9LiR7Y29va2llTmFtZX1gO1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBvcHRpb25zLmFkdmFuY2VkPy5jb29raWVzPy5bY29va2llTmFtZV0/LmF0dHJpYnV0ZXM7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGAke3NlY3VyZUNvb2tpZVByZWZpeH0ke25hbWV9YCxcbiAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgc2VjdXJlOiAhIXNlY3VyZUNvb2tpZVByZWZpeCxcbiAgICAgICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgICAgIHBhdGg6IFwiL1wiLFxuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgLi4uY3Jvc3NTdWJkb21haW5FbmFibGVkID8geyBkb21haW4gfSA6IHt9LFxuICAgICAgICAuLi5vcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcyxcbiAgICAgICAgLi4ub3ZlcnJpZGVBdHRyaWJ1dGVzLFxuICAgICAgICAuLi5hdHRyaWJ1dGVzXG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4gY3JlYXRlQ29va2llO1xufVxuZnVuY3Rpb24gZ2V0Q29va2llcyhvcHRpb25zKSB7XG4gIGNvbnN0IGNyZWF0ZUNvb2tpZSA9IGNyZWF0ZUNvb2tpZUdldHRlcihvcHRpb25zKTtcbiAgY29uc3Qgc2Vzc2lvbk1heEFnZSA9IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luIHx8IG1zKFwiN2RcIikgLyAxZTM7XG4gIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGNyZWF0ZUNvb2tpZShcInNlc3Npb25fdG9rZW5cIiwge1xuICAgIG1heEFnZTogc2Vzc2lvbk1heEFnZVxuICB9KTtcbiAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBjcmVhdGVDb29raWUoXCJzZXNzaW9uX2RhdGFcIiwge1xuICAgIG1heEFnZTogb3B0aW9ucy5zZXNzaW9uPy5jb29raWVDYWNoZT8ubWF4QWdlIHx8IDYwICogNVxuICB9KTtcbiAgY29uc3QgZG9udFJlbWVtYmVyVG9rZW4gPSBjcmVhdGVDb29raWUoXCJkb250X3JlbWVtYmVyXCIpO1xuICByZXR1cm4ge1xuICAgIHNlc3Npb25Ub2tlbjoge1xuICAgICAgbmFtZTogc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgICBvcHRpb25zOiBzZXNzaW9uVG9rZW4uYXR0cmlidXRlc1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogVGhpcyBjb29raWUgaXMgdXNlZCB0byBzdG9yZSB0aGUgc2Vzc2lvbiBkYXRhIGluIHRoZSBjb29raWVcbiAgICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3Igd2hlbiB5b3Ugd2FudCB0byBjYWNoZSB0aGUgc2Vzc2lvbiBpbiB0aGUgY29va2llXG4gICAgICovXG4gICAgc2Vzc2lvbkRhdGE6IHtcbiAgICAgIG5hbWU6IHNlc3Npb25EYXRhLm5hbWUsXG4gICAgICBvcHRpb25zOiBzZXNzaW9uRGF0YS5hdHRyaWJ1dGVzXG4gICAgfSxcbiAgICBkb250UmVtZW1iZXJUb2tlbjoge1xuICAgICAgbmFtZTogZG9udFJlbWVtYmVyVG9rZW4ubmFtZSxcbiAgICAgIG9wdGlvbnM6IGRvbnRSZW1lbWJlclRva2VuLmF0dHJpYnV0ZXNcbiAgICB9XG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiBzZXRDb29raWVDYWNoZShjdHgsIHNlc3Npb24sIGRvbnRSZW1lbWJlck1lKSB7XG4gIGNvbnN0IHNob3VsZFN0b3JlU2Vzc2lvbkRhdGFJbkNvb2tpZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/LmVuYWJsZWQ7XG4gIGlmIChzaG91bGRTdG9yZVNlc3Npb25EYXRhSW5Db29raWUpIHtcbiAgICBjb25zdCBmaWx0ZXJlZFNlc3Npb24gPSBPYmplY3QuZW50cmllcyhzZXNzaW9uLnNlc3Npb24pLnJlZHVjZShcbiAgICAgIChhY2MsIFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZENvbmZpZyA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uYWRkaXRpb25hbEZpZWxkcz8uW2tleV07XG4gICAgICAgIGlmICghZmllbGRDb25maWcgfHwgZmllbGRDb25maWcucmV0dXJuZWQgIT09IGZhbHNlKSB7XG4gICAgICAgICAgYWNjW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICBjb25zdCBzZXNzaW9uRGF0YSA9IHsgc2Vzc2lvbjogZmlsdGVyZWRTZXNzaW9uLCB1c2VyOiBzZXNzaW9uLnVzZXIgfTtcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEub3B0aW9ucyxcbiAgICAgIG1heEFnZTogZG9udFJlbWVtYmVyTWUgPyB2b2lkIDAgOiBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5vcHRpb25zLm1heEFnZVxuICAgIH07XG4gICAgY29uc3QgZXhwaXJlc0F0RGF0ZSA9IGdldERhdGUob3B0aW9ucy5tYXhBZ2UgfHwgNjAsIFwic2VjXCIpLmdldFRpbWUoKTtcbiAgICBjb25zdCBkYXRhID0gYmFzZTY0VXJsLmVuY29kZShcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbkRhdGEsXG4gICAgICAgIGV4cGlyZXNBdDogZXhwaXJlc0F0RGF0ZSxcbiAgICAgICAgc2lnbmF0dXJlOiBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnNpZ24oXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIC4uLnNlc3Npb25EYXRhLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBleHBpcmVzQXREYXRlXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgfSksXG4gICAgICB7XG4gICAgICAgIHBhZGRpbmc6IGZhbHNlXG4gICAgICB9XG4gICAgKTtcbiAgICBpZiAoZGF0YS5sZW5ndGggPiA0MDkzKSB7XG4gICAgICBjdHguY29udGV4dD8ubG9nZ2VyPy5lcnJvcihcbiAgICAgICAgYFNlc3Npb24gZGF0YSBleGNlZWRzIGNvb2tpZSBzaXplIGxpbWl0ICgke2RhdGEubGVuZ3RofSBieXRlcyA+IDQwOTMgYnl0ZXMpLiBDb25zaWRlciByZWR1Y2luZyBzZXNzaW9uIGRhdGEgc2l6ZSBvciBkaXNhYmxpbmcgY29va2llIGNhY2hlLiBTZXNzaW9uIHdpbGwgbm90IGJlIGNhY2hlZCBpbiBjb29raWUuYFxuICAgICAgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY3R4LnNldENvb2tpZShjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lLCBkYXRhLCBvcHRpb25zKTtcbiAgfVxufVxuYXN5bmMgZnVuY3Rpb24gc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHNlc3Npb24sIGRvbnRSZW1lbWJlck1lLCBvdmVycmlkZXMpIHtcbiAgY29uc3QgZG9udFJlbWVtYmVyTWVDb29raWUgPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm5hbWUsXG4gICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICk7XG4gIGRvbnRSZW1lbWJlck1lID0gZG9udFJlbWVtYmVyTWUgIT09IHZvaWQgMCA/IGRvbnRSZW1lbWJlck1lIDogISFkb250UmVtZW1iZXJNZUNvb2tpZTtcbiAgY29uc3Qgb3B0aW9ucyA9IGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5vcHRpb25zO1xuICBjb25zdCBtYXhBZ2UgPSBkb250UmVtZW1iZXJNZSA/IHZvaWQgMCA6IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZXhwaXJlc0luO1xuICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLFxuICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAge1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIG1heEFnZSxcbiAgICAgIC4uLm92ZXJyaWRlc1xuICAgIH1cbiAgKTtcbiAgaWYgKGRvbnRSZW1lbWJlck1lKSB7XG4gICAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm5hbWUsXG4gICAgICBcInRydWVcIixcbiAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm9wdGlvbnNcbiAgICApO1xuICB9XG4gIGF3YWl0IHNldENvb2tpZUNhY2hlKGN0eCwgc2Vzc2lvbiwgZG9udFJlbWVtYmVyTWUpO1xuICBjdHguY29udGV4dC5zZXROZXdTZXNzaW9uKHNlc3Npb24pO1xuICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuc2Vjb25kYXJ5U3RvcmFnZT8uc2V0KFxuICAgICAgc2Vzc2lvbi5zZXNzaW9uLnRva2VuLFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXIsXG4gICAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvblxuICAgICAgfSksXG4gICAgICBNYXRoLmZsb29yKFxuICAgICAgICAobmV3IERhdGUoc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdCkuZ2V0VGltZSgpIC0gRGF0ZS5ub3coKSkgLyAxZTNcbiAgICAgIClcbiAgICApO1xuICB9XG59XG5mdW5jdGlvbiBkZWxldGVTZXNzaW9uQ29va2llKGN0eCwgc2tpcERvbnRSZW1lbWJlck1lKSB7XG4gIGN0eC5zZXRDb29raWUoY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWUsIFwiXCIsIHtcbiAgICAuLi5jdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ub3B0aW9ucyxcbiAgICBtYXhBZ2U6IDBcbiAgfSk7XG4gIGN0eC5zZXRDb29raWUoY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZSwgXCJcIiwge1xuICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm9wdGlvbnMsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICBpZiAoIXNraXBEb250UmVtZW1iZXJNZSkge1xuICAgIGN0eC5zZXRDb29raWUoY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ubmFtZSwgXCJcIiwge1xuICAgICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ub3B0aW9ucyxcbiAgICAgIG1heEFnZTogMFxuICAgIH0pO1xuICB9XG59XG5mdW5jdGlvbiBwYXJzZUNvb2tpZXMoY29va2llSGVhZGVyKSB7XG4gIGNvbnN0IGNvb2tpZXMgPSBjb29raWVIZWFkZXIuc3BsaXQoXCI7IFwiKTtcbiAgY29uc3QgY29va2llTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgY29va2llcy5mb3JFYWNoKChjb29raWUpID0+IHtcbiAgICBjb25zdCBbbmFtZSwgdmFsdWVdID0gY29va2llLnNwbGl0KFwiPVwiKTtcbiAgICBjb29raWVNYXAuc2V0KG5hbWUsIHZhbHVlKTtcbiAgfSk7XG4gIHJldHVybiBjb29raWVNYXA7XG59XG5jb25zdCBnZXRTZXNzaW9uQ29va2llID0gKHJlcXVlc3QsIGNvbmZpZykgPT4ge1xuICBpZiAoY29uZmlnPy5jb29raWVQcmVmaXgpIHtcbiAgICBpZiAoY29uZmlnLmNvb2tpZU5hbWUpIHtcbiAgICAgIGNvbmZpZy5jb29raWVQcmVmaXggPSBgJHtjb25maWcuY29va2llUHJlZml4fS1gO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25maWcuY29va2llUHJlZml4ID0gYCR7Y29uZmlnLmNvb2tpZVByZWZpeH0uYDtcbiAgICB9XG4gIH1cbiAgY29uc3QgaGVhZGVycyA9IFwiaGVhZGVyc1wiIGluIHJlcXVlc3QgPyByZXF1ZXN0LmhlYWRlcnMgOiByZXF1ZXN0O1xuICBjb25zdCByZXEgPSByZXF1ZXN0IGluc3RhbmNlb2YgUmVxdWVzdCA/IHJlcXVlc3QgOiB2b2lkIDA7XG4gIGdldEJhc2VVUkwocmVxPy51cmwsIGNvbmZpZz8ucGF0aCwgcmVxKTtcbiAgY29uc3QgY29va2llcyA9IGhlYWRlcnMuZ2V0KFwiY29va2llXCIpO1xuICBpZiAoIWNvb2tpZXMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB7IGNvb2tpZU5hbWUgPSBcInNlc3Npb25fdG9rZW5cIiwgY29va2llUHJlZml4ID0gXCJiZXR0ZXItYXV0aC5cIiB9ID0gY29uZmlnIHx8IHt9O1xuICBjb25zdCBuYW1lID0gYCR7Y29va2llUHJlZml4fSR7Y29va2llTmFtZX1gO1xuICBjb25zdCBzZWN1cmVDb29raWVOYW1lID0gYF9fU2VjdXJlLSR7bmFtZX1gO1xuICBjb25zdCBwYXJzZWRDb29raWUgPSBwYXJzZUNvb2tpZXMoY29va2llcyk7XG4gIGNvbnN0IHNlc3Npb25Ub2tlbiA9IHBhcnNlZENvb2tpZS5nZXQobmFtZSkgfHwgcGFyc2VkQ29va2llLmdldChzZWN1cmVDb29raWVOYW1lKTtcbiAgaWYgKHNlc3Npb25Ub2tlbikge1xuICAgIHJldHVybiBzZXNzaW9uVG9rZW47XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xuY29uc3QgZ2V0Q29va2llQ2FjaGUgPSBhc3luYyAocmVxdWVzdCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGhlYWRlcnMgPSByZXF1ZXN0IGluc3RhbmNlb2YgSGVhZGVycyA/IHJlcXVlc3QgOiByZXF1ZXN0LmhlYWRlcnM7XG4gIGNvbnN0IGNvb2tpZXMgPSBoZWFkZXJzLmdldChcImNvb2tpZVwiKTtcbiAgaWYgKCFjb29raWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBjb29raWVOYW1lID0gXCJzZXNzaW9uX2RhdGFcIiwgY29va2llUHJlZml4ID0gXCJiZXR0ZXItYXV0aFwiIH0gPSBjb25maWcgfHwge307XG4gIGNvbnN0IG5hbWUgPSBjb25maWc/LmlzU2VjdXJlICE9PSB2b2lkIDAgPyBjb25maWcuaXNTZWN1cmUgPyBgX19TZWN1cmUtJHtjb29raWVQcmVmaXh9LiR7Y29va2llTmFtZX1gIDogYCR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YCA6IGlzUHJvZHVjdGlvbiA/IGBfX1NlY3VyZS0ke2Nvb2tpZVByZWZpeH0uJHtjb29raWVOYW1lfWAgOiBgJHtjb29raWVQcmVmaXh9LiR7Y29va2llTmFtZX1gO1xuICBjb25zdCBwYXJzZWRDb29raWUgPSBwYXJzZUNvb2tpZXMoY29va2llcyk7XG4gIGNvbnN0IHNlc3Npb25EYXRhID0gcGFyc2VkQ29va2llLmdldChuYW1lKTtcbiAgaWYgKHNlc3Npb25EYXRhKSB7XG4gICAgY29uc3Qgc2Vzc2lvbkRhdGFQYXlsb2FkID0gc2FmZUpTT05QYXJzZShiaW5hcnkuZGVjb2RlKGJhc2U2NFVybC5kZWNvZGUoc2Vzc2lvbkRhdGEpKSk7XG4gICAgaWYgKCFzZXNzaW9uRGF0YVBheWxvYWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBzZWNyZXQgPSBjb25maWc/LnNlY3JldCB8fCBlbnYuQkVUVEVSX0FVVEhfU0VDUkVUO1xuICAgIGlmICghc2VjcmV0KSB7XG4gICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICBcImdldENvb2tpZUNhY2hlIHJlcXVpcmVzIGEgc2VjcmV0IHRvIGJlIHByb3ZpZGVkLiBFaXRoZXIgcGFzcyBpdCBhcyBhbiBvcHRpb24gb3Igc2V0IHRoZSBCRVRURVJfQVVUSF9TRUNSRVQgZW52aXJvbm1lbnQgdmFyaWFibGVcIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgaXNWYWxpZCA9IGF3YWl0IGNyZWF0ZUhNQUMoXCJTSEEtMjU2XCIsIFwiYmFzZTY0dXJsbm9wYWRcIikudmVyaWZ5KFxuICAgICAgc2VjcmV0LFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAuLi5zZXNzaW9uRGF0YVBheWxvYWQuc2Vzc2lvbixcbiAgICAgICAgZXhwaXJlc0F0OiBzZXNzaW9uRGF0YVBheWxvYWQuZXhwaXJlc0F0XG4gICAgICB9KSxcbiAgICAgIHNlc3Npb25EYXRhUGF5bG9hZC5zaWduYXR1cmVcbiAgICApO1xuICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBzZXNzaW9uRGF0YVBheWxvYWQuc2Vzc2lvbjtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG5cbmV4cG9ydCB7IHNldENvb2tpZUNhY2hlIGFzIGEsIGdldFNlc3Npb25Db29raWUgYXMgYiwgY3JlYXRlQ29va2llR2V0dGVyIGFzIGMsIGRlbGV0ZVNlc3Npb25Db29raWUgYXMgZCwgZ2V0Q29va2llQ2FjaGUgYXMgZSwgZ2V0Q29va2llcyBhcyBnLCBtcyBhcyBtLCBwYXJzZUNvb2tpZXMgYXMgcCwgc2V0U2Vzc2lvbkNvb2tpZSBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getSession),\n/* harmony export */   b: () => (/* binding */ revokeSessions),\n/* harmony export */   c: () => (/* binding */ revokeSession),\n/* harmony export */   d: () => (/* binding */ getSessionQuerySchema),\n/* harmony export */   e: () => (/* binding */ sensitiveSessionMiddleware),\n/* harmony export */   f: () => (/* binding */ freshSessionMiddleware),\n/* harmony export */   g: () => (/* binding */ getSessionFromCtx),\n/* harmony export */   h: () => (/* binding */ requestOnlySessionMiddleware),\n/* harmony export */   l: () => (/* binding */ listSessions),\n/* harmony export */   r: () => (/* binding */ revokeOtherSessions),\n/* harmony export */   s: () => (/* binding */ sessionMiddleware)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n\n\n\n\n\n\n\n\n\n\n\nconst getSessionQuerySchema = zod__WEBPACK_IMPORTED_MODULE_9__.optional(\n  zod__WEBPACK_IMPORTED_MODULE_9__.object({\n    /**\n     * If cookie cache is enabled, it will disable the cache\n     * and fetch the session from the database\n     */\n    disableCookieCache: zod__WEBPACK_IMPORTED_MODULE_9__.coerce.boolean().meta({\n      description: \"Disable cookie cache and fetch session from database\"\n    }).optional(),\n    disableRefresh: zod__WEBPACK_IMPORTED_MODULE_9__.coerce.boolean().meta({\n      description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n    }).optional()\n  })\n);\nconst getSession = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/get-session\",\n  {\n    method: \"GET\",\n    query: getSessionQuerySchema,\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Get the current session\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      $ref: \"#/components/schemas/Session\"\n                    },\n                    user: {\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  },\n                  required: [\"session\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessionCookieToken = await ctx.getSignedCookie(\n        ctx.context.authCookies.sessionToken.name,\n        ctx.context.secret\n      );\n      if (!sessionCookieToken) {\n        return null;\n      }\n      const sessionDataCookie = ctx.getCookie(\n        ctx.context.authCookies.sessionData.name\n      );\n      const sessionDataPayload = sessionDataCookie ? (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_4__.s)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_8__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_7__.base64Url.decode(sessionDataCookie))) : null;\n      if (sessionDataPayload) {\n        const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_6__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n          ctx.context.secret,\n          JSON.stringify({\n            ...sessionDataPayload.session,\n            expiresAt: sessionDataPayload.expiresAt\n          }),\n          sessionDataPayload.signature\n        );\n        if (!isValid) {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n          return ctx.json(null);\n        }\n      }\n      const dontRememberMe = await ctx.getSignedCookie(\n        ctx.context.authCookies.dontRememberToken.name,\n        ctx.context.secret\n      );\n      if (sessionDataPayload?.session && ctx.context.options.session?.cookieCache?.enabled && !ctx.query?.disableCookieCache) {\n        const session2 = sessionDataPayload.session;\n        const hasExpired = sessionDataPayload.expiresAt < Date.now() || session2.session.expiresAt < /* @__PURE__ */ new Date();\n        if (!hasExpired) {\n          ctx.context.session = session2;\n          return ctx.json(\n            session2\n          );\n        } else {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n        }\n      }\n      const session = await ctx.context.internalAdapter.findSession(sessionCookieToken);\n      ctx.context.session = session;\n      if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n        (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.d)(ctx);\n        if (session) {\n          await ctx.context.internalAdapter.deleteSession(\n            session.session.token\n          );\n        }\n        return ctx.json(null);\n      }\n      if (dontRememberMe || ctx.query?.disableRefresh) {\n        return ctx.json(\n          session\n        );\n      }\n      const expiresIn = ctx.context.sessionConfig.expiresIn;\n      const updateAge = ctx.context.sessionConfig.updateAge;\n      const sessionIsDueToBeUpdatedDate = session.session.expiresAt.valueOf() - expiresIn * 1e3 + updateAge * 1e3;\n      const shouldBeUpdated = sessionIsDueToBeUpdatedDate <= Date.now();\n      if (shouldBeUpdated && (!ctx.query?.disableRefresh || !ctx.context.options.session?.disableSessionRefresh)) {\n        const updatedSession = await ctx.context.internalAdapter.updateSession(\n          session.session.token,\n          {\n            expiresAt: (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_2__.g)(ctx.context.sessionConfig.expiresIn, \"sec\"),\n            updatedAt: /* @__PURE__ */ new Date()\n          }\n        );\n        if (!updatedSession) {\n          (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.d)(ctx);\n          return ctx.json(null, { status: 401 });\n        }\n        const maxAge = (updatedSession.expiresAt.valueOf() - Date.now()) / 1e3;\n        await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(\n          ctx,\n          {\n            session: updatedSession,\n            user: session.user\n          },\n          false,\n          {\n            maxAge\n          }\n        );\n        return ctx.json({\n          session: updatedSession,\n          user: session.user\n        });\n      }\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(ctx, session, !!dontRememberMe);\n      return ctx.json(\n        session\n      );\n    } catch (error) {\n      ctx.context.logger.error(\"INTERNAL_SERVER_ERROR\", error);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n  }\n);\nconst getSessionFromCtx = async (ctx, config) => {\n  if (ctx.context.session) {\n    return ctx.context.session;\n  }\n  const session = await getSession()({\n    ...ctx,\n    asResponse: false,\n    headers: ctx.headers,\n    returnHeaders: false,\n    query: {\n      ...config,\n      ...ctx.query\n    }\n  }).catch((e) => {\n    return null;\n  });\n  ctx.context.session = session;\n  return session;\n};\nconst sessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nconst sensitiveSessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  const session = await getSessionFromCtx(ctx, { disableCookieCache: true });\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nconst requestOnlySessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(\n  async (ctx) => {\n    const session = await getSessionFromCtx(ctx);\n    if (!session?.session && (ctx.request || ctx.headers)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    return { session };\n  }\n);\nconst freshSessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  if (ctx.context.sessionConfig.freshAge === 0) {\n    return {\n      session\n    };\n  }\n  const freshAge = ctx.context.sessionConfig.freshAge;\n  const lastUpdated = session.session.updatedAt?.valueOf() || session.session.createdAt.valueOf();\n  const now = Date.now();\n  const isFresh = now - lastUpdated < freshAge * 1e3;\n  if (!isFresh) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"FORBIDDEN\", {\n      message: \"Session is not fresh\"\n    });\n  }\n  return {\n    session\n  };\n});\nconst listSessions = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/list-sessions\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"List all active sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    $ref: \"#/components/schemas/Session\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessions = await ctx.context.internalAdapter.listSessions(\n        ctx.context.session.user.id\n      );\n      const activeSessions = sessions.filter((session) => {\n        return session.expiresAt > /* @__PURE__ */ new Date();\n      });\n      return ctx.json(\n        activeSessions\n      );\n    } catch (e) {\n      ctx.context.logger.error(e);\n      throw ctx.error(\"INTERNAL_SERVER_ERROR\");\n    }\n  }\n);\nconst revokeSession = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/revoke-session\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_9__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_9__.string().meta({\n        description: \"The token to revoke\"\n      })\n    }),\n    use: [sensitiveSessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke a single session\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  token: {\n                    type: \"string\",\n                    description: \"The token to revoke\"\n                  }\n                },\n                required: [\"token\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the session was revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token;\n    const findSession = await ctx.context.internalAdapter.findSession(token);\n    if (!findSession) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: \"Session not found\"\n      });\n    }\n    if (findSession.session.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    try {\n      await ctx.context.internalAdapter.deleteSession(token);\n    } catch (error) {\n      ctx.context.logger.error(\n        error && typeof error === \"object\" && \"name\" in error ? error.name : \"\",\n        error\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst revokeSessions = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/revoke-sessions\",\n  {\n    method: \"POST\",\n    use: [sensitiveSessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke all sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if all sessions were revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      await ctx.context.internalAdapter.deleteSessions(\n        ctx.context.session.user.id\n      );\n    } catch (error) {\n      ctx.context.logger.error(\n        error && typeof error === \"object\" && \"name\" in error ? error.name : \"\",\n        error\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst revokeOtherSessions = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/revoke-other-sessions\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    use: [sensitiveSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Revoke all other sessions for the user except the current one\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if all other sessions were revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    if (!session.user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      session.user.id\n    );\n    const activeSessions = sessions.filter((session2) => {\n      return session2.expiresAt > /* @__PURE__ */ new Date();\n    });\n    const otherSessions = activeSessions.filter(\n      (session2) => session2.token !== ctx.context.session.session.token\n    );\n    await Promise.all(\n      otherSessions.map(\n        (session2) => ctx.context.internalAdapter.deleteSession(session2.token)\n      )\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguREVCdFJPRjkubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF1QztBQUNpRDtBQUM5QjtBQUN3RDtBQUN6RjtBQUN1QztBQUNMO0FBQ047QUFDQztBQUNIOztBQUVuRCw4QkFBOEIseUNBQVU7QUFDeEMsRUFBRSx1Q0FBUTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLCtDQUFnQjtBQUN4QztBQUNBLEtBQUs7QUFDTCxvQkFBb0IsK0NBQWdCO0FBQ3BDO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLHlCQUF5QixnRkFBa0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCw0REFBYSxDQUFDLDZEQUFNLFFBQVEsZ0VBQVM7QUFDMUY7QUFDQSw4QkFBOEIsbUVBQVU7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNERBQW1CO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw0QkFBNEIsZ0ZBQWtCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRThSIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguREVCdFJPRjkubWpzPzgxYzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBjcmVhdGVBdXRoTWlkZGxld2FyZSwgY3JlYXRlQXV0aEVuZHBvaW50IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvbWlkZGxld2FyZSc7XG5pbXBvcnQgeyBnIGFzIGdldERhdGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgeyBkIGFzIGRlbGV0ZVNlc3Npb25Db29raWUsIHMgYXMgc2V0U2Vzc2lvbkNvb2tpZSwgYSBhcyBzZXRDb29raWVDYWNoZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguRDlfdlFSODMubWpzJztcbmltcG9ydCAqIGFzIHogZnJvbSAnem9kJztcbmltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCB7IEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgeyBjcmVhdGVITUFDIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0IHsgYmFzZTY0VXJsIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgeyBiaW5hcnkgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcblxuY29uc3QgZ2V0U2Vzc2lvblF1ZXJ5U2NoZW1hID0gei5vcHRpb25hbChcbiAgei5vYmplY3Qoe1xuICAgIC8qKlxuICAgICAqIElmIGNvb2tpZSBjYWNoZSBpcyBlbmFibGVkLCBpdCB3aWxsIGRpc2FibGUgdGhlIGNhY2hlXG4gICAgICogYW5kIGZldGNoIHRoZSBzZXNzaW9uIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICovXG4gICAgZGlzYWJsZUNvb2tpZUNhY2hlOiB6LmNvZXJjZS5ib29sZWFuKCkubWV0YSh7XG4gICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIGNvb2tpZSBjYWNoZSBhbmQgZmV0Y2ggc2Vzc2lvbiBmcm9tIGRhdGFiYXNlXCJcbiAgICB9KS5vcHRpb25hbCgpLFxuICAgIGRpc2FibGVSZWZyZXNoOiB6LmNvZXJjZS5ib29sZWFuKCkubWV0YSh7XG4gICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIHNlc3Npb24gcmVmcmVzaC4gVXNlZnVsIGZvciBjaGVja2luZyBzZXNzaW9uIHN0YXR1cywgd2l0aG91dCB1cGRhdGluZyB0aGUgc2Vzc2lvblwiXG4gICAgfSkub3B0aW9uYWwoKVxuICB9KVxuKTtcbmNvbnN0IGdldFNlc3Npb24gPSAoKSA9PiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2dldC1zZXNzaW9uXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IGdldFNlc3Npb25RdWVyeVNjaGVtYSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGN1cnJlbnQgc2Vzc2lvblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic2Vzc2lvblwiLCBcInVzZXJcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZVRva2VuID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgKTtcbiAgICAgIGlmICghc2Vzc2lvbkNvb2tpZVRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbkRhdGFDb29raWUgPSBjdHguZ2V0Q29va2llKFxuICAgICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lXG4gICAgICApO1xuICAgICAgY29uc3Qgc2Vzc2lvbkRhdGFQYXlsb2FkID0gc2Vzc2lvbkRhdGFDb29raWUgPyBzYWZlSlNPTlBhcnNlKGJpbmFyeS5kZWNvZGUoYmFzZTY0VXJsLmRlY29kZShzZXNzaW9uRGF0YUNvb2tpZSkpKSA6IG51bGw7XG4gICAgICBpZiAoc2Vzc2lvbkRhdGFQYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnZlcmlmeShcbiAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgLi4uc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb24sXG4gICAgICAgICAgICBleHBpcmVzQXQ6IHNlc3Npb25EYXRhUGF5bG9hZC5leHBpcmVzQXRcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBzZXNzaW9uRGF0YVBheWxvYWQuc2lnbmF0dXJlXG4gICAgICAgICk7XG4gICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgIGNvbnN0IGRhdGFDb29raWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lO1xuICAgICAgICAgIGN0eC5zZXRDb29raWUoZGF0YUNvb2tpZSwgXCJcIiwge1xuICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBkb250UmVtZW1iZXJNZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm5hbWUsXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgKTtcbiAgICAgIGlmIChzZXNzaW9uRGF0YVBheWxvYWQ/LnNlc3Npb24gJiYgY3R4LmNvbnRleHQub3B0aW9ucy5zZXNzaW9uPy5jb29raWVDYWNoZT8uZW5hYmxlZCAmJiAhY3R4LnF1ZXJ5Py5kaXNhYmxlQ29va2llQ2FjaGUpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbjIgPSBzZXNzaW9uRGF0YVBheWxvYWQuc2Vzc2lvbjtcbiAgICAgICAgY29uc3QgaGFzRXhwaXJlZCA9IHNlc3Npb25EYXRhUGF5bG9hZC5leHBpcmVzQXQgPCBEYXRlLm5vdygpIHx8IHNlc3Npb24yLnNlc3Npb24uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gICAgICAgIGlmICghaGFzRXhwaXJlZCkge1xuICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uMjtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgICAgICBzZXNzaW9uMlxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgZGF0YUNvb2tpZSA9IGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm5hbWU7XG4gICAgICAgICAgY3R4LnNldENvb2tpZShkYXRhQ29va2llLCBcIlwiLCB7XG4gICAgICAgICAgICBtYXhBZ2U6IDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbihzZXNzaW9uQ29va2llVG9rZW4pO1xuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICBpZiAoIXNlc3Npb24gfHwgc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgaWYgKHNlc3Npb24pIHtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlblxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgfVxuICAgICAgaWYgKGRvbnRSZW1lbWJlck1lIHx8IGN0eC5xdWVyeT8uZGlzYWJsZVJlZnJlc2gpIHtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgIHNlc3Npb25cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4cGlyZXNJbiA9IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZXhwaXJlc0luO1xuICAgICAgY29uc3QgdXBkYXRlQWdlID0gY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy51cGRhdGVBZ2U7XG4gICAgICBjb25zdCBzZXNzaW9uSXNEdWVUb0JlVXBkYXRlZERhdGUgPSBzZXNzaW9uLnNlc3Npb24uZXhwaXJlc0F0LnZhbHVlT2YoKSAtIGV4cGlyZXNJbiAqIDFlMyArIHVwZGF0ZUFnZSAqIDFlMztcbiAgICAgIGNvbnN0IHNob3VsZEJlVXBkYXRlZCA9IHNlc3Npb25Jc0R1ZVRvQmVVcGRhdGVkRGF0ZSA8PSBEYXRlLm5vdygpO1xuICAgICAgaWYgKHNob3VsZEJlVXBkYXRlZCAmJiAoIWN0eC5xdWVyeT8uZGlzYWJsZVJlZnJlc2ggfHwgIWN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uZGlzYWJsZVNlc3Npb25SZWZyZXNoKSkge1xuICAgICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVTZXNzaW9uKFxuICAgICAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICB7XG4gICAgICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUoY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy5leHBpcmVzSW4sIFwic2VjXCIpLFxuICAgICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCF1cGRhdGVkU2Vzc2lvbikge1xuICAgICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtYXhBZ2UgPSAodXBkYXRlZFNlc3Npb24uZXhwaXJlc0F0LnZhbHVlT2YoKSAtIERhdGUubm93KCkpIC8gMWUzO1xuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgICAgIGN0eCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzZXNzaW9uOiB1cGRhdGVkU2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAge1xuICAgICAgICAgICAgbWF4QWdlXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgIHNlc3Npb246IHVwZGF0ZWRTZXNzaW9uLFxuICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHNldENvb2tpZUNhY2hlKGN0eCwgc2Vzc2lvbiwgISFkb250UmVtZW1iZXJNZSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgIHNlc3Npb25cbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfU0VTU0lPTlxuICAgICAgfSk7XG4gICAgfVxuICB9XG4pO1xuY29uc3QgZ2V0U2Vzc2lvbkZyb21DdHggPSBhc3luYyAoY3R4LCBjb25maWcpID0+IHtcbiAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb24pIHtcbiAgICByZXR1cm4gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgfVxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbigpKHtcbiAgICAuLi5jdHgsXG4gICAgYXNSZXNwb25zZTogZmFsc2UsXG4gICAgaGVhZGVyczogY3R4LmhlYWRlcnMsXG4gICAgcmV0dXJuSGVhZGVyczogZmFsc2UsXG4gICAgcXVlcnk6IHtcbiAgICAgIC4uLmNvbmZpZyxcbiAgICAgIC4uLmN0eC5xdWVyeVxuICAgIH1cbiAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSk7XG4gIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uO1xuICByZXR1cm4gc2Vzc2lvbjtcbn07XG5jb25zdCBzZXNzaW9uTWlkZGxld2FyZSA9IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gIGlmICghc2Vzc2lvbj8uc2Vzc2lvbikge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHNlc3Npb25cbiAgfTtcbn0pO1xuY29uc3Qgc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgsIHsgZGlzYWJsZUNvb2tpZUNhY2hlOiB0cnVlIH0pO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uXG4gIH07XG59KTtcbmNvbnN0IHJlcXVlc3RPbmx5U2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbj8uc2Vzc2lvbiAmJiAoY3R4LnJlcXVlc3QgfHwgY3R4LmhlYWRlcnMpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIHJldHVybiB7IHNlc3Npb24gfTtcbiAgfVxuKTtcbmNvbnN0IGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZnJlc2hBZ2UgPT09IDApIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvblxuICAgIH07XG4gIH1cbiAgY29uc3QgZnJlc2hBZ2UgPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlO1xuICBjb25zdCBsYXN0VXBkYXRlZCA9IHNlc3Npb24uc2Vzc2lvbi51cGRhdGVkQXQ/LnZhbHVlT2YoKSB8fCBzZXNzaW9uLnNlc3Npb24uY3JlYXRlZEF0LnZhbHVlT2YoKTtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgaXNGcmVzaCA9IG5vdyAtIGxhc3RVcGRhdGVkIDwgZnJlc2hBZ2UgKiAxZTM7XG4gIGlmICghaXNGcmVzaCkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlNlc3Npb24gaXMgbm90IGZyZXNoXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHNlc3Npb25cbiAgfTtcbn0pO1xuY29uc3QgbGlzdFNlc3Npb25zID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saXN0LXNlc3Npb25zXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3QgYWxsIGFjdGl2ZSBzZXNzaW9ucyBmb3IgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlzdFNlc3Npb25zKFxuICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICAgICk7XG4gICAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcigoc2Vzc2lvbikgPT4ge1xuICAgICAgICByZXR1cm4gc2Vzc2lvbi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICBhY3RpdmVTZXNzaW9uc1xuICAgICAgKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoZSk7XG4gICAgICB0aHJvdyBjdHguZXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIik7XG4gICAgfVxuICB9XG4pO1xuY29uc3QgcmV2b2tlU2Vzc2lvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLXNlc3Npb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byByZXZva2VcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtzZW5zaXRpdmVTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGEgc2luZ2xlIHNlc3Npb25cIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byByZXZva2VcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInRva2VuXCJdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgc2Vzc2lvbiB3YXMgcmV2b2tlZCBzdWNjZXNzZnVsbHlcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN0YXR1c1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHRva2VuID0gY3R4LmJvZHkudG9rZW47XG4gICAgY29uc3QgZmluZFNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24odG9rZW4pO1xuICAgIGlmICghZmluZFNlc3Npb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJTZXNzaW9uIG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGZpbmRTZXNzaW9uLnNlc3Npb24udXNlcklkICE9PSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHRva2VuKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZXJyb3IgPyBlcnJvci5uYW1lIDogXCJcIixcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIik7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHJldm9rZVNlc3Npb25zID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXZva2Utc2Vzc2lvbnNcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhbGwgc2Vzc2lvbnMgZm9yIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiBhbGwgc2Vzc2lvbnMgd2VyZSByZXZva2VkIHN1Y2Nlc3NmdWxseVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGVycm9yICYmIHR5cGVvZiBlcnJvciA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlcnJvciA/IGVycm9yLm5hbWUgOiBcIlwiLFxuICAgICAgICBlcnJvclxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgcmV2b2tlT3RoZXJTZXNzaW9ucyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLW90aGVyLXNlc3Npb25zXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIHVzZTogW3NlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYWxsIG90aGVyIHNlc3Npb25zIGZvciB0aGUgdXNlciBleGNlcHQgdGhlIGN1cnJlbnQgb25lXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiBhbGwgb3RoZXIgc2Vzc2lvbnMgd2VyZSByZXZva2VkIHN1Y2Nlc3NmdWxseVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgaWYgKCFzZXNzaW9uLnVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlzdFNlc3Npb25zKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcigoc2Vzc2lvbjIpID0+IHtcbiAgICAgIHJldHVybiBzZXNzaW9uMi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICB9KTtcbiAgICBjb25zdCBvdGhlclNlc3Npb25zID0gYWN0aXZlU2Vzc2lvbnMuZmlsdGVyKFxuICAgICAgKHNlc3Npb24yKSA9PiBzZXNzaW9uMi50b2tlbiAhPT0gY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuXG4gICAgKTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIG90aGVyU2Vzc2lvbnMubWFwKFxuICAgICAgICAoc2Vzc2lvbjIpID0+IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHNlc3Npb24yLnRva2VuKVxuICAgICAgKVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG5leHBvcnQgeyBnZXRTZXNzaW9uIGFzIGEsIHJldm9rZVNlc3Npb25zIGFzIGIsIHJldm9rZVNlc3Npb24gYXMgYywgZ2V0U2Vzc2lvblF1ZXJ5U2NoZW1hIGFzIGQsIHNlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlIGFzIGUsIGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUgYXMgZiwgZ2V0U2Vzc2lvbkZyb21DdHggYXMgZywgcmVxdWVzdE9ubHlTZXNzaW9uTWlkZGxld2FyZSBhcyBoLCBsaXN0U2Vzc2lvbnMgYXMgbCwgcmV2b2tlT3RoZXJTZXNzaW9ucyBhcyByLCBzZXNzaW9uTWlkZGxld2FyZSBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getBaseURL),\n/* harmony export */   b: () => (/* binding */ getHost),\n/* harmony export */   c: () => (/* binding */ getProtocol),\n/* harmony export */   g: () => (/* binding */ getOrigin)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n\n\n\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    const pathname = parsedUrl.pathname.replace(/\\/+$/, \"\") || \"/\";\n    return pathname !== \"/\";\n  } catch (error) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  const trimmedUrl = url.replace(/\\/+$/, \"\");\n  if (!path || path === \"/\") {\n    return trimmedUrl;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${trimmedUrl}${path}`;\n}\nfunction getBaseURL(url, path, request, loadEnv) {\n  if (url) {\n    return withPath(url, path);\n  }\n  if (loadEnv !== false) {\n    const fromEnv = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n    if (fromEnv) {\n      return withPath(fromEnv, path);\n    }\n  }\n  const fromRequest = request?.headers.get(\"x-forwarded-host\");\n  const fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n  if (fromRequest && fromRequestProto) {\n    return withPath(`${fromRequestProto}://${fromRequest}`, path);\n  }\n  if (request) {\n    const url2 = getOrigin(request.url);\n    if (!url2) {\n      throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n        \"Could not get origin from request. Please provide a valid base URL.\"\n      );\n    }\n    return withPath(url2, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  } catch (error) {\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUE0QztBQUNjOztBQUUxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGNBQWMsb0VBQWU7QUFDN0IsMkJBQTJCLElBQUk7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLEtBQUs7QUFDaEQsWUFBWSxXQUFXLEVBQUUsS0FBSztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQUcsb0JBQW9CLHNEQUFHLGdDQUFnQyxzREFBRywyQkFBMkIsc0RBQUcsZ0NBQWdDLHNEQUFHLDBCQUEwQixzREFBRyxvQkFBb0Isc0RBQUc7QUFDdE07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUJBQWlCLEtBQUssWUFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvRUFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFMkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanM/YzcwNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlbnYgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuXG5mdW5jdGlvbiBjaGVja0hhc1BhdGgodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIGNvbnN0IHBhdGhuYW1lID0gcGFyc2VkVXJsLnBhdGhuYW1lLnJlcGxhY2UoL1xcLyskLywgXCJcIikgfHwgXCIvXCI7XG4gICAgcmV0dXJuIHBhdGhuYW1lICE9PSBcIi9cIjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgYEludmFsaWQgYmFzZSBVUkw6ICR7dXJsfS4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBiYXNlIFVSTC5gXG4gICAgKTtcbiAgfVxufVxuZnVuY3Rpb24gd2l0aFBhdGgodXJsLCBwYXRoID0gXCIvYXBpL2F1dGhcIikge1xuICBjb25zdCBoYXNQYXRoID0gY2hlY2tIYXNQYXRoKHVybCk7XG4gIGlmIChoYXNQYXRoKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICBjb25zdCB0cmltbWVkVXJsID0gdXJsLnJlcGxhY2UoL1xcLyskLywgXCJcIik7XG4gIGlmICghcGF0aCB8fCBwYXRoID09PSBcIi9cIikge1xuICAgIHJldHVybiB0cmltbWVkVXJsO1xuICB9XG4gIHBhdGggPSBwYXRoLnN0YXJ0c1dpdGgoXCIvXCIpID8gcGF0aCA6IGAvJHtwYXRofWA7XG4gIHJldHVybiBgJHt0cmltbWVkVXJsfSR7cGF0aH1gO1xufVxuZnVuY3Rpb24gZ2V0QmFzZVVSTCh1cmwsIHBhdGgsIHJlcXVlc3QsIGxvYWRFbnYpIHtcbiAgaWYgKHVybCkge1xuICAgIHJldHVybiB3aXRoUGF0aCh1cmwsIHBhdGgpO1xuICB9XG4gIGlmIChsb2FkRW52ICE9PSBmYWxzZSkge1xuICAgIGNvbnN0IGZyb21FbnYgPSBlbnYuQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5ORVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52LlBVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0JFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTlVYVF9QVUJMSUNfQVVUSF9VUkwgfHwgKGVudi5CQVNFX1VSTCAhPT0gXCIvXCIgPyBlbnYuQkFTRV9VUkwgOiB2b2lkIDApO1xuICAgIGlmIChmcm9tRW52KSB7XG4gICAgICByZXR1cm4gd2l0aFBhdGgoZnJvbUVudiwgcGF0aCk7XG4gICAgfVxuICB9XG4gIGNvbnN0IGZyb21SZXF1ZXN0ID0gcmVxdWVzdD8uaGVhZGVycy5nZXQoXCJ4LWZvcndhcmRlZC1ob3N0XCIpO1xuICBjb25zdCBmcm9tUmVxdWVzdFByb3RvID0gcmVxdWVzdD8uaGVhZGVycy5nZXQoXCJ4LWZvcndhcmRlZC1wcm90b1wiKTtcbiAgaWYgKGZyb21SZXF1ZXN0ICYmIGZyb21SZXF1ZXN0UHJvdG8pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgoYCR7ZnJvbVJlcXVlc3RQcm90b306Ly8ke2Zyb21SZXF1ZXN0fWAsIHBhdGgpO1xuICB9XG4gIGlmIChyZXF1ZXN0KSB7XG4gICAgY29uc3QgdXJsMiA9IGdldE9yaWdpbihyZXF1ZXN0LnVybCk7XG4gICAgaWYgKCF1cmwyKSB7XG4gICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICBcIkNvdWxkIG5vdCBnZXQgb3JpZ2luIGZyb20gcmVxdWVzdC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBiYXNlIFVSTC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHdpdGhQYXRoKHVybDIsIHBhdGgpO1xuICB9XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbikge1xuICAgIHJldHVybiB3aXRoUGF0aCh3aW5kb3cubG9jYXRpb24ub3JpZ2luLCBwYXRoKTtcbiAgfVxuICByZXR1cm4gdm9pZCAwO1xufVxuZnVuY3Rpb24gZ2V0T3JpZ2luKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLm9yaWdpbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0UHJvdG9jb2wodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwucHJvdG9jb2w7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldEhvc3QodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwuaG9zdDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgeyBnZXRCYXNlVVJMIGFzIGEsIGdldEhvc3QgYXMgYiwgZ2V0UHJvdG9jb2wgYXMgYywgZ2V0T3JpZ2luIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createAdapterFactory)\n/* harmony export */ });\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction withApplyDefault(value, field, action) {\n  if (action === \"update\") {\n    if (value === void 0 && field.onUpdate !== void 0) {\n      if (typeof field.onUpdate === \"function\") {\n        return field.onUpdate();\n      }\n      return field.onUpdate;\n    }\n    return value;\n  }\n  if (value === void 0 || value === null) {\n    if (field.defaultValue !== void 0) {\n      if (typeof field.defaultValue === \"function\") {\n        return field.defaultValue();\n      }\n      return field.defaultValue;\n    }\n  }\n  return value;\n}\n\nlet debugLogs = [];\nlet transactionId = -1;\nconst createAsIsTransaction = (adapter) => (fn) => fn(adapter);\nconst createAdapterFactory = ({\n  adapter: customAdapter,\n  config: cfg\n}) => (options) => {\n  const uniqueAdapterFactoryInstanceId = Math.random().toString(36).substring(2, 15);\n  const config = {\n    ...cfg,\n    supportsBooleans: cfg.supportsBooleans ?? true,\n    supportsDates: cfg.supportsDates ?? true,\n    supportsJSON: cfg.supportsJSON ?? false,\n    adapterName: cfg.adapterName ?? cfg.adapterId,\n    supportsNumericIds: cfg.supportsNumericIds ?? true,\n    transaction: cfg.transaction ?? false,\n    disableTransformInput: cfg.disableTransformInput ?? false,\n    disableTransformOutput: cfg.disableTransformOutput ?? false\n  };\n  if (options.advanced?.database?.useNumberId === true && config.supportsNumericIds === false) {\n    throw new Error(\n      `[${config.adapterName}] Your database or database adapter does not support numeric ids. Please disable \"useNumberId\" in your config.`\n    );\n  }\n  const schema = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options);\n  const getDefaultFieldName = ({\n    field,\n    model: unsafe_model\n  }) => {\n    if (field === \"id\" || field === \"_id\") {\n      return \"id\";\n    }\n    const model = getDefaultModelName(unsafe_model);\n    let f = schema[model]?.fields[field];\n    if (!f) {\n      const result = Object.entries(schema[model].fields).find(\n        ([_, f2]) => f2.fieldName === field\n      );\n      if (result) {\n        f = result[1];\n        field = result[0];\n      }\n    }\n    if (!f) {\n      debugLog(`Field ${field} not found in model ${model}`);\n      debugLog(`Schema:`, schema);\n      throw new Error(`Field ${field} not found in model ${model}`);\n    }\n    return field;\n  };\n  const getDefaultModelName = (model) => {\n    if (config.usePlural && model.charAt(model.length - 1) === \"s\") {\n      let pluralessModel = model.slice(0, -1);\n      let m2 = schema[pluralessModel] ? pluralessModel : void 0;\n      if (!m2) {\n        m2 = Object.entries(schema).find(\n          ([_, f]) => f.modelName === pluralessModel\n        )?.[0];\n      }\n      if (m2) {\n        return m2;\n      }\n    }\n    let m = schema[model] ? model : void 0;\n    if (!m) {\n      m = Object.entries(schema).find(([_, f]) => f.modelName === model)?.[0];\n    }\n    if (!m) {\n      debugLog(`Model \"${model}\" not found in schema`);\n      debugLog(`Schema:`, schema);\n      throw new Error(`Model \"${model}\" not found in schema`);\n    }\n    return m;\n  };\n  const getModelName = (model) => {\n    const defaultModelKey = getDefaultModelName(model);\n    const usePlural = config && config.usePlural;\n    const useCustomModelName = schema && schema[defaultModelKey] && schema[defaultModelKey].modelName !== model;\n    if (useCustomModelName) {\n      return usePlural ? `${schema[defaultModelKey].modelName}s` : schema[defaultModelKey].modelName;\n    }\n    return usePlural ? `${model}s` : model;\n  };\n  function getFieldName({\n    model: model_name,\n    field: field_name\n  }) {\n    const model = getDefaultModelName(model_name);\n    const field = getDefaultFieldName({ model, field: field_name });\n    return schema[model]?.fields[field]?.fieldName || field;\n  }\n  const debugLog = (...args) => {\n    if (config.debugLogs === true || typeof config.debugLogs === \"object\") {\n      if (typeof config.debugLogs === \"object\" && \"isRunningAdapterTests\" in config.debugLogs) {\n        if (config.debugLogs.isRunningAdapterTests) {\n          args.shift();\n          debugLogs.push({ instance: uniqueAdapterFactoryInstanceId, args });\n        }\n        return;\n      }\n      if (typeof config.debugLogs === \"object\" && config.debugLogs.logCondition && !config.debugLogs.logCondition?.()) {\n        return;\n      }\n      if (typeof args[0] === \"object\" && \"method\" in args[0]) {\n        const method = args.shift().method;\n        if (typeof config.debugLogs === \"object\") {\n          if (method === \"create\" && !config.debugLogs.create) {\n            return;\n          } else if (method === \"update\" && !config.debugLogs.update) {\n            return;\n          } else if (method === \"updateMany\" && !config.debugLogs.updateMany) {\n            return;\n          } else if (method === \"findOne\" && !config.debugLogs.findOne) {\n            return;\n          } else if (method === \"findMany\" && !config.debugLogs.findMany) {\n            return;\n          } else if (method === \"delete\" && !config.debugLogs.delete) {\n            return;\n          } else if (method === \"deleteMany\" && !config.debugLogs.deleteMany) {\n            return;\n          } else if (method === \"count\" && !config.debugLogs.count) {\n            return;\n          }\n        }\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.info(`[${config.adapterName}]`, ...args);\n      } else {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.info(`[${config.adapterName}]`, ...args);\n      }\n    }\n  };\n  const idField = ({\n    customModelName,\n    forceAllowId\n  }) => {\n    const shouldGenerateId = !config.disableIdGeneration && !options.advanced?.database?.useNumberId && !forceAllowId;\n    const model = getDefaultModelName(customModelName ?? \"id\");\n    return {\n      type: options.advanced?.database?.useNumberId ? \"number\" : \"string\",\n      required: shouldGenerateId ? true : false,\n      ...shouldGenerateId ? {\n        defaultValue() {\n          if (config.disableIdGeneration) return void 0;\n          const useNumberId = options.advanced?.database?.useNumberId;\n          let generateId$1 = options.advanced?.database?.generateId;\n          if (options.advanced?.generateId !== void 0) {\n            _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.warn(\n              \"Your Better Auth config includes advanced.generateId which is deprecated. Please use advanced.database.generateId instead. This will be removed in future releases.\"\n            );\n            generateId$1 = options.advanced?.generateId;\n          }\n          if (generateId$1 === false || useNumberId) return void 0;\n          if (generateId$1) {\n            return generateId$1({\n              model\n            });\n          }\n          if (config.customIdGenerator) {\n            return config.customIdGenerator({ model });\n          }\n          return (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_2__.g)();\n        }\n      } : {}\n    };\n  };\n  const getFieldAttributes = ({\n    model,\n    field\n  }) => {\n    const defaultModelName = getDefaultModelName(model);\n    const defaultFieldName = getDefaultFieldName({\n      field,\n      model: defaultModelName\n    });\n    const fields = schema[defaultModelName].fields;\n    fields.id = idField({ customModelName: defaultModelName });\n    return fields[defaultFieldName];\n  };\n  const transformInput = async (data, defaultModelName, action, forceAllowId) => {\n    const transformedData = {};\n    const fields = schema[defaultModelName].fields;\n    const newMappedKeys = config.mapKeysTransformInput ?? {};\n    if (!config.disableIdGeneration && !options.advanced?.database?.useNumberId) {\n      fields.id = idField({\n        customModelName: defaultModelName,\n        forceAllowId: forceAllowId && \"id\" in data\n      });\n    }\n    for (const field in fields) {\n      const value = data[field];\n      const fieldAttributes = fields[field];\n      let newFieldName = newMappedKeys[field] || fields[field].fieldName || field;\n      if (value === void 0 && (fieldAttributes.defaultValue === void 0 && !fieldAttributes.transform?.input && !(action === \"update\" && fieldAttributes.onUpdate) || action === \"update\" && !fieldAttributes.onUpdate)) {\n        continue;\n      }\n      let newValue = withApplyDefault(value, fieldAttributes, action);\n      if (fieldAttributes.transform?.input) {\n        newValue = await fieldAttributes.transform.input(newValue);\n      }\n      if (fieldAttributes.references?.field === \"id\" && options.advanced?.database?.useNumberId) {\n        if (Array.isArray(newValue)) {\n          newValue = newValue.map((x) => x !== null ? Number(x) : null);\n        } else {\n          newValue = newValue !== null ? Number(newValue) : null;\n        }\n      } else if (config.supportsJSON === false && typeof newValue === \"object\" && fieldAttributes.type === \"json\") {\n        newValue = JSON.stringify(newValue);\n      } else if (config.supportsDates === false && newValue instanceof Date && fieldAttributes.type === \"date\") {\n        newValue = newValue.toISOString();\n      } else if (config.supportsBooleans === false && typeof newValue === \"boolean\") {\n        newValue = newValue ? 1 : 0;\n      }\n      if (config.customTransformInput) {\n        newValue = config.customTransformInput({\n          data: newValue,\n          action,\n          field: newFieldName,\n          fieldAttributes,\n          model: defaultModelName,\n          schema,\n          options\n        });\n      }\n      if (newValue !== void 0) {\n        transformedData[newFieldName] = newValue;\n      }\n    }\n    return transformedData;\n  };\n  const transformOutput = async (data, unsafe_model, select = []) => {\n    if (!data) return null;\n    const newMappedKeys = config.mapKeysTransformOutput ?? {};\n    const transformedData = {};\n    const tableSchema = schema[unsafe_model].fields;\n    const idKey = Object.entries(newMappedKeys).find(\n      ([_, v]) => v === \"id\"\n    )?.[0];\n    tableSchema[idKey ?? \"id\"] = {\n      type: options.advanced?.database?.useNumberId ? \"number\" : \"string\"\n    };\n    for (const key in tableSchema) {\n      if (select.length && !select.includes(key)) {\n        continue;\n      }\n      const field = tableSchema[key];\n      if (field) {\n        const originalKey = field.fieldName || key;\n        let newValue = data[Object.entries(newMappedKeys).find(\n          ([_, v]) => v === originalKey\n        )?.[0] || originalKey];\n        if (field.transform?.output) {\n          newValue = await field.transform.output(newValue);\n        }\n        let newFieldName = newMappedKeys[key] || key;\n        if (originalKey === \"id\" || field.references?.field === \"id\") {\n          if (typeof newValue !== \"undefined\" && newValue !== null)\n            newValue = String(newValue);\n        } else if (config.supportsJSON === false && typeof newValue === \"string\" && field.type === \"json\") {\n          newValue = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(newValue);\n        } else if (config.supportsDates === false && typeof newValue === \"string\" && field.type === \"date\") {\n          newValue = new Date(newValue);\n        } else if (config.supportsBooleans === false && typeof newValue === \"number\" && field.type === \"boolean\") {\n          newValue = newValue === 1;\n        }\n        if (config.customTransformOutput) {\n          newValue = config.customTransformOutput({\n            data: newValue,\n            field: newFieldName,\n            fieldAttributes: field,\n            select,\n            model: unsafe_model,\n            schema,\n            options\n          });\n        }\n        transformedData[newFieldName] = newValue;\n      }\n    }\n    return transformedData;\n  };\n  const transformWhereClause = ({\n    model,\n    where\n  }) => {\n    if (!where) return void 0;\n    const newMappedKeys = config.mapKeysTransformInput ?? {};\n    return where.map((w) => {\n      const {\n        field: unsafe_field,\n        value,\n        operator = \"eq\",\n        connector = \"AND\"\n      } = w;\n      if (operator === \"in\") {\n        if (!Array.isArray(value)) {\n          throw new Error(\"Value must be an array\");\n        }\n      }\n      const defaultModelName = getDefaultModelName(model);\n      const defaultFieldName = getDefaultFieldName({\n        field: unsafe_field,\n        model\n      });\n      const fieldName = newMappedKeys[defaultFieldName] || getFieldName({\n        field: defaultFieldName,\n        model: defaultModelName\n      });\n      const fieldAttr = getFieldAttributes({\n        field: defaultFieldName,\n        model: defaultModelName\n      });\n      if (defaultFieldName === \"id\" || fieldAttr.references?.field === \"id\") {\n        if (options.advanced?.database?.useNumberId) {\n          if (Array.isArray(value)) {\n            return {\n              operator,\n              connector,\n              field: fieldName,\n              value: value.map(Number)\n            };\n          }\n          return {\n            operator,\n            connector,\n            field: fieldName,\n            value: Number(value)\n          };\n        }\n      }\n      return {\n        operator,\n        connector,\n        field: fieldName,\n        value\n      };\n    });\n  };\n  const adapterInstance = customAdapter({\n    options,\n    schema,\n    debugLog,\n    getFieldName,\n    getModelName,\n    getDefaultModelName,\n    getDefaultFieldName,\n    getFieldAttributes,\n    transformInput,\n    transformOutput,\n    transformWhereClause\n  });\n  let lazyLoadTransaction = null;\n  const adapter = {\n    transaction: async (cb) => {\n      if (!lazyLoadTransaction) {\n        if (!config.transaction) {\n          if (typeof config.debugLogs === \"object\" && \"isRunningAdapterTests\" in config.debugLogs && config.debugLogs.isRunningAdapterTests) ; else {\n            _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.warn(\n              `[${config.adapterName}] - Transactions are not supported. Executing operations sequentially.`\n            );\n          }\n          lazyLoadTransaction = createAsIsTransaction(adapter);\n        } else {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.debug(\n            `[${config.adapterName}] - Using provided transaction implementation.`\n          );\n          lazyLoadTransaction = config.transaction;\n        }\n      }\n      return lazyLoadTransaction(cb);\n    },\n    create: async ({\n      data: unsafeData,\n      model: unsafeModel,\n      select,\n      forceAllowId = false\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      unsafeModel = getDefaultModelName(unsafeModel);\n      if (\"id\" in unsafeData && !forceAllowId) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.warn(\n          `[${config.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \\`forceAllowId\\` parameter. The id will be ignored.`\n        );\n        const err = new Error();\n        const stack = err.stack?.split(\"\\n\").filter((_, i) => i !== 1).join(\"\\n\").replace(\"Error:\", \"Create method with `id` being called at:\");\n        console.log(stack);\n        unsafeData.id = void 0;\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      let data = unsafeData;\n      if (!config.disableTransformInput) {\n        data = await transformInput(\n          unsafeData,\n          unsafeModel,\n          \"create\",\n          forceAllowId\n        );\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const res = await adapterInstance.create({ data, model });\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"DB Result\")}:`,\n        { model, res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await transformOutput(res, unsafeModel, select);\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    update: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      update: unsafeData\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      unsafeModel = getDefaultModelName(unsafeModel);\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      let data = unsafeData;\n      if (!config.disableTransformInput) {\n        data = await transformInput(unsafeData, unsafeModel, \"update\");\n      }\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const res = await adapterInstance.update({\n        model,\n        where,\n        update: data\n      });\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await transformOutput(res, unsafeModel);\n      }\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    updateMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      update: unsafeData\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      let data = unsafeData;\n      if (!config.disableTransformInput) {\n        data = await transformInput(unsafeData, unsafeModel, \"update\");\n      }\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const updatedCount = await adapterInstance.updateMany({\n        model,\n        where,\n        update: data\n      });\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: updatedCount }\n      );\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: updatedCount }\n      );\n      return updatedCount;\n    },\n    findOne: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      select\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`,\n        `${formatMethod(\"findOne\")}:`,\n        { model, where, select }\n      );\n      const res = await adapterInstance.findOne({\n        model,\n        where,\n        select\n      });\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`,\n        `${formatMethod(\"findOne\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await transformOutput(res, unsafeModel, select);\n      }\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`,\n        `${formatMethod(\"findOne\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    findMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      limit: unsafeLimit,\n      sortBy,\n      offset\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const limit = unsafeLimit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`,\n        `${formatMethod(\"findMany\")}:`,\n        { model, where, limit, sortBy, offset }\n      );\n      const res = await adapterInstance.findMany({\n        model,\n        where,\n        limit,\n        sortBy,\n        offset\n      });\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`,\n        `${formatMethod(\"findMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await Promise.all(\n          res.map(async (r) => await transformOutput(r, unsafeModel))\n        );\n      }\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`,\n        `${formatMethod(\"findMany\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    delete: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"delete\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"delete\")}:`,\n        { model, where }\n      );\n      await adapterInstance.delete({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"delete\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"delete\")} ${formatAction(\"DB Result\")}:`,\n        { model }\n      );\n    },\n    deleteMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"deleteMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"deleteMany\")} ${formatAction(\"DeleteMany\")}:`,\n        { model, where }\n      );\n      const res = await adapterInstance.deleteMany({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"deleteMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"deleteMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      return res;\n    },\n    count: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"count\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"count\")}:`,\n        {\n          model,\n          where\n        }\n      );\n      const res = await adapterInstance.count({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"count\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"count\")}:`,\n        {\n          model,\n          data: res\n        }\n      );\n      return res;\n    },\n    createSchema: adapterInstance.createSchema ? async (_, file) => {\n      const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options);\n      if (options.secondaryStorage && !options.session?.storeSessionInDatabase) {\n        delete tables.session;\n      }\n      if (options.rateLimit && options.rateLimit.storage === \"database\" && // rate-limit will default to enabled in production,\n      // and given storage is database, it will try to use the rate-limit table,\n      // so we should make sure to generate rate-limit table schema\n      (typeof options.rateLimit.enabled === \"undefined\" || // and of course if they forcefully set to true, then they want rate-limit,\n      // thus we should also generate rate-limit table schema\n      options.rateLimit.enabled === true)) {\n        tables.ratelimit = {\n          modelName: options.rateLimit.modelName ?? \"ratelimit\",\n          fields: {\n            key: {\n              type: \"string\",\n              unique: true,\n              required: true,\n              fieldName: options.rateLimit.fields?.key ?? \"key\"\n            },\n            count: {\n              type: \"number\",\n              required: true,\n              fieldName: options.rateLimit.fields?.count ?? \"count\"\n            },\n            lastRequest: {\n              type: \"number\",\n              required: true,\n              bigint: true,\n              defaultValue: () => Date.now(),\n              fieldName: options.rateLimit.fields?.lastRequest ?? \"lastRequest\"\n            }\n          }\n        };\n      }\n      return adapterInstance.createSchema({ file, tables });\n    } : void 0,\n    options: {\n      adapterConfig: config,\n      ...adapterInstance.options ?? {}\n    },\n    id: config.adapterId,\n    // Secretly export values ONLY if this adapter has enabled adapter-test-debug-logs.\n    // This would then be used during our adapter-tests to help print debug logs if a test fails.\n    //@ts-expect-error - ^^\n    ...config.debugLogs?.isRunningAdapterTests ? {\n      adapterTestDebugLogs: {\n        resetDebugLogs() {\n          debugLogs = debugLogs.filter(\n            (log) => log.instance !== uniqueAdapterFactoryInstanceId\n          );\n        },\n        printDebugLogs() {\n          const separator = `\\u2500`.repeat(80);\n          const logs = debugLogs.filter(\n            (log2) => log2.instance === uniqueAdapterFactoryInstanceId\n          );\n          if (logs.length === 0) {\n            return;\n          }\n          let log = logs.reverse().map((log2) => {\n            log2.args[0] = `\n${log2.args[0]}`;\n            return [...log2.args, \"\\n\"];\n          }).reduce(\n            (prev, curr) => {\n              return [...curr, ...prev];\n            },\n            [`\n${separator}`]\n          );\n          console.log(...log);\n        }\n      }\n    } : {}\n  };\n  return adapter;\n};\nfunction formatTransactionId(transactionId2) {\n  if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.getColorDepth)() < 8) {\n    return `#${transactionId2}`;\n  }\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.fg.magenta}#${transactionId2}${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\nfunction formatStep(step, total) {\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.bg.black}${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.fg.yellow}[${step}/${total}]${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\nfunction formatMethod(method) {\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.bright}${method}${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\nfunction formatAction(action) {\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.dim}(${action})${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQWdFO0FBQ0E7QUFDSDtBQUNoRDtBQUNRO0FBQ1k7QUFDQztBQUNEO0FBQ0U7QUFDckI7QUFDbUI7QUFDRDtBQUNBO0FBQ0M7QUFDRztBQUNzQzs7QUFFMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQSxpQkFBaUIsNERBQWE7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixPQUFPLHFCQUFxQixNQUFNO0FBQzFEO0FBQ0EsK0JBQStCLE9BQU8scUJBQXFCLE1BQU07QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLE1BQU07QUFDL0I7QUFDQSxnQ0FBZ0MsTUFBTTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGtDQUFrQztBQUM5RDtBQUNBLDBCQUEwQixNQUFNO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esd0NB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxjQUFjO0FBQzFELE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLGFBQWE7QUFDZjtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsRUFBRSxVQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLG9FQUFhO0FBQ25CLGVBQWUsZUFBZTtBQUM5QjtBQUNBLFlBQVksNkRBQVUsWUFBWSxHQUFHLGVBQWUsRUFBRSw2REFBVSxPQUFPO0FBQ3ZFO0FBQ0E7QUFDQSxZQUFZLDZEQUFVLFVBQVUsRUFBRSw2REFBVSxXQUFXLEdBQUcsS0FBSyxHQUFHLE1BQU0sR0FBRyw2REFBVSxPQUFPO0FBQzVGO0FBQ0E7QUFDQSxZQUFZLDZEQUFVLFFBQVEsRUFBRSxPQUFPLEVBQUUsNkRBQVUsT0FBTztBQUMxRDtBQUNBO0FBQ0EsWUFBWSw2REFBVSxLQUFLLEdBQUcsT0FBTyxHQUFHLDZEQUFVLE9BQU87QUFDekQ7O0FBRXFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzPzUzMGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcyBhcyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CS0V0RXB0MC5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRBdXRoVGFibGVzIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5wUWplUmt6Ti5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICd6b2QnO1xuaW1wb3J0ICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgJy4vYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCB7IGxvZ2dlciwgVFRZX0NPTE9SUywgZ2V0Q29sb3JEZXB0aCB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5cbmZ1bmN0aW9uIHdpdGhBcHBseURlZmF1bHQodmFsdWUsIGZpZWxkLCBhY3Rpb24pIHtcbiAgaWYgKGFjdGlvbiA9PT0gXCJ1cGRhdGVcIikge1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwICYmIGZpZWxkLm9uVXBkYXRlICE9PSB2b2lkIDApIHtcbiAgICAgIGlmICh0eXBlb2YgZmllbGQub25VcGRhdGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gZmllbGQub25VcGRhdGUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmaWVsZC5vblVwZGF0ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGlmICh2YWx1ZSA9PT0gdm9pZCAwIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgaWYgKGZpZWxkLmRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBpZiAodHlwZW9mIGZpZWxkLmRlZmF1bHRWYWx1ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBmaWVsZC5kZWZhdWx0VmFsdWUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmaWVsZC5kZWZhdWx0VmFsdWU7XG4gICAgfVxuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxubGV0IGRlYnVnTG9ncyA9IFtdO1xubGV0IHRyYW5zYWN0aW9uSWQgPSAtMTtcbmNvbnN0IGNyZWF0ZUFzSXNUcmFuc2FjdGlvbiA9IChhZGFwdGVyKSA9PiAoZm4pID0+IGZuKGFkYXB0ZXIpO1xuY29uc3QgY3JlYXRlQWRhcHRlckZhY3RvcnkgPSAoe1xuICBhZGFwdGVyOiBjdXN0b21BZGFwdGVyLFxuICBjb25maWc6IGNmZ1xufSkgPT4gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdW5pcXVlQWRhcHRlckZhY3RvcnlJbnN0YW5jZUlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDE1KTtcbiAgY29uc3QgY29uZmlnID0ge1xuICAgIC4uLmNmZyxcbiAgICBzdXBwb3J0c0Jvb2xlYW5zOiBjZmcuc3VwcG9ydHNCb29sZWFucyA/PyB0cnVlLFxuICAgIHN1cHBvcnRzRGF0ZXM6IGNmZy5zdXBwb3J0c0RhdGVzID8/IHRydWUsXG4gICAgc3VwcG9ydHNKU09OOiBjZmcuc3VwcG9ydHNKU09OID8/IGZhbHNlLFxuICAgIGFkYXB0ZXJOYW1lOiBjZmcuYWRhcHRlck5hbWUgPz8gY2ZnLmFkYXB0ZXJJZCxcbiAgICBzdXBwb3J0c051bWVyaWNJZHM6IGNmZy5zdXBwb3J0c051bWVyaWNJZHMgPz8gdHJ1ZSxcbiAgICB0cmFuc2FjdGlvbjogY2ZnLnRyYW5zYWN0aW9uID8/IGZhbHNlLFxuICAgIGRpc2FibGVUcmFuc2Zvcm1JbnB1dDogY2ZnLmRpc2FibGVUcmFuc2Zvcm1JbnB1dCA/PyBmYWxzZSxcbiAgICBkaXNhYmxlVHJhbnNmb3JtT3V0cHV0OiBjZmcuZGlzYWJsZVRyYW5zZm9ybU91dHB1dCA/PyBmYWxzZVxuICB9O1xuICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID09PSB0cnVlICYmIGNvbmZpZy5zdXBwb3J0c051bWVyaWNJZHMgPT09IGZhbHNlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYFske2NvbmZpZy5hZGFwdGVyTmFtZX1dIFlvdXIgZGF0YWJhc2Ugb3IgZGF0YWJhc2UgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IG51bWVyaWMgaWRzLiBQbGVhc2UgZGlzYWJsZSBcInVzZU51bWJlcklkXCIgaW4geW91ciBjb25maWcuYFxuICAgICk7XG4gIH1cbiAgY29uc3Qgc2NoZW1hID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgY29uc3QgZ2V0RGVmYXVsdEZpZWxkTmFtZSA9ICh7XG4gICAgZmllbGQsXG4gICAgbW9kZWw6IHVuc2FmZV9tb2RlbFxuICB9KSA9PiB7XG4gICAgaWYgKGZpZWxkID09PSBcImlkXCIgfHwgZmllbGQgPT09IFwiX2lkXCIpIHtcbiAgICAgIHJldHVybiBcImlkXCI7XG4gICAgfVxuICAgIGNvbnN0IG1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVfbW9kZWwpO1xuICAgIGxldCBmID0gc2NoZW1hW21vZGVsXT8uZmllbGRzW2ZpZWxkXTtcbiAgICBpZiAoIWYpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE9iamVjdC5lbnRyaWVzKHNjaGVtYVttb2RlbF0uZmllbGRzKS5maW5kKFxuICAgICAgICAoW18sIGYyXSkgPT4gZjIuZmllbGROYW1lID09PSBmaWVsZFxuICAgICAgKTtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgZiA9IHJlc3VsdFsxXTtcbiAgICAgICAgZmllbGQgPSByZXN1bHRbMF07XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghZikge1xuICAgICAgZGVidWdMb2coYEZpZWxkICR7ZmllbGR9IG5vdCBmb3VuZCBpbiBtb2RlbCAke21vZGVsfWApO1xuICAgICAgZGVidWdMb2coYFNjaGVtYTpgLCBzY2hlbWEpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWVsZCAke2ZpZWxkfSBub3QgZm91bmQgaW4gbW9kZWwgJHttb2RlbH1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkO1xuICB9O1xuICBjb25zdCBnZXREZWZhdWx0TW9kZWxOYW1lID0gKG1vZGVsKSA9PiB7XG4gICAgaWYgKGNvbmZpZy51c2VQbHVyYWwgJiYgbW9kZWwuY2hhckF0KG1vZGVsLmxlbmd0aCAtIDEpID09PSBcInNcIikge1xuICAgICAgbGV0IHBsdXJhbGVzc01vZGVsID0gbW9kZWwuc2xpY2UoMCwgLTEpO1xuICAgICAgbGV0IG0yID0gc2NoZW1hW3BsdXJhbGVzc01vZGVsXSA/IHBsdXJhbGVzc01vZGVsIDogdm9pZCAwO1xuICAgICAgaWYgKCFtMikge1xuICAgICAgICBtMiA9IE9iamVjdC5lbnRyaWVzKHNjaGVtYSkuZmluZChcbiAgICAgICAgICAoW18sIGZdKSA9PiBmLm1vZGVsTmFtZSA9PT0gcGx1cmFsZXNzTW9kZWxcbiAgICAgICAgKT8uWzBdO1xuICAgICAgfVxuICAgICAgaWYgKG0yKSB7XG4gICAgICAgIHJldHVybiBtMjtcbiAgICAgIH1cbiAgICB9XG4gICAgbGV0IG0gPSBzY2hlbWFbbW9kZWxdID8gbW9kZWwgOiB2b2lkIDA7XG4gICAgaWYgKCFtKSB7XG4gICAgICBtID0gT2JqZWN0LmVudHJpZXMoc2NoZW1hKS5maW5kKChbXywgZl0pID0+IGYubW9kZWxOYW1lID09PSBtb2RlbCk/LlswXTtcbiAgICB9XG4gICAgaWYgKCFtKSB7XG4gICAgICBkZWJ1Z0xvZyhgTW9kZWwgXCIke21vZGVsfVwiIG5vdCBmb3VuZCBpbiBzY2hlbWFgKTtcbiAgICAgIGRlYnVnTG9nKGBTY2hlbWE6YCwgc2NoZW1hKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTW9kZWwgXCIke21vZGVsfVwiIG5vdCBmb3VuZCBpbiBzY2hlbWFgKTtcbiAgICB9XG4gICAgcmV0dXJuIG07XG4gIH07XG4gIGNvbnN0IGdldE1vZGVsTmFtZSA9IChtb2RlbCkgPT4ge1xuICAgIGNvbnN0IGRlZmF1bHRNb2RlbEtleSA9IGdldERlZmF1bHRNb2RlbE5hbWUobW9kZWwpO1xuICAgIGNvbnN0IHVzZVBsdXJhbCA9IGNvbmZpZyAmJiBjb25maWcudXNlUGx1cmFsO1xuICAgIGNvbnN0IHVzZUN1c3RvbU1vZGVsTmFtZSA9IHNjaGVtYSAmJiBzY2hlbWFbZGVmYXVsdE1vZGVsS2V5XSAmJiBzY2hlbWFbZGVmYXVsdE1vZGVsS2V5XS5tb2RlbE5hbWUgIT09IG1vZGVsO1xuICAgIGlmICh1c2VDdXN0b21Nb2RlbE5hbWUpIHtcbiAgICAgIHJldHVybiB1c2VQbHVyYWwgPyBgJHtzY2hlbWFbZGVmYXVsdE1vZGVsS2V5XS5tb2RlbE5hbWV9c2AgOiBzY2hlbWFbZGVmYXVsdE1vZGVsS2V5XS5tb2RlbE5hbWU7XG4gICAgfVxuICAgIHJldHVybiB1c2VQbHVyYWwgPyBgJHttb2RlbH1zYCA6IG1vZGVsO1xuICB9O1xuICBmdW5jdGlvbiBnZXRGaWVsZE5hbWUoe1xuICAgIG1vZGVsOiBtb2RlbF9uYW1lLFxuICAgIGZpZWxkOiBmaWVsZF9uYW1lXG4gIH0pIHtcbiAgICBjb25zdCBtb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUobW9kZWxfbmFtZSk7XG4gICAgY29uc3QgZmllbGQgPSBnZXREZWZhdWx0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiBmaWVsZF9uYW1lIH0pO1xuICAgIHJldHVybiBzY2hlbWFbbW9kZWxdPy5maWVsZHNbZmllbGRdPy5maWVsZE5hbWUgfHwgZmllbGQ7XG4gIH1cbiAgY29uc3QgZGVidWdMb2cgPSAoLi4uYXJncykgPT4ge1xuICAgIGlmIChjb25maWcuZGVidWdMb2dzID09PSB0cnVlIHx8IHR5cGVvZiBjb25maWcuZGVidWdMb2dzID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBpZiAodHlwZW9mIGNvbmZpZy5kZWJ1Z0xvZ3MgPT09IFwib2JqZWN0XCIgJiYgXCJpc1J1bm5pbmdBZGFwdGVyVGVzdHNcIiBpbiBjb25maWcuZGVidWdMb2dzKSB7XG4gICAgICAgIGlmIChjb25maWcuZGVidWdMb2dzLmlzUnVubmluZ0FkYXB0ZXJUZXN0cykge1xuICAgICAgICAgIGFyZ3Muc2hpZnQoKTtcbiAgICAgICAgICBkZWJ1Z0xvZ3MucHVzaCh7IGluc3RhbmNlOiB1bmlxdWVBZGFwdGVyRmFjdG9yeUluc3RhbmNlSWQsIGFyZ3MgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGVidWdMb2dzID09PSBcIm9iamVjdFwiICYmIGNvbmZpZy5kZWJ1Z0xvZ3MubG9nQ29uZGl0aW9uICYmICFjb25maWcuZGVidWdMb2dzLmxvZ0NvbmRpdGlvbj8uKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSBcIm9iamVjdFwiICYmIFwibWV0aG9kXCIgaW4gYXJnc1swXSkge1xuICAgICAgICBjb25zdCBtZXRob2QgPSBhcmdzLnNoaWZ0KCkubWV0aG9kO1xuICAgICAgICBpZiAodHlwZW9mIGNvbmZpZy5kZWJ1Z0xvZ3MgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBpZiAobWV0aG9kID09PSBcImNyZWF0ZVwiICYmICFjb25maWcuZGVidWdMb2dzLmNyZWF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInVwZGF0ZVwiICYmICFjb25maWcuZGVidWdMb2dzLnVwZGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInVwZGF0ZU1hbnlcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy51cGRhdGVNYW55KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiZmluZE9uZVwiICYmICFjb25maWcuZGVidWdMb2dzLmZpbmRPbmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJmaW5kTWFueVwiICYmICFjb25maWcuZGVidWdMb2dzLmZpbmRNYW55KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiZGVsZXRlXCIgJiYgIWNvbmZpZy5kZWJ1Z0xvZ3MuZGVsZXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiZGVsZXRlTWFueVwiICYmICFjb25maWcuZGVidWdMb2dzLmRlbGV0ZU1hbnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJjb3VudFwiICYmICFjb25maWcuZGVidWdMb2dzLmNvdW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxvZ2dlci5pbmZvKGBbJHtjb25maWcuYWRhcHRlck5hbWV9XWAsIC4uLmFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nZ2VyLmluZm8oYFske2NvbmZpZy5hZGFwdGVyTmFtZX1dYCwgLi4uYXJncyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCBpZEZpZWxkID0gKHtcbiAgICBjdXN0b21Nb2RlbE5hbWUsXG4gICAgZm9yY2VBbGxvd0lkXG4gIH0pID0+IHtcbiAgICBjb25zdCBzaG91bGRHZW5lcmF0ZUlkID0gIWNvbmZpZy5kaXNhYmxlSWRHZW5lcmF0aW9uICYmICFvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgJiYgIWZvcmNlQWxsb3dJZDtcbiAgICBjb25zdCBtb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUoY3VzdG9tTW9kZWxOYW1lID8/IFwiaWRcIik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwibnVtYmVyXCIgOiBcInN0cmluZ1wiLFxuICAgICAgcmVxdWlyZWQ6IHNob3VsZEdlbmVyYXRlSWQgPyB0cnVlIDogZmFsc2UsXG4gICAgICAuLi5zaG91bGRHZW5lcmF0ZUlkID8ge1xuICAgICAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICAgICAgaWYgKGNvbmZpZy5kaXNhYmxlSWRHZW5lcmF0aW9uKSByZXR1cm4gdm9pZCAwO1xuICAgICAgICAgIGNvbnN0IHVzZU51bWJlcklkID0gb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkO1xuICAgICAgICAgIGxldCBnZW5lcmF0ZUlkJDEgPSBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8uZ2VuZXJhdGVJZDtcbiAgICAgICAgICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICAgICAgXCJZb3VyIEJldHRlciBBdXRoIGNvbmZpZyBpbmNsdWRlcyBhZHZhbmNlZC5nZW5lcmF0ZUlkIHdoaWNoIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgYWR2YW5jZWQuZGF0YWJhc2UuZ2VuZXJhdGVJZCBpbnN0ZWFkLiBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiBmdXR1cmUgcmVsZWFzZXMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBnZW5lcmF0ZUlkJDEgPSBvcHRpb25zLmFkdmFuY2VkPy5nZW5lcmF0ZUlkO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZ2VuZXJhdGVJZCQxID09PSBmYWxzZSB8fCB1c2VOdW1iZXJJZCkgcmV0dXJuIHZvaWQgMDtcbiAgICAgICAgICBpZiAoZ2VuZXJhdGVJZCQxKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2VuZXJhdGVJZCQxKHtcbiAgICAgICAgICAgICAgbW9kZWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29uZmlnLmN1c3RvbUlkR2VuZXJhdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnLmN1c3RvbUlkR2VuZXJhdG9yKHsgbW9kZWwgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBnZW5lcmF0ZUlkKCk7XG4gICAgICAgIH1cbiAgICAgIH0gOiB7fVxuICAgIH07XG4gIH07XG4gIGNvbnN0IGdldEZpZWxkQXR0cmlidXRlcyA9ICh7XG4gICAgbW9kZWwsXG4gICAgZmllbGRcbiAgfSkgPT4ge1xuICAgIGNvbnN0IGRlZmF1bHRNb2RlbE5hbWUgPSBnZXREZWZhdWx0TW9kZWxOYW1lKG1vZGVsKTtcbiAgICBjb25zdCBkZWZhdWx0RmllbGROYW1lID0gZ2V0RGVmYXVsdEZpZWxkTmFtZSh7XG4gICAgICBmaWVsZCxcbiAgICAgIG1vZGVsOiBkZWZhdWx0TW9kZWxOYW1lXG4gICAgfSk7XG4gICAgY29uc3QgZmllbGRzID0gc2NoZW1hW2RlZmF1bHRNb2RlbE5hbWVdLmZpZWxkcztcbiAgICBmaWVsZHMuaWQgPSBpZEZpZWxkKHsgY3VzdG9tTW9kZWxOYW1lOiBkZWZhdWx0TW9kZWxOYW1lIH0pO1xuICAgIHJldHVybiBmaWVsZHNbZGVmYXVsdEZpZWxkTmFtZV07XG4gIH07XG4gIGNvbnN0IHRyYW5zZm9ybUlucHV0ID0gYXN5bmMgKGRhdGEsIGRlZmF1bHRNb2RlbE5hbWUsIGFjdGlvbiwgZm9yY2VBbGxvd0lkKSA9PiB7XG4gICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0ge307XG4gICAgY29uc3QgZmllbGRzID0gc2NoZW1hW2RlZmF1bHRNb2RlbE5hbWVdLmZpZWxkcztcbiAgICBjb25zdCBuZXdNYXBwZWRLZXlzID0gY29uZmlnLm1hcEtleXNUcmFuc2Zvcm1JbnB1dCA/PyB7fTtcbiAgICBpZiAoIWNvbmZpZy5kaXNhYmxlSWRHZW5lcmF0aW9uICYmICFvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQpIHtcbiAgICAgIGZpZWxkcy5pZCA9IGlkRmllbGQoe1xuICAgICAgICBjdXN0b21Nb2RlbE5hbWU6IGRlZmF1bHRNb2RlbE5hbWUsXG4gICAgICAgIGZvcmNlQWxsb3dJZDogZm9yY2VBbGxvd0lkICYmIFwiaWRcIiBpbiBkYXRhXG4gICAgICB9KTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtmaWVsZF07XG4gICAgICBjb25zdCBmaWVsZEF0dHJpYnV0ZXMgPSBmaWVsZHNbZmllbGRdO1xuICAgICAgbGV0IG5ld0ZpZWxkTmFtZSA9IG5ld01hcHBlZEtleXNbZmllbGRdIHx8IGZpZWxkc1tmaWVsZF0uZmllbGROYW1lIHx8IGZpZWxkO1xuICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgJiYgKGZpZWxkQXR0cmlidXRlcy5kZWZhdWx0VmFsdWUgPT09IHZvaWQgMCAmJiAhZmllbGRBdHRyaWJ1dGVzLnRyYW5zZm9ybT8uaW5wdXQgJiYgIShhY3Rpb24gPT09IFwidXBkYXRlXCIgJiYgZmllbGRBdHRyaWJ1dGVzLm9uVXBkYXRlKSB8fCBhY3Rpb24gPT09IFwidXBkYXRlXCIgJiYgIWZpZWxkQXR0cmlidXRlcy5vblVwZGF0ZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBsZXQgbmV3VmFsdWUgPSB3aXRoQXBwbHlEZWZhdWx0KHZhbHVlLCBmaWVsZEF0dHJpYnV0ZXMsIGFjdGlvbik7XG4gICAgICBpZiAoZmllbGRBdHRyaWJ1dGVzLnRyYW5zZm9ybT8uaW5wdXQpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBhd2FpdCBmaWVsZEF0dHJpYnV0ZXMudHJhbnNmb3JtLmlucHV0KG5ld1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWVsZEF0dHJpYnV0ZXMucmVmZXJlbmNlcz8uZmllbGQgPT09IFwiaWRcIiAmJiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobmV3VmFsdWUpKSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZS5tYXAoKHgpID0+IHggIT09IG51bGwgPyBOdW1iZXIoeCkgOiBudWxsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlICE9PSBudWxsID8gTnVtYmVyKG5ld1ZhbHVlKSA6IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzSlNPTiA9PT0gZmFsc2UgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcIm9iamVjdFwiICYmIGZpZWxkQXR0cmlidXRlcy50eXBlID09PSBcImpzb25cIikge1xuICAgICAgICBuZXdWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzRGF0ZXMgPT09IGZhbHNlICYmIG5ld1ZhbHVlIGluc3RhbmNlb2YgRGF0ZSAmJiBmaWVsZEF0dHJpYnV0ZXMudHlwZSA9PT0gXCJkYXRlXCIpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZS50b0lTT1N0cmluZygpO1xuICAgICAgfSBlbHNlIGlmIChjb25maWcuc3VwcG9ydHNCb29sZWFucyA9PT0gZmFsc2UgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlID8gMSA6IDA7XG4gICAgICB9XG4gICAgICBpZiAoY29uZmlnLmN1c3RvbVRyYW5zZm9ybUlucHV0KSB7XG4gICAgICAgIG5ld1ZhbHVlID0gY29uZmlnLmN1c3RvbVRyYW5zZm9ybUlucHV0KHtcbiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZSxcbiAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgZmllbGQ6IG5ld0ZpZWxkTmFtZSxcbiAgICAgICAgICBmaWVsZEF0dHJpYnV0ZXMsXG4gICAgICAgICAgbW9kZWw6IGRlZmF1bHRNb2RlbE5hbWUsXG4gICAgICAgICAgc2NoZW1hLFxuICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAobmV3VmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICB0cmFuc2Zvcm1lZERhdGFbbmV3RmllbGROYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJhbnNmb3JtZWREYXRhO1xuICB9O1xuICBjb25zdCB0cmFuc2Zvcm1PdXRwdXQgPSBhc3luYyAoZGF0YSwgdW5zYWZlX21vZGVsLCBzZWxlY3QgPSBbXSkgPT4ge1xuICAgIGlmICghZGF0YSkgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgbmV3TWFwcGVkS2V5cyA9IGNvbmZpZy5tYXBLZXlzVHJhbnNmb3JtT3V0cHV0ID8/IHt9O1xuICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IHt9O1xuICAgIGNvbnN0IHRhYmxlU2NoZW1hID0gc2NoZW1hW3Vuc2FmZV9tb2RlbF0uZmllbGRzO1xuICAgIGNvbnN0IGlkS2V5ID0gT2JqZWN0LmVudHJpZXMobmV3TWFwcGVkS2V5cykuZmluZChcbiAgICAgIChbXywgdl0pID0+IHYgPT09IFwiaWRcIlxuICAgICk/LlswXTtcbiAgICB0YWJsZVNjaGVtYVtpZEtleSA/PyBcImlkXCJdID0ge1xuICAgICAgdHlwZTogb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJudW1iZXJcIiA6IFwic3RyaW5nXCJcbiAgICB9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRhYmxlU2NoZW1hKSB7XG4gICAgICBpZiAoc2VsZWN0Lmxlbmd0aCAmJiAhc2VsZWN0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBmaWVsZCA9IHRhYmxlU2NoZW1hW2tleV07XG4gICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxLZXkgPSBmaWVsZC5maWVsZE5hbWUgfHwga2V5O1xuICAgICAgICBsZXQgbmV3VmFsdWUgPSBkYXRhW09iamVjdC5lbnRyaWVzKG5ld01hcHBlZEtleXMpLmZpbmQoXG4gICAgICAgICAgKFtfLCB2XSkgPT4gdiA9PT0gb3JpZ2luYWxLZXlcbiAgICAgICAgKT8uWzBdIHx8IG9yaWdpbmFsS2V5XTtcbiAgICAgICAgaWYgKGZpZWxkLnRyYW5zZm9ybT8ub3V0cHV0KSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBhd2FpdCBmaWVsZC50cmFuc2Zvcm0ub3V0cHV0KG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbmV3RmllbGROYW1lID0gbmV3TWFwcGVkS2V5c1trZXldIHx8IGtleTtcbiAgICAgICAgaWYgKG9yaWdpbmFsS2V5ID09PSBcImlkXCIgfHwgZmllbGQucmVmZXJlbmNlcz8uZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgICAgIGlmICh0eXBlb2YgbmV3VmFsdWUgIT09IFwidW5kZWZpbmVkXCIgJiYgbmV3VmFsdWUgIT09IG51bGwpXG4gICAgICAgICAgICBuZXdWYWx1ZSA9IFN0cmluZyhuZXdWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzSlNPTiA9PT0gZmFsc2UgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiICYmIGZpZWxkLnR5cGUgPT09IFwianNvblwiKSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBzYWZlSlNPTlBhcnNlKG5ld1ZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb25maWcuc3VwcG9ydHNEYXRlcyA9PT0gZmFsc2UgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiICYmIGZpZWxkLnR5cGUgPT09IFwiZGF0ZVwiKSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBuZXcgRGF0ZShuZXdWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzQm9vbGVhbnMgPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJudW1iZXJcIiAmJiBmaWVsZC50eXBlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgIG5ld1ZhbHVlID0gbmV3VmFsdWUgPT09IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbmZpZy5jdXN0b21UcmFuc2Zvcm1PdXRwdXQpIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IGNvbmZpZy5jdXN0b21UcmFuc2Zvcm1PdXRwdXQoe1xuICAgICAgICAgICAgZGF0YTogbmV3VmFsdWUsXG4gICAgICAgICAgICBmaWVsZDogbmV3RmllbGROYW1lLFxuICAgICAgICAgICAgZmllbGRBdHRyaWJ1dGVzOiBmaWVsZCxcbiAgICAgICAgICAgIHNlbGVjdCxcbiAgICAgICAgICAgIG1vZGVsOiB1bnNhZmVfbW9kZWwsXG4gICAgICAgICAgICBzY2hlbWEsXG4gICAgICAgICAgICBvcHRpb25zXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdHJhbnNmb3JtZWREYXRhW25ld0ZpZWxkTmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRyYW5zZm9ybWVkRGF0YTtcbiAgfTtcbiAgY29uc3QgdHJhbnNmb3JtV2hlcmVDbGF1c2UgPSAoe1xuICAgIG1vZGVsLFxuICAgIHdoZXJlXG4gIH0pID0+IHtcbiAgICBpZiAoIXdoZXJlKSByZXR1cm4gdm9pZCAwO1xuICAgIGNvbnN0IG5ld01hcHBlZEtleXMgPSBjb25maWcubWFwS2V5c1RyYW5zZm9ybUlucHV0ID8/IHt9O1xuICAgIHJldHVybiB3aGVyZS5tYXAoKHcpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZmllbGQ6IHVuc2FmZV9maWVsZCxcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIG9wZXJhdG9yID0gXCJlcVwiLFxuICAgICAgICBjb25uZWN0b3IgPSBcIkFORFwiXG4gICAgICB9ID0gdztcbiAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJpblwiKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBtdXN0IGJlIGFuIGFycmF5XCIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBkZWZhdWx0TW9kZWxOYW1lID0gZ2V0RGVmYXVsdE1vZGVsTmFtZShtb2RlbCk7XG4gICAgICBjb25zdCBkZWZhdWx0RmllbGROYW1lID0gZ2V0RGVmYXVsdEZpZWxkTmFtZSh7XG4gICAgICAgIGZpZWxkOiB1bnNhZmVfZmllbGQsXG4gICAgICAgIG1vZGVsXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGZpZWxkTmFtZSA9IG5ld01hcHBlZEtleXNbZGVmYXVsdEZpZWxkTmFtZV0gfHwgZ2V0RmllbGROYW1lKHtcbiAgICAgICAgZmllbGQ6IGRlZmF1bHRGaWVsZE5hbWUsXG4gICAgICAgIG1vZGVsOiBkZWZhdWx0TW9kZWxOYW1lXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGZpZWxkQXR0ciA9IGdldEZpZWxkQXR0cmlidXRlcyh7XG4gICAgICAgIGZpZWxkOiBkZWZhdWx0RmllbGROYW1lLFxuICAgICAgICBtb2RlbDogZGVmYXVsdE1vZGVsTmFtZVxuICAgICAgfSk7XG4gICAgICBpZiAoZGVmYXVsdEZpZWxkTmFtZSA9PT0gXCJpZFwiIHx8IGZpZWxkQXR0ci5yZWZlcmVuY2VzPy5maWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICAgIGlmIChvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQpIHtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIG9wZXJhdG9yLFxuICAgICAgICAgICAgICBjb25uZWN0b3IsXG4gICAgICAgICAgICAgIGZpZWxkOiBmaWVsZE5hbWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS5tYXAoTnVtYmVyKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9wZXJhdG9yLFxuICAgICAgICAgICAgY29ubmVjdG9yLFxuICAgICAgICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcbiAgICAgICAgICAgIHZhbHVlOiBOdW1iZXIodmFsdWUpXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3BlcmF0b3IsXG4gICAgICAgIGNvbm5lY3RvcixcbiAgICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcbiAgICAgICAgdmFsdWVcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGFkYXB0ZXJJbnN0YW5jZSA9IGN1c3RvbUFkYXB0ZXIoe1xuICAgIG9wdGlvbnMsXG4gICAgc2NoZW1hLFxuICAgIGRlYnVnTG9nLFxuICAgIGdldEZpZWxkTmFtZSxcbiAgICBnZXRNb2RlbE5hbWUsXG4gICAgZ2V0RGVmYXVsdE1vZGVsTmFtZSxcbiAgICBnZXREZWZhdWx0RmllbGROYW1lLFxuICAgIGdldEZpZWxkQXR0cmlidXRlcyxcbiAgICB0cmFuc2Zvcm1JbnB1dCxcbiAgICB0cmFuc2Zvcm1PdXRwdXQsXG4gICAgdHJhbnNmb3JtV2hlcmVDbGF1c2VcbiAgfSk7XG4gIGxldCBsYXp5TG9hZFRyYW5zYWN0aW9uID0gbnVsbDtcbiAgY29uc3QgYWRhcHRlciA9IHtcbiAgICB0cmFuc2FjdGlvbjogYXN5bmMgKGNiKSA9PiB7XG4gICAgICBpZiAoIWxhenlMb2FkVHJhbnNhY3Rpb24pIHtcbiAgICAgICAgaWYgKCFjb25maWcudHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGNvbmZpZy5kZWJ1Z0xvZ3MgPT09IFwib2JqZWN0XCIgJiYgXCJpc1J1bm5pbmdBZGFwdGVyVGVzdHNcIiBpbiBjb25maWcuZGVidWdMb2dzICYmIGNvbmZpZy5kZWJ1Z0xvZ3MuaXNSdW5uaW5nQWRhcHRlclRlc3RzKSA7IGVsc2Uge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgICAgIGBbJHtjb25maWcuYWRhcHRlck5hbWV9XSAtIFRyYW5zYWN0aW9ucyBhcmUgbm90IHN1cHBvcnRlZC4gRXhlY3V0aW5nIG9wZXJhdGlvbnMgc2VxdWVudGlhbGx5LmBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxhenlMb2FkVHJhbnNhY3Rpb24gPSBjcmVhdGVBc0lzVHJhbnNhY3Rpb24oYWRhcHRlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKFxuICAgICAgICAgICAgYFske2NvbmZpZy5hZGFwdGVyTmFtZX1dIC0gVXNpbmcgcHJvdmlkZWQgdHJhbnNhY3Rpb24gaW1wbGVtZW50YXRpb24uYFxuICAgICAgICAgICk7XG4gICAgICAgICAgbGF6eUxvYWRUcmFuc2FjdGlvbiA9IGNvbmZpZy50cmFuc2FjdGlvbjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGxhenlMb2FkVHJhbnNhY3Rpb24oY2IpO1xuICAgIH0sXG4gICAgY3JlYXRlOiBhc3luYyAoe1xuICAgICAgZGF0YTogdW5zYWZlRGF0YSxcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHNlbGVjdCxcbiAgICAgIGZvcmNlQWxsb3dJZCA9IGZhbHNlXG4gICAgfSkgPT4ge1xuICAgICAgdHJhbnNhY3Rpb25JZCsrO1xuICAgICAgbGV0IHRoaXNUcmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25JZDtcbiAgICAgIGNvbnN0IG1vZGVsID0gZ2V0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIHVuc2FmZU1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBpZiAoXCJpZFwiIGluIHVuc2FmZURhdGEgJiYgIWZvcmNlQWxsb3dJZCkge1xuICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICBgWyR7Y29uZmlnLmFkYXB0ZXJOYW1lfV0gLSBZb3UgYXJlIHRyeWluZyB0byBjcmVhdGUgYSByZWNvcmQgd2l0aCBhbiBpZC4gVGhpcyBpcyBub3QgYWxsb3dlZCBhcyB3ZSBoYW5kbGUgaWQgZ2VuZXJhdGlvbiBmb3IgeW91LCB1bmxlc3MgeW91IHBhc3MgaW4gdGhlIFxcYGZvcmNlQWxsb3dJZFxcYCBwYXJhbWV0ZXIuIFRoZSBpZCB3aWxsIGJlIGlnbm9yZWQuYFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoKTtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBlcnIuc3RhY2s/LnNwbGl0KFwiXFxuXCIpLmZpbHRlcigoXywgaSkgPT4gaSAhPT0gMSkuam9pbihcIlxcblwiKS5yZXBsYWNlKFwiRXJyb3I6XCIsIFwiQ3JlYXRlIG1ldGhvZCB3aXRoIGBpZGAgYmVpbmcgY2FsbGVkIGF0OlwiKTtcbiAgICAgICAgY29uc29sZS5sb2coc3RhY2spO1xuICAgICAgICB1bnNhZmVEYXRhLmlkID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlVuc2FmZSBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdW5zYWZlRGF0YSB9XG4gICAgICApO1xuICAgICAgbGV0IGRhdGEgPSB1bnNhZmVEYXRhO1xuICAgICAgaWYgKCFjb25maWcuZGlzYWJsZVRyYW5zZm9ybUlucHV0KSB7XG4gICAgICAgIGRhdGEgPSBhd2FpdCB0cmFuc2Zvcm1JbnB1dChcbiAgICAgICAgICB1bnNhZmVEYXRhLFxuICAgICAgICAgIHVuc2FmZU1vZGVsLFxuICAgICAgICAgIFwiY3JlYXRlXCIsXG4gICAgICAgICAgZm9yY2VBbGxvd0lkXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiY3JlYXRlXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJjcmVhdGVcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIElucHV0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UuY3JlYXRlKHsgZGF0YSwgbW9kZWwgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiY3JlYXRlXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgzLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJjcmVhdGVcIil9ICR7Zm9ybWF0QWN0aW9uKFwiREIgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCByZXMgfVxuICAgICAgKTtcbiAgICAgIGxldCB0cmFuc2Zvcm1lZCA9IHJlcztcbiAgICAgIGlmICghY29uZmlnLmRpc2FibGVUcmFuc2Zvcm1PdXRwdXQpIHtcbiAgICAgICAgdHJhbnNmb3JtZWQgPSBhd2FpdCB0cmFuc2Zvcm1PdXRwdXQocmVzLCB1bnNhZmVNb2RlbCwgc2VsZWN0KTtcbiAgICAgIH1cbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJjcmVhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDQsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImNyZWF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJQYXJzZWQgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB0cmFuc2Zvcm1lZCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkO1xuICAgIH0sXG4gICAgdXBkYXRlOiBhc3luYyAoe1xuICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlLFxuICAgICAgdXBkYXRlOiB1bnNhZmVEYXRhXG4gICAgfSkgPT4ge1xuICAgICAgdHJhbnNhY3Rpb25JZCsrO1xuICAgICAgbGV0IHRoaXNUcmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25JZDtcbiAgICAgIHVuc2FmZU1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlVuc2FmZSBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdW5zYWZlRGF0YSB9XG4gICAgICApO1xuICAgICAgbGV0IGRhdGEgPSB1bnNhZmVEYXRhO1xuICAgICAgaWYgKCFjb25maWcuZGlzYWJsZVRyYW5zZm9ybUlucHV0KSB7XG4gICAgICAgIGRhdGEgPSBhd2FpdCB0cmFuc2Zvcm1JbnB1dCh1bnNhZmVEYXRhLCB1bnNhZmVNb2RlbCwgXCJ1cGRhdGVcIik7XG4gICAgICB9XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwidXBkYXRlXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJ1cGRhdGVcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIElucHV0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UudXBkYXRlKHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlLFxuICAgICAgICB1cGRhdGU6IGRhdGFcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogcmVzIH1cbiAgICAgICk7XG4gICAgICBsZXQgdHJhbnNmb3JtZWQgPSByZXM7XG4gICAgICBpZiAoIWNvbmZpZy5kaXNhYmxlVHJhbnNmb3JtT3V0cHV0KSB7XG4gICAgICAgIHRyYW5zZm9ybWVkID0gYXdhaXQgdHJhbnNmb3JtT3V0cHV0KHJlcywgdW5zYWZlTW9kZWwpO1xuICAgICAgfVxuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoNCwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHRyYW5zZm9ybWVkIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG4gICAgfSxcbiAgICB1cGRhdGVNYW55OiBhc3luYyAoe1xuICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlLFxuICAgICAgdXBkYXRlOiB1bnNhZmVEYXRhXG4gICAgfSkgPT4ge1xuICAgICAgdHJhbnNhY3Rpb25JZCsrO1xuICAgICAgbGV0IHRoaXNUcmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25JZDtcbiAgICAgIGNvbnN0IG1vZGVsID0gZ2V0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGNvbnN0IHdoZXJlID0gdHJhbnNmb3JtV2hlcmVDbGF1c2Uoe1xuICAgICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgICAgfSk7XG4gICAgICB1bnNhZmVNb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiVW5zYWZlIElucHV0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB1bnNhZmVEYXRhIH1cbiAgICAgICk7XG4gICAgICBsZXQgZGF0YSA9IHVuc2FmZURhdGE7XG4gICAgICBpZiAoIWNvbmZpZy5kaXNhYmxlVHJhbnNmb3JtSW5wdXQpIHtcbiAgICAgICAgZGF0YSA9IGF3YWl0IHRyYW5zZm9ybUlucHV0KHVuc2FmZURhdGEsIHVuc2FmZU1vZGVsLCBcInVwZGF0ZVwiKTtcbiAgICAgIH1cbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJ1cGRhdGVNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YSB9XG4gICAgICApO1xuICAgICAgY29uc3QgdXBkYXRlZENvdW50ID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLnVwZGF0ZU1hbnkoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIHVwZGF0ZTogZGF0YVxuICAgICAgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwidXBkYXRlTWFueVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHVwZGF0ZWRDb3VudCB9XG4gICAgICApO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDQsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdXBkYXRlZENvdW50IH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdXBkYXRlZENvdW50O1xuICAgIH0sXG4gICAgZmluZE9uZTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZSxcbiAgICAgIHNlbGVjdFxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgdW5zYWZlTW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJmaW5kT25lXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kT25lXCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCB3aGVyZSwgc2VsZWN0IH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsLFxuICAgICAgICB3aGVyZSxcbiAgICAgICAgc2VsZWN0XG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJmaW5kT25lXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kT25lXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogcmVzIH1cbiAgICAgICk7XG4gICAgICBsZXQgdHJhbnNmb3JtZWQgPSByZXM7XG4gICAgICBpZiAoIWNvbmZpZy5kaXNhYmxlVHJhbnNmb3JtT3V0cHV0KSB7XG4gICAgICAgIHRyYW5zZm9ybWVkID0gYXdhaXQgdHJhbnNmb3JtT3V0cHV0KHJlcywgdW5zYWZlTW9kZWwsIHNlbGVjdCk7XG4gICAgICB9XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE9uZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgMyl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZmluZE9uZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJQYXJzZWQgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB0cmFuc2Zvcm1lZCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkO1xuICAgIH0sXG4gICAgZmluZE1hbnk6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmUsXG4gICAgICBsaW1pdDogdW5zYWZlTGltaXQsXG4gICAgICBzb3J0QnksXG4gICAgICBvZmZzZXRcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbGltaXQgPSB1bnNhZmVMaW1pdCA/PyBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8uZGVmYXVsdEZpbmRNYW55TGltaXQgPz8gMTAwO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIHVuc2FmZU1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDMpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImZpbmRNYW55XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCB3aGVyZSwgbGltaXQsIHNvcnRCeSwgb2Zmc2V0IH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIGxpbWl0LFxuICAgICAgICBzb3J0QnksXG4gICAgICAgIG9mZnNldFxuICAgICAgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDIsIDMpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImZpbmRNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogcmVzIH1cbiAgICAgICk7XG4gICAgICBsZXQgdHJhbnNmb3JtZWQgPSByZXM7XG4gICAgICBpZiAoIWNvbmZpZy5kaXNhYmxlVHJhbnNmb3JtT3V0cHV0KSB7XG4gICAgICAgIHRyYW5zZm9ybWVkID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgcmVzLm1hcChhc3luYyAocikgPT4gYXdhaXQgdHJhbnNmb3JtT3V0cHV0KHIsIHVuc2FmZU1vZGVsKSlcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJmaW5kTWFueVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgMyl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZmluZE1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdHJhbnNmb3JtZWQgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcbiAgICB9LFxuICAgIGRlbGV0ZTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgdW5zYWZlTW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJkZWxldGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDIpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImRlbGV0ZVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUgfVxuICAgICAgKTtcbiAgICAgIGF3YWl0IGFkYXB0ZXJJbnN0YW5jZS5kZWxldGUoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImRlbGV0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZGVsZXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCB9XG4gICAgICApO1xuICAgIH0sXG4gICAgZGVsZXRlTWFueTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgdW5zYWZlTW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJkZWxldGVNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCAyKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJkZWxldGVNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIkRlbGV0ZU1hbnlcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIHdoZXJlIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UuZGVsZXRlTWFueSh7XG4gICAgICAgIG1vZGVsLFxuICAgICAgICB3aGVyZVxuICAgICAgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZGVsZXRlTWFueVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZGVsZXRlTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHJlcyB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9LFxuICAgIGNvdW50OiBhc3luYyAoe1xuICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgfSkgPT4ge1xuICAgICAgdHJhbnNhY3Rpb25JZCsrO1xuICAgICAgbGV0IHRoaXNUcmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25JZDtcbiAgICAgIGNvbnN0IG1vZGVsID0gZ2V0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGNvbnN0IHdoZXJlID0gdHJhbnNmb3JtV2hlcmVDbGF1c2Uoe1xuICAgICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgICAgfSk7XG4gICAgICB1bnNhZmVNb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNvdW50XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCAyKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJjb3VudFwiKX06YCxcbiAgICAgICAge1xuICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgIHdoZXJlXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UuY291bnQoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNvdW50XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCAyKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJjb3VudFwiKX06YCxcbiAgICAgICAge1xuICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgIGRhdGE6IHJlc1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9LFxuICAgIGNyZWF0ZVNjaGVtYTogYWRhcHRlckluc3RhbmNlLmNyZWF0ZVNjaGVtYSA/IGFzeW5jIChfLCBmaWxlKSA9PiB7XG4gICAgICBjb25zdCB0YWJsZXMgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICAgICAgaWYgKG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSAmJiAhb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgIGRlbGV0ZSB0YWJsZXMuc2Vzc2lvbjtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnJhdGVMaW1pdCAmJiBvcHRpb25zLnJhdGVMaW1pdC5zdG9yYWdlID09PSBcImRhdGFiYXNlXCIgJiYgLy8gcmF0ZS1saW1pdCB3aWxsIGRlZmF1bHQgdG8gZW5hYmxlZCBpbiBwcm9kdWN0aW9uLFxuICAgICAgLy8gYW5kIGdpdmVuIHN0b3JhZ2UgaXMgZGF0YWJhc2UsIGl0IHdpbGwgdHJ5IHRvIHVzZSB0aGUgcmF0ZS1saW1pdCB0YWJsZSxcbiAgICAgIC8vIHNvIHdlIHNob3VsZCBtYWtlIHN1cmUgdG8gZ2VuZXJhdGUgcmF0ZS1saW1pdCB0YWJsZSBzY2hlbWFcbiAgICAgICh0eXBlb2Ygb3B0aW9ucy5yYXRlTGltaXQuZW5hYmxlZCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAvLyBhbmQgb2YgY291cnNlIGlmIHRoZXkgZm9yY2VmdWxseSBzZXQgdG8gdHJ1ZSwgdGhlbiB0aGV5IHdhbnQgcmF0ZS1saW1pdCxcbiAgICAgIC8vIHRodXMgd2Ugc2hvdWxkIGFsc28gZ2VuZXJhdGUgcmF0ZS1saW1pdCB0YWJsZSBzY2hlbWFcbiAgICAgIG9wdGlvbnMucmF0ZUxpbWl0LmVuYWJsZWQgPT09IHRydWUpKSB7XG4gICAgICAgIHRhYmxlcy5yYXRlbGltaXQgPSB7XG4gICAgICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnJhdGVMaW1pdC5tb2RlbE5hbWUgPz8gXCJyYXRlbGltaXRcIixcbiAgICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICAgIGtleToge1xuICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0LmZpZWxkcz8ua2V5ID8/IFwia2V5XCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb3VudDoge1xuICAgICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdC5maWVsZHM/LmNvdW50ID8/IFwiY291bnRcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxhc3RSZXF1ZXN0OiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICBiaWdpbnQ6IHRydWUsXG4gICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdC5maWVsZHM/Lmxhc3RSZXF1ZXN0ID8/IFwibGFzdFJlcXVlc3RcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhZGFwdGVySW5zdGFuY2UuY3JlYXRlU2NoZW1hKHsgZmlsZSwgdGFibGVzIH0pO1xuICAgIH0gOiB2b2lkIDAsXG4gICAgb3B0aW9uczoge1xuICAgICAgYWRhcHRlckNvbmZpZzogY29uZmlnLFxuICAgICAgLi4uYWRhcHRlckluc3RhbmNlLm9wdGlvbnMgPz8ge31cbiAgICB9LFxuICAgIGlkOiBjb25maWcuYWRhcHRlcklkLFxuICAgIC8vIFNlY3JldGx5IGV4cG9ydCB2YWx1ZXMgT05MWSBpZiB0aGlzIGFkYXB0ZXIgaGFzIGVuYWJsZWQgYWRhcHRlci10ZXN0LWRlYnVnLWxvZ3MuXG4gICAgLy8gVGhpcyB3b3VsZCB0aGVuIGJlIHVzZWQgZHVyaW5nIG91ciBhZGFwdGVyLXRlc3RzIHRvIGhlbHAgcHJpbnQgZGVidWcgbG9ncyBpZiBhIHRlc3QgZmFpbHMuXG4gICAgLy9AdHMtZXhwZWN0LWVycm9yIC0gXl5cbiAgICAuLi5jb25maWcuZGVidWdMb2dzPy5pc1J1bm5pbmdBZGFwdGVyVGVzdHMgPyB7XG4gICAgICBhZGFwdGVyVGVzdERlYnVnTG9nczoge1xuICAgICAgICByZXNldERlYnVnTG9ncygpIHtcbiAgICAgICAgICBkZWJ1Z0xvZ3MgPSBkZWJ1Z0xvZ3MuZmlsdGVyKFxuICAgICAgICAgICAgKGxvZykgPT4gbG9nLmluc3RhbmNlICE9PSB1bmlxdWVBZGFwdGVyRmFjdG9yeUluc3RhbmNlSWRcbiAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICBwcmludERlYnVnTG9ncygpIHtcbiAgICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSBgXFx1MjUwMGAucmVwZWF0KDgwKTtcbiAgICAgICAgICBjb25zdCBsb2dzID0gZGVidWdMb2dzLmZpbHRlcihcbiAgICAgICAgICAgIChsb2cyKSA9PiBsb2cyLmluc3RhbmNlID09PSB1bmlxdWVBZGFwdGVyRmFjdG9yeUluc3RhbmNlSWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChsb2dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgbG9nID0gbG9ncy5yZXZlcnNlKCkubWFwKChsb2cyKSA9PiB7XG4gICAgICAgICAgICBsb2cyLmFyZ3NbMF0gPSBgXG4ke2xvZzIuYXJnc1swXX1gO1xuICAgICAgICAgICAgcmV0dXJuIFsuLi5sb2cyLmFyZ3MsIFwiXFxuXCJdO1xuICAgICAgICAgIH0pLnJlZHVjZShcbiAgICAgICAgICAgIChwcmV2LCBjdXJyKSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiBbLi4uY3VyciwgLi4ucHJldl07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgW2BcbiR7c2VwYXJhdG9yfWBdXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyguLi5sb2cpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSA6IHt9XG4gIH07XG4gIHJldHVybiBhZGFwdGVyO1xufTtcbmZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uSWQodHJhbnNhY3Rpb25JZDIpIHtcbiAgaWYgKGdldENvbG9yRGVwdGgoKSA8IDgpIHtcbiAgICByZXR1cm4gYCMke3RyYW5zYWN0aW9uSWQyfWA7XG4gIH1cbiAgcmV0dXJuIGAke1RUWV9DT0xPUlMuZmcubWFnZW50YX0jJHt0cmFuc2FjdGlvbklkMn0ke1RUWV9DT0xPUlMucmVzZXR9YDtcbn1cbmZ1bmN0aW9uIGZvcm1hdFN0ZXAoc3RlcCwgdG90YWwpIHtcbiAgcmV0dXJuIGAke1RUWV9DT0xPUlMuYmcuYmxhY2t9JHtUVFlfQ09MT1JTLmZnLnllbGxvd31bJHtzdGVwfS8ke3RvdGFsfV0ke1RUWV9DT0xPUlMucmVzZXR9YDtcbn1cbmZ1bmN0aW9uIGZvcm1hdE1ldGhvZChtZXRob2QpIHtcbiAgcmV0dXJuIGAke1RUWV9DT0xPUlMuYnJpZ2h0fSR7bWV0aG9kfSR7VFRZX0NPTE9SUy5yZXNldH1gO1xufVxuZnVuY3Rpb24gZm9ybWF0QWN0aW9uKGFjdGlvbikge1xuICByZXR1cm4gYCR7VFRZX0NPTE9SUy5kaW19KCR7YWN0aW9ufSkke1RUWV9DT0xPUlMucmVzZXR9YDtcbn1cblxuZXhwb3J0IHsgY3JlYXRlQWRhcHRlckZhY3RvcnkgYXMgYyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   p: () => (/* binding */ parseSetCookieHeader),\n/* harmony export */   s: () => (/* binding */ setCookieToHeader)\n/* harmony export */ });\nfunction parseSetCookieHeader(setCookie) {\n  const cookies = /* @__PURE__ */ new Map();\n  const cookieArray = setCookie.split(\", \");\n  cookieArray.forEach((cookieString) => {\n    const parts = cookieString.split(\";\").map((part) => part.trim());\n    const [nameValue, ...attributes] = parts;\n    const [name, ...valueParts] = (nameValue || \"\").split(\"=\");\n    const value = valueParts.join(\"=\");\n    if (!name || value === void 0) {\n      return;\n    }\n    const attrObj = { value };\n    attributes.forEach((attribute) => {\n      const [attrName, ...attrValueParts] = attribute.split(\"=\");\n      const attrValue = attrValueParts.join(\"=\");\n      const normalizedAttrName = attrName.trim().toLowerCase();\n      switch (normalizedAttrName) {\n        case \"max-age\":\n          attrObj[\"max-age\"] = attrValue ? parseInt(attrValue.trim(), 10) : void 0;\n          break;\n        case \"expires\":\n          attrObj.expires = attrValue ? new Date(attrValue.trim()) : void 0;\n          break;\n        case \"domain\":\n          attrObj.domain = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"path\":\n          attrObj.path = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"secure\":\n          attrObj.secure = true;\n          break;\n        case \"httponly\":\n          attrObj.httponly = true;\n          break;\n        case \"samesite\":\n          attrObj.samesite = attrValue ? attrValue.trim().toLowerCase() : void 0;\n          break;\n        default:\n          attrObj[normalizedAttrName] = attrValue ? attrValue.trim() : true;\n          break;\n      }\n    });\n    cookies.set(name, attrObj);\n  });\n  return cookies;\n}\nfunction setCookieToHeader(headers) {\n  return (context) => {\n    const setCookieHeader = context.response.headers.get(\"set-cookie\");\n    if (!setCookieHeader) {\n      return;\n    }\n    const cookieMap = /* @__PURE__ */ new Map();\n    const existingCookiesHeader = headers.get(\"cookie\") || \"\";\n    existingCookiesHeader.split(\";\").forEach((cookie) => {\n      const [name, ...rest] = cookie.trim().split(\"=\");\n      if (name && rest.length > 0) {\n        cookieMap.set(name, rest.join(\"=\"));\n      }\n    });\n    const setCookieHeaders = setCookieHeader.split(\",\");\n    setCookieHeaders.forEach((header) => {\n      const cookies = parseSetCookieHeader(header);\n      cookies.forEach((value, name) => {\n        cookieMap.set(name, value.value);\n      });\n    });\n    const updatedCookies = Array.from(cookieMap.entries()).map(([name, value]) => `${name}=${value}`).join(\"; \");\n    headers.set(\"cookie\", updatedCookies);\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguSWg4Qzc2Vm8ubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxxRkFBcUYsS0FBSyxHQUFHLE1BQU0sV0FBVztBQUM5RztBQUNBO0FBQ0E7O0FBRTZEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguSWg4Qzc2Vm8ubWpzP2ZmMmUiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcGFyc2VTZXRDb29raWVIZWFkZXIoc2V0Q29va2llKSB7XG4gIGNvbnN0IGNvb2tpZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICBjb25zdCBjb29raWVBcnJheSA9IHNldENvb2tpZS5zcGxpdChcIiwgXCIpO1xuICBjb29raWVBcnJheS5mb3JFYWNoKChjb29raWVTdHJpbmcpID0+IHtcbiAgICBjb25zdCBwYXJ0cyA9IGNvb2tpZVN0cmluZy5zcGxpdChcIjtcIikubWFwKChwYXJ0KSA9PiBwYXJ0LnRyaW0oKSk7XG4gICAgY29uc3QgW25hbWVWYWx1ZSwgLi4uYXR0cmlidXRlc10gPSBwYXJ0cztcbiAgICBjb25zdCBbbmFtZSwgLi4udmFsdWVQYXJ0c10gPSAobmFtZVZhbHVlIHx8IFwiXCIpLnNwbGl0KFwiPVwiKTtcbiAgICBjb25zdCB2YWx1ZSA9IHZhbHVlUGFydHMuam9pbihcIj1cIik7XG4gICAgaWYgKCFuYW1lIHx8IHZhbHVlID09PSB2b2lkIDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgYXR0ck9iaiA9IHsgdmFsdWUgfTtcbiAgICBhdHRyaWJ1dGVzLmZvckVhY2goKGF0dHJpYnV0ZSkgPT4ge1xuICAgICAgY29uc3QgW2F0dHJOYW1lLCAuLi5hdHRyVmFsdWVQYXJ0c10gPSBhdHRyaWJ1dGUuc3BsaXQoXCI9XCIpO1xuICAgICAgY29uc3QgYXR0clZhbHVlID0gYXR0clZhbHVlUGFydHMuam9pbihcIj1cIik7XG4gICAgICBjb25zdCBub3JtYWxpemVkQXR0ck5hbWUgPSBhdHRyTmFtZS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgIHN3aXRjaCAobm9ybWFsaXplZEF0dHJOYW1lKSB7XG4gICAgICAgIGNhc2UgXCJtYXgtYWdlXCI6XG4gICAgICAgICAgYXR0ck9ialtcIm1heC1hZ2VcIl0gPSBhdHRyVmFsdWUgPyBwYXJzZUludChhdHRyVmFsdWUudHJpbSgpLCAxMCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJleHBpcmVzXCI6XG4gICAgICAgICAgYXR0ck9iai5leHBpcmVzID0gYXR0clZhbHVlID8gbmV3IERhdGUoYXR0clZhbHVlLnRyaW0oKSkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJkb21haW5cIjpcbiAgICAgICAgICBhdHRyT2JqLmRvbWFpbiA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJwYXRoXCI6XG4gICAgICAgICAgYXR0ck9iai5wYXRoID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKSA6IHZvaWQgMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInNlY3VyZVwiOlxuICAgICAgICAgIGF0dHJPYmouc2VjdXJlID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImh0dHBvbmx5XCI6XG4gICAgICAgICAgYXR0ck9iai5odHRwb25seSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzYW1lc2l0ZVwiOlxuICAgICAgICAgIGF0dHJPYmouc2FtZXNpdGUgPSBhdHRyVmFsdWUgPyBhdHRyVmFsdWUudHJpbSgpLnRvTG93ZXJDYXNlKCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYXR0ck9ialtub3JtYWxpemVkQXR0ck5hbWVdID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKSA6IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29va2llcy5zZXQobmFtZSwgYXR0ck9iaik7XG4gIH0pO1xuICByZXR1cm4gY29va2llcztcbn1cbmZ1bmN0aW9uIHNldENvb2tpZVRvSGVhZGVyKGhlYWRlcnMpIHtcbiAgcmV0dXJuIChjb250ZXh0KSA9PiB7XG4gICAgY29uc3Qgc2V0Q29va2llSGVhZGVyID0gY29udGV4dC5yZXNwb25zZS5oZWFkZXJzLmdldChcInNldC1jb29raWVcIik7XG4gICAgaWYgKCFzZXRDb29raWVIZWFkZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY29va2llTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICBjb25zdCBleGlzdGluZ0Nvb2tpZXNIZWFkZXIgPSBoZWFkZXJzLmdldChcImNvb2tpZVwiKSB8fCBcIlwiO1xuICAgIGV4aXN0aW5nQ29va2llc0hlYWRlci5zcGxpdChcIjtcIikuZm9yRWFjaCgoY29va2llKSA9PiB7XG4gICAgICBjb25zdCBbbmFtZSwgLi4ucmVzdF0gPSBjb29raWUudHJpbSgpLnNwbGl0KFwiPVwiKTtcbiAgICAgIGlmIChuYW1lICYmIHJlc3QubGVuZ3RoID4gMCkge1xuICAgICAgICBjb29raWVNYXAuc2V0KG5hbWUsIHJlc3Quam9pbihcIj1cIikpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IHNldENvb2tpZUhlYWRlcnMgPSBzZXRDb29raWVIZWFkZXIuc3BsaXQoXCIsXCIpO1xuICAgIHNldENvb2tpZUhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyKSA9PiB7XG4gICAgICBjb25zdCBjb29raWVzID0gcGFyc2VTZXRDb29raWVIZWFkZXIoaGVhZGVyKTtcbiAgICAgIGNvb2tpZXMuZm9yRWFjaCgodmFsdWUsIG5hbWUpID0+IHtcbiAgICAgICAgY29va2llTWFwLnNldChuYW1lLCB2YWx1ZS52YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25zdCB1cGRhdGVkQ29va2llcyA9IEFycmF5LmZyb20oY29va2llTWFwLmVudHJpZXMoKSkubWFwKChbbmFtZSwgdmFsdWVdKSA9PiBgJHtuYW1lfT0ke3ZhbHVlfWApLmpvaW4oXCI7IFwiKTtcbiAgICBoZWFkZXJzLnNldChcImNvb2tpZVwiLCB1cGRhdGVkQ29va2llcyk7XG4gIH07XG59XG5cbmV4cG9ydCB7IHBhcnNlU2V0Q29va2llSGVhZGVyIGFzIHAsIHNldENvb2tpZVRvSGVhZGVyIGFzIHMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ checkPassword),\n/* harmony export */   v: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n\n\nasync function validatePassword(ctx, data) {\n  const accounts = await ctx.context.internalAdapter.findAccounts(data.userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword) {\n    return false;\n  }\n  const compare = await ctx.context.password.verify({\n    hash: currentPassword,\n    password: data.password\n  });\n  return compare;\n}\nasync function checkPassword(userId, c) {\n  const accounts = await c.context.internalAdapter.findAccounts(userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword || !c.body.password) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"No password credential found\"\n    });\n  }\n  const compare = await c.context.password.verify({\n    hash: currentPassword,\n    password: c.body.password\n  });\n  if (!compare) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid password\"\n    });\n  }\n  return true;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1Qzs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaURBQVE7QUFDdEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxjQUFjLGlEQUFRO0FBQ3RCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFcUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5Zd0RRaG9QYy5tanM/ODc0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcblxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVQYXNzd29yZChjdHgsIGRhdGEpIHtcbiAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKGRhdGEudXNlcklkKTtcbiAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSBhY2NvdW50cz8uZmluZChcbiAgICAoYWNjb3VudCkgPT4gYWNjb3VudC5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIlxuICApO1xuICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBjcmVkZW50aWFsQWNjb3VudD8ucGFzc3dvcmQ7XG4gIGlmICghY3JlZGVudGlhbEFjY291bnQgfHwgIWN1cnJlbnRQYXNzd29yZCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBjb21wYXJlID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgcGFzc3dvcmQ6IGRhdGEucGFzc3dvcmRcbiAgfSk7XG4gIHJldHVybiBjb21wYXJlO1xufVxuYXN5bmMgZnVuY3Rpb24gY2hlY2tQYXNzd29yZCh1c2VySWQsIGMpIHtcbiAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyh1c2VySWQpO1xuICBjb25zdCBjcmVkZW50aWFsQWNjb3VudCA9IGFjY291bnRzPy5maW5kKFxuICAgIChhY2NvdW50KSA9PiBhY2NvdW50LnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICk7XG4gIGNvbnN0IGN1cnJlbnRQYXNzd29yZCA9IGNyZWRlbnRpYWxBY2NvdW50Py5wYXNzd29yZDtcbiAgaWYgKCFjcmVkZW50aWFsQWNjb3VudCB8fCAhY3VycmVudFBhc3N3b3JkIHx8ICFjLmJvZHkucGFzc3dvcmQpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIk5vIHBhc3N3b3JkIGNyZWRlbnRpYWwgZm91bmRcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IGNvbXBhcmUgPSBhd2FpdCBjLmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgcGFzc3dvcmQ6IGMuYm9keS5wYXNzd29yZFxuICB9KTtcbiAgaWYgKCFjb21wYXJlKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIHBhc3N3b3JkXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IHsgY2hlY2tQYXNzd29yZCBhcyBjLCB2YWxpZGF0ZVBhc3N3b3JkIGFzIHYgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getAuthTables)\n/* harmony export */ });\nconst getAuthTables = (options) => {\n  const pluginSchema = (options.plugins ?? []).reduce(\n    (acc, plugin) => {\n      const schema = plugin.schema;\n      if (!schema) return acc;\n      for (const [key, value] of Object.entries(schema)) {\n        acc[key] = {\n          fields: {\n            ...acc[key]?.fields,\n            ...value.fields\n          },\n          modelName: value.modelName || key\n        };\n      }\n      return acc;\n    },\n    {}\n  );\n  const shouldAddRateLimitTable = options.rateLimit?.storage === \"database\";\n  const rateLimitTable = {\n    rateLimit: {\n      modelName: options.rateLimit?.modelName || \"rateLimit\",\n      fields: {\n        key: {\n          type: \"string\",\n          fieldName: options.rateLimit?.fields?.key || \"key\"\n        },\n        count: {\n          type: \"number\",\n          fieldName: options.rateLimit?.fields?.count || \"count\"\n        },\n        lastRequest: {\n          type: \"number\",\n          bigint: true,\n          fieldName: options.rateLimit?.fields?.lastRequest || \"lastRequest\"\n        }\n      }\n    }\n  };\n  const { user, session, account, ...pluginTables } = pluginSchema;\n  const sessionTable = {\n    session: {\n      modelName: options.session?.modelName || \"session\",\n      fields: {\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.expiresAt || \"expiresAt\"\n        },\n        token: {\n          type: \"string\",\n          required: true,\n          fieldName: options.session?.fields?.token || \"token\",\n          unique: true\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.createdAt || \"createdAt\",\n          defaultValue: () => /* @__PURE__ */ new Date()\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.updatedAt || \"updatedAt\",\n          onUpdate: () => /* @__PURE__ */ new Date()\n        },\n        ipAddress: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.ipAddress || \"ipAddress\"\n        },\n        userAgent: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.userAgent || \"userAgent\"\n        },\n        userId: {\n          type: \"string\",\n          fieldName: options.session?.fields?.userId || \"userId\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true\n        },\n        ...session?.fields,\n        ...options.session?.additionalFields\n      },\n      order: 2\n    }\n  };\n  return {\n    user: {\n      modelName: options.user?.modelName || \"user\",\n      fields: {\n        name: {\n          type: \"string\",\n          required: true,\n          fieldName: options.user?.fields?.name || \"name\",\n          sortable: true\n        },\n        email: {\n          type: \"string\",\n          unique: true,\n          required: true,\n          fieldName: options.user?.fields?.email || \"email\",\n          sortable: true\n        },\n        emailVerified: {\n          type: \"boolean\",\n          defaultValue: false,\n          required: true,\n          fieldName: options.user?.fields?.emailVerified || \"emailVerified\",\n          input: false\n        },\n        image: {\n          type: \"string\",\n          required: false,\n          fieldName: options.user?.fields?.image || \"image\"\n        },\n        createdAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          onUpdate: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...user?.fields,\n        ...options.user?.additionalFields\n      },\n      order: 1\n    },\n    //only add session table if it's not stored in secondary storage\n    ...!options.secondaryStorage || options.session?.storeSessionInDatabase ? sessionTable : {},\n    account: {\n      modelName: options.account?.modelName || \"account\",\n      fields: {\n        accountId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.accountId || \"accountId\"\n        },\n        providerId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.providerId || \"providerId\"\n        },\n        userId: {\n          type: \"string\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true,\n          fieldName: options.account?.fields?.userId || \"userId\"\n        },\n        accessToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.accessToken || \"accessToken\"\n        },\n        refreshToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.refreshToken || \"refreshToken\"\n        },\n        idToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.idToken || \"idToken\"\n        },\n        accessTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"accessTokenExpiresAt\"\n        },\n        refreshTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.refreshTokenExpiresAt || \"refreshTokenExpiresAt\"\n        },\n        scope: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.scope || \"scope\"\n        },\n        password: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.password || \"password\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.createdAt || \"createdAt\",\n          defaultValue: () => /* @__PURE__ */ new Date()\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.updatedAt || \"updatedAt\",\n          onUpdate: () => /* @__PURE__ */ new Date()\n        },\n        ...account?.fields,\n        ...options.account?.additionalFields\n      },\n      order: 3\n    },\n    verification: {\n      modelName: options.verification?.modelName || \"verification\",\n      fields: {\n        identifier: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.identifier || \"identifier\"\n        },\n        value: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.value || \"value\"\n        },\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.verification?.fields?.expiresAt || \"expiresAt\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          onUpdate: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.updatedAt || \"updatedAt\"\n        }\n      },\n      order: 4\n    },\n    ...pluginTables,\n    ...shouldAddRateLimitTable ? rateLimitTable : {}\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGgucFFqZVJrek4ubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMENBQTBDO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0EsK0ZBQStGO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRThCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGgucFFqZVJrek4ubWpzPzhhNzAiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0QXV0aFRhYmxlcyA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHBsdWdpblNjaGVtYSA9IChvcHRpb25zLnBsdWdpbnMgPz8gW10pLnJlZHVjZShcbiAgICAoYWNjLCBwbHVnaW4pID0+IHtcbiAgICAgIGNvbnN0IHNjaGVtYSA9IHBsdWdpbi5zY2hlbWE7XG4gICAgICBpZiAoIXNjaGVtYSkgcmV0dXJuIGFjYztcbiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHNjaGVtYSkpIHtcbiAgICAgICAgYWNjW2tleV0gPSB7XG4gICAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICAuLi5hY2Nba2V5XT8uZmllbGRzLFxuICAgICAgICAgICAgLi4udmFsdWUuZmllbGRzXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtb2RlbE5hbWU6IHZhbHVlLm1vZGVsTmFtZSB8fCBrZXlcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSxcbiAgICB7fVxuICApO1xuICBjb25zdCBzaG91bGRBZGRSYXRlTGltaXRUYWJsZSA9IG9wdGlvbnMucmF0ZUxpbWl0Py5zdG9yYWdlID09PSBcImRhdGFiYXNlXCI7XG4gIGNvbnN0IHJhdGVMaW1pdFRhYmxlID0ge1xuICAgIHJhdGVMaW1pdDoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8ubW9kZWxOYW1lIHx8IFwicmF0ZUxpbWl0XCIsXG4gICAgICBmaWVsZHM6IHtcbiAgICAgICAga2V5OiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5maWVsZHM/LmtleSB8fCBcImtleVwiXG4gICAgICAgIH0sXG4gICAgICAgIGNvdW50OiB7XG4gICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5maWVsZHM/LmNvdW50IHx8IFwiY291bnRcIlxuICAgICAgICB9LFxuICAgICAgICBsYXN0UmVxdWVzdDoge1xuICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgYmlnaW50OiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/LmZpZWxkcz8ubGFzdFJlcXVlc3QgfHwgXCJsYXN0UmVxdWVzdFwiXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGNvbnN0IHsgdXNlciwgc2Vzc2lvbiwgYWNjb3VudCwgLi4ucGx1Z2luVGFibGVzIH0gPSBwbHVnaW5TY2hlbWE7XG4gIGNvbnN0IHNlc3Npb25UYWJsZSA9IHtcbiAgICBzZXNzaW9uOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8ubW9kZWxOYW1lIHx8IFwic2Vzc2lvblwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGV4cGlyZXNBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LmV4cGlyZXNBdCB8fCBcImV4cGlyZXNBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy50b2tlbiB8fCBcInRva2VuXCIsXG4gICAgICAgICAgdW5pcXVlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LmNyZWF0ZWRBdCB8fCBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCIsXG4gICAgICAgICAgb25VcGRhdGU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIGlwQWRkcmVzczoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LmlwQWRkcmVzcyB8fCBcImlwQWRkcmVzc1wiXG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJBZ2VudDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnVzZXJBZ2VudCB8fCBcInVzZXJBZ2VudFwiXG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udXNlcklkIHx8IFwidXNlcklkXCIsXG4gICAgICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICAgICAgbW9kZWw6IG9wdGlvbnMudXNlcj8ubW9kZWxOYW1lIHx8IFwidXNlclwiLFxuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIG9uRGVsZXRlOiBcImNhc2NhZGVcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgLi4uc2Vzc2lvbj8uZmllbGRzLFxuICAgICAgICAuLi5vcHRpb25zLnNlc3Npb24/LmFkZGl0aW9uYWxGaWVsZHNcbiAgICAgIH0sXG4gICAgICBvcmRlcjogMlxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIHtcbiAgICB1c2VyOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMudXNlcj8ubW9kZWxOYW1lIHx8IFwidXNlclwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIG5hbWU6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy51c2VyPy5maWVsZHM/Lm5hbWUgfHwgXCJuYW1lXCIsXG4gICAgICAgICAgc29ydGFibGU6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5lbWFpbCB8fCBcImVtYWlsXCIsXG4gICAgICAgICAgc29ydGFibGU6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZmFsc2UsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uZW1haWxWZXJpZmllZCB8fCBcImVtYWlsVmVyaWZpZWRcIixcbiAgICAgICAgICBpbnB1dDogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5pbWFnZSB8fCBcImltYWdlXCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIG9uVXBkYXRlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy51cGRhdGVkQXQgfHwgXCJ1cGRhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICAuLi51c2VyPy5maWVsZHMsXG4gICAgICAgIC4uLm9wdGlvbnMudXNlcj8uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfSxcbiAgICAgIG9yZGVyOiAxXG4gICAgfSxcbiAgICAvL29ubHkgYWRkIHNlc3Npb24gdGFibGUgaWYgaXQncyBub3Qgc3RvcmVkIGluIHNlY29uZGFyeSBzdG9yYWdlXG4gICAgLi4uIW9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSB8fCBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgPyBzZXNzaW9uVGFibGUgOiB7fSxcbiAgICBhY2NvdW50OiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMuYWNjb3VudD8ubW9kZWxOYW1lIHx8IFwiYWNjb3VudFwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGFjY291bnRJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjb3VudElkIHx8IFwiYWNjb3VudElkXCJcbiAgICAgICAgfSxcbiAgICAgICAgcHJvdmlkZXJJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucHJvdmlkZXJJZCB8fCBcInByb3ZpZGVySWRcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICBvbkRlbGV0ZTogXCJjYXNjYWRlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnVzZXJJZCB8fCBcInVzZXJJZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjZXNzVG9rZW4gfHwgXCJhY2Nlc3NUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnJlZnJlc2hUb2tlbiB8fCBcInJlZnJlc2hUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIGlkVG9rZW46IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5pZFRva2VuIHx8IFwiaWRUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmFjY2Vzc1Rva2VuRXhwaXJlc0F0IHx8IFwiYWNjZXNzVG9rZW5FeHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucmVmcmVzaFRva2VuRXhwaXJlc0F0IHx8IFwicmVmcmVzaFRva2VuRXhwaXJlc0F0XCJcbiAgICAgICAgfSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5zY29wZSB8fCBcInNjb3BlXCJcbiAgICAgICAgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5wYXNzd29yZCB8fCBcInBhc3N3b3JkXCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uY3JlYXRlZEF0IHx8IFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy51cGRhdGVkQXQgfHwgXCJ1cGRhdGVkQXRcIixcbiAgICAgICAgICBvblVwZGF0ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgfSxcbiAgICAgICAgLi4uYWNjb3VudD8uZmllbGRzLFxuICAgICAgICAuLi5vcHRpb25zLmFjY291bnQ/LmFkZGl0aW9uYWxGaWVsZHNcbiAgICAgIH0sXG4gICAgICBvcmRlcjogM1xuICAgIH0sXG4gICAgdmVyaWZpY2F0aW9uOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5tb2RlbE5hbWUgfHwgXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBpZGVudGlmaWVyOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmlkZW50aWZpZXIgfHwgXCJpZGVudGlmaWVyXCJcbiAgICAgICAgfSxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8udmFsdWUgfHwgXCJ2YWx1ZVwiXG4gICAgICAgIH0sXG4gICAgICAgIGV4cGlyZXNBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8uZXhwaXJlc0F0IHx8IFwiZXhwaXJlc0F0XCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmNyZWF0ZWRBdCB8fCBcImNyZWF0ZWRBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgb25VcGRhdGU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCJcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9yZGVyOiA0XG4gICAgfSxcbiAgICAuLi5wbHVnaW5UYWJsZXMsXG4gICAgLi4uc2hvdWxkQWRkUmF0ZUxpbWl0VGFibGUgPyByYXRlTGltaXRUYWJsZSA6IHt9XG4gIH07XG59O1xuXG5leHBvcnQgeyBnZXRBdXRoVGFibGVzIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\n");

/***/ })

};
;