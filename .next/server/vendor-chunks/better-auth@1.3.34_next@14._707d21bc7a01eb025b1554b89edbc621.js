"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621";
exports.ids = ["vendor-chunks/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/client/react/index.mjs":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/client/react/index.mjs ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter),\n/* harmony export */   createAuthClient: () => (/* binding */ createAuthClient),\n/* harmony export */   useStore: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var _shared_better_auth_RKafzlkP_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/better-auth.RKafzlkP.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@1.0.1/node_modules/nanostores/listen-keys/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@14.2.33_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/.pnpm/@better-fetch+fetch@1.1.18/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _shared_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/better-auth.DR3R5wdU.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/env */ \"(ssr)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/error */ \"(ssr)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_BYWGbmZ5_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../shared/better-auth.BYWGbmZ5.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs\");\n/* harmony import */ var _shared_better_auth_msGOU0m9_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../shared/better-auth.msGOU0m9.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs\");\n\n\n\n\n\n\n\n\n\n\nfunction useStore(store, options = {}) {\n  let snapshotRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(store.get());\n  const { keys, deps = [store, keys] } = options;\n  let subscribe = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((onChange) => {\n    const emitChange = (value) => {\n      if (snapshotRef.current === value) return;\n      snapshotRef.current = value;\n      onChange();\n    };\n    emitChange(store.value);\n    if (keys?.length) {\n      return (0,nanostores__WEBPACK_IMPORTED_MODULE_8__.listenKeys)(store, keys, emitChange);\n    }\n    return store.listen(emitChange);\n  }, deps);\n  let get = () => snapshotRef.current;\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe, get, get);\n}\n\nfunction getAtomKey(str) {\n  return `use${capitalizeFirstLetter(str)}`;\n}\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nfunction createAuthClient(options) {\n  const {\n    pluginPathMethods,\n    pluginsActions,\n    pluginsAtoms,\n    $fetch,\n    $store,\n    atomListeners\n  } = (0,_shared_better_auth_RKafzlkP_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(options);\n  let resolvedHooks = {};\n  for (const [key, value] of Object.entries(pluginsAtoms)) {\n    resolvedHooks[getAtomKey(key)] = () => useStore(value);\n  }\n  const routes = {\n    ...pluginsActions,\n    ...resolvedHooks,\n    $fetch,\n    $store\n  };\n  const proxy = (0,_shared_better_auth_RKafzlkP_mjs__WEBPACK_IMPORTED_MODULE_0__.c)(\n    routes,\n    $fetch,\n    pluginPathMethods,\n    pluginsAtoms,\n    atomListeners\n  );\n  return proxy;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NsaWVudC9yZWFjdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQTBHO0FBQ2xFO0FBQzBCO0FBQ3JDO0FBQ2tCO0FBQ2hCO0FBQ0U7QUFDYztBQUNBOztBQUUvQyxxQ0FBcUM7QUFDckMsb0JBQW9CLDZDQUFNO0FBQzFCLFVBQVUsNkJBQTZCO0FBQ3ZDLGtCQUFrQixrREFBVztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsc0RBQVU7QUFDdkI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLFNBQVMsMkRBQW9CO0FBQzdCOztBQUVBO0FBQ0EsZUFBZSwyQkFBMkI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxFQUFFLG1FQUFlO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG1FQUFzQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2RCIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jbGllbnQvcmVhY3QvaW5kZXgubWpzPzFjMjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZyBhcyBnZXRDbGllbnRDb25maWcsIGMgYXMgY3JlYXRlRHluYW1pY1BhdGhQcm94eSB9IGZyb20gJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5SS2FmemxrUC5tanMnO1xuaW1wb3J0IHsgbGlzdGVuS2V5cyB9IGZyb20gJ25hbm9zdG9yZXMnO1xuaW1wb3J0IHsgdXNlUmVmLCB1c2VDYWxsYmFjaywgdXNlU3luY0V4dGVybmFsU3RvcmUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgJ0BiZXR0ZXItZmV0Y2gvZmV0Y2gnO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguQllXR2JtWjUubWpzJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLm1zR09VMG05Lm1qcyc7XG5cbmZ1bmN0aW9uIHVzZVN0b3JlKHN0b3JlLCBvcHRpb25zID0ge30pIHtcbiAgbGV0IHNuYXBzaG90UmVmID0gdXNlUmVmKHN0b3JlLmdldCgpKTtcbiAgY29uc3QgeyBrZXlzLCBkZXBzID0gW3N0b3JlLCBrZXlzXSB9ID0gb3B0aW9ucztcbiAgbGV0IHN1YnNjcmliZSA9IHVzZUNhbGxiYWNrKChvbkNoYW5nZSkgPT4ge1xuICAgIGNvbnN0IGVtaXRDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgIGlmIChzbmFwc2hvdFJlZi5jdXJyZW50ID09PSB2YWx1ZSkgcmV0dXJuO1xuICAgICAgc25hcHNob3RSZWYuY3VycmVudCA9IHZhbHVlO1xuICAgICAgb25DaGFuZ2UoKTtcbiAgICB9O1xuICAgIGVtaXRDaGFuZ2Uoc3RvcmUudmFsdWUpO1xuICAgIGlmIChrZXlzPy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBsaXN0ZW5LZXlzKHN0b3JlLCBrZXlzLCBlbWl0Q2hhbmdlKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0b3JlLmxpc3RlbihlbWl0Q2hhbmdlKTtcbiAgfSwgZGVwcyk7XG4gIGxldCBnZXQgPSAoKSA9PiBzbmFwc2hvdFJlZi5jdXJyZW50O1xuICByZXR1cm4gdXNlU3luY0V4dGVybmFsU3RvcmUoc3Vic2NyaWJlLCBnZXQsIGdldCk7XG59XG5cbmZ1bmN0aW9uIGdldEF0b21LZXkoc3RyKSB7XG4gIHJldHVybiBgdXNlJHtjYXBpdGFsaXplRmlyc3RMZXR0ZXIoc3RyKX1gO1xufVxuZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cikge1xuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpO1xufVxuZnVuY3Rpb24gY3JlYXRlQXV0aENsaWVudChvcHRpb25zKSB7XG4gIGNvbnN0IHtcbiAgICBwbHVnaW5QYXRoTWV0aG9kcyxcbiAgICBwbHVnaW5zQWN0aW9ucyxcbiAgICBwbHVnaW5zQXRvbXMsXG4gICAgJGZldGNoLFxuICAgICRzdG9yZSxcbiAgICBhdG9tTGlzdGVuZXJzXG4gIH0gPSBnZXRDbGllbnRDb25maWcob3B0aW9ucyk7XG4gIGxldCByZXNvbHZlZEhvb2tzID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHBsdWdpbnNBdG9tcykpIHtcbiAgICByZXNvbHZlZEhvb2tzW2dldEF0b21LZXkoa2V5KV0gPSAoKSA9PiB1c2VTdG9yZSh2YWx1ZSk7XG4gIH1cbiAgY29uc3Qgcm91dGVzID0ge1xuICAgIC4uLnBsdWdpbnNBY3Rpb25zLFxuICAgIC4uLnJlc29sdmVkSG9va3MsXG4gICAgJGZldGNoLFxuICAgICRzdG9yZVxuICB9O1xuICBjb25zdCBwcm94eSA9IGNyZWF0ZUR5bmFtaWNQYXRoUHJveHkoXG4gICAgcm91dGVzLFxuICAgICRmZXRjaCxcbiAgICBwbHVnaW5QYXRoTWV0aG9kcyxcbiAgICBwbHVnaW5zQXRvbXMsXG4gICAgYXRvbUxpc3RlbmVyc1xuICApO1xuICByZXR1cm4gcHJveHk7XG59XG5cbmV4cG9ydCB7IGNhcGl0YWxpemVGaXJzdExldHRlciwgY3JlYXRlQXV0aENsaWVudCwgdXNlU3RvcmUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/client/react/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   u: () => (/* binding */ useAuthQuery)\n/* harmony export */ });\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@1.0.1/node_modules/nanostores/atom/index.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@1.0.1/node_modules/nanostores/lifecycle/index.js\");\n\n\nconst isServer = typeof window === \"undefined\";\nconst useAuthQuery = (initializedAtom, path, $fetch, options) => {\n  const value = (0,nanostores__WEBPACK_IMPORTED_MODULE_0__.atom)({\n    data: null,\n    error: null,\n    isPending: true,\n    isRefetching: false,\n    refetch: (queryParams) => {\n      return fn(queryParams);\n    }\n  });\n  const fn = (queryParams) => {\n    const opts = typeof options === \"function\" ? options({\n      data: value.get().data,\n      error: value.get().error,\n      isPending: value.get().isPending\n    }) : options;\n    $fetch(path, {\n      ...opts,\n      query: {\n        ...opts?.query,\n        ...queryParams?.query\n      },\n      async onSuccess(context) {\n        value.set({\n          data: context.data,\n          error: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onSuccess?.(context);\n      },\n      async onError(context) {\n        const { request } = context;\n        const retryAttempts = typeof request.retry === \"number\" ? request.retry : request.retry?.attempts;\n        const retryAttempt = request.retryAttempt || 0;\n        if (retryAttempts && retryAttempt < retryAttempts) return;\n        value.set({\n          error: context.error,\n          data: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onError?.(context);\n      },\n      async onRequest(context) {\n        const currentValue = value.get();\n        value.set({\n          isPending: currentValue.data === null,\n          data: currentValue.data,\n          error: null,\n          isRefetching: true,\n          refetch: value.value.refetch\n        });\n        await opts?.onRequest?.(context);\n      }\n    }).catch((error) => {\n      value.set({\n        error,\n        data: null,\n        isPending: false,\n        isRefetching: false,\n        refetch: value.value.refetch\n      });\n    });\n  };\n  initializedAtom = Array.isArray(initializedAtom) ? initializedAtom : [initializedAtom];\n  let isMounted = false;\n  for (const initAtom of initializedAtom) {\n    initAtom.subscribe(() => {\n      if (isServer) {\n        return;\n      }\n      if (isMounted) {\n        fn();\n      } else {\n        (0,nanostores__WEBPACK_IMPORTED_MODULE_1__.onMount)(value, () => {\n          const timeoutId = setTimeout(() => {\n            if (!isMounted) {\n              fn();\n              isMounted = true;\n            }\n          }, 0);\n          return () => {\n            value.off();\n            initAtom.off();\n            clearTimeout(timeoutId);\n          };\n        });\n      }\n    });\n  }\n  return value;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CWVdHYm1aNS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDOztBQUUzQztBQUNBO0FBQ0EsZ0JBQWdCLGdEQUFJO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixRQUFRLG1EQUFPO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFNkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkJZV0dibVo1Lm1qcz82MjRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGF0b20sIG9uTW91bnQgfSBmcm9tICduYW5vc3RvcmVzJztcblxuY29uc3QgaXNTZXJ2ZXIgPSB0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiO1xuY29uc3QgdXNlQXV0aFF1ZXJ5ID0gKGluaXRpYWxpemVkQXRvbSwgcGF0aCwgJGZldGNoLCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHZhbHVlID0gYXRvbSh7XG4gICAgZGF0YTogbnVsbCxcbiAgICBlcnJvcjogbnVsbCxcbiAgICBpc1BlbmRpbmc6IHRydWUsXG4gICAgaXNSZWZldGNoaW5nOiBmYWxzZSxcbiAgICByZWZldGNoOiAocXVlcnlQYXJhbXMpID0+IHtcbiAgICAgIHJldHVybiBmbihxdWVyeVBhcmFtcyk7XG4gICAgfVxuICB9KTtcbiAgY29uc3QgZm4gPSAocXVlcnlQYXJhbXMpID0+IHtcbiAgICBjb25zdCBvcHRzID0gdHlwZW9mIG9wdGlvbnMgPT09IFwiZnVuY3Rpb25cIiA/IG9wdGlvbnMoe1xuICAgICAgZGF0YTogdmFsdWUuZ2V0KCkuZGF0YSxcbiAgICAgIGVycm9yOiB2YWx1ZS5nZXQoKS5lcnJvcixcbiAgICAgIGlzUGVuZGluZzogdmFsdWUuZ2V0KCkuaXNQZW5kaW5nXG4gICAgfSkgOiBvcHRpb25zO1xuICAgICRmZXRjaChwYXRoLCB7XG4gICAgICAuLi5vcHRzLFxuICAgICAgcXVlcnk6IHtcbiAgICAgICAgLi4ub3B0cz8ucXVlcnksXG4gICAgICAgIC4uLnF1ZXJ5UGFyYW1zPy5xdWVyeVxuICAgICAgfSxcbiAgICAgIGFzeW5jIG9uU3VjY2Vzcyhjb250ZXh0KSB7XG4gICAgICAgIHZhbHVlLnNldCh7XG4gICAgICAgICAgZGF0YTogY29udGV4dC5kYXRhLFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIGlzUGVuZGluZzogZmFsc2UsXG4gICAgICAgICAgaXNSZWZldGNoaW5nOiBmYWxzZSxcbiAgICAgICAgICByZWZldGNoOiB2YWx1ZS52YWx1ZS5yZWZldGNoXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBvcHRzPy5vblN1Y2Nlc3M/Lihjb250ZXh0KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBvbkVycm9yKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgeyByZXF1ZXN0IH0gPSBjb250ZXh0O1xuICAgICAgICBjb25zdCByZXRyeUF0dGVtcHRzID0gdHlwZW9mIHJlcXVlc3QucmV0cnkgPT09IFwibnVtYmVyXCIgPyByZXF1ZXN0LnJldHJ5IDogcmVxdWVzdC5yZXRyeT8uYXR0ZW1wdHM7XG4gICAgICAgIGNvbnN0IHJldHJ5QXR0ZW1wdCA9IHJlcXVlc3QucmV0cnlBdHRlbXB0IHx8IDA7XG4gICAgICAgIGlmIChyZXRyeUF0dGVtcHRzICYmIHJldHJ5QXR0ZW1wdCA8IHJldHJ5QXR0ZW1wdHMpIHJldHVybjtcbiAgICAgICAgdmFsdWUuc2V0KHtcbiAgICAgICAgICBlcnJvcjogY29udGV4dC5lcnJvcixcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIGlzUGVuZGluZzogZmFsc2UsXG4gICAgICAgICAgaXNSZWZldGNoaW5nOiBmYWxzZSxcbiAgICAgICAgICByZWZldGNoOiB2YWx1ZS52YWx1ZS5yZWZldGNoXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBvcHRzPy5vbkVycm9yPy4oY29udGV4dCk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgb25SZXF1ZXN0KGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gdmFsdWUuZ2V0KCk7XG4gICAgICAgIHZhbHVlLnNldCh7XG4gICAgICAgICAgaXNQZW5kaW5nOiBjdXJyZW50VmFsdWUuZGF0YSA9PT0gbnVsbCxcbiAgICAgICAgICBkYXRhOiBjdXJyZW50VmFsdWUuZGF0YSxcbiAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICBpc1JlZmV0Y2hpbmc6IHRydWUsXG4gICAgICAgICAgcmVmZXRjaDogdmFsdWUudmFsdWUucmVmZXRjaFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgb3B0cz8ub25SZXF1ZXN0Py4oY29udGV4dCk7XG4gICAgICB9XG4gICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB2YWx1ZS5zZXQoe1xuICAgICAgICBlcnJvcixcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaXNQZW5kaW5nOiBmYWxzZSxcbiAgICAgICAgaXNSZWZldGNoaW5nOiBmYWxzZSxcbiAgICAgICAgcmVmZXRjaDogdmFsdWUudmFsdWUucmVmZXRjaFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG4gIGluaXRpYWxpemVkQXRvbSA9IEFycmF5LmlzQXJyYXkoaW5pdGlhbGl6ZWRBdG9tKSA/IGluaXRpYWxpemVkQXRvbSA6IFtpbml0aWFsaXplZEF0b21dO1xuICBsZXQgaXNNb3VudGVkID0gZmFsc2U7XG4gIGZvciAoY29uc3QgaW5pdEF0b20gb2YgaW5pdGlhbGl6ZWRBdG9tKSB7XG4gICAgaW5pdEF0b20uc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgIGlmIChpc1NlcnZlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaXNNb3VudGVkKSB7XG4gICAgICAgIGZuKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbk1vdW50KHZhbHVlLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzTW91bnRlZCkge1xuICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgICBpc01vdW50ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIDApO1xuICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB2YWx1ZS5vZmYoKTtcbiAgICAgICAgICAgIGluaXRBdG9tLm9mZigpO1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufTtcblxuZXhwb3J0IHsgdXNlQXV0aFF1ZXJ5IGFzIHUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getBaseURL),\n/* harmony export */   b: () => (/* binding */ getHost),\n/* harmony export */   c: () => (/* binding */ getProtocol),\n/* harmony export */   g: () => (/* binding */ getOrigin)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(ssr)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/error */ \"(ssr)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n\n\n\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    const pathname = parsedUrl.pathname.replace(/\\/+$/, \"\") || \"/\";\n    return pathname !== \"/\";\n  } catch (error) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  const trimmedUrl = url.replace(/\\/+$/, \"\");\n  if (!path || path === \"/\") {\n    return trimmedUrl;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${trimmedUrl}${path}`;\n}\nfunction getBaseURL(url, path, request, loadEnv) {\n  if (url) {\n    return withPath(url, path);\n  }\n  if (loadEnv !== false) {\n    const fromEnv = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n    if (fromEnv) {\n      return withPath(fromEnv, path);\n    }\n  }\n  const fromRequest = request?.headers.get(\"x-forwarded-host\");\n  const fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n  if (fromRequest && fromRequestProto) {\n    return withPath(`${fromRequestProto}://${fromRequest}`, path);\n  }\n  if (request) {\n    const url2 = getOrigin(request.url);\n    if (!url2) {\n      throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n        \"Could not get origin from request. Please provide a valid base URL.\"\n      );\n    }\n    return withPath(url2, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  } catch (error) {\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTRDO0FBQ2M7O0FBRTFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osY0FBYyxvRUFBZTtBQUM3QiwyQkFBMkIsSUFBSTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsS0FBSztBQUNoRCxZQUFZLFdBQVcsRUFBRSxLQUFLO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzREFBRyxvQkFBb0Isc0RBQUcsZ0NBQWdDLHNEQUFHLDJCQUEyQixzREFBRyxnQ0FBZ0Msc0RBQUcsMEJBQTBCLHNEQUFHLG9CQUFvQixzREFBRztBQUN0TTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUIsS0FBSyxZQUFZO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9FQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUUyRSIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzPzY5YTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZW52IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcblxuZnVuY3Rpb24gY2hlY2tIYXNQYXRoKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICBjb25zdCBwYXRobmFtZSA9IHBhcnNlZFVybC5wYXRobmFtZS5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpIHx8IFwiL1wiO1xuICAgIHJldHVybiBwYXRobmFtZSAhPT0gXCIvXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIGBJbnZhbGlkIGJhc2UgVVJMOiAke3VybH0uIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIHdpdGhQYXRoKHVybCwgcGF0aCA9IFwiL2FwaS9hdXRoXCIpIHtcbiAgY29uc3QgaGFzUGF0aCA9IGNoZWNrSGFzUGF0aCh1cmwpO1xuICBpZiAoaGFzUGF0aCkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgY29uc3QgdHJpbW1lZFVybCA9IHVybC5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpO1xuICBpZiAoIXBhdGggfHwgcGF0aCA9PT0gXCIvXCIpIHtcbiAgICByZXR1cm4gdHJpbW1lZFVybDtcbiAgfVxuICBwYXRoID0gcGF0aC5zdGFydHNXaXRoKFwiL1wiKSA/IHBhdGggOiBgLyR7cGF0aH1gO1xuICByZXR1cm4gYCR7dHJpbW1lZFVybH0ke3BhdGh9YDtcbn1cbmZ1bmN0aW9uIGdldEJhc2VVUkwodXJsLCBwYXRoLCByZXF1ZXN0LCBsb2FkRW52KSB7XG4gIGlmICh1cmwpIHtcbiAgICByZXR1cm4gd2l0aFBhdGgodXJsLCBwYXRoKTtcbiAgfVxuICBpZiAobG9hZEVudiAhPT0gZmFsc2UpIHtcbiAgICBjb25zdCBmcm9tRW52ID0gZW52LkJFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTkVYVF9QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5OVVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0FVVEhfVVJMIHx8IChlbnYuQkFTRV9VUkwgIT09IFwiL1wiID8gZW52LkJBU0VfVVJMIDogdm9pZCAwKTtcbiAgICBpZiAoZnJvbUVudikge1xuICAgICAgcmV0dXJuIHdpdGhQYXRoKGZyb21FbnYsIHBhdGgpO1xuICAgIH1cbiAgfVxuICBjb25zdCBmcm9tUmVxdWVzdCA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtaG9zdFwiKTtcbiAgY29uc3QgZnJvbVJlcXVlc3RQcm90byA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtcHJvdG9cIik7XG4gIGlmIChmcm9tUmVxdWVzdCAmJiBmcm9tUmVxdWVzdFByb3RvKSB7XG4gICAgcmV0dXJuIHdpdGhQYXRoKGAke2Zyb21SZXF1ZXN0UHJvdG99Oi8vJHtmcm9tUmVxdWVzdH1gLCBwYXRoKTtcbiAgfVxuICBpZiAocmVxdWVzdCkge1xuICAgIGNvbnN0IHVybDIgPSBnZXRPcmlnaW4ocmVxdWVzdC51cmwpO1xuICAgIGlmICghdXJsMikge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJDb3VsZCBub3QgZ2V0IG9yaWdpbiBmcm9tIHJlcXVlc3QuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB3aXRoUGF0aCh1cmwyLCBwYXRoKTtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgod2luZG93LmxvY2F0aW9uLm9yaWdpbiwgcGF0aCk7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGdldE9yaWdpbih1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5vcmlnaW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFByb3RvY29sKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLnByb3RvY29sO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRIb3N0KHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3Q7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IHsgZ2V0QmFzZVVSTCBhcyBhLCBnZXRIb3N0IGFzIGIsIGdldFByb3RvY29sIGFzIGMsIGdldE9yaWdpbiBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createDynamicPathProxy),\n/* harmony export */   g: () => (/* binding */ getClientConfig)\n/* harmony export */ });\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/.pnpm/@better-fetch+fetch@1.1.18/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@1.0.1/node_modules/nanostores/atom/index.js\");\n/* harmony import */ var _better_auth_BYWGbmZ5_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.BYWGbmZ5.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BYWGbmZ5.mjs\");\n/* harmony import */ var _better_auth_msGOU0m9_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.msGOU0m9.mjs */ \"(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs\");\n\n\n\n\n\n\nconst redirectPlugin = {\n  id: \"redirect\",\n  name: \"Redirect\",\n  hooks: {\n    onSuccess(context) {\n      if (context.data?.url && context.data?.redirect) {\n        if (typeof window !== \"undefined\" && window.location) {\n          if (window.location) {\n            try {\n              window.location.href = context.data.url;\n            } catch {\n            }\n          }\n        }\n      }\n    }\n  }\n};\n\nfunction getSessionAtom($fetch) {\n  const $signal = (0,nanostores__WEBPACK_IMPORTED_MODULE_4__.atom)(false);\n  const session = (0,_better_auth_BYWGbmZ5_mjs__WEBPACK_IMPORTED_MODULE_2__.u)($signal, \"/get-session\", $fetch, {\n    method: \"GET\"\n  });\n  return {\n    session,\n    $sessionSignal: $signal\n  };\n}\n\nconst getClientConfig = (options, loadEnv) => {\n  const isCredentialsSupported = \"credentials\" in Request.prototype;\n  const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(options?.baseURL, options?.basePath, void 0, loadEnv) ?? \"/api/auth\";\n  const pluginsFetchPlugins = options?.plugins?.flatMap((plugin) => plugin.fetchPlugins).filter((pl) => pl !== void 0) || [];\n  const lifeCyclePlugin = {\n    id: \"lifecycle-hooks\",\n    name: \"lifecycle-hooks\",\n    hooks: {\n      onSuccess: options?.fetchOptions?.onSuccess,\n      onError: options?.fetchOptions?.onError,\n      onRequest: options?.fetchOptions?.onRequest,\n      onResponse: options?.fetchOptions?.onResponse\n    }\n  };\n  const { onSuccess, onError, onRequest, onResponse, ...restOfFetchOptions } = options?.fetchOptions || {};\n  const $fetch = (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.createFetch)({\n    baseURL,\n    ...isCredentialsSupported ? { credentials: \"include\" } : {},\n    method: \"GET\",\n    jsonParser(text) {\n      if (!text) {\n        return null;\n      }\n      return (0,_better_auth_msGOU0m9_mjs__WEBPACK_IMPORTED_MODULE_3__.p)(text, {\n        strict: false\n      });\n    },\n    customFetchImpl: fetch,\n    ...restOfFetchOptions,\n    plugins: [\n      lifeCyclePlugin,\n      ...restOfFetchOptions.plugins || [],\n      ...options?.disableDefaultFetchPlugins ? [] : [redirectPlugin],\n      ...pluginsFetchPlugins\n    ]\n  });\n  const { $sessionSignal, session } = getSessionAtom($fetch);\n  const plugins = options?.plugins || [];\n  let pluginsActions = {};\n  let pluginsAtoms = {\n    $sessionSignal,\n    session\n  };\n  let pluginPathMethods = {\n    \"/sign-out\": \"POST\",\n    \"/revoke-sessions\": \"POST\",\n    \"/revoke-other-sessions\": \"POST\",\n    \"/delete-user\": \"POST\"\n  };\n  const atomListeners = [\n    {\n      signal: \"$sessionSignal\",\n      matcher(path) {\n        return path === \"/sign-out\" || path === \"/update-user\" || path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path === \"/delete-user\" || path === \"/verify-email\";\n      }\n    }\n  ];\n  for (const plugin of plugins) {\n    if (plugin.getAtoms) {\n      Object.assign(pluginsAtoms, plugin.getAtoms?.($fetch));\n    }\n    if (plugin.pathMethods) {\n      Object.assign(pluginPathMethods, plugin.pathMethods);\n    }\n    if (plugin.atomListeners) {\n      atomListeners.push(...plugin.atomListeners);\n    }\n  }\n  const $store = {\n    notify: (signal) => {\n      pluginsAtoms[signal].set(\n        !pluginsAtoms[signal].get()\n      );\n    },\n    listen: (signal, listener) => {\n      pluginsAtoms[signal].subscribe(listener);\n    },\n    atoms: pluginsAtoms\n  };\n  for (const plugin of plugins) {\n    if (plugin.getActions) {\n      Object.assign(\n        pluginsActions,\n        plugin.getActions?.($fetch, $store, options)\n      );\n    }\n  }\n  return {\n    get baseURL() {\n      return baseURL;\n    },\n    pluginsActions,\n    pluginsAtoms,\n    pluginPathMethods,\n    atomListeners,\n    $fetch,\n    $store\n  };\n};\n\nfunction isAtom(value) {\n  return typeof value === \"object\" && value !== null && \"get\" in value && typeof value.get === \"function\" && \"lc\" in value && typeof value.lc === \"number\";\n}\n\nfunction getMethod(path, knownPathMethods, args) {\n  const method = knownPathMethods[path];\n  const { fetchOptions, query, ...body } = args || {};\n  if (method) {\n    return method;\n  }\n  if (fetchOptions?.method) {\n    return fetchOptions.method;\n  }\n  if (body && Object.keys(body).length > 0) {\n    return \"POST\";\n  }\n  return \"GET\";\n}\nfunction createDynamicPathProxy(routes, client, knownPathMethods, atoms, atomListeners) {\n  function createProxy(path = []) {\n    return new Proxy(function() {\n    }, {\n      get(_, prop) {\n        if (typeof prop !== \"string\") {\n          return void 0;\n        }\n        if (prop === \"then\" || prop === \"catch\" || prop === \"finally\") {\n          return void 0;\n        }\n        const fullPath = [...path, prop];\n        let current = routes;\n        for (const segment of fullPath) {\n          if (current && typeof current === \"object\" && segment in current) {\n            current = current[segment];\n          } else {\n            current = void 0;\n            break;\n          }\n        }\n        if (typeof current === \"function\") {\n          return current;\n        }\n        if (isAtom(current)) {\n          return current;\n        }\n        return createProxy(fullPath);\n      },\n      apply: async (_, __, args) => {\n        const routePath = \"/\" + path.map(\n          (segment) => segment.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`)\n        ).join(\"/\");\n        const arg = args[0] || {};\n        const fetchOptions = args[1] || {};\n        const { query, fetchOptions: argFetchOptions, ...body } = arg;\n        const options = {\n          ...fetchOptions,\n          ...argFetchOptions\n        };\n        const method = getMethod(routePath, knownPathMethods, arg);\n        return await client(routePath, {\n          ...options,\n          body: method === \"GET\" ? void 0 : {\n            ...body,\n            ...options?.body || {}\n          },\n          query: query || options?.query,\n          method,\n          async onSuccess(context) {\n            await options?.onSuccess?.(context);\n            if (!atomListeners) return;\n            const matches = atomListeners.filter((s) => s.matcher(routePath));\n            if (!matches.length) return;\n            for (const match of matches) {\n              const signal = atoms[match.signal];\n              if (!signal) return;\n              const val = signal.get();\n              setTimeout(() => {\n                signal.set(!val);\n              }, 10);\n            }\n          }\n        });\n      }\n    });\n  }\n  return createProxy();\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5SS2FmemxrUC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFrRDtBQUNXO0FBQzNCO0FBQzZCO0FBQ0g7O0FBRTVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCLGdEQUFJO0FBQ3RCLGtCQUFrQiw0REFBWTtBQUM5QjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0IsNERBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUVBQW1FO0FBQzdFLGlCQUFpQixnRUFBVztBQUM1QjtBQUNBLGtDQUFrQyx5QkFBeUIsSUFBSTtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw0REFBUztBQUN0QjtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxVQUFVLDBCQUEwQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVSwrQkFBK0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsaUVBQWlFLHFCQUFxQjtBQUN0RjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0RBQWdEO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUU2RCIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguUkthZnpsa1AubWpzP2ZkYjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCB7IGEgYXMgZ2V0QmFzZVVSTCB9IGZyb20gJy4vYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzJztcbmltcG9ydCB7IGF0b20gfSBmcm9tICduYW5vc3RvcmVzJztcbmltcG9ydCB7IHUgYXMgdXNlQXV0aFF1ZXJ5IH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CWVdHYm1aNS5tanMnO1xuaW1wb3J0IHsgcCBhcyBwYXJzZUpTT04gfSBmcm9tICcuL2JldHRlci1hdXRoLm1zR09VMG05Lm1qcyc7XG5cbmNvbnN0IHJlZGlyZWN0UGx1Z2luID0ge1xuICBpZDogXCJyZWRpcmVjdFwiLFxuICBuYW1lOiBcIlJlZGlyZWN0XCIsXG4gIGhvb2tzOiB7XG4gICAgb25TdWNjZXNzKGNvbnRleHQpIHtcbiAgICAgIGlmIChjb250ZXh0LmRhdGE/LnVybCAmJiBjb250ZXh0LmRhdGE/LnJlZGlyZWN0KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbikge1xuICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY29udGV4dC5kYXRhLnVybDtcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gZ2V0U2Vzc2lvbkF0b20oJGZldGNoKSB7XG4gIGNvbnN0ICRzaWduYWwgPSBhdG9tKGZhbHNlKTtcbiAgY29uc3Qgc2Vzc2lvbiA9IHVzZUF1dGhRdWVyeSgkc2lnbmFsLCBcIi9nZXQtc2Vzc2lvblwiLCAkZmV0Y2gsIHtcbiAgICBtZXRob2Q6IFwiR0VUXCJcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgc2Vzc2lvbixcbiAgICAkc2Vzc2lvblNpZ25hbDogJHNpZ25hbFxuICB9O1xufVxuXG5jb25zdCBnZXRDbGllbnRDb25maWcgPSAob3B0aW9ucywgbG9hZEVudikgPT4ge1xuICBjb25zdCBpc0NyZWRlbnRpYWxzU3VwcG9ydGVkID0gXCJjcmVkZW50aWFsc1wiIGluIFJlcXVlc3QucHJvdG90eXBlO1xuICBjb25zdCBiYXNlVVJMID0gZ2V0QmFzZVVSTChvcHRpb25zPy5iYXNlVVJMLCBvcHRpb25zPy5iYXNlUGF0aCwgdm9pZCAwLCBsb2FkRW52KSA/PyBcIi9hcGkvYXV0aFwiO1xuICBjb25zdCBwbHVnaW5zRmV0Y2hQbHVnaW5zID0gb3B0aW9ucz8ucGx1Z2lucz8uZmxhdE1hcCgocGx1Z2luKSA9PiBwbHVnaW4uZmV0Y2hQbHVnaW5zKS5maWx0ZXIoKHBsKSA9PiBwbCAhPT0gdm9pZCAwKSB8fCBbXTtcbiAgY29uc3QgbGlmZUN5Y2xlUGx1Z2luID0ge1xuICAgIGlkOiBcImxpZmVjeWNsZS1ob29rc1wiLFxuICAgIG5hbWU6IFwibGlmZWN5Y2xlLWhvb2tzXCIsXG4gICAgaG9va3M6IHtcbiAgICAgIG9uU3VjY2Vzczogb3B0aW9ucz8uZmV0Y2hPcHRpb25zPy5vblN1Y2Nlc3MsXG4gICAgICBvbkVycm9yOiBvcHRpb25zPy5mZXRjaE9wdGlvbnM/Lm9uRXJyb3IsXG4gICAgICBvblJlcXVlc3Q6IG9wdGlvbnM/LmZldGNoT3B0aW9ucz8ub25SZXF1ZXN0LFxuICAgICAgb25SZXNwb25zZTogb3B0aW9ucz8uZmV0Y2hPcHRpb25zPy5vblJlc3BvbnNlXG4gICAgfVxuICB9O1xuICBjb25zdCB7IG9uU3VjY2Vzcywgb25FcnJvciwgb25SZXF1ZXN0LCBvblJlc3BvbnNlLCAuLi5yZXN0T2ZGZXRjaE9wdGlvbnMgfSA9IG9wdGlvbnM/LmZldGNoT3B0aW9ucyB8fCB7fTtcbiAgY29uc3QgJGZldGNoID0gY3JlYXRlRmV0Y2goe1xuICAgIGJhc2VVUkwsXG4gICAgLi4uaXNDcmVkZW50aWFsc1N1cHBvcnRlZCA/IHsgY3JlZGVudGlhbHM6IFwiaW5jbHVkZVwiIH0gOiB7fSxcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAganNvblBhcnNlcih0ZXh0KSB7XG4gICAgICBpZiAoIXRleHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyc2VKU09OKHRleHQsIHtcbiAgICAgICAgc3RyaWN0OiBmYWxzZVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBjdXN0b21GZXRjaEltcGw6IGZldGNoLFxuICAgIC4uLnJlc3RPZkZldGNoT3B0aW9ucyxcbiAgICBwbHVnaW5zOiBbXG4gICAgICBsaWZlQ3ljbGVQbHVnaW4sXG4gICAgICAuLi5yZXN0T2ZGZXRjaE9wdGlvbnMucGx1Z2lucyB8fCBbXSxcbiAgICAgIC4uLm9wdGlvbnM/LmRpc2FibGVEZWZhdWx0RmV0Y2hQbHVnaW5zID8gW10gOiBbcmVkaXJlY3RQbHVnaW5dLFxuICAgICAgLi4ucGx1Z2luc0ZldGNoUGx1Z2luc1xuICAgIF1cbiAgfSk7XG4gIGNvbnN0IHsgJHNlc3Npb25TaWduYWwsIHNlc3Npb24gfSA9IGdldFNlc3Npb25BdG9tKCRmZXRjaCk7XG4gIGNvbnN0IHBsdWdpbnMgPSBvcHRpb25zPy5wbHVnaW5zIHx8IFtdO1xuICBsZXQgcGx1Z2luc0FjdGlvbnMgPSB7fTtcbiAgbGV0IHBsdWdpbnNBdG9tcyA9IHtcbiAgICAkc2Vzc2lvblNpZ25hbCxcbiAgICBzZXNzaW9uXG4gIH07XG4gIGxldCBwbHVnaW5QYXRoTWV0aG9kcyA9IHtcbiAgICBcIi9zaWduLW91dFwiOiBcIlBPU1RcIixcbiAgICBcIi9yZXZva2Utc2Vzc2lvbnNcIjogXCJQT1NUXCIsXG4gICAgXCIvcmV2b2tlLW90aGVyLXNlc3Npb25zXCI6IFwiUE9TVFwiLFxuICAgIFwiL2RlbGV0ZS11c2VyXCI6IFwiUE9TVFwiXG4gIH07XG4gIGNvbnN0IGF0b21MaXN0ZW5lcnMgPSBbXG4gICAge1xuICAgICAgc2lnbmFsOiBcIiRzZXNzaW9uU2lnbmFsXCIsXG4gICAgICBtYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHBhdGggPT09IFwiL3NpZ24tb3V0XCIgfHwgcGF0aCA9PT0gXCIvdXBkYXRlLXVzZXJcIiB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi1pblwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi11cFwiKSB8fCBwYXRoID09PSBcIi9kZWxldGUtdXNlclwiIHx8IHBhdGggPT09IFwiL3ZlcmlmeS1lbWFpbFwiO1xuICAgICAgfVxuICAgIH1cbiAgXTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2YgcGx1Z2lucykge1xuICAgIGlmIChwbHVnaW4uZ2V0QXRvbXMpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24ocGx1Z2luc0F0b21zLCBwbHVnaW4uZ2V0QXRvbXM/LigkZmV0Y2gpKTtcbiAgICB9XG4gICAgaWYgKHBsdWdpbi5wYXRoTWV0aG9kcykge1xuICAgICAgT2JqZWN0LmFzc2lnbihwbHVnaW5QYXRoTWV0aG9kcywgcGx1Z2luLnBhdGhNZXRob2RzKTtcbiAgICB9XG4gICAgaWYgKHBsdWdpbi5hdG9tTGlzdGVuZXJzKSB7XG4gICAgICBhdG9tTGlzdGVuZXJzLnB1c2goLi4ucGx1Z2luLmF0b21MaXN0ZW5lcnMpO1xuICAgIH1cbiAgfVxuICBjb25zdCAkc3RvcmUgPSB7XG4gICAgbm90aWZ5OiAoc2lnbmFsKSA9PiB7XG4gICAgICBwbHVnaW5zQXRvbXNbc2lnbmFsXS5zZXQoXG4gICAgICAgICFwbHVnaW5zQXRvbXNbc2lnbmFsXS5nZXQoKVxuICAgICAgKTtcbiAgICB9LFxuICAgIGxpc3RlbjogKHNpZ25hbCwgbGlzdGVuZXIpID0+IHtcbiAgICAgIHBsdWdpbnNBdG9tc1tzaWduYWxdLnN1YnNjcmliZShsaXN0ZW5lcik7XG4gICAgfSxcbiAgICBhdG9tczogcGx1Z2luc0F0b21zXG4gIH07XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIHBsdWdpbnMpIHtcbiAgICBpZiAocGx1Z2luLmdldEFjdGlvbnMpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24oXG4gICAgICAgIHBsdWdpbnNBY3Rpb25zLFxuICAgICAgICBwbHVnaW4uZ2V0QWN0aW9ucz8uKCRmZXRjaCwgJHN0b3JlLCBvcHRpb25zKVxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBnZXQgYmFzZVVSTCgpIHtcbiAgICAgIHJldHVybiBiYXNlVVJMO1xuICAgIH0sXG4gICAgcGx1Z2luc0FjdGlvbnMsXG4gICAgcGx1Z2luc0F0b21zLFxuICAgIHBsdWdpblBhdGhNZXRob2RzLFxuICAgIGF0b21MaXN0ZW5lcnMsXG4gICAgJGZldGNoLFxuICAgICRzdG9yZVxuICB9O1xufTtcblxuZnVuY3Rpb24gaXNBdG9tKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUgIT09IG51bGwgJiYgXCJnZXRcIiBpbiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUuZ2V0ID09PSBcImZ1bmN0aW9uXCIgJiYgXCJsY1wiIGluIHZhbHVlICYmIHR5cGVvZiB2YWx1ZS5sYyA9PT0gXCJudW1iZXJcIjtcbn1cblxuZnVuY3Rpb24gZ2V0TWV0aG9kKHBhdGgsIGtub3duUGF0aE1ldGhvZHMsIGFyZ3MpIHtcbiAgY29uc3QgbWV0aG9kID0ga25vd25QYXRoTWV0aG9kc1twYXRoXTtcbiAgY29uc3QgeyBmZXRjaE9wdGlvbnMsIHF1ZXJ5LCAuLi5ib2R5IH0gPSBhcmdzIHx8IHt9O1xuICBpZiAobWV0aG9kKSB7XG4gICAgcmV0dXJuIG1ldGhvZDtcbiAgfVxuICBpZiAoZmV0Y2hPcHRpb25zPy5tZXRob2QpIHtcbiAgICByZXR1cm4gZmV0Y2hPcHRpb25zLm1ldGhvZDtcbiAgfVxuICBpZiAoYm9keSAmJiBPYmplY3Qua2V5cyhib2R5KS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIFwiUE9TVFwiO1xuICB9XG4gIHJldHVybiBcIkdFVFwiO1xufVxuZnVuY3Rpb24gY3JlYXRlRHluYW1pY1BhdGhQcm94eShyb3V0ZXMsIGNsaWVudCwga25vd25QYXRoTWV0aG9kcywgYXRvbXMsIGF0b21MaXN0ZW5lcnMpIHtcbiAgZnVuY3Rpb24gY3JlYXRlUHJveHkocGF0aCA9IFtdKSB7XG4gICAgcmV0dXJuIG5ldyBQcm94eShmdW5jdGlvbigpIHtcbiAgICB9LCB7XG4gICAgICBnZXQoXywgcHJvcCkge1xuICAgICAgICBpZiAodHlwZW9mIHByb3AgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9wID09PSBcInRoZW5cIiB8fCBwcm9wID09PSBcImNhdGNoXCIgfHwgcHJvcCA9PT0gXCJmaW5hbGx5XCIpIHtcbiAgICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gWy4uLnBhdGgsIHByb3BdO1xuICAgICAgICBsZXQgY3VycmVudCA9IHJvdXRlcztcbiAgICAgICAgZm9yIChjb25zdCBzZWdtZW50IG9mIGZ1bGxQYXRoKSB7XG4gICAgICAgICAgaWYgKGN1cnJlbnQgJiYgdHlwZW9mIGN1cnJlbnQgPT09IFwib2JqZWN0XCIgJiYgc2VnbWVudCBpbiBjdXJyZW50KSB7XG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtzZWdtZW50XTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3VycmVudCA9IHZvaWQgMDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0F0b20oY3VycmVudCkpIHtcbiAgICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlUHJveHkoZnVsbFBhdGgpO1xuICAgICAgfSxcbiAgICAgIGFwcGx5OiBhc3luYyAoXywgX18sIGFyZ3MpID0+IHtcbiAgICAgICAgY29uc3Qgcm91dGVQYXRoID0gXCIvXCIgKyBwYXRoLm1hcChcbiAgICAgICAgICAoc2VnbWVudCkgPT4gc2VnbWVudC5yZXBsYWNlKC9bQS1aXS9nLCAobGV0dGVyKSA9PiBgLSR7bGV0dGVyLnRvTG93ZXJDYXNlKCl9YClcbiAgICAgICAgKS5qb2luKFwiL1wiKTtcbiAgICAgICAgY29uc3QgYXJnID0gYXJnc1swXSB8fCB7fTtcbiAgICAgICAgY29uc3QgZmV0Y2hPcHRpb25zID0gYXJnc1sxXSB8fCB7fTtcbiAgICAgICAgY29uc3QgeyBxdWVyeSwgZmV0Y2hPcHRpb25zOiBhcmdGZXRjaE9wdGlvbnMsIC4uLmJvZHkgfSA9IGFyZztcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAuLi5mZXRjaE9wdGlvbnMsXG4gICAgICAgICAgLi4uYXJnRmV0Y2hPcHRpb25zXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IGdldE1ldGhvZChyb3V0ZVBhdGgsIGtub3duUGF0aE1ldGhvZHMsIGFyZyk7XG4gICAgICAgIHJldHVybiBhd2FpdCBjbGllbnQocm91dGVQYXRoLCB7XG4gICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICBib2R5OiBtZXRob2QgPT09IFwiR0VUXCIgPyB2b2lkIDAgOiB7XG4gICAgICAgICAgICAuLi5ib2R5LFxuICAgICAgICAgICAgLi4ub3B0aW9ucz8uYm9keSB8fCB7fVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5IHx8IG9wdGlvbnM/LnF1ZXJ5LFxuICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgICBhc3luYyBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgICAgICAgYXdhaXQgb3B0aW9ucz8ub25TdWNjZXNzPy4oY29udGV4dCk7XG4gICAgICAgICAgICBpZiAoIWF0b21MaXN0ZW5lcnMpIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBhdG9tTGlzdGVuZXJzLmZpbHRlcigocykgPT4gcy5tYXRjaGVyKHJvdXRlUGF0aCkpO1xuICAgICAgICAgICAgaWYgKCFtYXRjaGVzLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHNpZ25hbCA9IGF0b21zW21hdGNoLnNpZ25hbF07XG4gICAgICAgICAgICAgIGlmICghc2lnbmFsKSByZXR1cm47XG4gICAgICAgICAgICAgIGNvbnN0IHZhbCA9IHNpZ25hbC5nZXQoKTtcbiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2lnbmFsLnNldCghdmFsKTtcbiAgICAgICAgICAgICAgfSwgMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZVByb3h5KCk7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZUR5bmFtaWNQYXRoUHJveHkgYXMgYywgZ2V0Q2xpZW50Q29uZmlnIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.RKafzlkP.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   p: () => (/* binding */ parseJSON)\n/* harmony export */ });\nconst PROTO_POLLUTION_PATTERNS = {\n  proto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n  constructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n  protoShort: /\"__proto__\"\\s*:/,\n  constructorShort: /\"constructor\"\\s*:/\n};\nconst JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nconst SPECIAL_VALUES = {\n  true: true,\n  false: false,\n  null: null,\n  undefined: void 0,\n  nan: Number.NaN,\n  infinity: Number.POSITIVE_INFINITY,\n  \"-infinity\": Number.NEGATIVE_INFINITY\n};\nconst ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n  return date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n  const match = ISO_DATE_REGEX.exec(value);\n  if (!match) return null;\n  const [\n    ,\n    year,\n    month,\n    day,\n    hour,\n    minute,\n    second,\n    ms,\n    offsetSign,\n    offsetHour,\n    offsetMinute\n  ] = match;\n  let date = new Date(\n    Date.UTC(\n      parseInt(year, 10),\n      parseInt(month, 10) - 1,\n      parseInt(day, 10),\n      parseInt(hour, 10),\n      parseInt(minute, 10),\n      parseInt(second, 10),\n      ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0\n    )\n  );\n  if (offsetSign) {\n    const offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n    date.setUTCMinutes(date.getUTCMinutes() + offset);\n  }\n  return isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n  const {\n    strict = false,\n    warnings = false,\n    reviver,\n    parseDates = true\n  } = options;\n  if (typeof value !== \"string\") {\n    return value;\n  }\n  const trimmed = value.trim();\n  if (trimmed.length > 0 && trimmed[0] === '\"' && trimmed.endsWith('\"') && !trimmed.slice(1, -1).includes('\"')) {\n    return trimmed.slice(1, -1);\n  }\n  const lowerValue = trimmed.toLowerCase();\n  if (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n    return SPECIAL_VALUES[lowerValue];\n  }\n  if (!JSON_SIGNATURE.test(trimmed)) {\n    if (strict) {\n      throw new SyntaxError(\"[better-json] Invalid JSON\");\n    }\n    return value;\n  }\n  const hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n    ([key, pattern]) => {\n      const matches = pattern.test(trimmed);\n      if (matches && warnings) {\n        console.warn(\n          `[better-json] Detected potential prototype pollution attempt using ${key} pattern`\n        );\n      }\n      return matches;\n    }\n  );\n  if (hasProtoPattern && strict) {\n    throw new Error(\n      \"[better-json] Potential prototype pollution attempt detected\"\n    );\n  }\n  try {\n    const secureReviver = (key, value2) => {\n      if (key === \"__proto__\" || key === \"constructor\" && value2 && typeof value2 === \"object\" && \"prototype\" in value2) {\n        if (warnings) {\n          console.warn(\n            `[better-json] Dropping \"${key}\" key to prevent prototype pollution`\n          );\n        }\n        return void 0;\n      }\n      if (parseDates && typeof value2 === \"string\") {\n        const date = parseISODate(value2);\n        if (date) {\n          return date;\n        }\n      }\n      return reviver ? reviver(key, value2) : value2;\n    };\n    return JSON.parse(trimmed, secureReviver);\n  } catch (error) {\n    if (strict) {\n      throw error;\n    }\n    return value;\n  }\n}\nfunction parseJSON(value, options = { strict: true }) {\n  return betterJSONParse(value, options);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5tc0dPVTBtOS5tanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0EscUJBQXFCLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxhQUFhLEVBQUUsYUFBYSxFQUFFLGdCQUFnQixFQUFFLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxPQUFPLEVBQUU7QUFDdEk7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsV0FBVyxLQUFLLE1BQU0sS0FBSztBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsSUFBSSxrQkFBa0IsRUFBRSxNQUFNLEVBQUU7QUFDakg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsS0FBSztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsSUFBSTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsY0FBYztBQUNwRDtBQUNBOztBQUUwQiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGgubXNHT1UwbTkubWpzPzQ4NjEiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUFJPVE9fUE9MTFVUSU9OX1BBVFRFUk5TID0ge1xuICBwcm90bzogL1wiKD86X3xcXFxcdTB7Mn01W0ZmXSl7Mn0oPzpwfFxcXFx1MHsyfTcwKSg/OnJ8XFxcXHUwezJ9NzIpKD86b3xcXFxcdTB7Mn02W0ZmXSkoPzp0fFxcXFx1MHsyfTc0KSg/Om98XFxcXHUwezJ9NltGZl0pKD86X3xcXFxcdTB7Mn01W0ZmXSl7Mn1cIlxccyo6LyxcbiAgY29uc3RydWN0b3I6IC9cIig/OmN8XFxcXHUwMDYzKSg/Om98XFxcXHUwMDZbRmZdKSg/Om58XFxcXHUwMDZbRWVdKSg/OnN8XFxcXHUwMDczKSg/OnR8XFxcXHUwMDc0KSg/OnJ8XFxcXHUwMDcyKSg/OnV8XFxcXHUwMDc1KSg/OmN8XFxcXHUwMDYzKSg/OnR8XFxcXHUwMDc0KSg/Om98XFxcXHUwMDZbRmZdKSg/OnJ8XFxcXHUwMDcyKVwiXFxzKjovLFxuICBwcm90b1Nob3J0OiAvXCJfX3Byb3RvX19cIlxccyo6LyxcbiAgY29uc3RydWN0b3JTaG9ydDogL1wiY29uc3RydWN0b3JcIlxccyo6L1xufTtcbmNvbnN0IEpTT05fU0lHTkFUVVJFID0gL15cXHMqW1wiW3tdfF5cXHMqLT9cXGR7MSwxNn0oXFwuXFxkezEsMTd9KT8oW0VlXVsrLV0/XFxkKyk/XFxzKiQvO1xuY29uc3QgU1BFQ0lBTF9WQUxVRVMgPSB7XG4gIHRydWU6IHRydWUsXG4gIGZhbHNlOiBmYWxzZSxcbiAgbnVsbDogbnVsbCxcbiAgdW5kZWZpbmVkOiB2b2lkIDAsXG4gIG5hbjogTnVtYmVyLk5hTixcbiAgaW5maW5pdHk6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSxcbiAgXCItaW5maW5pdHlcIjogTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZXG59O1xuY29uc3QgSVNPX0RBVEVfUkVHRVggPSAvXihcXGR7NH0pLShcXGR7Mn0pLShcXGR7Mn0pVChcXGR7Mn0pOihcXGR7Mn0pOihcXGR7Mn0pKD86XFwuKFxcZHsxLDd9KSk/KD86WnwoWystXSkoXFxkezJ9KTooXFxkezJ9KSkkLztcbmZ1bmN0aW9uIGlzVmFsaWREYXRlKGRhdGUpIHtcbiAgcmV0dXJuIGRhdGUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTihkYXRlLmdldFRpbWUoKSk7XG59XG5mdW5jdGlvbiBwYXJzZUlTT0RhdGUodmFsdWUpIHtcbiAgY29uc3QgbWF0Y2ggPSBJU09fREFURV9SRUdFWC5leGVjKHZhbHVlKTtcbiAgaWYgKCFtYXRjaCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IFtcbiAgICAsXG4gICAgeWVhcixcbiAgICBtb250aCxcbiAgICBkYXksXG4gICAgaG91cixcbiAgICBtaW51dGUsXG4gICAgc2Vjb25kLFxuICAgIG1zLFxuICAgIG9mZnNldFNpZ24sXG4gICAgb2Zmc2V0SG91cixcbiAgICBvZmZzZXRNaW51dGVcbiAgXSA9IG1hdGNoO1xuICBsZXQgZGF0ZSA9IG5ldyBEYXRlKFxuICAgIERhdGUuVVRDKFxuICAgICAgcGFyc2VJbnQoeWVhciwgMTApLFxuICAgICAgcGFyc2VJbnQobW9udGgsIDEwKSAtIDEsXG4gICAgICBwYXJzZUludChkYXksIDEwKSxcbiAgICAgIHBhcnNlSW50KGhvdXIsIDEwKSxcbiAgICAgIHBhcnNlSW50KG1pbnV0ZSwgMTApLFxuICAgICAgcGFyc2VJbnQoc2Vjb25kLCAxMCksXG4gICAgICBtcyA/IHBhcnNlSW50KG1zLnBhZEVuZCgzLCBcIjBcIiksIDEwKSA6IDBcbiAgICApXG4gICk7XG4gIGlmIChvZmZzZXRTaWduKSB7XG4gICAgY29uc3Qgb2Zmc2V0ID0gKHBhcnNlSW50KG9mZnNldEhvdXIsIDEwKSAqIDYwICsgcGFyc2VJbnQob2Zmc2V0TWludXRlLCAxMCkpICogKG9mZnNldFNpZ24gPT09IFwiK1wiID8gLTEgOiAxKTtcbiAgICBkYXRlLnNldFVUQ01pbnV0ZXMoZGF0ZS5nZXRVVENNaW51dGVzKCkgKyBvZmZzZXQpO1xuICB9XG4gIHJldHVybiBpc1ZhbGlkRGF0ZShkYXRlKSA/IGRhdGUgOiBudWxsO1xufVxuZnVuY3Rpb24gYmV0dGVySlNPTlBhcnNlKHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHN0cmljdCA9IGZhbHNlLFxuICAgIHdhcm5pbmdzID0gZmFsc2UsXG4gICAgcmV2aXZlcixcbiAgICBwYXJzZURhdGVzID0gdHJ1ZVxuICB9ID0gb3B0aW9ucztcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBjb25zdCB0cmltbWVkID0gdmFsdWUudHJpbSgpO1xuICBpZiAodHJpbW1lZC5sZW5ndGggPiAwICYmIHRyaW1tZWRbMF0gPT09ICdcIicgJiYgdHJpbW1lZC5lbmRzV2l0aCgnXCInKSAmJiAhdHJpbW1lZC5zbGljZSgxLCAtMSkuaW5jbHVkZXMoJ1wiJykpIHtcbiAgICByZXR1cm4gdHJpbW1lZC5zbGljZSgxLCAtMSk7XG4gIH1cbiAgY29uc3QgbG93ZXJWYWx1ZSA9IHRyaW1tZWQudG9Mb3dlckNhc2UoKTtcbiAgaWYgKGxvd2VyVmFsdWUubGVuZ3RoIDw9IDkgJiYgbG93ZXJWYWx1ZSBpbiBTUEVDSUFMX1ZBTFVFUykge1xuICAgIHJldHVybiBTUEVDSUFMX1ZBTFVFU1tsb3dlclZhbHVlXTtcbiAgfVxuICBpZiAoIUpTT05fU0lHTkFUVVJFLnRlc3QodHJpbW1lZCkpIHtcbiAgICBpZiAoc3RyaWN0KSB7XG4gICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXCJbYmV0dGVyLWpzb25dIEludmFsaWQgSlNPTlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGNvbnN0IGhhc1Byb3RvUGF0dGVybiA9IE9iamVjdC5lbnRyaWVzKFBST1RPX1BPTExVVElPTl9QQVRURVJOUykuc29tZShcbiAgICAoW2tleSwgcGF0dGVybl0pID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBwYXR0ZXJuLnRlc3QodHJpbW1lZCk7XG4gICAgICBpZiAobWF0Y2hlcyAmJiB3YXJuaW5ncykge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYFtiZXR0ZXItanNvbl0gRGV0ZWN0ZWQgcG90ZW50aWFsIHByb3RvdHlwZSBwb2xsdXRpb24gYXR0ZW1wdCB1c2luZyAke2tleX0gcGF0dGVybmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXRjaGVzO1xuICAgIH1cbiAgKTtcbiAgaWYgKGhhc1Byb3RvUGF0dGVybiAmJiBzdHJpY3QpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcIltiZXR0ZXItanNvbl0gUG90ZW50aWFsIHByb3RvdHlwZSBwb2xsdXRpb24gYXR0ZW1wdCBkZXRlY3RlZFwiXG4gICAgKTtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHNlY3VyZVJldml2ZXIgPSAoa2V5LCB2YWx1ZTIpID0+IHtcbiAgICAgIGlmIChrZXkgPT09IFwiX19wcm90b19fXCIgfHwga2V5ID09PSBcImNvbnN0cnVjdG9yXCIgJiYgdmFsdWUyICYmIHR5cGVvZiB2YWx1ZTIgPT09IFwib2JqZWN0XCIgJiYgXCJwcm90b3R5cGVcIiBpbiB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKHdhcm5pbmdzKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgYFtiZXR0ZXItanNvbl0gRHJvcHBpbmcgXCIke2tleX1cIiBrZXkgdG8gcHJldmVudCBwcm90b3R5cGUgcG9sbHV0aW9uYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGlmIChwYXJzZURhdGVzICYmIHR5cGVvZiB2YWx1ZTIgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IHBhcnNlSVNPRGF0ZSh2YWx1ZTIpO1xuICAgICAgICBpZiAoZGF0ZSkge1xuICAgICAgICAgIHJldHVybiBkYXRlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV2aXZlciA/IHJldml2ZXIoa2V5LCB2YWx1ZTIpIDogdmFsdWUyO1xuICAgIH07XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodHJpbW1lZCwgc2VjdXJlUmV2aXZlcik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKHN0cmljdCkge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufVxuZnVuY3Rpb24gcGFyc2VKU09OKHZhbHVlLCBvcHRpb25zID0geyBzdHJpY3Q6IHRydWUgfSkge1xuICByZXR1cm4gYmV0dGVySlNPTlBhcnNlKHZhbHVlLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IHsgcGFyc2VKU09OIGFzIHAgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.msGOU0m9.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/index.mjs":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/index.mjs ***!
  \******************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdapter: () => (/* binding */ createAdapter),\n/* harmony export */   createAdapterFactory: () => (/* reexport safe */ _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c)\n/* harmony export */ });\n/* harmony import */ var _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../shared/better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _shared_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst createAdapter = _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FkYXB0ZXJzL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0U7QUFDbEM7QUFDRDtBQUNiO0FBQ2E7QUFDQTtBQUNUO0FBQ3RCO0FBQ1E7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNEO0FBQ0E7QUFDQztBQUNXOztBQUU1QyxzQkFBc0IsK0RBQW9COztBQUVLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FkYXB0ZXJzL2luZGV4Lm1qcz9mNThiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGMgYXMgY3JlYXRlQWRhcHRlckZhY3RvcnkgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzJztcbmV4cG9ydCAqIGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2RiL2FkYXB0ZXInO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCAnLi4vc2hhcmVkL2JldHRlci1hdXRoLnBRamVSa3pOLm1qcyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCAnem9kJztcbmltcG9ydCAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcblxuY29uc3QgY3JlYXRlQWRhcHRlciA9IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5O1xuXG5leHBvcnQgeyBjcmVhdGVBZGFwdGVyLCBjcmVhdGVBZGFwdGVyRmFjdG9yeSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/prisma-adapter/index.mjs":
/*!*********************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/prisma-adapter/index.mjs ***!
  \*********************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdapter: () => (/* reexport safe */ _index_mjs__WEBPACK_IMPORTED_MODULE_0__.createAdapter),\n/* harmony export */   createAdapterFactory: () => (/* reexport safe */ _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__.c),\n/* harmony export */   prismaAdapter: () => (/* binding */ prismaAdapter)\n/* harmony export */ });\n/* harmony import */ var _index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _shared_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../shared/better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst prismaAdapter = (prisma, config) => {\n  let lazyOptions = null;\n  const createCustomAdapter = (prisma2) => ({ getFieldName }) => {\n    const db = prisma2;\n    const convertSelect = (select, model) => {\n      if (!select || !model) return void 0;\n      return select.reduce((prev, cur) => {\n        return {\n          ...prev,\n          [getFieldName({ model, field: cur })]: true\n        };\n      }, {});\n    };\n    function operatorToPrismaOperator(operator) {\n      switch (operator) {\n        case \"starts_with\":\n          return \"startsWith\";\n        case \"ends_with\":\n          return \"endsWith\";\n        case \"ne\":\n          return \"not\";\n        case \"not_in\":\n          return \"notIn\";\n        default:\n          return operator;\n      }\n    }\n    const convertWhereClause = (model, where) => {\n      if (!where || !where.length) return {};\n      if (where.length === 1) {\n        const w = where[0];\n        if (!w) {\n          return;\n        }\n        return {\n          [getFieldName({ model, field: w.field })]: w.operator === \"eq\" || !w.operator ? w.value : {\n            [operatorToPrismaOperator(w.operator)]: w.value\n          }\n        };\n      }\n      const and = where.filter((w) => w.connector === \"AND\" || !w.connector);\n      const or = where.filter((w) => w.connector === \"OR\");\n      const andClause = and.map((w) => {\n        return {\n          [getFieldName({ model, field: w.field })]: w.operator === \"eq\" || !w.operator ? w.value : {\n            [operatorToPrismaOperator(w.operator)]: w.value\n          }\n        };\n      });\n      const orClause = or.map((w) => {\n        return {\n          [getFieldName({ model, field: w.field })]: w.operator === \"eq\" || !w.operator ? w.value : {\n            [operatorToPrismaOperator(w.operator)]: w.value\n          }\n        };\n      });\n      return {\n        ...andClause.length ? { AND: andClause } : {},\n        ...orClause.length ? { OR: orClause } : {}\n      };\n    };\n    return {\n      async create({ model, data: values, select }) {\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].create({\n          data: values,\n          select: convertSelect(select, model)\n        });\n      },\n      async findOne({ model, where, select }) {\n        const whereClause = convertWhereClause(model, where);\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].findFirst({\n          where: whereClause,\n          select: convertSelect(select, model)\n        });\n      },\n      async findMany({ model, where, limit, offset, sortBy }) {\n        const whereClause = convertWhereClause(model, where);\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].findMany({\n          where: whereClause,\n          take: limit || 100,\n          skip: offset || 0,\n          ...sortBy?.field ? {\n            orderBy: {\n              [getFieldName({ model, field: sortBy.field })]: sortBy.direction === \"desc\" ? \"desc\" : \"asc\"\n            }\n          } : {}\n        });\n      },\n      async count({ model, where }) {\n        const whereClause = convertWhereClause(model, where);\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        return await db[model].count({\n          where: whereClause\n        });\n      },\n      async update({ model, where, update }) {\n        if (!db[model]) {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n            `Model ${model} does not exist in the database. If you haven't generated the Prisma client, you need to run 'npx prisma generate'`\n          );\n        }\n        const whereClause = convertWhereClause(model, where);\n        return await db[model].update({\n          where: whereClause,\n          data: update\n        });\n      },\n      async updateMany({ model, where, update }) {\n        const whereClause = convertWhereClause(model, where);\n        const result = await db[model].updateMany({\n          where: whereClause,\n          data: update\n        });\n        return result ? result.count : 0;\n      },\n      async delete({ model, where }) {\n        const whereClause = convertWhereClause(model, where);\n        try {\n          await db[model].delete({\n            where: whereClause\n          });\n        } catch (e) {\n        }\n      },\n      async deleteMany({ model, where }) {\n        const whereClause = convertWhereClause(model, where);\n        const result = await db[model].deleteMany({\n          where: whereClause\n        });\n        return result ? result.count : 0;\n      },\n      options: config\n    };\n  };\n  let adapterOptions = null;\n  adapterOptions = {\n    config: {\n      adapterId: \"prisma\",\n      adapterName: \"Prisma Adapter\",\n      usePlural: config.usePlural ?? false,\n      debugLogs: config.debugLogs ?? false,\n      transaction: config.transaction ?? false ? (cb) => prisma.$transaction((tx) => {\n        const adapter2 = (0,_shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__.c)({\n          config: adapterOptions.config,\n          adapter: createCustomAdapter(tx)\n        })(lazyOptions);\n        return cb(adapter2);\n      }) : false\n    },\n    adapter: createCustomAdapter(prisma)\n  };\n  const adapter = (0,_shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_2__.c)(adapterOptions);\n  return (options) => {\n    lazyOptions = options;\n    return adapter(options);\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FkYXB0ZXJzL3ByaXNtYS1hZGFwdGVyL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE2QztBQUNhO0FBQ3dCO0FBQ3JDO0FBQ0U7QUFDaEI7QUFDZ0I7QUFDQTtBQUNaO0FBQ3RCO0FBQ1E7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNEO0FBQ0E7QUFDZTs7QUFFL0M7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixtQkFBbUI7QUFDN0M7QUFDQSxPQUFPLElBQUk7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVCQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVCQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLDBCQUEwQix1QkFBdUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsZ0NBQWdDLGlCQUFpQixJQUFJO0FBQ3JELCtCQUErQixlQUFlO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw2QkFBNkI7QUFDbEQ7QUFDQSxvQkFBb0Isb0VBQWU7QUFDbkMscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1Asc0JBQXNCLHNCQUFzQjtBQUM1QztBQUNBO0FBQ0Esb0JBQW9CLG9FQUFlO0FBQ25DLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLHVCQUF1QixxQ0FBcUM7QUFDNUQ7QUFDQTtBQUNBLG9CQUFvQixvRUFBZTtBQUNuQyxxQkFBcUIsT0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLDRCQUE0QjtBQUMxRDtBQUNBLFlBQVk7QUFDWixTQUFTO0FBQ1QsT0FBTztBQUNQLG9CQUFvQixjQUFjO0FBQ2xDO0FBQ0E7QUFDQSxvQkFBb0Isb0VBQWU7QUFDbkMscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLHFCQUFxQixzQkFBc0I7QUFDM0M7QUFDQSxvQkFBb0Isb0VBQWU7QUFDbkMscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCx5QkFBeUIsc0JBQXNCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFVBQVU7QUFDVjtBQUNBLE9BQU87QUFDUCx5QkFBeUIsY0FBYztBQUN2QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixtRUFBb0I7QUFDN0M7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLGtCQUFrQixtRUFBb0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFK0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvYWRhcHRlcnMvcHJpc21hLWFkYXB0ZXIvaW5kZXgubWpzP2Y3Y2IiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHsgY3JlYXRlQWRhcHRlciB9IGZyb20gJy4uL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZUFkYXB0ZXJGYWN0b3J5IH0gZnJvbSAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkVCeEtlVk5aLm1qcyc7XG5leHBvcnQgKiBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9kYi9hZGFwdGVyJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5wUWplUmt6Ti5tanMnO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5pbXBvcnQgJ3pvZCc7XG5pbXBvcnQgJ2JldHRlci1jYWxsJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CNFFveGRnYy5tanMnO1xuXG5jb25zdCBwcmlzbWFBZGFwdGVyID0gKHByaXNtYSwgY29uZmlnKSA9PiB7XG4gIGxldCBsYXp5T3B0aW9ucyA9IG51bGw7XG4gIGNvbnN0IGNyZWF0ZUN1c3RvbUFkYXB0ZXIgPSAocHJpc21hMikgPT4gKHsgZ2V0RmllbGROYW1lIH0pID0+IHtcbiAgICBjb25zdCBkYiA9IHByaXNtYTI7XG4gICAgY29uc3QgY29udmVydFNlbGVjdCA9IChzZWxlY3QsIG1vZGVsKSA9PiB7XG4gICAgICBpZiAoIXNlbGVjdCB8fCAhbW9kZWwpIHJldHVybiB2b2lkIDA7XG4gICAgICByZXR1cm4gc2VsZWN0LnJlZHVjZSgocHJldiwgY3VyKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICBbZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiBjdXIgfSldOiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9LCB7fSk7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBvcGVyYXRvclRvUHJpc21hT3BlcmF0b3Iob3BlcmF0b3IpIHtcbiAgICAgIHN3aXRjaCAob3BlcmF0b3IpIHtcbiAgICAgICAgY2FzZSBcInN0YXJ0c193aXRoXCI6XG4gICAgICAgICAgcmV0dXJuIFwic3RhcnRzV2l0aFwiO1xuICAgICAgICBjYXNlIFwiZW5kc193aXRoXCI6XG4gICAgICAgICAgcmV0dXJuIFwiZW5kc1dpdGhcIjtcbiAgICAgICAgY2FzZSBcIm5lXCI6XG4gICAgICAgICAgcmV0dXJuIFwibm90XCI7XG4gICAgICAgIGNhc2UgXCJub3RfaW5cIjpcbiAgICAgICAgICByZXR1cm4gXCJub3RJblwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBvcGVyYXRvcjtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29udmVydFdoZXJlQ2xhdXNlID0gKG1vZGVsLCB3aGVyZSkgPT4ge1xuICAgICAgaWYgKCF3aGVyZSB8fCAhd2hlcmUubGVuZ3RoKSByZXR1cm4ge307XG4gICAgICBpZiAod2hlcmUubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGNvbnN0IHcgPSB3aGVyZVswXTtcbiAgICAgICAgaWYgKCF3KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgW2dldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZDogdy5maWVsZCB9KV06IHcub3BlcmF0b3IgPT09IFwiZXFcIiB8fCAhdy5vcGVyYXRvciA/IHcudmFsdWUgOiB7XG4gICAgICAgICAgICBbb3BlcmF0b3JUb1ByaXNtYU9wZXJhdG9yKHcub3BlcmF0b3IpXTogdy52YWx1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFuZCA9IHdoZXJlLmZpbHRlcigodykgPT4gdy5jb25uZWN0b3IgPT09IFwiQU5EXCIgfHwgIXcuY29ubmVjdG9yKTtcbiAgICAgIGNvbnN0IG9yID0gd2hlcmUuZmlsdGVyKCh3KSA9PiB3LmNvbm5lY3RvciA9PT0gXCJPUlwiKTtcbiAgICAgIGNvbnN0IGFuZENsYXVzZSA9IGFuZC5tYXAoKHcpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBbZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiB3LmZpZWxkIH0pXTogdy5vcGVyYXRvciA9PT0gXCJlcVwiIHx8ICF3Lm9wZXJhdG9yID8gdy52YWx1ZSA6IHtcbiAgICAgICAgICAgIFtvcGVyYXRvclRvUHJpc21hT3BlcmF0b3Iody5vcGVyYXRvcildOiB3LnZhbHVlXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBjb25zdCBvckNsYXVzZSA9IG9yLm1hcCgodykgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIFtnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHcuZmllbGQgfSldOiB3Lm9wZXJhdG9yID09PSBcImVxXCIgfHwgIXcub3BlcmF0b3IgPyB3LnZhbHVlIDoge1xuICAgICAgICAgICAgW29wZXJhdG9yVG9QcmlzbWFPcGVyYXRvcih3Lm9wZXJhdG9yKV06IHcudmFsdWVcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmFuZENsYXVzZS5sZW5ndGggPyB7IEFORDogYW5kQ2xhdXNlIH0gOiB7fSxcbiAgICAgICAgLi4ub3JDbGF1c2UubGVuZ3RoID8geyBPUjogb3JDbGF1c2UgfSA6IHt9XG4gICAgICB9O1xuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIGNyZWF0ZSh7IG1vZGVsLCBkYXRhOiB2YWx1ZXMsIHNlbGVjdCB9KSB7XG4gICAgICAgIGlmICghZGJbbW9kZWxdKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIGBNb2RlbCAke21vZGVsfSBkb2VzIG5vdCBleGlzdCBpbiB0aGUgZGF0YWJhc2UuIElmIHlvdSBoYXZlbid0IGdlbmVyYXRlZCB0aGUgUHJpc21hIGNsaWVudCwgeW91IG5lZWQgdG8gcnVuICducHggcHJpc21hIGdlbmVyYXRlJ2BcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBkYlttb2RlbF0uY3JlYXRlKHtcbiAgICAgICAgICBkYXRhOiB2YWx1ZXMsXG4gICAgICAgICAgc2VsZWN0OiBjb252ZXJ0U2VsZWN0KHNlbGVjdCwgbW9kZWwpXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGZpbmRPbmUoeyBtb2RlbCwgd2hlcmUsIHNlbGVjdCB9KSB7XG4gICAgICAgIGNvbnN0IHdoZXJlQ2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgIGlmICghZGJbbW9kZWxdKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIGBNb2RlbCAke21vZGVsfSBkb2VzIG5vdCBleGlzdCBpbiB0aGUgZGF0YWJhc2UuIElmIHlvdSBoYXZlbid0IGdlbmVyYXRlZCB0aGUgUHJpc21hIGNsaWVudCwgeW91IG5lZWQgdG8gcnVuICducHggcHJpc21hIGdlbmVyYXRlJ2BcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBkYlttb2RlbF0uZmluZEZpcnN0KHtcbiAgICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2UsXG4gICAgICAgICAgc2VsZWN0OiBjb252ZXJ0U2VsZWN0KHNlbGVjdCwgbW9kZWwpXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGZpbmRNYW55KHsgbW9kZWwsIHdoZXJlLCBsaW1pdCwgb2Zmc2V0LCBzb3J0QnkgfSkge1xuICAgICAgICBjb25zdCB3aGVyZUNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICBpZiAoIWRiW21vZGVsXSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgICBgTW9kZWwgJHttb2RlbH0gZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlLiBJZiB5b3UgaGF2ZW4ndCBnZW5lcmF0ZWQgdGhlIFByaXNtYSBjbGllbnQsIHlvdSBuZWVkIHRvIHJ1biAnbnB4IHByaXNtYSBnZW5lcmF0ZSdgXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXdhaXQgZGJbbW9kZWxdLmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2UsXG4gICAgICAgICAgdGFrZTogbGltaXQgfHwgMTAwLFxuICAgICAgICAgIHNraXA6IG9mZnNldCB8fCAwLFxuICAgICAgICAgIC4uLnNvcnRCeT8uZmllbGQgPyB7XG4gICAgICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgICAgIFtnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHNvcnRCeS5maWVsZCB9KV06IHNvcnRCeS5kaXJlY3Rpb24gPT09IFwiZGVzY1wiID8gXCJkZXNjXCIgOiBcImFzY1wiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSA6IHt9XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGNvdW50KHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgaWYgKCFkYlttb2RlbF0pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgYE1vZGVsICR7bW9kZWx9IGRvZXMgbm90IGV4aXN0IGluIHRoZSBkYXRhYmFzZS4gSWYgeW91IGhhdmVuJ3QgZ2VuZXJhdGVkIHRoZSBQcmlzbWEgY2xpZW50LCB5b3UgbmVlZCB0byBydW4gJ25weCBwcmlzbWEgZ2VuZXJhdGUnYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IGRiW21vZGVsXS5jb3VudCh7XG4gICAgICAgICAgd2hlcmU6IHdoZXJlQ2xhdXNlXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIHVwZGF0ZSh7IG1vZGVsLCB3aGVyZSwgdXBkYXRlIH0pIHtcbiAgICAgICAgaWYgKCFkYlttb2RlbF0pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgYE1vZGVsICR7bW9kZWx9IGRvZXMgbm90IGV4aXN0IGluIHRoZSBkYXRhYmFzZS4gSWYgeW91IGhhdmVuJ3QgZ2VuZXJhdGVkIHRoZSBQcmlzbWEgY2xpZW50LCB5b3UgbmVlZCB0byBydW4gJ25weCBwcmlzbWEgZ2VuZXJhdGUnYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGRiW21vZGVsXS51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcbiAgICAgICAgICBkYXRhOiB1cGRhdGVcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgdXBkYXRlTWFueSh7IG1vZGVsLCB3aGVyZSwgdXBkYXRlIH0pIHtcbiAgICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGJbbW9kZWxdLnVwZGF0ZU1hbnkoe1xuICAgICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcbiAgICAgICAgICBkYXRhOiB1cGRhdGVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQgPyByZXN1bHQuY291bnQgOiAwO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGRlbGV0ZSh7IG1vZGVsLCB3aGVyZSB9KSB7XG4gICAgICAgIGNvbnN0IHdoZXJlQ2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgZGJbbW9kZWxdLmRlbGV0ZSh7XG4gICAgICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYXN5bmMgZGVsZXRlTWFueSh7IG1vZGVsLCB3aGVyZSB9KSB7XG4gICAgICAgIGNvbnN0IHdoZXJlQ2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiW21vZGVsXS5kZWxldGVNYW55KHtcbiAgICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2VcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQgPyByZXN1bHQuY291bnQgOiAwO1xuICAgICAgfSxcbiAgICAgIG9wdGlvbnM6IGNvbmZpZ1xuICAgIH07XG4gIH07XG4gIGxldCBhZGFwdGVyT3B0aW9ucyA9IG51bGw7XG4gIGFkYXB0ZXJPcHRpb25zID0ge1xuICAgIGNvbmZpZzoge1xuICAgICAgYWRhcHRlcklkOiBcInByaXNtYVwiLFxuICAgICAgYWRhcHRlck5hbWU6IFwiUHJpc21hIEFkYXB0ZXJcIixcbiAgICAgIHVzZVBsdXJhbDogY29uZmlnLnVzZVBsdXJhbCA/PyBmYWxzZSxcbiAgICAgIGRlYnVnTG9nczogY29uZmlnLmRlYnVnTG9ncyA/PyBmYWxzZSxcbiAgICAgIHRyYW5zYWN0aW9uOiBjb25maWcudHJhbnNhY3Rpb24gPz8gZmFsc2UgPyAoY2IpID0+IHByaXNtYS4kdHJhbnNhY3Rpb24oKHR4KSA9PiB7XG4gICAgICAgIGNvbnN0IGFkYXB0ZXIyID0gY3JlYXRlQWRhcHRlckZhY3Rvcnkoe1xuICAgICAgICAgIGNvbmZpZzogYWRhcHRlck9wdGlvbnMuY29uZmlnLFxuICAgICAgICAgIGFkYXB0ZXI6IGNyZWF0ZUN1c3RvbUFkYXB0ZXIodHgpXG4gICAgICAgIH0pKGxhenlPcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIGNiKGFkYXB0ZXIyKTtcbiAgICAgIH0pIDogZmFsc2VcbiAgICB9LFxuICAgIGFkYXB0ZXI6IGNyZWF0ZUN1c3RvbUFkYXB0ZXIocHJpc21hKVxuICB9O1xuICBjb25zdCBhZGFwdGVyID0gY3JlYXRlQWRhcHRlckZhY3RvcnkoYWRhcHRlck9wdGlvbnMpO1xuICByZXR1cm4gKG9wdGlvbnMpID0+IHtcbiAgICBsYXp5T3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgcmV0dXJuIGFkYXB0ZXIob3B0aW9ucyk7XG4gIH07XG59O1xuXG5leHBvcnQgeyBjcmVhdGVBZGFwdGVyRmFjdG9yeSwgcHJpc21hQWRhcHRlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/adapters/prisma-adapter/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/api/index.mjs":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/api/index.mjs ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_0__.APIError),\n/* harmony export */   accountInfo: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.f),\n/* harmony export */   callbackOAuth: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.I),\n/* harmony export */   changeEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.A),\n/* harmony export */   changePassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.z),\n/* harmony export */   checkEndpointConflicts: () => (/* binding */ checkEndpointConflicts),\n/* harmony export */   createAuthEndpoint: () => (/* reexport safe */ _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* reexport safe */ _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.createAuthMiddleware),\n/* harmony export */   createEmailVerificationToken: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.c),\n/* harmony export */   deleteUser: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.x),\n/* harmony export */   deleteUserCallback: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.k),\n/* harmony export */   error: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.e),\n/* harmony export */   forgetPassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.E),\n/* harmony export */   forgetPasswordCallback: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.v),\n/* harmony export */   freshSessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.f),\n/* harmony export */   getAccessToken: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.i),\n/* harmony export */   getEndpoints: () => (/* binding */ getEndpoints),\n/* harmony export */   getSession: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.a),\n/* harmony export */   getSessionFromCtx: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.g),\n/* harmony export */   getSessionQuerySchema: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.d),\n/* harmony export */   isSimpleRequest: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.L),\n/* harmony export */   linkSocialAccount: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.m),\n/* harmony export */   listSessions: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.l),\n/* harmony export */   listUserAccounts: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.l),\n/* harmony export */   ok: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.b),\n/* harmony export */   optionsMiddleware: () => (/* reexport safe */ _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.optionsMiddleware),\n/* harmony export */   originCheck: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.o),\n/* harmony export */   originCheckMiddleware: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.a),\n/* harmony export */   refreshToken: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.r),\n/* harmony export */   requestOnlySessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.h),\n/* harmony export */   requestPasswordReset: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.q),\n/* harmony export */   requestPasswordResetCallback: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.n),\n/* harmony export */   resetPassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.D),\n/* harmony export */   revokeOtherSessions: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.r),\n/* harmony export */   revokeSession: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.c),\n/* harmony export */   revokeSessions: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.b),\n/* harmony export */   router: () => (/* binding */ router),\n/* harmony export */   sendVerificationEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.B),\n/* harmony export */   sendVerificationEmailFn: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.K),\n/* harmony export */   sensitiveSessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.e),\n/* harmony export */   sessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.s),\n/* harmony export */   setPassword: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.y),\n/* harmony export */   signInEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.F),\n/* harmony export */   signInSocial: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.J),\n/* harmony export */   signOut: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.G),\n/* harmony export */   signUpEmail: () => (/* binding */ signUpEmail),\n/* harmony export */   unlinkAccount: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.j),\n/* harmony export */   updateUser: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.u),\n/* harmony export */   verifyEmail: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.C)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../shared/better-auth.BX9UB8EP.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs\");\n/* harmony import */ var _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../shared/better-auth.DEBtROF9.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.1.12/node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _shared_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _shared_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../shared/better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _shared_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../shared/better-auth.ClH5r3NH.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _shared_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../shared/better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _shared_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../shared/better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _shared_better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../shared/better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst signUpEmail = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_3__.createAuthEndpoint)(\n  \"/sign-up/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_26__.record(zod__WEBPACK_IMPORTED_MODULE_26__.string(), zod__WEBPACK_IMPORTED_MODULE_26__.any()),\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Sign up a user using email and password\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  email: {\n                    type: \"string\",\n                    description: \"The email of the user\"\n                  },\n                  password: {\n                    type: \"string\",\n                    description: \"The password of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The profile image URL of the user\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  },\n                  rememberMe: {\n                    type: \"boolean\",\n                    description: \"If this is false, the session will not be remembered. Default is `true`.\"\n                  }\n                },\n                required: [\"name\", \"email\", \"password\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Successfully created user\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\",\n                      nullable: true,\n                      description: \"Authentication token for the session\"\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"The unique identifier of the user\"\n                        },\n                        email: {\n                          type: \"string\",\n                          format: \"email\",\n                          description: \"The email address of the user\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"The name of the user\"\n                        },\n                        image: {\n                          type: \"string\",\n                          format: \"uri\",\n                          nullable: true,\n                          description: \"The profile image URL of the user\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Whether the email has been verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was created\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was last updated\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"user\"]\n                  // token is optional\n                }\n              }\n            }\n          },\n          \"422\": {\n            description: \"Unprocessable Entity. User already exists or failed to create user.\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.enabled || ctx.context.options.emailAndPassword?.disableSignUp) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password sign up is not enabled\"\n      });\n    }\n    const body = ctx.body;\n    const { name, email, password, image, callbackURL, rememberMe, ...rest } = body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_26__.email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (password.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (password.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const dbUser = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (dbUser?.user) {\n      ctx.context.logger.info(`Sign-up attempt for existing email: ${email}`);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL\n      });\n    }\n    const hash = await ctx.context.password.hash(password);\n    let createdUser;\n    try {\n      const data = (0,_shared_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_8__.d)(ctx.context.options, rest, \"create\");\n      createdUser = await ctx.context.internalAdapter.createUser(\n        {\n          email: email.toLowerCase(),\n          name,\n          image,\n          ...data,\n          emailVerified: false\n        },\n        ctx\n      );\n      if (!createdUser) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n        });\n      }\n    } catch (e) {\n      if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_6__.isDevelopment)()) {\n        ctx.context.logger.error(\"Failed to create user\", e);\n      }\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n        throw e;\n      }\n      ctx.context.logger?.error(\"Failed to create user\", e);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER,\n        details: e\n      });\n    }\n    if (!createdUser) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n      });\n    }\n    await ctx.context.internalAdapter.linkAccount(\n      {\n        userId: createdUser.id,\n        providerId: \"credential\",\n        accountId: createdUser.id,\n        password: hash\n      },\n      ctx\n    );\n    if (ctx.context.options.emailVerification?.sendOnSignUp || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      const token = await (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\n        ctx.context.secret,\n        createdUser.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${body.callbackURL || \"/\"}`;\n      const args = ctx.request ? [\n        {\n          user: createdUser,\n          url,\n          token\n        },\n        ctx.request\n      ] : [\n        {\n          user: createdUser,\n          url,\n          token\n        }\n      ];\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        ...args\n      );\n    }\n    if (ctx.context.options.emailAndPassword.autoSignIn === false || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      return ctx.json({\n        token: null,\n        user: {\n          id: createdUser.id,\n          email: createdUser.email,\n          name: createdUser.name,\n          image: createdUser.image,\n          emailVerified: createdUser.emailVerified,\n          createdAt: createdUser.createdAt,\n          updatedAt: createdUser.updatedAt\n        }\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      createdUser.id,\n      ctx,\n      rememberMe === false\n    );\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_shared_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_4__.s)(\n      ctx,\n      {\n        session,\n        user: createdUser\n      },\n      rememberMe === false\n    );\n    return ctx.json({\n      token: session.token,\n      user: {\n        id: createdUser.id,\n        email: createdUser.email,\n        name: createdUser.name,\n        image: createdUser.image,\n        emailVerified: createdUser.emailVerified,\n        createdAt: createdUser.createdAt,\n        updatedAt: createdUser.updatedAt\n      }\n    });\n  }\n);\n\nfunction shouldRateLimit(max, window, rateLimitData) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  const timeSinceLastRequest = now - rateLimitData.lastRequest;\n  return timeSinceLastRequest < windowInMs && rateLimitData.count >= max;\n}\nfunction rateLimitResponse(retryAfter) {\n  return new Response(\n    JSON.stringify({\n      message: \"Too many requests. Please try again later.\"\n    }),\n    {\n      status: 429,\n      statusText: \"Too Many Requests\",\n      headers: {\n        \"X-Retry-After\": retryAfter.toString()\n      }\n    }\n  );\n}\nfunction getRetryAfter(lastRequest, window) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  return Math.ceil((lastRequest + windowInMs - now) / 1e3);\n}\nfunction createDBStorage(ctx) {\n  const model = \"rateLimit\";\n  const db = ctx.adapter;\n  return {\n    get: async (key) => {\n      const res = await db.findMany({\n        model,\n        where: [{ field: \"key\", value: key }]\n      });\n      const data = res[0];\n      if (typeof data?.lastRequest === \"bigint\") {\n        data.lastRequest = Number(data.lastRequest);\n      }\n      return data;\n    },\n    set: async (key, value, _update) => {\n      try {\n        if (_update) {\n          await db.updateMany({\n            model,\n            where: [{ field: \"key\", value: key }],\n            update: {\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        } else {\n          await db.create({\n            model,\n            data: {\n              key,\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        }\n      } catch (e) {\n        ctx.logger.error(\"Error setting rate limit\", e);\n      }\n    }\n  };\n}\nconst memory = /* @__PURE__ */ new Map();\nfunction getRateLimitStorage(ctx, rateLimitSettings) {\n  if (ctx.options.rateLimit?.customStorage) {\n    return ctx.options.rateLimit.customStorage;\n  }\n  const storage = ctx.rateLimit.storage;\n  if (storage === \"secondary-storage\") {\n    return {\n      get: async (key) => {\n        const data = await ctx.options.secondaryStorage?.get(key);\n        return data ? (0,_shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_15__.s)(data) : void 0;\n      },\n      set: async (key, value, _update) => {\n        const ttl = rateLimitSettings?.window ?? ctx.options.rateLimit?.window ?? 10;\n        await ctx.options.secondaryStorage?.set?.(\n          key,\n          JSON.stringify(value),\n          ttl\n        );\n      }\n    };\n  } else if (storage === \"memory\") {\n    return {\n      async get(key) {\n        return memory.get(key);\n      },\n      async set(key, value, _update) {\n        memory.set(key, value);\n      }\n    };\n  }\n  return createDBStorage(ctx);\n}\nasync function onRequestRateLimit(req, ctx) {\n  if (!ctx.rateLimit.enabled) {\n    return;\n  }\n  const path = new URL(req.url).pathname.replace(\n    ctx.options.basePath || \"/api/auth\",\n    \"\"\n  );\n  let window = ctx.rateLimit.window;\n  let max = ctx.rateLimit.max;\n  const ip = (0,_shared_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_16__.g)(req, ctx.options);\n  if (!ip) {\n    return;\n  }\n  const key = ip + path;\n  const specialRules = getDefaultSpecialRules();\n  const specialRule = specialRules.find((rule) => rule.pathMatcher(path));\n  if (specialRule) {\n    window = specialRule.window;\n    max = specialRule.max;\n  }\n  for (const plugin of ctx.options.plugins || []) {\n    if (plugin.rateLimit) {\n      const matchedRule = plugin.rateLimit.find(\n        (rule) => rule.pathMatcher(path)\n      );\n      if (matchedRule) {\n        window = matchedRule.window;\n        max = matchedRule.max;\n        break;\n      }\n    }\n  }\n  if (ctx.rateLimit.customRules) {\n    const _path = Object.keys(ctx.rateLimit.customRules).find((p) => {\n      if (p.includes(\"*\")) {\n        const isMatch = (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.w)(p)(path);\n        return isMatch;\n      }\n      return p === path;\n    });\n    if (_path) {\n      const customRule = ctx.rateLimit.customRules[_path];\n      const resolved = typeof customRule === \"function\" ? await customRule(req) : customRule;\n      if (resolved) {\n        window = resolved.window;\n        max = resolved.max;\n      }\n      if (resolved === false) {\n        return;\n      }\n    }\n  }\n  const storage = getRateLimitStorage(ctx, {\n    window\n  });\n  const data = await storage.get(key);\n  const now = Date.now();\n  if (!data) {\n    await storage.set(key, {\n      key,\n      count: 1,\n      lastRequest: now\n    });\n  } else {\n    const timeSinceLastRequest = now - data.lastRequest;\n    if (shouldRateLimit(max, window, data)) {\n      const retryAfter = getRetryAfter(data.lastRequest, window);\n      return rateLimitResponse(retryAfter);\n    } else if (timeSinceLastRequest > window * 1e3) {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: 1,\n          lastRequest: now\n        },\n        true\n      );\n    } else {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: data.count + 1,\n          lastRequest: now\n        },\n        true\n      );\n    }\n  }\n}\nfunction getDefaultSpecialRules() {\n  const specialRules = [\n    {\n      pathMatcher(path) {\n        return path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path.startsWith(\"/change-password\") || path.startsWith(\"/change-email\");\n      },\n      window: 10,\n      max: 3\n    }\n  ];\n  return specialRules;\n}\n\nfunction checkEndpointConflicts(options, logger2) {\n  const endpointRegistry = /* @__PURE__ */ new Map();\n  options.plugins?.forEach((plugin) => {\n    if (plugin.endpoints) {\n      for (const [key, endpoint] of Object.entries(plugin.endpoints)) {\n        if (endpoint && \"path\" in endpoint) {\n          const path = endpoint.path;\n          let methods = [];\n          if (endpoint.options && \"method\" in endpoint.options) {\n            if (Array.isArray(endpoint.options.method)) {\n              methods = endpoint.options.method;\n            } else if (typeof endpoint.options.method === \"string\") {\n              methods = [endpoint.options.method];\n            }\n          }\n          if (methods.length === 0) {\n            methods = [\"*\"];\n          }\n          if (!endpointRegistry.has(path)) {\n            endpointRegistry.set(path, []);\n          }\n          endpointRegistry.get(path).push({\n            pluginId: plugin.id,\n            endpointKey: key,\n            methods\n          });\n        }\n      }\n    }\n  });\n  const conflicts = [];\n  for (const [path, entries] of endpointRegistry.entries()) {\n    if (entries.length > 1) {\n      const methodMap = /* @__PURE__ */ new Map();\n      let hasConflict = false;\n      for (const entry of entries) {\n        for (const method of entry.methods) {\n          if (!methodMap.has(method)) {\n            methodMap.set(method, []);\n          }\n          methodMap.get(method).push(entry.pluginId);\n          if (methodMap.get(method).length > 1) {\n            hasConflict = true;\n          }\n          if (method === \"*\" && entries.length > 1) {\n            hasConflict = true;\n          } else if (method !== \"*\" && methodMap.has(\"*\")) {\n            hasConflict = true;\n          }\n        }\n      }\n      if (hasConflict) {\n        const uniquePlugins = [...new Set(entries.map((e) => e.pluginId))];\n        const conflictingMethods = [];\n        for (const [method, plugins] of methodMap.entries()) {\n          if (plugins.length > 1 || method === \"*\" && entries.length > 1 || method !== \"*\" && methodMap.has(\"*\")) {\n            conflictingMethods.push(method);\n          }\n        }\n        conflicts.push({\n          path,\n          plugins: uniquePlugins,\n          conflictingMethods\n        });\n      }\n    }\n  }\n  if (conflicts.length > 0) {\n    const conflictMessages = conflicts.map(\n      (conflict) => `  - \"${conflict.path}\" [${conflict.conflictingMethods.join(\", \")}] used by plugins: ${conflict.plugins.join(\", \")}`\n    ).join(\"\\n\");\n    logger2.error(\n      `Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths with conflicting HTTP methods:\n${conflictMessages}\n\nTo resolve this, you can:\n\t1. Use only one of the conflicting plugins\n\t2. Configure the plugins to use different paths (if supported)\n\t3. Ensure plugins use different HTTP methods for the same path\n`\n    );\n  }\n}\nfunction getEndpoints(ctx, options) {\n  const pluginEndpoints = options.plugins?.reduce((acc, plugin) => {\n    return {\n      ...acc,\n      ...plugin.endpoints\n    };\n  }, {}) ?? {};\n  const middlewares = options.plugins?.map(\n    (plugin) => plugin.middlewares?.map((m) => {\n      const middleware = (async (context) => {\n        const authContext = await ctx;\n        return m.middleware({\n          ...context,\n          context: {\n            ...authContext,\n            ...context.context\n          }\n        });\n      });\n      middleware.options = m.middleware.options;\n      return {\n        path: m.path,\n        middleware\n      };\n    })\n  ).filter((plugin) => plugin !== void 0).flat() || [];\n  const baseEndpoints = {\n    signInSocial: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.J,\n    callbackOAuth: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.I,\n    getSession: (0,_shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.a)(),\n    signOut: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.G,\n    signUpEmail: signUpEmail(),\n    signInEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.F,\n    forgetPassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.E,\n    resetPassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.D,\n    verifyEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.C,\n    sendVerificationEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.B,\n    changeEmail: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.A,\n    changePassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.z,\n    setPassword: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.y,\n    updateUser: (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.u)(),\n    deleteUser: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.x,\n    forgetPasswordCallback: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.v,\n    requestPasswordReset: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.q,\n    requestPasswordResetCallback: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.n,\n    listSessions: (0,_shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.l)(),\n    revokeSession: _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.c,\n    revokeSessions: _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.b,\n    revokeOtherSessions: _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_2__.r,\n    linkSocialAccount: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.m,\n    listUserAccounts: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.l,\n    deleteUserCallback: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.k,\n    unlinkAccount: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.j,\n    refreshToken: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.r,\n    getAccessToken: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.i,\n    accountInfo: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.f\n  };\n  const endpoints = {\n    ...baseEndpoints,\n    ...pluginEndpoints,\n    ok: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.b,\n    error: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.e\n  };\n  const api = (0,_shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.t)(endpoints, ctx);\n  return {\n    api,\n    middlewares\n  };\n}\nconst router = (ctx, options) => {\n  const { api, middlewares } = getEndpoints(ctx, options);\n  const basePath = new URL(ctx.baseURL).pathname;\n  return (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createRouter)(api, {\n    routerContext: ctx,\n    openapi: {\n      disabled: true\n    },\n    basePath,\n    routerMiddleware: [\n      {\n        path: \"/**\",\n        middleware: _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_1__.a\n      },\n      ...middlewares\n    ],\n    async onRequest(req) {\n      const disabledPaths = ctx.options.disabledPaths || [];\n      const path = new URL(req.url).pathname.replace(basePath, \"\");\n      if (disabledPaths.includes(path)) {\n        return new Response(\"Not Found\", { status: 404 });\n      }\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onRequest) {\n          const response = await plugin.onRequest(req, ctx);\n          if (response && \"response\" in response) {\n            return response.response;\n          }\n          if (response && \"request\" in response) {\n            const rateLimitResponse = await onRequestRateLimit(\n              response.request,\n              ctx\n            );\n            if (rateLimitResponse) {\n              return rateLimitResponse;\n            }\n            return response.request;\n          }\n        }\n      }\n      return onRequestRateLimit(req, ctx);\n    },\n    async onResponse(res) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onResponse) {\n          const response = await plugin.onResponse(res, ctx);\n          if (response) {\n            return response.response;\n          }\n        }\n      }\n      return res;\n    },\n    onError(e) {\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError && e.status === \"FOUND\") {\n        return;\n      }\n      if (options.onAPIError?.throw) {\n        throw e;\n      }\n      if (options.onAPIError?.onError) {\n        options.onAPIError.onError(e, ctx);\n        return;\n      }\n      const optLogLevel = options.logger?.level;\n      const log = optLogLevel === \"error\" || optLogLevel === \"warn\" || optLogLevel === \"debug\" ? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_6__.logger : void 0;\n      if (options.logger?.disabled !== true) {\n        if (e && typeof e === \"object\" && \"message\" in e && typeof e.message === \"string\") {\n          if (e.message.includes(\"no column\") || e.message.includes(\"column\") || e.message.includes(\"relation\") || e.message.includes(\"table\") || e.message.includes(\"does not exist\")) {\n            ctx.logger?.error(e.message);\n            return;\n          }\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n          if (e.status === \"INTERNAL_SERVER_ERROR\") {\n            ctx.logger.error(e.status, e);\n          }\n          log?.error(e.message);\n        } else {\n          ctx.logger?.error(\n            e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n            e\n          );\n        }\n      }\n    }\n  });\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FwaS9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRDtBQUNkO0FBQ3FuQjtBQUNsaUI7QUFDaUM7QUFDc0U7QUFDeE07QUFDeUM7QUFDeUM7QUFDaEM7QUFDaEI7QUFDRztBQUNoQztBQUMyQztBQUN0QztBQUNGO0FBQ0M7QUFDRDtBQUNFO0FBQ3JCO0FBQ21CO0FBQ0Q7QUFDQTtBQUNZO0FBQzVCO0FBQ3NCO0FBQ2tDO0FBQ1I7QUFDcEI7QUFDQTtBQUNBO0FBQ1g7QUFDRTtBQUNyQjtBQUNlO0FBQ2U7QUFDdkI7QUFDdUI7O0FBRTVDLDBCQUEwQixnRkFBa0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx3Q0FBUSxDQUFDLHdDQUFRLElBQUkscUNBQUs7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNB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Iiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FwaS9pbmRleC5tanM/NzBhYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUElFcnJvciwgY3JlYXRlUm91dGVyIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuZXhwb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4sIHcgYXMgd2lsZGNhcmRNYXRjaCwgdSBhcyB1cGRhdGVVc2VyLCB0IGFzIHRvQXV0aEVuZHBvaW50cywgYSBhcyBvcmlnaW5DaGVja01pZGRsZXdhcmUsIGUgYXMgZXJyb3IsIGIgYXMgb2ssIGYgYXMgYWNjb3VudEluZm8sIGkgYXMgZ2V0QWNjZXNzVG9rZW4sIHIgYXMgcmVmcmVzaFRva2VuLCBqIGFzIHVubGlua0FjY291bnQsIGsgYXMgZGVsZXRlVXNlckNhbGxiYWNrLCBsIGFzIGxpc3RVc2VyQWNjb3VudHMsIG0gYXMgbGlua1NvY2lhbEFjY291bnQsIG4gYXMgcmVxdWVzdFBhc3N3b3JkUmVzZXRDYWxsYmFjaywgcSBhcyByZXF1ZXN0UGFzc3dvcmRSZXNldCwgdiBhcyBmb3JnZXRQYXNzd29yZENhbGxiYWNrLCB4IGFzIGRlbGV0ZVVzZXIsIHkgYXMgc2V0UGFzc3dvcmQsIHogYXMgY2hhbmdlUGFzc3dvcmQsIEEgYXMgY2hhbmdlRW1haWwsIEIgYXMgc2VuZFZlcmlmaWNhdGlvbkVtYWlsLCBDIGFzIHZlcmlmeUVtYWlsLCBEIGFzIHJlc2V0UGFzc3dvcmQsIEUgYXMgZm9yZ2V0UGFzc3dvcmQsIEYgYXMgc2lnbkluRW1haWwsIEcgYXMgc2lnbk91dCwgSSBhcyBjYWxsYmFja09BdXRoLCBKIGFzIHNpZ25JblNvY2lhbCB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CWDlVQjhFUC5tanMnO1xuZXhwb3J0IHsgTCBhcyBpc1NpbXBsZVJlcXVlc3QsIG8gYXMgb3JpZ2luQ2hlY2ssIEsgYXMgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4gfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQlg5VUI4RVAubWpzJztcbmltcG9ydCB7IGwgYXMgbGlzdFNlc3Npb25zLCBhIGFzIGdldFNlc3Npb24sIHIgYXMgcmV2b2tlT3RoZXJTZXNzaW9ucywgYiBhcyByZXZva2VTZXNzaW9ucywgYyBhcyByZXZva2VTZXNzaW9uIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkRFQnRST0Y5Lm1qcyc7XG5leHBvcnQgeyBmIGFzIGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUsIGcgYXMgZ2V0U2Vzc2lvbkZyb21DdHgsIGQgYXMgZ2V0U2Vzc2lvblF1ZXJ5U2NoZW1hLCBoIGFzIHJlcXVlc3RPbmx5U2Vzc2lvbk1pZGRsZXdhcmUsIGUgYXMgc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmUsIHMgYXMgc2Vzc2lvbk1pZGRsZXdhcmUgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguREVCdFJPRjkubWpzJztcbmltcG9ydCAqIGFzIHogZnJvbSAnem9kJztcbmltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL21pZGRsZXdhcmUnO1xuZXhwb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBjcmVhdGVBdXRoTWlkZGxld2FyZSwgb3B0aW9uc01pZGRsZXdhcmUgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9taWRkbGV3YXJlJztcbmltcG9ydCB7IHMgYXMgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5EOV92UVI4My5tanMnO1xuaW1wb3J0IHsgQkFTRV9FUlJPUl9DT0RFUyB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcbmltcG9ydCB7IGlzRGV2ZWxvcG1lbnQsIGxvZ2dlciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL2RiJztcbmltcG9ydCB7IGQgYXMgcGFyc2VVc2VySW5wdXQgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQ3dqOWR0NmkubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCAna3lzZWx5JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGIvYWRhcHRlcic7XG5pbXBvcnQgeyBzIGFzIHNhZmVKU09OUGFyc2UgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0SXAgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQ2xINXIzTkgubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvc29jaWFsLXByb3ZpZGVycyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5DVzZEOWVTeC5tanMnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCAnZGVmdSc7XG5pbXBvcnQgJy4uL2NyeXB0by9pbmRleC5tanMnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzJztcbmltcG9ydCAnam9zZS9lcnJvcnMnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguSWg4Qzc2Vm8ubWpzJztcblxuY29uc3Qgc2lnblVwRW1haWwgPSAoKSA9PiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NpZ24tdXAvZW1haWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5yZWNvcmQoei5zdHJpbmcoKSwgei5hbnkoKSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgICRJbmZlcjoge1xuICAgICAgICBib2R5OiB7fVxuICAgICAgfSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiB1cCBhIHVzZXIgdXNpbmcgZW1haWwgYW5kIHBhc3N3b3JkXCIsXG4gICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwYXNzd29yZCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHByb2ZpbGUgaW1hZ2UgVVJMIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBjYWxsYmFja1VSTDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHVzZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGNhbGxiYWNrXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZW1lbWJlck1lOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJZiB0aGlzIGlzIGZhbHNlLCB0aGUgc2Vzc2lvbiB3aWxsIG5vdCBiZSByZW1lbWJlcmVkLiBEZWZhdWx0IGlzIGB0cnVlYC5cIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcIm5hbWVcIiwgXCJlbWFpbFwiLCBcInBhc3N3b3JkXCJdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NmdWxseSBjcmVhdGVkIHVzZXJcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBdXRoZW50aWNhdGlvbiB0b2tlbiBmb3IgdGhlIHNlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgYWRkcmVzcyBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcInVyaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHByb2ZpbGUgaW1hZ2UgVVJMIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGV0aGVyIHRoZSBlbWFpbCBoYXMgYmVlbiB2ZXJpZmllZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiV2hlbiB0aGUgdXNlciB3YXMgY3JlYXRlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiV2hlbiB0aGUgdXNlciB3YXMgbGFzdCB1cGRhdGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxWZXJpZmllZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXBkYXRlZEF0XCJcbiAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1widXNlclwiXVxuICAgICAgICAgICAgICAgICAgLy8gdG9rZW4gaXMgb3B0aW9uYWxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiNDIyXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVucHJvY2Vzc2FibGUgRW50aXR5LiBVc2VyIGFscmVhZHkgZXhpc3RzIG9yIGZhaWxlZCB0byBjcmVhdGUgdXNlci5cIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uZW5hYmxlZCB8fCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LmRpc2FibGVTaWduVXApIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJFbWFpbCBhbmQgcGFzc3dvcmQgc2lnbiB1cCBpcyBub3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYm9keSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHsgbmFtZSwgZW1haWwsIHBhc3N3b3JkLCBpbWFnZSwgY2FsbGJhY2tVUkwsIHJlbWVtYmVyTWUsIC4uLnJlc3QgfSA9IGJvZHk7XG4gICAgY29uc3QgaXNWYWxpZEVtYWlsID0gei5lbWFpbCgpLnNhZmVQYXJzZShlbWFpbCk7XG4gICAgaWYgKCFpc1ZhbGlkRW1haWwuc3VjY2Vzcykge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoIDwgbWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBzaG9ydFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoID4gbWF4UGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBsb25nXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgZGJVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgaWYgKGRiVXNlcj8udXNlcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmluZm8oYFNpZ24tdXAgYXR0ZW1wdCBmb3IgZXhpc3RpbmcgZW1haWw6ICR7ZW1haWx9YCk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9BTFJFQURZX0VYSVNUU19VU0VfQU5PVEhFUl9FTUFJTFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKHBhc3N3b3JkKTtcbiAgICBsZXQgY3JlYXRlZFVzZXI7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBwYXJzZVVzZXJJbnB1dChjdHguY29udGV4dC5vcHRpb25zLCByZXN0LCBcImNyZWF0ZVwiKTtcbiAgICAgIGNyZWF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVVzZXIoXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGltYWdlLFxuICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgaWYgKCFjcmVhdGVkVXNlcikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGlzRGV2ZWxvcG1lbnQoKSkge1xuICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIiwgZSk7XG4gICAgICB9XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9XG4gICAgICBjdHguY29udGV4dC5sb2dnZXI/LmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSB1c2VyXCIsIGUpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUixcbiAgICAgICAgZGV0YWlsczogZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghY3JlYXRlZFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoXG4gICAgICB7XG4gICAgICAgIHVzZXJJZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgICBhY2NvdW50SWQ6IGNyZWF0ZWRVc2VyLmlkLFxuICAgICAgICBwYXNzd29yZDogaGFzaFxuICAgICAgfSxcbiAgICAgIGN0eFxuICAgICk7XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRPblNpZ25VcCB8fCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgY3JlYXRlZFVzZXIuZW1haWwsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICApO1xuICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Ym9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgY29uc3QgYXJncyA9IGN0eC5yZXF1ZXN0ID8gW1xuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHRva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICBdIDogW1xuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHRva2VuXG4gICAgICAgIH1cbiAgICAgIF07XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWw/LihcbiAgICAgICAgLi4uYXJnc1xuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5hdXRvU2lnbkluID09PSBmYWxzZSB8fCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICB0b2tlbjogbnVsbCxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogY3JlYXRlZFVzZXIuZW1haWwsXG4gICAgICAgICAgbmFtZTogY3JlYXRlZFVzZXIubmFtZSxcbiAgICAgICAgICBpbWFnZTogY3JlYXRlZFVzZXIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogY3JlYXRlZFVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGNyZWF0ZWRVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IGNyZWF0ZWRVc2VyLnVwZGF0ZWRBdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgY3JlYXRlZFVzZXIuaWQsXG4gICAgICBjdHgsXG4gICAgICByZW1lbWJlck1lID09PSBmYWxzZVxuICAgICk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgIGN0eCxcbiAgICAgIHtcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgdXNlcjogY3JlYXRlZFVzZXJcbiAgICAgIH0sXG4gICAgICByZW1lbWJlck1lID09PSBmYWxzZVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiBjcmVhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgbmFtZTogY3JlYXRlZFVzZXIubmFtZSxcbiAgICAgICAgaW1hZ2U6IGNyZWF0ZWRVc2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBjcmVhdGVkVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICBjcmVhdGVkQXQ6IGNyZWF0ZWRVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgdXBkYXRlZEF0OiBjcmVhdGVkVXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcblxuZnVuY3Rpb24gc2hvdWxkUmF0ZUxpbWl0KG1heCwgd2luZG93LCByYXRlTGltaXREYXRhKSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IHdpbmRvd0luTXMgPSB3aW5kb3cgKiAxZTM7XG4gIGNvbnN0IHRpbWVTaW5jZUxhc3RSZXF1ZXN0ID0gbm93IC0gcmF0ZUxpbWl0RGF0YS5sYXN0UmVxdWVzdDtcbiAgcmV0dXJuIHRpbWVTaW5jZUxhc3RSZXF1ZXN0IDwgd2luZG93SW5NcyAmJiByYXRlTGltaXREYXRhLmNvdW50ID49IG1heDtcbn1cbmZ1bmN0aW9uIHJhdGVMaW1pdFJlc3BvbnNlKHJldHJ5QWZ0ZXIpIHtcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBtZXNzYWdlOiBcIlRvbyBtYW55IHJlcXVlc3RzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiXG4gICAgfSksXG4gICAge1xuICAgICAgc3RhdHVzOiA0MjksXG4gICAgICBzdGF0dXNUZXh0OiBcIlRvbyBNYW55IFJlcXVlc3RzXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiWC1SZXRyeS1BZnRlclwiOiByZXRyeUFmdGVyLnRvU3RyaW5nKClcbiAgICAgIH1cbiAgICB9XG4gICk7XG59XG5mdW5jdGlvbiBnZXRSZXRyeUFmdGVyKGxhc3RSZXF1ZXN0LCB3aW5kb3cpIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3Qgd2luZG93SW5NcyA9IHdpbmRvdyAqIDFlMztcbiAgcmV0dXJuIE1hdGguY2VpbCgobGFzdFJlcXVlc3QgKyB3aW5kb3dJbk1zIC0gbm93KSAvIDFlMyk7XG59XG5mdW5jdGlvbiBjcmVhdGVEQlN0b3JhZ2UoY3R4KSB7XG4gIGNvbnN0IG1vZGVsID0gXCJyYXRlTGltaXRcIjtcbiAgY29uc3QgZGIgPSBjdHguYWRhcHRlcjtcbiAgcmV0dXJuIHtcbiAgICBnZXQ6IGFzeW5jIChrZXkpID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRiLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJrZXlcIiwgdmFsdWU6IGtleSB9XVxuICAgICAgfSk7XG4gICAgICBjb25zdCBkYXRhID0gcmVzWzBdO1xuICAgICAgaWYgKHR5cGVvZiBkYXRhPy5sYXN0UmVxdWVzdCA9PT0gXCJiaWdpbnRcIikge1xuICAgICAgICBkYXRhLmxhc3RSZXF1ZXN0ID0gTnVtYmVyKGRhdGEubGFzdFJlcXVlc3QpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcbiAgICBzZXQ6IGFzeW5jIChrZXksIHZhbHVlLCBfdXBkYXRlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoX3VwZGF0ZSkge1xuICAgICAgICAgIGF3YWl0IGRiLnVwZGF0ZU1hbnkoe1xuICAgICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwia2V5XCIsIHZhbHVlOiBrZXkgfV0sXG4gICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgY291bnQ6IHZhbHVlLmNvdW50LFxuICAgICAgICAgICAgICBsYXN0UmVxdWVzdDogdmFsdWUubGFzdFJlcXVlc3RcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhd2FpdCBkYi5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgY291bnQ6IHZhbHVlLmNvdW50LFxuICAgICAgICAgICAgICBsYXN0UmVxdWVzdDogdmFsdWUubGFzdFJlcXVlc3RcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjdHgubG9nZ2VyLmVycm9yKFwiRXJyb3Igc2V0dGluZyByYXRlIGxpbWl0XCIsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbmNvbnN0IG1lbW9yeSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRSYXRlTGltaXRTdG9yYWdlKGN0eCwgcmF0ZUxpbWl0U2V0dGluZ3MpIHtcbiAgaWYgKGN0eC5vcHRpb25zLnJhdGVMaW1pdD8uY3VzdG9tU3RvcmFnZSkge1xuICAgIHJldHVybiBjdHgub3B0aW9ucy5yYXRlTGltaXQuY3VzdG9tU3RvcmFnZTtcbiAgfVxuICBjb25zdCBzdG9yYWdlID0gY3R4LnJhdGVMaW1pdC5zdG9yYWdlO1xuICBpZiAoc3RvcmFnZSA9PT0gXCJzZWNvbmRhcnktc3RvcmFnZVwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGdldDogYXN5bmMgKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgY3R4Lm9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZT8uZ2V0KGtleSk7XG4gICAgICAgIHJldHVybiBkYXRhID8gc2FmZUpTT05QYXJzZShkYXRhKSA6IHZvaWQgMDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGFzeW5jIChrZXksIHZhbHVlLCBfdXBkYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IHR0bCA9IHJhdGVMaW1pdFNldHRpbmdzPy53aW5kb3cgPz8gY3R4Lm9wdGlvbnMucmF0ZUxpbWl0Py53aW5kb3cgPz8gMTA7XG4gICAgICAgIGF3YWl0IGN0eC5vcHRpb25zLnNlY29uZGFyeVN0b3JhZ2U/LnNldD8uKFxuICAgICAgICAgIGtleSxcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh2YWx1ZSksXG4gICAgICAgICAgdHRsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfTtcbiAgfSBlbHNlIGlmIChzdG9yYWdlID09PSBcIm1lbW9yeVwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIGdldChrZXkpIHtcbiAgICAgICAgcmV0dXJuIG1lbW9yeS5nZXQoa2V5KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBzZXQoa2V5LCB2YWx1ZSwgX3VwZGF0ZSkge1xuICAgICAgICBtZW1vcnkuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZURCU3RvcmFnZShjdHgpO1xufVxuYXN5bmMgZnVuY3Rpb24gb25SZXF1ZXN0UmF0ZUxpbWl0KHJlcSwgY3R4KSB7XG4gIGlmICghY3R4LnJhdGVMaW1pdC5lbmFibGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHBhdGggPSBuZXcgVVJMKHJlcS51cmwpLnBhdGhuYW1lLnJlcGxhY2UoXG4gICAgY3R4Lm9wdGlvbnMuYmFzZVBhdGggfHwgXCIvYXBpL2F1dGhcIixcbiAgICBcIlwiXG4gICk7XG4gIGxldCB3aW5kb3cgPSBjdHgucmF0ZUxpbWl0LndpbmRvdztcbiAgbGV0IG1heCA9IGN0eC5yYXRlTGltaXQubWF4O1xuICBjb25zdCBpcCA9IGdldElwKHJlcSwgY3R4Lm9wdGlvbnMpO1xuICBpZiAoIWlwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGtleSA9IGlwICsgcGF0aDtcbiAgY29uc3Qgc3BlY2lhbFJ1bGVzID0gZ2V0RGVmYXVsdFNwZWNpYWxSdWxlcygpO1xuICBjb25zdCBzcGVjaWFsUnVsZSA9IHNwZWNpYWxSdWxlcy5maW5kKChydWxlKSA9PiBydWxlLnBhdGhNYXRjaGVyKHBhdGgpKTtcbiAgaWYgKHNwZWNpYWxSdWxlKSB7XG4gICAgd2luZG93ID0gc3BlY2lhbFJ1bGUud2luZG93O1xuICAgIG1heCA9IHNwZWNpYWxSdWxlLm1heDtcbiAgfVxuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBjdHgub3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgaWYgKHBsdWdpbi5yYXRlTGltaXQpIHtcbiAgICAgIGNvbnN0IG1hdGNoZWRSdWxlID0gcGx1Z2luLnJhdGVMaW1pdC5maW5kKFxuICAgICAgICAocnVsZSkgPT4gcnVsZS5wYXRoTWF0Y2hlcihwYXRoKVxuICAgICAgKTtcbiAgICAgIGlmIChtYXRjaGVkUnVsZSkge1xuICAgICAgICB3aW5kb3cgPSBtYXRjaGVkUnVsZS53aW5kb3c7XG4gICAgICAgIG1heCA9IG1hdGNoZWRSdWxlLm1heDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzKSB7XG4gICAgY29uc3QgX3BhdGggPSBPYmplY3Qua2V5cyhjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzKS5maW5kKChwKSA9PiB7XG4gICAgICBpZiAocC5pbmNsdWRlcyhcIipcIikpIHtcbiAgICAgICAgY29uc3QgaXNNYXRjaCA9IHdpbGRjYXJkTWF0Y2gocCkocGF0aCk7XG4gICAgICAgIHJldHVybiBpc01hdGNoO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHAgPT09IHBhdGg7XG4gICAgfSk7XG4gICAgaWYgKF9wYXRoKSB7XG4gICAgICBjb25zdCBjdXN0b21SdWxlID0gY3R4LnJhdGVMaW1pdC5jdXN0b21SdWxlc1tfcGF0aF07XG4gICAgICBjb25zdCByZXNvbHZlZCA9IHR5cGVvZiBjdXN0b21SdWxlID09PSBcImZ1bmN0aW9uXCIgPyBhd2FpdCBjdXN0b21SdWxlKHJlcSkgOiBjdXN0b21SdWxlO1xuICAgICAgaWYgKHJlc29sdmVkKSB7XG4gICAgICAgIHdpbmRvdyA9IHJlc29sdmVkLndpbmRvdztcbiAgICAgICAgbWF4ID0gcmVzb2x2ZWQubWF4O1xuICAgICAgfVxuICAgICAgaWYgKHJlc29sdmVkID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNvbnN0IHN0b3JhZ2UgPSBnZXRSYXRlTGltaXRTdG9yYWdlKGN0eCwge1xuICAgIHdpbmRvd1xuICB9KTtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IHN0b3JhZ2UuZ2V0KGtleSk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGlmICghZGF0YSkge1xuICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KGtleSwge1xuICAgICAga2V5LFxuICAgICAgY291bnQ6IDEsXG4gICAgICBsYXN0UmVxdWVzdDogbm93XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgdGltZVNpbmNlTGFzdFJlcXVlc3QgPSBub3cgLSBkYXRhLmxhc3RSZXF1ZXN0O1xuICAgIGlmIChzaG91bGRSYXRlTGltaXQobWF4LCB3aW5kb3csIGRhdGEpKSB7XG4gICAgICBjb25zdCByZXRyeUFmdGVyID0gZ2V0UmV0cnlBZnRlcihkYXRhLmxhc3RSZXF1ZXN0LCB3aW5kb3cpO1xuICAgICAgcmV0dXJuIHJhdGVMaW1pdFJlc3BvbnNlKHJldHJ5QWZ0ZXIpO1xuICAgIH0gZWxzZSBpZiAodGltZVNpbmNlTGFzdFJlcXVlc3QgPiB3aW5kb3cgKiAxZTMpIHtcbiAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KFxuICAgICAgICBrZXksXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIGNvdW50OiAxLFxuICAgICAgICAgIGxhc3RSZXF1ZXN0OiBub3dcbiAgICAgICAgfSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgc3RvcmFnZS5zZXQoXG4gICAgICAgIGtleSxcbiAgICAgICAge1xuICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgY291bnQ6IGRhdGEuY291bnQgKyAxLFxuICAgICAgICAgIGxhc3RSZXF1ZXN0OiBub3dcbiAgICAgICAgfSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGdldERlZmF1bHRTcGVjaWFsUnVsZXMoKSB7XG4gIGNvbnN0IHNwZWNpYWxSdWxlcyA9IFtcbiAgICB7XG4gICAgICBwYXRoTWF0Y2hlcihwYXRoKSB7XG4gICAgICAgIHJldHVybiBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi1pblwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi11cFwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvY2hhbmdlLXBhc3N3b3JkXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9jaGFuZ2UtZW1haWxcIik7XG4gICAgICB9LFxuICAgICAgd2luZG93OiAxMCxcbiAgICAgIG1heDogM1xuICAgIH1cbiAgXTtcbiAgcmV0dXJuIHNwZWNpYWxSdWxlcztcbn1cblxuZnVuY3Rpb24gY2hlY2tFbmRwb2ludENvbmZsaWN0cyhvcHRpb25zLCBsb2dnZXIyKSB7XG4gIGNvbnN0IGVuZHBvaW50UmVnaXN0cnkgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICBvcHRpb25zLnBsdWdpbnM/LmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgIGlmIChwbHVnaW4uZW5kcG9pbnRzKSB7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIGVuZHBvaW50XSBvZiBPYmplY3QuZW50cmllcyhwbHVnaW4uZW5kcG9pbnRzKSkge1xuICAgICAgICBpZiAoZW5kcG9pbnQgJiYgXCJwYXRoXCIgaW4gZW5kcG9pbnQpIHtcbiAgICAgICAgICBjb25zdCBwYXRoID0gZW5kcG9pbnQucGF0aDtcbiAgICAgICAgICBsZXQgbWV0aG9kcyA9IFtdO1xuICAgICAgICAgIGlmIChlbmRwb2ludC5vcHRpb25zICYmIFwibWV0aG9kXCIgaW4gZW5kcG9pbnQub3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW5kcG9pbnQub3B0aW9ucy5tZXRob2QpKSB7XG4gICAgICAgICAgICAgIG1ldGhvZHMgPSBlbmRwb2ludC5vcHRpb25zLm1ldGhvZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVuZHBvaW50Lm9wdGlvbnMubWV0aG9kID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgIG1ldGhvZHMgPSBbZW5kcG9pbnQub3B0aW9ucy5tZXRob2RdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWV0aG9kcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIG1ldGhvZHMgPSBbXCIqXCJdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWVuZHBvaW50UmVnaXN0cnkuaGFzKHBhdGgpKSB7XG4gICAgICAgICAgICBlbmRwb2ludFJlZ2lzdHJ5LnNldChwYXRoLCBbXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVuZHBvaW50UmVnaXN0cnkuZ2V0KHBhdGgpLnB1c2goe1xuICAgICAgICAgICAgcGx1Z2luSWQ6IHBsdWdpbi5pZCxcbiAgICAgICAgICAgIGVuZHBvaW50S2V5OiBrZXksXG4gICAgICAgICAgICBtZXRob2RzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBjb25zdCBjb25mbGljdHMgPSBbXTtcbiAgZm9yIChjb25zdCBbcGF0aCwgZW50cmllc10gb2YgZW5kcG9pbnRSZWdpc3RyeS5lbnRyaWVzKCkpIHtcbiAgICBpZiAoZW50cmllcy5sZW5ndGggPiAxKSB7XG4gICAgICBjb25zdCBtZXRob2RNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgICAgbGV0IGhhc0NvbmZsaWN0ID0gZmFsc2U7XG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCBtZXRob2Qgb2YgZW50cnkubWV0aG9kcykge1xuICAgICAgICAgIGlmICghbWV0aG9kTWFwLmhhcyhtZXRob2QpKSB7XG4gICAgICAgICAgICBtZXRob2RNYXAuc2V0KG1ldGhvZCwgW10pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXRob2RNYXAuZ2V0KG1ldGhvZCkucHVzaChlbnRyeS5wbHVnaW5JZCk7XG4gICAgICAgICAgaWYgKG1ldGhvZE1hcC5nZXQobWV0aG9kKS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBoYXNDb25mbGljdCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChtZXRob2QgPT09IFwiKlwiICYmIGVudHJpZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgaGFzQ29uZmxpY3QgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kICE9PSBcIipcIiAmJiBtZXRob2RNYXAuaGFzKFwiKlwiKSkge1xuICAgICAgICAgICAgaGFzQ29uZmxpY3QgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGhhc0NvbmZsaWN0KSB7XG4gICAgICAgIGNvbnN0IHVuaXF1ZVBsdWdpbnMgPSBbLi4ubmV3IFNldChlbnRyaWVzLm1hcCgoZSkgPT4gZS5wbHVnaW5JZCkpXTtcbiAgICAgICAgY29uc3QgY29uZmxpY3RpbmdNZXRob2RzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgW21ldGhvZCwgcGx1Z2luc10gb2YgbWV0aG9kTWFwLmVudHJpZXMoKSkge1xuICAgICAgICAgIGlmIChwbHVnaW5zLmxlbmd0aCA+IDEgfHwgbWV0aG9kID09PSBcIipcIiAmJiBlbnRyaWVzLmxlbmd0aCA+IDEgfHwgbWV0aG9kICE9PSBcIipcIiAmJiBtZXRob2RNYXAuaGFzKFwiKlwiKSkge1xuICAgICAgICAgICAgY29uZmxpY3RpbmdNZXRob2RzLnB1c2gobWV0aG9kKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uZmxpY3RzLnB1c2goe1xuICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgcGx1Z2luczogdW5pcXVlUGx1Z2lucyxcbiAgICAgICAgICBjb25mbGljdGluZ01ldGhvZHNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChjb25mbGljdHMubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGNvbmZsaWN0TWVzc2FnZXMgPSBjb25mbGljdHMubWFwKFxuICAgICAgKGNvbmZsaWN0KSA9PiBgICAtIFwiJHtjb25mbGljdC5wYXRofVwiIFske2NvbmZsaWN0LmNvbmZsaWN0aW5nTWV0aG9kcy5qb2luKFwiLCBcIil9XSB1c2VkIGJ5IHBsdWdpbnM6ICR7Y29uZmxpY3QucGx1Z2lucy5qb2luKFwiLCBcIil9YFxuICAgICkuam9pbihcIlxcblwiKTtcbiAgICBsb2dnZXIyLmVycm9yKFxuICAgICAgYEVuZHBvaW50IHBhdGggY29uZmxpY3RzIGRldGVjdGVkISBNdWx0aXBsZSBwbHVnaW5zIGFyZSB0cnlpbmcgdG8gdXNlIHRoZSBzYW1lIGVuZHBvaW50IHBhdGhzIHdpdGggY29uZmxpY3RpbmcgSFRUUCBtZXRob2RzOlxuJHtjb25mbGljdE1lc3NhZ2VzfVxuXG5UbyByZXNvbHZlIHRoaXMsIHlvdSBjYW46XG5cdDEuIFVzZSBvbmx5IG9uZSBvZiB0aGUgY29uZmxpY3RpbmcgcGx1Z2luc1xuXHQyLiBDb25maWd1cmUgdGhlIHBsdWdpbnMgdG8gdXNlIGRpZmZlcmVudCBwYXRocyAoaWYgc3VwcG9ydGVkKVxuXHQzLiBFbnN1cmUgcGx1Z2lucyB1c2UgZGlmZmVyZW50IEhUVFAgbWV0aG9kcyBmb3IgdGhlIHNhbWUgcGF0aFxuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldEVuZHBvaW50cyhjdHgsIG9wdGlvbnMpIHtcbiAgY29uc3QgcGx1Z2luRW5kcG9pbnRzID0gb3B0aW9ucy5wbHVnaW5zPy5yZWR1Y2UoKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmFjYyxcbiAgICAgIC4uLnBsdWdpbi5lbmRwb2ludHNcbiAgICB9O1xuICB9LCB7fSkgPz8ge307XG4gIGNvbnN0IG1pZGRsZXdhcmVzID0gb3B0aW9ucy5wbHVnaW5zPy5tYXAoXG4gICAgKHBsdWdpbikgPT4gcGx1Z2luLm1pZGRsZXdhcmVzPy5tYXAoKG0pID0+IHtcbiAgICAgIGNvbnN0IG1pZGRsZXdhcmUgPSAoYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgICAgICAgY29uc3QgYXV0aENvbnRleHQgPSBhd2FpdCBjdHg7XG4gICAgICAgIHJldHVybiBtLm1pZGRsZXdhcmUoe1xuICAgICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgLi4uYXV0aENvbnRleHQsXG4gICAgICAgICAgICAuLi5jb250ZXh0LmNvbnRleHRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBtaWRkbGV3YXJlLm9wdGlvbnMgPSBtLm1pZGRsZXdhcmUub3B0aW9ucztcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGg6IG0ucGF0aCxcbiAgICAgICAgbWlkZGxld2FyZVxuICAgICAgfTtcbiAgICB9KVxuICApLmZpbHRlcigocGx1Z2luKSA9PiBwbHVnaW4gIT09IHZvaWQgMCkuZmxhdCgpIHx8IFtdO1xuICBjb25zdCBiYXNlRW5kcG9pbnRzID0ge1xuICAgIHNpZ25JblNvY2lhbCxcbiAgICBjYWxsYmFja09BdXRoLFxuICAgIGdldFNlc3Npb246IGdldFNlc3Npb24oKSxcbiAgICBzaWduT3V0LFxuICAgIHNpZ25VcEVtYWlsOiBzaWduVXBFbWFpbCgpLFxuICAgIHNpZ25JbkVtYWlsLFxuICAgIGZvcmdldFBhc3N3b3JkLFxuICAgIHJlc2V0UGFzc3dvcmQsXG4gICAgdmVyaWZ5RW1haWwsXG4gICAgc2VuZFZlcmlmaWNhdGlvbkVtYWlsLFxuICAgIGNoYW5nZUVtYWlsLFxuICAgIGNoYW5nZVBhc3N3b3JkLFxuICAgIHNldFBhc3N3b3JkLFxuICAgIHVwZGF0ZVVzZXI6IHVwZGF0ZVVzZXIoKSxcbiAgICBkZWxldGVVc2VyLFxuICAgIGZvcmdldFBhc3N3b3JkQ2FsbGJhY2ssXG4gICAgcmVxdWVzdFBhc3N3b3JkUmVzZXQsXG4gICAgcmVxdWVzdFBhc3N3b3JkUmVzZXRDYWxsYmFjayxcbiAgICBsaXN0U2Vzc2lvbnM6IGxpc3RTZXNzaW9ucygpLFxuICAgIHJldm9rZVNlc3Npb24sXG4gICAgcmV2b2tlU2Vzc2lvbnMsXG4gICAgcmV2b2tlT3RoZXJTZXNzaW9ucyxcbiAgICBsaW5rU29jaWFsQWNjb3VudCxcbiAgICBsaXN0VXNlckFjY291bnRzLFxuICAgIGRlbGV0ZVVzZXJDYWxsYmFjayxcbiAgICB1bmxpbmtBY2NvdW50LFxuICAgIHJlZnJlc2hUb2tlbixcbiAgICBnZXRBY2Nlc3NUb2tlbixcbiAgICBhY2NvdW50SW5mb1xuICB9O1xuICBjb25zdCBlbmRwb2ludHMgPSB7XG4gICAgLi4uYmFzZUVuZHBvaW50cyxcbiAgICAuLi5wbHVnaW5FbmRwb2ludHMsXG4gICAgb2ssXG4gICAgZXJyb3JcbiAgfTtcbiAgY29uc3QgYXBpID0gdG9BdXRoRW5kcG9pbnRzKGVuZHBvaW50cywgY3R4KTtcbiAgcmV0dXJuIHtcbiAgICBhcGksXG4gICAgbWlkZGxld2FyZXNcbiAgfTtcbn1cbmNvbnN0IHJvdXRlciA9IChjdHgsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgeyBhcGksIG1pZGRsZXdhcmVzIH0gPSBnZXRFbmRwb2ludHMoY3R4LCBvcHRpb25zKTtcbiAgY29uc3QgYmFzZVBhdGggPSBuZXcgVVJMKGN0eC5iYXNlVVJMKS5wYXRobmFtZTtcbiAgcmV0dXJuIGNyZWF0ZVJvdXRlcihhcGksIHtcbiAgICByb3V0ZXJDb250ZXh0OiBjdHgsXG4gICAgb3BlbmFwaToge1xuICAgICAgZGlzYWJsZWQ6IHRydWVcbiAgICB9LFxuICAgIGJhc2VQYXRoLFxuICAgIHJvdXRlck1pZGRsZXdhcmU6IFtcbiAgICAgIHtcbiAgICAgICAgcGF0aDogXCIvKipcIixcbiAgICAgICAgbWlkZGxld2FyZTogb3JpZ2luQ2hlY2tNaWRkbGV3YXJlXG4gICAgICB9LFxuICAgICAgLi4ubWlkZGxld2FyZXNcbiAgICBdLFxuICAgIGFzeW5jIG9uUmVxdWVzdChyZXEpIHtcbiAgICAgIGNvbnN0IGRpc2FibGVkUGF0aHMgPSBjdHgub3B0aW9ucy5kaXNhYmxlZFBhdGhzIHx8IFtdO1xuICAgICAgY29uc3QgcGF0aCA9IG5ldyBVUkwocmVxLnVybCkucGF0aG5hbWUucmVwbGFjZShiYXNlUGF0aCwgXCJcIik7XG4gICAgICBpZiAoZGlzYWJsZWRQYXRocy5pbmNsdWRlcyhwYXRoKSkge1xuICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFwiTm90IEZvdW5kXCIsIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBjdHgub3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgICAgIGlmIChwbHVnaW4ub25SZXF1ZXN0KSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwbHVnaW4ub25SZXF1ZXN0KHJlcSwgY3R4KTtcbiAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgXCJyZXNwb25zZVwiIGluIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucmVzcG9uc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChyZXNwb25zZSAmJiBcInJlcXVlc3RcIiBpbiByZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc3QgcmF0ZUxpbWl0UmVzcG9uc2UgPSBhd2FpdCBvblJlcXVlc3RSYXRlTGltaXQoXG4gICAgICAgICAgICAgIHJlc3BvbnNlLnJlcXVlc3QsXG4gICAgICAgICAgICAgIGN0eFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChyYXRlTGltaXRSZXNwb25zZSkge1xuICAgICAgICAgICAgICByZXR1cm4gcmF0ZUxpbWl0UmVzcG9uc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucmVxdWVzdDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvblJlcXVlc3RSYXRlTGltaXQocmVxLCBjdHgpO1xuICAgIH0sXG4gICAgYXN5bmMgb25SZXNwb25zZShyZXMpIHtcbiAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIGN0eC5vcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICAgICAgaWYgKHBsdWdpbi5vblJlc3BvbnNlKSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwbHVnaW4ub25SZXNwb25zZShyZXMsIGN0eCk7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucmVzcG9uc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgb25FcnJvcihlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yICYmIGUuc3RhdHVzID09PSBcIkZPVU5EXCIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMub25BUElFcnJvcj8udGhyb3cpIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLm9uQVBJRXJyb3I/Lm9uRXJyb3IpIHtcbiAgICAgICAgb3B0aW9ucy5vbkFQSUVycm9yLm9uRXJyb3IoZSwgY3R4KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgb3B0TG9nTGV2ZWwgPSBvcHRpb25zLmxvZ2dlcj8ubGV2ZWw7XG4gICAgICBjb25zdCBsb2cgPSBvcHRMb2dMZXZlbCA9PT0gXCJlcnJvclwiIHx8IG9wdExvZ0xldmVsID09PSBcIndhcm5cIiB8fCBvcHRMb2dMZXZlbCA9PT0gXCJkZWJ1Z1wiID8gbG9nZ2VyIDogdm9pZCAwO1xuICAgICAgaWYgKG9wdGlvbnMubG9nZ2VyPy5kaXNhYmxlZCAhPT0gdHJ1ZSkge1xuICAgICAgICBpZiAoZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm1lc3NhZ2VcIiBpbiBlICYmIHR5cGVvZiBlLm1lc3NhZ2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKFwibm8gY29sdW1uXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcImNvbHVtblwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJyZWxhdGlvblwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJ0YWJsZVwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJkb2VzIG5vdCBleGlzdFwiKSkge1xuICAgICAgICAgICAgY3R4LmxvZ2dlcj8uZXJyb3IoZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgIGlmIChlLnN0YXR1cyA9PT0gXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIikge1xuICAgICAgICAgICAgY3R4LmxvZ2dlci5lcnJvcihlLnN0YXR1cywgZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxvZz8uZXJyb3IoZS5tZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdHgubG9nZ2VyPy5lcnJvcihcbiAgICAgICAgICAgIGUgJiYgdHlwZW9mIGUgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZSA/IGUubmFtZSA6IFwiXCIsXG4gICAgICAgICAgICBlXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5leHBvcnQgeyBhY2NvdW50SW5mbywgY2FsbGJhY2tPQXV0aCwgY2hhbmdlRW1haWwsIGNoYW5nZVBhc3N3b3JkLCBjaGVja0VuZHBvaW50Q29uZmxpY3RzLCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuLCBkZWxldGVVc2VyLCBkZWxldGVVc2VyQ2FsbGJhY2ssIGVycm9yLCBmb3JnZXRQYXNzd29yZCwgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjaywgZ2V0QWNjZXNzVG9rZW4sIGdldEVuZHBvaW50cywgZ2V0U2Vzc2lvbiwgbGlua1NvY2lhbEFjY291bnQsIGxpc3RTZXNzaW9ucywgbGlzdFVzZXJBY2NvdW50cywgb2ssIG9yaWdpbkNoZWNrTWlkZGxld2FyZSwgcmVmcmVzaFRva2VuLCByZXF1ZXN0UGFzc3dvcmRSZXNldCwgcmVxdWVzdFBhc3N3b3JkUmVzZXRDYWxsYmFjaywgcmVzZXRQYXNzd29yZCwgcmV2b2tlT3RoZXJTZXNzaW9ucywgcmV2b2tlU2Vzc2lvbiwgcmV2b2tlU2Vzc2lvbnMsIHJvdXRlciwgc2VuZFZlcmlmaWNhdGlvbkVtYWlsLCBzZXRQYXNzd29yZCwgc2lnbkluRW1haWwsIHNpZ25JblNvY2lhbCwgc2lnbk91dCwgc2lnblVwRW1haWwsIHVubGlua0FjY291bnQsIHVwZGF0ZVVzZXIsIHZlcmlmeUVtYWlsIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/api/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs":
/*!*****************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs ***!
  \*****************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BunSqliteAdapter: () => (/* binding */ BunSqliteAdapter),\n/* harmony export */   BunSqliteDialect: () => (/* binding */ BunSqliteDialect),\n/* harmony export */   BunSqliteDriver: () => (/* binding */ BunSqliteDriver),\n/* harmony export */   BunSqliteIntrospector: () => (/* binding */ BunSqliteIntrospector),\n/* harmony export */   BunSqliteQueryCompiler: () => (/* binding */ BunSqliteQueryCompiler)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/query-compiler/compiled-query.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/migration/migrator.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/raw-builder/sql.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/query-compiler/default-query-compiler.js\");\n\n\nclass BunSqliteAdapter {\n  get supportsCreateIfNotExists() {\n    return true;\n  }\n  get supportsTransactionalDdl() {\n    return false;\n  }\n  get supportsReturning() {\n    return true;\n  }\n  async acquireMigrationLock() {\n  }\n  async releaseMigrationLock() {\n  }\n  get supportsOutput() {\n    return true;\n  }\n}\nclass BunSqliteDriver {\n  #config;\n  #connectionMutex = new ConnectionMutex();\n  #db;\n  #connection;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  async init() {\n    this.#db = this.#config.database;\n    this.#connection = new BunSqliteConnection(this.#db);\n    if (this.#config.onCreateConnection) {\n      await this.#config.onCreateConnection(this.#connection);\n    }\n  }\n  async acquireConnection() {\n    await this.#connectionMutex.lock();\n    return this.#connection;\n  }\n  async beginTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"begin\"));\n  }\n  async commitTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"commit\"));\n  }\n  async rollbackTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"rollback\"));\n  }\n  async releaseConnection() {\n    this.#connectionMutex.unlock();\n  }\n  async destroy() {\n    this.#db?.close();\n  }\n}\nclass BunSqliteConnection {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  executeQuery(compiledQuery) {\n    const { sql: sql2, parameters } = compiledQuery;\n    const stmt = this.#db.prepare(sql2);\n    return Promise.resolve({\n      rows: stmt.all(parameters)\n    });\n  }\n  async *streamQuery() {\n    throw new Error(\"Streaming query is not supported by SQLite driver.\");\n  }\n}\nclass ConnectionMutex {\n  #promise;\n  #resolve;\n  async lock() {\n    while (this.#promise) {\n      await this.#promise;\n    }\n    this.#promise = new Promise((resolve) => {\n      this.#resolve = resolve;\n    });\n  }\n  unlock() {\n    const resolve = this.#resolve;\n    this.#promise = void 0;\n    this.#resolve = void 0;\n    resolve?.();\n  }\n}\nclass BunSqliteIntrospector {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  async getSchemas() {\n    return [];\n  }\n  async getTables(options = { withInternalKyselyTables: false }) {\n    let query = this.#db.selectFrom(\"sqlite_schema\").where(\"type\", \"=\", \"table\").where(\"name\", \"not like\", \"sqlite_%\").select(\"name\").$castTo();\n    if (!options.withInternalKyselyTables) {\n      query = query.where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_TABLE).where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_LOCK_TABLE);\n    }\n    const tables = await query.execute();\n    return Promise.all(tables.map(({ name }) => this.#getTableMetadata(name)));\n  }\n  async getMetadata(options) {\n    return {\n      tables: await this.getTables(options)\n    };\n  }\n  async #getTableMetadata(table) {\n    const db = this.#db;\n    const createSql = await db.selectFrom(\"sqlite_master\").where(\"name\", \"=\", table).select(\"sql\").$castTo().execute();\n    const autoIncrementCol = createSql[0]?.sql?.split(/[\\(\\),]/)?.find((it) => it.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g, \"\");\n    const columns = await db.selectFrom(\n      (0,kysely__WEBPACK_IMPORTED_MODULE_2__.sql)`pragma_table_info(${table})`.as(\"table_info\")\n    ).select([\"name\", \"type\", \"notnull\", \"dflt_value\"]).execute();\n    return {\n      name: table,\n      columns: columns.map((col) => ({\n        name: col.name,\n        dataType: col.type,\n        isNullable: !col.notnull,\n        isAutoIncrementing: col.name === autoIncrementCol,\n        hasDefaultValue: col.dflt_value != null\n      })),\n      isView: true\n    };\n  }\n}\nclass BunSqliteQueryCompiler extends kysely__WEBPACK_IMPORTED_MODULE_3__.DefaultQueryCompiler {\n  getCurrentParameterPlaceholder() {\n    return \"?\";\n  }\n  getLeftIdentifierWrapper() {\n    return '\"';\n  }\n  getRightIdentifierWrapper() {\n    return '\"';\n  }\n  getAutoIncrement() {\n    return \"autoincrement\";\n  }\n}\nclass BunSqliteDialect {\n  #config;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  createDriver() {\n    return new BunSqliteDriver(this.#config);\n  }\n  createQueryCompiler() {\n    return new BunSqliteQueryCompiler();\n  }\n  createAdapter() {\n    return new BunSqliteAdapter();\n  }\n  createIntrospector(db) {\n    return new BunSqliteIntrospector(db);\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rcy9idW4tc3FsaXRlLWRpYWxlY3QubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF5SDs7QUFFekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGlEQUFhO0FBQy9DO0FBQ0E7QUFDQSxrQ0FBa0MsaURBQWE7QUFDL0M7QUFDQTtBQUNBLGtDQUFrQyxpREFBYTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsaUNBQWlDO0FBQy9EO0FBQ0E7QUFDQSx3Q0FBd0MsMkRBQXVCLHNCQUFzQixnRUFBNEI7QUFDakg7QUFDQTtBQUNBLHFDQUFxQyxNQUFNO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLDJDQUFHLHFCQUFxQixNQUFNO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx3REFBb0I7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFOEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmtzL2J1bi1zcWxpdGUtZGlhbGVjdC5tanM/YjMzYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21waWxlZFF1ZXJ5LCBEZWZhdWx0UXVlcnlDb21waWxlciwgREVGQVVMVF9NSUdSQVRJT05fVEFCTEUsIERFRkFVTFRfTUlHUkFUSU9OX0xPQ0tfVEFCTEUsIHNxbCB9IGZyb20gJ2t5c2VseSc7XG5cbmNsYXNzIEJ1blNxbGl0ZUFkYXB0ZXIge1xuICBnZXQgc3VwcG9ydHNDcmVhdGVJZk5vdEV4aXN0cygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBnZXQgc3VwcG9ydHNUcmFuc2FjdGlvbmFsRGRsKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBnZXQgc3VwcG9ydHNSZXR1cm5pbmcoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgYXN5bmMgYWNxdWlyZU1pZ3JhdGlvbkxvY2soKSB7XG4gIH1cbiAgYXN5bmMgcmVsZWFzZU1pZ3JhdGlvbkxvY2soKSB7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzT3V0cHV0KCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5jbGFzcyBCdW5TcWxpdGVEcml2ZXIge1xuICAjY29uZmlnO1xuICAjY29ubmVjdGlvbk11dGV4ID0gbmV3IENvbm5lY3Rpb25NdXRleCgpO1xuICAjZGI7XG4gICNjb25uZWN0aW9uO1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLiNjb25maWcgPSB7IC4uLmNvbmZpZyB9O1xuICB9XG4gIGFzeW5jIGluaXQoKSB7XG4gICAgdGhpcy4jZGIgPSB0aGlzLiNjb25maWcuZGF0YWJhc2U7XG4gICAgdGhpcy4jY29ubmVjdGlvbiA9IG5ldyBCdW5TcWxpdGVDb25uZWN0aW9uKHRoaXMuI2RiKTtcbiAgICBpZiAodGhpcy4jY29uZmlnLm9uQ3JlYXRlQ29ubmVjdGlvbikge1xuICAgICAgYXdhaXQgdGhpcy4jY29uZmlnLm9uQ3JlYXRlQ29ubmVjdGlvbih0aGlzLiNjb25uZWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgYWNxdWlyZUNvbm5lY3Rpb24oKSB7XG4gICAgYXdhaXQgdGhpcy4jY29ubmVjdGlvbk11dGV4LmxvY2soKTtcbiAgICByZXR1cm4gdGhpcy4jY29ubmVjdGlvbjtcbiAgfVxuICBhc3luYyBiZWdpblRyYW5zYWN0aW9uKGNvbm5lY3Rpb24pIHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGVRdWVyeShDb21waWxlZFF1ZXJ5LnJhdyhcImJlZ2luXCIpKTtcbiAgfVxuICBhc3luYyBjb21taXRUcmFuc2FjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlUXVlcnkoQ29tcGlsZWRRdWVyeS5yYXcoXCJjb21taXRcIikpO1xuICB9XG4gIGFzeW5jIHJvbGxiYWNrVHJhbnNhY3Rpb24oY29ubmVjdGlvbikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZVF1ZXJ5KENvbXBpbGVkUXVlcnkucmF3KFwicm9sbGJhY2tcIikpO1xuICB9XG4gIGFzeW5jIHJlbGVhc2VDb25uZWN0aW9uKCkge1xuICAgIHRoaXMuI2Nvbm5lY3Rpb25NdXRleC51bmxvY2soKTtcbiAgfVxuICBhc3luYyBkZXN0cm95KCkge1xuICAgIHRoaXMuI2RiPy5jbG9zZSgpO1xuICB9XG59XG5jbGFzcyBCdW5TcWxpdGVDb25uZWN0aW9uIHtcbiAgI2RiO1xuICBjb25zdHJ1Y3RvcihkYikge1xuICAgIHRoaXMuI2RiID0gZGI7XG4gIH1cbiAgZXhlY3V0ZVF1ZXJ5KGNvbXBpbGVkUXVlcnkpIHtcbiAgICBjb25zdCB7IHNxbDogc3FsMiwgcGFyYW1ldGVycyB9ID0gY29tcGlsZWRRdWVyeTtcbiAgICBjb25zdCBzdG10ID0gdGhpcy4jZGIucHJlcGFyZShzcWwyKTtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgIHJvd3M6IHN0bXQuYWxsKHBhcmFtZXRlcnMpXG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgKnN0cmVhbVF1ZXJ5KCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlN0cmVhbWluZyBxdWVyeSBpcyBub3Qgc3VwcG9ydGVkIGJ5IFNRTGl0ZSBkcml2ZXIuXCIpO1xuICB9XG59XG5jbGFzcyBDb25uZWN0aW9uTXV0ZXgge1xuICAjcHJvbWlzZTtcbiAgI3Jlc29sdmU7XG4gIGFzeW5jIGxvY2soKSB7XG4gICAgd2hpbGUgKHRoaXMuI3Byb21pc2UpIHtcbiAgICAgIGF3YWl0IHRoaXMuI3Byb21pc2U7XG4gICAgfVxuICAgIHRoaXMuI3Byb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy4jcmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgfSk7XG4gIH1cbiAgdW5sb2NrKCkge1xuICAgIGNvbnN0IHJlc29sdmUgPSB0aGlzLiNyZXNvbHZlO1xuICAgIHRoaXMuI3Byb21pc2UgPSB2b2lkIDA7XG4gICAgdGhpcy4jcmVzb2x2ZSA9IHZvaWQgMDtcbiAgICByZXNvbHZlPy4oKTtcbiAgfVxufVxuY2xhc3MgQnVuU3FsaXRlSW50cm9zcGVjdG9yIHtcbiAgI2RiO1xuICBjb25zdHJ1Y3RvcihkYikge1xuICAgIHRoaXMuI2RiID0gZGI7XG4gIH1cbiAgYXN5bmMgZ2V0U2NoZW1hcygpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgYXN5bmMgZ2V0VGFibGVzKG9wdGlvbnMgPSB7IHdpdGhJbnRlcm5hbEt5c2VseVRhYmxlczogZmFsc2UgfSkge1xuICAgIGxldCBxdWVyeSA9IHRoaXMuI2RiLnNlbGVjdEZyb20oXCJzcWxpdGVfc2NoZW1hXCIpLndoZXJlKFwidHlwZVwiLCBcIj1cIiwgXCJ0YWJsZVwiKS53aGVyZShcIm5hbWVcIiwgXCJub3QgbGlrZVwiLCBcInNxbGl0ZV8lXCIpLnNlbGVjdChcIm5hbWVcIikuJGNhc3RUbygpO1xuICAgIGlmICghb3B0aW9ucy53aXRoSW50ZXJuYWxLeXNlbHlUYWJsZXMpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoXCJuYW1lXCIsIFwiIT1cIiwgREVGQVVMVF9NSUdSQVRJT05fVEFCTEUpLndoZXJlKFwibmFtZVwiLCBcIiE9XCIsIERFRkFVTFRfTUlHUkFUSU9OX0xPQ0tfVEFCTEUpO1xuICAgIH1cbiAgICBjb25zdCB0YWJsZXMgPSBhd2FpdCBxdWVyeS5leGVjdXRlKCk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRhYmxlcy5tYXAoKHsgbmFtZSB9KSA9PiB0aGlzLiNnZXRUYWJsZU1ldGFkYXRhKG5hbWUpKSk7XG4gIH1cbiAgYXN5bmMgZ2V0TWV0YWRhdGEob3B0aW9ucykge1xuICAgIHJldHVybiB7XG4gICAgICB0YWJsZXM6IGF3YWl0IHRoaXMuZ2V0VGFibGVzKG9wdGlvbnMpXG4gICAgfTtcbiAgfVxuICBhc3luYyAjZ2V0VGFibGVNZXRhZGF0YSh0YWJsZSkge1xuICAgIGNvbnN0IGRiID0gdGhpcy4jZGI7XG4gICAgY29uc3QgY3JlYXRlU3FsID0gYXdhaXQgZGIuc2VsZWN0RnJvbShcInNxbGl0ZV9tYXN0ZXJcIikud2hlcmUoXCJuYW1lXCIsIFwiPVwiLCB0YWJsZSkuc2VsZWN0KFwic3FsXCIpLiRjYXN0VG8oKS5leGVjdXRlKCk7XG4gICAgY29uc3QgYXV0b0luY3JlbWVudENvbCA9IGNyZWF0ZVNxbFswXT8uc3FsPy5zcGxpdCgvW1xcKFxcKSxdLyk/LmZpbmQoKGl0KSA9PiBpdC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYXV0b2luY3JlbWVudFwiKSk/LnNwbGl0KC9cXHMrLyk/LlswXT8ucmVwbGFjZSgvW1wiYF0vZywgXCJcIik7XG4gICAgY29uc3QgY29sdW1ucyA9IGF3YWl0IGRiLnNlbGVjdEZyb20oXG4gICAgICBzcWxgcHJhZ21hX3RhYmxlX2luZm8oJHt0YWJsZX0pYC5hcyhcInRhYmxlX2luZm9cIilcbiAgICApLnNlbGVjdChbXCJuYW1lXCIsIFwidHlwZVwiLCBcIm5vdG51bGxcIiwgXCJkZmx0X3ZhbHVlXCJdKS5leGVjdXRlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRhYmxlLFxuICAgICAgY29sdW1uczogY29sdW1ucy5tYXAoKGNvbCkgPT4gKHtcbiAgICAgICAgbmFtZTogY29sLm5hbWUsXG4gICAgICAgIGRhdGFUeXBlOiBjb2wudHlwZSxcbiAgICAgICAgaXNOdWxsYWJsZTogIWNvbC5ub3RudWxsLFxuICAgICAgICBpc0F1dG9JbmNyZW1lbnRpbmc6IGNvbC5uYW1lID09PSBhdXRvSW5jcmVtZW50Q29sLFxuICAgICAgICBoYXNEZWZhdWx0VmFsdWU6IGNvbC5kZmx0X3ZhbHVlICE9IG51bGxcbiAgICAgIH0pKSxcbiAgICAgIGlzVmlldzogdHJ1ZVxuICAgIH07XG4gIH1cbn1cbmNsYXNzIEJ1blNxbGl0ZVF1ZXJ5Q29tcGlsZXIgZXh0ZW5kcyBEZWZhdWx0UXVlcnlDb21waWxlciB7XG4gIGdldEN1cnJlbnRQYXJhbWV0ZXJQbGFjZWhvbGRlcigpIHtcbiAgICByZXR1cm4gXCI/XCI7XG4gIH1cbiAgZ2V0TGVmdElkZW50aWZpZXJXcmFwcGVyKCkge1xuICAgIHJldHVybiAnXCInO1xuICB9XG4gIGdldFJpZ2h0SWRlbnRpZmllcldyYXBwZXIoKSB7XG4gICAgcmV0dXJuICdcIic7XG4gIH1cbiAgZ2V0QXV0b0luY3JlbWVudCgpIHtcbiAgICByZXR1cm4gXCJhdXRvaW5jcmVtZW50XCI7XG4gIH1cbn1cbmNsYXNzIEJ1blNxbGl0ZURpYWxlY3Qge1xuICAjY29uZmlnO1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLiNjb25maWcgPSB7IC4uLmNvbmZpZyB9O1xuICB9XG4gIGNyZWF0ZURyaXZlcigpIHtcbiAgICByZXR1cm4gbmV3IEJ1blNxbGl0ZURyaXZlcih0aGlzLiNjb25maWcpO1xuICB9XG4gIGNyZWF0ZVF1ZXJ5Q29tcGlsZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBCdW5TcWxpdGVRdWVyeUNvbXBpbGVyKCk7XG4gIH1cbiAgY3JlYXRlQWRhcHRlcigpIHtcbiAgICByZXR1cm4gbmV3IEJ1blNxbGl0ZUFkYXB0ZXIoKTtcbiAgfVxuICBjcmVhdGVJbnRyb3NwZWN0b3IoZGIpIHtcbiAgICByZXR1cm4gbmV3IEJ1blNxbGl0ZUludHJvc3BlY3RvcihkYik7XG4gIH1cbn1cblxuZXhwb3J0IHsgQnVuU3FsaXRlQWRhcHRlciwgQnVuU3FsaXRlRGlhbGVjdCwgQnVuU3FsaXRlRHJpdmVyLCBCdW5TcWxpdGVJbnRyb3NwZWN0b3IsIEJ1blNxbGl0ZVF1ZXJ5Q29tcGlsZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs":
/*!******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs ***!
  \******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NodeSqliteAdapter: () => (/* binding */ NodeSqliteAdapter),\n/* harmony export */   NodeSqliteDialect: () => (/* binding */ NodeSqliteDialect),\n/* harmony export */   NodeSqliteDriver: () => (/* binding */ NodeSqliteDriver),\n/* harmony export */   NodeSqliteIntrospector: () => (/* binding */ NodeSqliteIntrospector),\n/* harmony export */   NodeSqliteQueryCompiler: () => (/* binding */ NodeSqliteQueryCompiler)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/query-compiler/compiled-query.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/migration/migrator.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/raw-builder/sql.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/query-compiler/default-query-compiler.js\");\n\n\nclass NodeSqliteAdapter {\n  get supportsCreateIfNotExists() {\n    return true;\n  }\n  get supportsTransactionalDdl() {\n    return false;\n  }\n  get supportsReturning() {\n    return true;\n  }\n  async acquireMigrationLock() {\n  }\n  async releaseMigrationLock() {\n  }\n  get supportsOutput() {\n    return true;\n  }\n}\nclass NodeSqliteDriver {\n  #config;\n  #connectionMutex = new ConnectionMutex();\n  #db;\n  #connection;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  async init() {\n    this.#db = this.#config.database;\n    this.#connection = new NodeSqliteConnection(this.#db);\n    if (this.#config.onCreateConnection) {\n      await this.#config.onCreateConnection(this.#connection);\n    }\n  }\n  async acquireConnection() {\n    await this.#connectionMutex.lock();\n    return this.#connection;\n  }\n  async beginTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"begin\"));\n  }\n  async commitTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"commit\"));\n  }\n  async rollbackTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"rollback\"));\n  }\n  async releaseConnection() {\n    this.#connectionMutex.unlock();\n  }\n  async destroy() {\n    this.#db?.close();\n  }\n}\nclass NodeSqliteConnection {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  executeQuery(compiledQuery) {\n    const { sql: sql2, parameters } = compiledQuery;\n    const stmt = this.#db.prepare(sql2);\n    const rows = stmt.all(...parameters);\n    return Promise.resolve({\n      rows\n    });\n  }\n  async *streamQuery() {\n    throw new Error(\"Streaming query is not supported by SQLite driver.\");\n  }\n}\nclass ConnectionMutex {\n  #promise;\n  #resolve;\n  async lock() {\n    while (this.#promise) {\n      await this.#promise;\n    }\n    this.#promise = new Promise((resolve) => {\n      this.#resolve = resolve;\n    });\n  }\n  unlock() {\n    const resolve = this.#resolve;\n    this.#promise = void 0;\n    this.#resolve = void 0;\n    resolve?.();\n  }\n}\nclass NodeSqliteIntrospector {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  async getSchemas() {\n    return [];\n  }\n  async getTables(options = { withInternalKyselyTables: false }) {\n    let query = this.#db.selectFrom(\"sqlite_schema\").where(\"type\", \"=\", \"table\").where(\"name\", \"not like\", \"sqlite_%\").select(\"name\").$castTo();\n    if (!options.withInternalKyselyTables) {\n      query = query.where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_TABLE).where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_LOCK_TABLE);\n    }\n    const tables = await query.execute();\n    return Promise.all(tables.map(({ name }) => this.#getTableMetadata(name)));\n  }\n  async getMetadata(options) {\n    return {\n      tables: await this.getTables(options)\n    };\n  }\n  async #getTableMetadata(table) {\n    const db = this.#db;\n    const createSql = await db.selectFrom(\"sqlite_master\").where(\"name\", \"=\", table).select(\"sql\").$castTo().execute();\n    const autoIncrementCol = createSql[0]?.sql?.split(/[\\(\\),]/)?.find((it) => it.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g, \"\");\n    const columns = await db.selectFrom(\n      (0,kysely__WEBPACK_IMPORTED_MODULE_2__.sql)`pragma_table_info(${table})`.as(\"table_info\")\n    ).select([\"name\", \"type\", \"notnull\", \"dflt_value\"]).execute();\n    return {\n      name: table,\n      columns: columns.map((col) => ({\n        name: col.name,\n        dataType: col.type,\n        isNullable: !col.notnull,\n        isAutoIncrementing: col.name === autoIncrementCol,\n        hasDefaultValue: col.dflt_value != null\n      })),\n      isView: true\n    };\n  }\n}\nclass NodeSqliteQueryCompiler extends kysely__WEBPACK_IMPORTED_MODULE_3__.DefaultQueryCompiler {\n  getCurrentParameterPlaceholder() {\n    return \"?\";\n  }\n  getLeftIdentifierWrapper() {\n    return '\"';\n  }\n  getRightIdentifierWrapper() {\n    return '\"';\n  }\n  getAutoIncrement() {\n    return \"autoincrement\";\n  }\n}\nclass NodeSqliteDialect {\n  #config;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  createDriver() {\n    return new NodeSqliteDriver(this.#config);\n  }\n  createQueryCompiler() {\n    return new NodeSqliteQueryCompiler();\n  }\n  createAdapter() {\n    return new NodeSqliteAdapter();\n  }\n  createIntrospector(db) {\n    return new NodeSqliteIntrospector(db);\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rcy9ub2RlLXNxbGl0ZS1kaWFsZWN0Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBeUg7O0FBRXpIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpREFBYTtBQUMvQztBQUNBO0FBQ0Esa0NBQWtDLGlEQUFhO0FBQy9DO0FBQ0E7QUFDQSxrQ0FBa0MsaURBQWE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0JBQXdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsaUNBQWlDO0FBQy9EO0FBQ0E7QUFDQSx3Q0FBd0MsMkRBQXVCLHNCQUFzQixnRUFBNEI7QUFDakg7QUFDQTtBQUNBLHFDQUFxQyxNQUFNO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLDJDQUFHLHFCQUFxQixNQUFNO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyx3REFBb0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFbUgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmtzL25vZGUtc3FsaXRlLWRpYWxlY3QubWpzPzdhOTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcGlsZWRRdWVyeSwgRGVmYXVsdFF1ZXJ5Q29tcGlsZXIsIERFRkFVTFRfTUlHUkFUSU9OX1RBQkxFLCBERUZBVUxUX01JR1JBVElPTl9MT0NLX1RBQkxFLCBzcWwgfSBmcm9tICdreXNlbHknO1xuXG5jbGFzcyBOb2RlU3FsaXRlQWRhcHRlciB7XG4gIGdldCBzdXBwb3J0c0NyZWF0ZUlmTm90RXhpc3RzKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGdldCBzdXBwb3J0c1RyYW5zYWN0aW9uYWxEZGwoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGdldCBzdXBwb3J0c1JldHVybmluZygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBhc3luYyBhY3F1aXJlTWlncmF0aW9uTG9jaygpIHtcbiAgfVxuICBhc3luYyByZWxlYXNlTWlncmF0aW9uTG9jaygpIHtcbiAgfVxuICBnZXQgc3VwcG9ydHNPdXRwdXQoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cbmNsYXNzIE5vZGVTcWxpdGVEcml2ZXIge1xuICAjY29uZmlnO1xuICAjY29ubmVjdGlvbk11dGV4ID0gbmV3IENvbm5lY3Rpb25NdXRleCgpO1xuICAjZGI7XG4gICNjb25uZWN0aW9uO1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLiNjb25maWcgPSB7IC4uLmNvbmZpZyB9O1xuICB9XG4gIGFzeW5jIGluaXQoKSB7XG4gICAgdGhpcy4jZGIgPSB0aGlzLiNjb25maWcuZGF0YWJhc2U7XG4gICAgdGhpcy4jY29ubmVjdGlvbiA9IG5ldyBOb2RlU3FsaXRlQ29ubmVjdGlvbih0aGlzLiNkYik7XG4gICAgaWYgKHRoaXMuI2NvbmZpZy5vbkNyZWF0ZUNvbm5lY3Rpb24pIHtcbiAgICAgIGF3YWl0IHRoaXMuI2NvbmZpZy5vbkNyZWF0ZUNvbm5lY3Rpb24odGhpcy4jY29ubmVjdGlvbik7XG4gICAgfVxuICB9XG4gIGFzeW5jIGFjcXVpcmVDb25uZWN0aW9uKCkge1xuICAgIGF3YWl0IHRoaXMuI2Nvbm5lY3Rpb25NdXRleC5sb2NrKCk7XG4gICAgcmV0dXJuIHRoaXMuI2Nvbm5lY3Rpb247XG4gIH1cbiAgYXN5bmMgYmVnaW5UcmFuc2FjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlUXVlcnkoQ29tcGlsZWRRdWVyeS5yYXcoXCJiZWdpblwiKSk7XG4gIH1cbiAgYXN5bmMgY29tbWl0VHJhbnNhY3Rpb24oY29ubmVjdGlvbikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZVF1ZXJ5KENvbXBpbGVkUXVlcnkucmF3KFwiY29tbWl0XCIpKTtcbiAgfVxuICBhc3luYyByb2xsYmFja1RyYW5zYWN0aW9uKGNvbm5lY3Rpb24pIHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGVRdWVyeShDb21waWxlZFF1ZXJ5LnJhdyhcInJvbGxiYWNrXCIpKTtcbiAgfVxuICBhc3luYyByZWxlYXNlQ29ubmVjdGlvbigpIHtcbiAgICB0aGlzLiNjb25uZWN0aW9uTXV0ZXgudW5sb2NrKCk7XG4gIH1cbiAgYXN5bmMgZGVzdHJveSgpIHtcbiAgICB0aGlzLiNkYj8uY2xvc2UoKTtcbiAgfVxufVxuY2xhc3MgTm9kZVNxbGl0ZUNvbm5lY3Rpb24ge1xuICAjZGI7XG4gIGNvbnN0cnVjdG9yKGRiKSB7XG4gICAgdGhpcy4jZGIgPSBkYjtcbiAgfVxuICBleGVjdXRlUXVlcnkoY29tcGlsZWRRdWVyeSkge1xuICAgIGNvbnN0IHsgc3FsOiBzcWwyLCBwYXJhbWV0ZXJzIH0gPSBjb21waWxlZFF1ZXJ5O1xuICAgIGNvbnN0IHN0bXQgPSB0aGlzLiNkYi5wcmVwYXJlKHNxbDIpO1xuICAgIGNvbnN0IHJvd3MgPSBzdG10LmFsbCguLi5wYXJhbWV0ZXJzKTtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgIHJvd3NcbiAgICB9KTtcbiAgfVxuICBhc3luYyAqc3RyZWFtUXVlcnkoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiU3RyZWFtaW5nIHF1ZXJ5IGlzIG5vdCBzdXBwb3J0ZWQgYnkgU1FMaXRlIGRyaXZlci5cIik7XG4gIH1cbn1cbmNsYXNzIENvbm5lY3Rpb25NdXRleCB7XG4gICNwcm9taXNlO1xuICAjcmVzb2x2ZTtcbiAgYXN5bmMgbG9jaygpIHtcbiAgICB3aGlsZSAodGhpcy4jcHJvbWlzZSkge1xuICAgICAgYXdhaXQgdGhpcy4jcHJvbWlzZTtcbiAgICB9XG4gICAgdGhpcy4jcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0aGlzLiNyZXNvbHZlID0gcmVzb2x2ZTtcbiAgICB9KTtcbiAgfVxuICB1bmxvY2soKSB7XG4gICAgY29uc3QgcmVzb2x2ZSA9IHRoaXMuI3Jlc29sdmU7XG4gICAgdGhpcy4jcHJvbWlzZSA9IHZvaWQgMDtcbiAgICB0aGlzLiNyZXNvbHZlID0gdm9pZCAwO1xuICAgIHJlc29sdmU/LigpO1xuICB9XG59XG5jbGFzcyBOb2RlU3FsaXRlSW50cm9zcGVjdG9yIHtcbiAgI2RiO1xuICBjb25zdHJ1Y3RvcihkYikge1xuICAgIHRoaXMuI2RiID0gZGI7XG4gIH1cbiAgYXN5bmMgZ2V0U2NoZW1hcygpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgYXN5bmMgZ2V0VGFibGVzKG9wdGlvbnMgPSB7IHdpdGhJbnRlcm5hbEt5c2VseVRhYmxlczogZmFsc2UgfSkge1xuICAgIGxldCBxdWVyeSA9IHRoaXMuI2RiLnNlbGVjdEZyb20oXCJzcWxpdGVfc2NoZW1hXCIpLndoZXJlKFwidHlwZVwiLCBcIj1cIiwgXCJ0YWJsZVwiKS53aGVyZShcIm5hbWVcIiwgXCJub3QgbGlrZVwiLCBcInNxbGl0ZV8lXCIpLnNlbGVjdChcIm5hbWVcIikuJGNhc3RUbygpO1xuICAgIGlmICghb3B0aW9ucy53aXRoSW50ZXJuYWxLeXNlbHlUYWJsZXMpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoXCJuYW1lXCIsIFwiIT1cIiwgREVGQVVMVF9NSUdSQVRJT05fVEFCTEUpLndoZXJlKFwibmFtZVwiLCBcIiE9XCIsIERFRkFVTFRfTUlHUkFUSU9OX0xPQ0tfVEFCTEUpO1xuICAgIH1cbiAgICBjb25zdCB0YWJsZXMgPSBhd2FpdCBxdWVyeS5leGVjdXRlKCk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRhYmxlcy5tYXAoKHsgbmFtZSB9KSA9PiB0aGlzLiNnZXRUYWJsZU1ldGFkYXRhKG5hbWUpKSk7XG4gIH1cbiAgYXN5bmMgZ2V0TWV0YWRhdGEob3B0aW9ucykge1xuICAgIHJldHVybiB7XG4gICAgICB0YWJsZXM6IGF3YWl0IHRoaXMuZ2V0VGFibGVzKG9wdGlvbnMpXG4gICAgfTtcbiAgfVxuICBhc3luYyAjZ2V0VGFibGVNZXRhZGF0YSh0YWJsZSkge1xuICAgIGNvbnN0IGRiID0gdGhpcy4jZGI7XG4gICAgY29uc3QgY3JlYXRlU3FsID0gYXdhaXQgZGIuc2VsZWN0RnJvbShcInNxbGl0ZV9tYXN0ZXJcIikud2hlcmUoXCJuYW1lXCIsIFwiPVwiLCB0YWJsZSkuc2VsZWN0KFwic3FsXCIpLiRjYXN0VG8oKS5leGVjdXRlKCk7XG4gICAgY29uc3QgYXV0b0luY3JlbWVudENvbCA9IGNyZWF0ZVNxbFswXT8uc3FsPy5zcGxpdCgvW1xcKFxcKSxdLyk/LmZpbmQoKGl0KSA9PiBpdC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYXV0b2luY3JlbWVudFwiKSk/LnNwbGl0KC9cXHMrLyk/LlswXT8ucmVwbGFjZSgvW1wiYF0vZywgXCJcIik7XG4gICAgY29uc3QgY29sdW1ucyA9IGF3YWl0IGRiLnNlbGVjdEZyb20oXG4gICAgICBzcWxgcHJhZ21hX3RhYmxlX2luZm8oJHt0YWJsZX0pYC5hcyhcInRhYmxlX2luZm9cIilcbiAgICApLnNlbGVjdChbXCJuYW1lXCIsIFwidHlwZVwiLCBcIm5vdG51bGxcIiwgXCJkZmx0X3ZhbHVlXCJdKS5leGVjdXRlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRhYmxlLFxuICAgICAgY29sdW1uczogY29sdW1ucy5tYXAoKGNvbCkgPT4gKHtcbiAgICAgICAgbmFtZTogY29sLm5hbWUsXG4gICAgICAgIGRhdGFUeXBlOiBjb2wudHlwZSxcbiAgICAgICAgaXNOdWxsYWJsZTogIWNvbC5ub3RudWxsLFxuICAgICAgICBpc0F1dG9JbmNyZW1lbnRpbmc6IGNvbC5uYW1lID09PSBhdXRvSW5jcmVtZW50Q29sLFxuICAgICAgICBoYXNEZWZhdWx0VmFsdWU6IGNvbC5kZmx0X3ZhbHVlICE9IG51bGxcbiAgICAgIH0pKSxcbiAgICAgIGlzVmlldzogdHJ1ZVxuICAgIH07XG4gIH1cbn1cbmNsYXNzIE5vZGVTcWxpdGVRdWVyeUNvbXBpbGVyIGV4dGVuZHMgRGVmYXVsdFF1ZXJ5Q29tcGlsZXIge1xuICBnZXRDdXJyZW50UGFyYW1ldGVyUGxhY2Vob2xkZXIoKSB7XG4gICAgcmV0dXJuIFwiP1wiO1xuICB9XG4gIGdldExlZnRJZGVudGlmaWVyV3JhcHBlcigpIHtcbiAgICByZXR1cm4gJ1wiJztcbiAgfVxuICBnZXRSaWdodElkZW50aWZpZXJXcmFwcGVyKCkge1xuICAgIHJldHVybiAnXCInO1xuICB9XG4gIGdldEF1dG9JbmNyZW1lbnQoKSB7XG4gICAgcmV0dXJuIFwiYXV0b2luY3JlbWVudFwiO1xuICB9XG59XG5jbGFzcyBOb2RlU3FsaXRlRGlhbGVjdCB7XG4gICNjb25maWc7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuI2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG4gIH1cbiAgY3JlYXRlRHJpdmVyKCkge1xuICAgIHJldHVybiBuZXcgTm9kZVNxbGl0ZURyaXZlcih0aGlzLiNjb25maWcpO1xuICB9XG4gIGNyZWF0ZVF1ZXJ5Q29tcGlsZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBOb2RlU3FsaXRlUXVlcnlDb21waWxlcigpO1xuICB9XG4gIGNyZWF0ZUFkYXB0ZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBOb2RlU3FsaXRlQWRhcHRlcigpO1xuICB9XG4gIGNyZWF0ZUludHJvc3BlY3RvcihkYikge1xuICAgIHJldHVybiBuZXcgTm9kZVNxbGl0ZUludHJvc3BlY3RvcihkYik7XG4gIH1cbn1cblxuZXhwb3J0IHsgTm9kZVNxbGl0ZUFkYXB0ZXIsIE5vZGVTcWxpdGVEaWFsZWN0LCBOb2RlU3FsaXRlRHJpdmVyLCBOb2RlU3FsaXRlSW50cm9zcGVjdG9yLCBOb2RlU3FsaXRlUXVlcnlDb21waWxlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compareHash: () => (/* binding */ compareHash),\n/* harmony export */   constantTimeEqual: () => (/* binding */ constantTimeEqual),\n/* harmony export */   generateRandomString: () => (/* reexport safe */ _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_4__.g),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   hashToBase64: () => (/* binding */ hashToBase64),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   symmetricDecrypt: () => (/* binding */ symmetricDecrypt),\n/* harmony export */   symmetricEncrypt: () => (/* binding */ symmetricEncrypt),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @noble/ciphers/chacha.js */ \"(rsc)/./node_modules/.pnpm/@noble+ciphers@2.0.1/node_modules/@noble/ciphers/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @noble/ciphers/utils.js */ \"(rsc)/./node_modules/.pnpm/@noble+ciphers@2.0.1/node_modules/@noble/ciphers/utils.js\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@6.1.0/node_modules/jose/dist/webapi/jwt/sign.js\");\n/* harmony import */ var _noble_hashes_scrypt_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @noble/hashes/scrypt.js */ \"(rsc)/./node_modules/.pnpm/@noble+hashes@2.0.1/node_modules/@noble/hashes/scrypt.js\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/hashes/utils.js */ \"(rsc)/./node_modules/.pnpm/@noble+hashes@2.0.1/node_modules/@noble/hashes/utils.js\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\nasync function signJWT(payload, secret, expiresIn = 3600) {\n  const jwt = await new jose__WEBPACK_IMPORTED_MODULE_6__.SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n  return jwt;\n}\n\nfunction constantTimeEqual(a, b) {\n  const aBuffer = new Uint8Array(a);\n  const bBuffer = new Uint8Array(b);\n  let c = aBuffer.length ^ bBuffer.length;\n  const length = Math.max(aBuffer.length, bBuffer.length);\n  for (let i = 0; i < length; i++) {\n    c |= (i < aBuffer.length ? aBuffer[i] : 0) ^ (i < bBuffer.length ? bBuffer[i] : 0);\n  }\n  return c === 0;\n}\n\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__.base64.encode(buffer);\n}\nasync function compareHash(data, hash) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(\n    typeof data === \"string\" ? new TextEncoder().encode(data) : data\n  );\n  const hashBuffer = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__.base64.decode(hash);\n  return constantTimeEqual(buffer, hashBuffer);\n}\n\nconst config = {\n  N: 16384,\n  r: 16,\n  p: 1,\n  dkLen: 64\n};\nasync function generateKey(password, salt) {\n  return await (0,_noble_hashes_scrypt_js__WEBPACK_IMPORTED_MODULE_7__.scryptAsync)(password.normalize(\"NFKC\"), salt, {\n    N: config.N,\n    p: config.p,\n    r: config.r,\n    dkLen: config.dkLen,\n    maxmem: 128 * config.N * config.r * 2\n  });\n}\nconst hashPassword = async (password) => {\n  const salt = _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(crypto.getRandomValues(new Uint8Array(16)));\n  const key = await generateKey(password, salt);\n  return `${salt}:${_better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(key)}`;\n};\nconst verifyPassword = async ({\n  hash,\n  password\n}) => {\n  const [salt, key] = hash.split(\":\");\n  if (!salt || !key) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"Invalid password hash\");\n  }\n  const targetKey = await generateKey(password, salt);\n  return constantTimeEqual(targetKey, (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_8__.hexToBytes)(key));\n};\n\nconst symmetricEncrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.utf8ToBytes)(data);\n  const chacha = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.managedNonce)(_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_10__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.bytesToHex)(chacha.encrypt(dataAsBytes));\n};\nconst symmetricDecrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.hexToBytes)(data);\n  const chacha = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_9__.managedNonce)(_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_10__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NyeXB0by9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUQ7QUFDUTtBQUMrQztBQUN6RDtBQUNwQjtBQUN1QjtBQUNUO0FBQ087QUFDTTtBQUNxQjtBQUM1Qzs7QUFFbkM7QUFDQSx3QkFBd0IseUNBQU8sK0JBQStCLGNBQWM7QUFDNUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsbUVBQVU7QUFDakMsU0FBUyw2REFBTTtBQUNmO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQVU7QUFDakM7QUFDQTtBQUNBLHFCQUFxQiw2REFBTTtBQUMzQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvRUFBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxlQUFlLHVEQUFHO0FBQ2xCO0FBQ0EsWUFBWSxLQUFLLEdBQUcsdURBQUcsYUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsY0FBYyxvRUFBZTtBQUM3QjtBQUNBO0FBQ0Esc0NBQXNDLGtFQUFVO0FBQ2hEOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwyQkFBMkIsbUVBQVU7QUFDckMsc0JBQXNCLG9FQUFXO0FBQ2pDLGlCQUFpQixxRUFBWSxDQUFDLHdFQUFpQjtBQUMvQyxTQUFTLG1FQUFVO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDJCQUEyQixtRUFBVTtBQUNyQyxzQkFBc0IsbUVBQVk7QUFDbEMsaUJBQWlCLHFFQUFZLENBQUMsd0VBQWlCO0FBQy9DO0FBQ0E7O0FBRW1JIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NyeXB0by9pbmRleC5tanM/YmNjMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0IHsgeGNoYWNoYTIwcG9seTEzMDUgfSBmcm9tICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0IHsgdXRmOFRvQnl0ZXMsIG1hbmFnZWROb25jZSwgYnl0ZXNUb0hleCwgaGV4VG9CeXRlcyBhcyBoZXhUb0J5dGVzJDEgfSBmcm9tICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgeyBiYXNlNjQgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IFNpZ25KV1QgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHNjcnlwdEFzeW5jIH0gZnJvbSAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0IHsgaGV4IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgeyBoZXhUb0J5dGVzIH0gZnJvbSAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5leHBvcnQgeyBnIGFzIGdlbmVyYXRlUmFuZG9tU3RyaW5nIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuXG5hc3luYyBmdW5jdGlvbiBzaWduSldUKHBheWxvYWQsIHNlY3JldCwgZXhwaXJlc0luID0gMzYwMCkge1xuICBjb25zdCBqd3QgPSBhd2FpdCBuZXcgU2lnbkpXVChwYXlsb2FkKS5zZXRQcm90ZWN0ZWRIZWFkZXIoeyBhbGc6IFwiSFMyNTZcIiB9KS5zZXRJc3N1ZWRBdCgpLnNldEV4cGlyYXRpb25UaW1lKE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDFlMykgKyBleHBpcmVzSW4pLnNpZ24obmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlY3JldCkpO1xuICByZXR1cm4gand0O1xufVxuXG5mdW5jdGlvbiBjb25zdGFudFRpbWVFcXVhbChhLCBiKSB7XG4gIGNvbnN0IGFCdWZmZXIgPSBuZXcgVWludDhBcnJheShhKTtcbiAgY29uc3QgYkJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGIpO1xuICBsZXQgYyA9IGFCdWZmZXIubGVuZ3RoIF4gYkJ1ZmZlci5sZW5ndGg7XG4gIGNvbnN0IGxlbmd0aCA9IE1hdGgubWF4KGFCdWZmZXIubGVuZ3RoLCBiQnVmZmVyLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBjIHw9IChpIDwgYUJ1ZmZlci5sZW5ndGggPyBhQnVmZmVyW2ldIDogMCkgXiAoaSA8IGJCdWZmZXIubGVuZ3RoID8gYkJ1ZmZlcltpXSA6IDApO1xuICB9XG4gIHJldHVybiBjID09PSAwO1xufVxuXG5hc3luYyBmdW5jdGlvbiBoYXNoVG9CYXNlNjQoZGF0YSkge1xuICBjb25zdCBidWZmZXIgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3QoZGF0YSk7XG4gIHJldHVybiBiYXNlNjQuZW5jb2RlKGJ1ZmZlcik7XG59XG5hc3luYyBmdW5jdGlvbiBjb21wYXJlSGFzaChkYXRhLCBoYXNoKSB7XG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChcbiAgICB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIiA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShkYXRhKSA6IGRhdGFcbiAgKTtcbiAgY29uc3QgaGFzaEJ1ZmZlciA9IGJhc2U2NC5kZWNvZGUoaGFzaCk7XG4gIHJldHVybiBjb25zdGFudFRpbWVFcXVhbChidWZmZXIsIGhhc2hCdWZmZXIpO1xufVxuXG5jb25zdCBjb25maWcgPSB7XG4gIE46IDE2Mzg0LFxuICByOiAxNixcbiAgcDogMSxcbiAgZGtMZW46IDY0XG59O1xuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpIHtcbiAgcmV0dXJuIGF3YWl0IHNjcnlwdEFzeW5jKHBhc3N3b3JkLm5vcm1hbGl6ZShcIk5GS0NcIiksIHNhbHQsIHtcbiAgICBOOiBjb25maWcuTixcbiAgICBwOiBjb25maWcucCxcbiAgICByOiBjb25maWcucixcbiAgICBka0xlbjogY29uZmlnLmRrTGVuLFxuICAgIG1heG1lbTogMTI4ICogY29uZmlnLk4gKiBjb25maWcuciAqIDJcbiAgfSk7XG59XG5jb25zdCBoYXNoUGFzc3dvcmQgPSBhc3luYyAocGFzc3dvcmQpID0+IHtcbiAgY29uc3Qgc2FsdCA9IGhleC5lbmNvZGUoY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxNikpKTtcbiAgY29uc3Qga2V5ID0gYXdhaXQgZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpO1xuICByZXR1cm4gYCR7c2FsdH06JHtoZXguZW5jb2RlKGtleSl9YDtcbn07XG5jb25zdCB2ZXJpZnlQYXNzd29yZCA9IGFzeW5jICh7XG4gIGhhc2gsXG4gIHBhc3N3b3JkXG59KSA9PiB7XG4gIGNvbnN0IFtzYWx0LCBrZXldID0gaGFzaC5zcGxpdChcIjpcIik7XG4gIGlmICghc2FsdCB8fCAha2V5KSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkludmFsaWQgcGFzc3dvcmQgaGFzaFwiKTtcbiAgfVxuICBjb25zdCB0YXJnZXRLZXkgPSBhd2FpdCBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCk7XG4gIHJldHVybiBjb25zdGFudFRpbWVFcXVhbCh0YXJnZXRLZXksIGhleFRvQnl0ZXMoa2V5KSk7XG59O1xuXG5jb25zdCBzeW1tZXRyaWNFbmNyeXB0ID0gYXN5bmMgKHtcbiAga2V5LFxuICBkYXRhXG59KSA9PiB7XG4gIGNvbnN0IGtleUFzQnl0ZXMgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3Qoa2V5KTtcbiAgY29uc3QgZGF0YUFzQnl0ZXMgPSB1dGY4VG9CeXRlcyhkYXRhKTtcbiAgY29uc3QgY2hhY2hhID0gbWFuYWdlZE5vbmNlKHhjaGFjaGEyMHBvbHkxMzA1KShuZXcgVWludDhBcnJheShrZXlBc0J5dGVzKSk7XG4gIHJldHVybiBieXRlc1RvSGV4KGNoYWNoYS5lbmNyeXB0KGRhdGFBc0J5dGVzKSk7XG59O1xuY29uc3Qgc3ltbWV0cmljRGVjcnlwdCA9IGFzeW5jICh7XG4gIGtleSxcbiAgZGF0YVxufSkgPT4ge1xuICBjb25zdCBrZXlBc0J5dGVzID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGtleSk7XG4gIGNvbnN0IGRhdGFBc0J5dGVzID0gaGV4VG9CeXRlcyQxKGRhdGEpO1xuICBjb25zdCBjaGFjaGEgPSBtYW5hZ2VkTm9uY2UoeGNoYWNoYTIwcG9seTEzMDUpKG5ldyBVaW50OEFycmF5KGtleUFzQnl0ZXMpKTtcbiAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShjaGFjaGEuZGVjcnlwdChkYXRhQXNCeXRlcykpO1xufTtcblxuZXhwb3J0IHsgY29tcGFyZUhhc2gsIGNvbnN0YW50VGltZUVxdWFsLCBoYXNoUGFzc3dvcmQsIGhhc2hUb0Jhc2U2NCwgc2lnbkpXVCwgc3ltbWV0cmljRGVjcnlwdCwgc3ltbWV0cmljRW5jcnlwdCwgdmVyaWZ5UGFzc3dvcmQgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/index.mjs":
/*!*********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/index.mjs ***!
  \*********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_10__.APIError),\n/* harmony export */   BASE_ERROR_CODES: () => (/* reexport safe */ _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__.BASE_ERROR_CODES),\n/* harmony export */   BetterAuthError: () => (/* reexport safe */ _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError),\n/* harmony export */   ENV: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.ENV),\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__.H),\n/* harmony export */   TTY_COLORS: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.TTY_COLORS),\n/* harmony export */   betterAuth: () => (/* reexport safe */ _shared_better_auth_CDx1PoNO_mjs__WEBPACK_IMPORTED_MODULE_5__.b),\n/* harmony export */   capitalizeFirstLetter: () => (/* reexport safe */ _shared_better_auth_D_2CmEwz_mjs__WEBPACK_IMPORTED_MODULE_6__.c),\n/* harmony export */   clientCredentialsToken: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.clientCredentialsToken),\n/* harmony export */   createAuthorizationCodeRequest: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationCodeRequest),\n/* harmony export */   createAuthorizationURL: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL),\n/* harmony export */   createClientCredentialsTokenRequest: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createClientCredentialsTokenRequest),\n/* harmony export */   createLogger: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.createLogger),\n/* harmony export */   createRefreshAccessTokenRequest: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createRefreshAccessTokenRequest),\n/* harmony export */   createTelemetry: () => (/* reexport safe */ _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_9__.createTelemetry),\n/* harmony export */   defineErrorCodes: () => (/* reexport safe */ _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_4__.defineErrorCodes),\n/* harmony export */   env: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env),\n/* harmony export */   generateCodeChallenge: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.generateCodeChallenge),\n/* harmony export */   generateId: () => (/* reexport safe */ _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_8__.g),\n/* harmony export */   generateState: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__.g),\n/* harmony export */   getBooleanEnvVar: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getBooleanEnvVar),\n/* harmony export */   getColorDepth: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getColorDepth),\n/* harmony export */   getEnvVar: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getEnvVar),\n/* harmony export */   getOAuth2Tokens: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.getOAuth2Tokens),\n/* harmony export */   getTelemetryAuthConfig: () => (/* reexport safe */ _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_9__.getTelemetryAuthConfig),\n/* harmony export */   isDevelopment: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isDevelopment),\n/* harmony export */   isProduction: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isProduction),\n/* harmony export */   isTest: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest),\n/* harmony export */   levels: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.levels),\n/* harmony export */   logger: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger),\n/* harmony export */   nodeENV: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.nodeENV),\n/* harmony export */   parseState: () => (/* reexport safe */ _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__.p),\n/* harmony export */   refreshAccessToken: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken),\n/* harmony export */   shouldPublishLog: () => (/* reexport safe */ _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.shouldPublishLog),\n/* harmony export */   validateAuthorizationCode: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode),\n/* harmony export */   validateToken: () => (/* reexport safe */ _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateToken)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/index.mjs\");\n/* harmony import */ var _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/oauth2 */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/oauth2/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/utils */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/utils/index.mjs\");\n/* harmony import */ var _shared_better_auth_CDx1PoNO_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./shared/better-auth.CDx1PoNO.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs\");\n/* harmony import */ var _shared_better_auth_D_2CmEwz_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./shared/better-auth.D-2CmEwz.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs\");\n/* harmony import */ var _shared_better_auth_BX9UB8EP_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./shared/better-auth.BX9UB8EP.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/telemetry */ \"(rsc)/./node_modules/.pnpm/@better-auth+telemetry@1.3._9689844af577e247fe82d98ccf8641df/node_modules/@better-auth/telemetry/dist/index.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _shared_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./shared/better-auth.DEBtROF9.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _api_index_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./api/index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/api/index.mjs\");\n/* harmony import */ var _shared_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./shared/better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var _shared_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./shared/better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _shared_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./shared/better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _shared_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./shared/better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _shared_better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./shared/better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n/* harmony import */ var _shared_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./shared/better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _shared_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./shared/better-auth.ClH5r3NH.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./crypto/index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _shared_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./shared/better-auth.BG42OQGC.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs\");\n/* harmony import */ var _shared_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./shared/better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _shared_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./shared/better-auth.CBTS2OzX.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\");\n/* harmony import */ var _shared_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./shared/better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n/* harmony import */ var _shared_better_auth_BNpIwq4C_mjs__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./shared/better-auth.BNpIwq4C.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _shared_better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./shared/better-auth.YwDQhoPc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0M7QUFDSjtBQUNPO0FBQ0Q7QUFDQTtBQUM0QjtBQUNXO0FBQzZCO0FBQ3hDO0FBQ2E7QUFDMUM7QUFDSTtBQUM5QjtBQUN5QjtBQUNIO0FBQ0Y7QUFDRTtBQUNMO0FBQ2Q7QUFDc0I7QUFDYjtBQUNrQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNGO0FBQ0M7QUFDRDtBQUNuQjtBQUNtQjtBQUNEO0FBQ0E7QUFDVztBQUNBO0FBQzdCO0FBQ2M7QUFDZTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDRDtBQUN0QiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9pbmRleC5tanM/ZDYzMyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuZXhwb3J0ICogZnJvbSAnQGJldHRlci1hdXRoL2NvcmUnO1xuZXhwb3J0ICogZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvb2F1dGgyJztcbmV4cG9ydCAqIGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcbmV4cG9ydCAqIGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL3V0aWxzJztcbmV4cG9ydCB7IGIgYXMgYmV0dGVyQXV0aCB9IGZyb20gJy4vc2hhcmVkL2JldHRlci1hdXRoLkNEeDFQb05PLm1qcyc7XG5leHBvcnQgeyBjIGFzIGNhcGl0YWxpemVGaXJzdExldHRlciB9IGZyb20gJy4vc2hhcmVkL2JldHRlci1hdXRoLkQtMkNtRXd6Lm1qcyc7XG5leHBvcnQgeyBIIGFzIEhJREVfTUVUQURBVEEsIGcgYXMgZ2VuZXJhdGVTdGF0ZSwgcCBhcyBwYXJzZVN0YXRlIH0gZnJvbSAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQlg5VUI4RVAubWpzJztcbmV4cG9ydCB7IGcgYXMgZ2VuZXJhdGVJZCB9IGZyb20gJy4vc2hhcmVkL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcyc7XG5leHBvcnQgeyBjcmVhdGVUZWxlbWV0cnksIGdldFRlbGVtZXRyeUF1dGhDb25maWcgfSBmcm9tICdAYmV0dGVyLWF1dGgvdGVsZW1ldHJ5JztcbmV4cG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5ERUJ0Uk9GOS5tanMnO1xuaW1wb3J0ICd6b2QnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9taWRkbGV3YXJlJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2JpbmFyeSc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL2RiJztcbmltcG9ydCAna3lzZWx5JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGIvYWRhcHRlcic7XG5pbXBvcnQgJy4vYXBpL2luZGV4Lm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkQ5X3ZRUjgzLm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkRSM1I1d2RVLm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkloOEM3NlZvLm1qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkN3ajlkdDZpLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CNFFveGRnYy5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5DbEg1cjNOSC5tanMnO1xuaW1wb3J0ICdkZWZ1JztcbmltcG9ydCAnLi9jcnlwdG8vaW5kZXgubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQkc0Mk9RR0MubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGgucFFqZVJrek4ubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ0JUUzJPelgubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQk5wSXdxNEMubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvc29jaWFsLXByb3ZpZGVycyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLll3RFFob1BjLm1qcyc7XG5pbXBvcnQgJ2pvc2UvZXJyb3JzJztcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/integrations/next-js.mjs":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/integrations/next-js.mjs ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   nextCookies: () => (/* binding */ nextCookies),\n/* harmony export */   toNextJsHandler: () => (/* binding */ toNextJsHandler)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _shared_better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../shared/better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/middleware/index.mjs\");\n\n\n\n\n\n\n\n\nfunction toNextJsHandler(auth) {\n  const handler = async (request) => {\n    return \"handler\" in auth ? auth.handler(request) : auth(request);\n  };\n  return {\n    GET: handler,\n    POST: handler\n  };\n}\nconst nextCookies = () => {\n  return {\n    id: \"next-cookies\",\n    hooks: {\n      after: [\n        {\n          matcher(ctx) {\n            return true;\n          },\n          handler: (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_6__.createAuthMiddleware)(async (ctx) => {\n            const returned = ctx.context.responseHeaders;\n            if (\"_flag\" in ctx && ctx._flag === \"router\") {\n              return;\n            }\n            if (returned instanceof Headers) {\n              const setCookies = returned?.get(\"set-cookie\");\n              if (!setCookies) return;\n              const parsed = (0,_shared_better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_5__.p)(setCookies);\n              const { cookies } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/next@14.2.33_react-dom@18.3.1_react@18.3.1__react@18.3.1\").then(__webpack_require__.bind(__webpack_require__, /*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@14.2.33_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/api/headers.js\"));\n              let cookieHelper;\n              try {\n                cookieHelper = await cookies();\n              } catch (error) {\n                if (error instanceof Error && error.message.startsWith(\n                  \"`cookies` was called outside a request scope.\"\n                )) {\n                  return;\n                }\n                throw error;\n              }\n              parsed.forEach((value, key) => {\n                if (!key) return;\n                const opts = {\n                  sameSite: value.samesite,\n                  secure: value.secure,\n                  maxAge: value[\"max-age\"],\n                  httpOnly: value.httponly,\n                  domain: value.domain,\n                  path: value.path\n                };\n                try {\n                  cookieHelper.set(key, decodeURIComponent(value.value), opts);\n                } catch (e) {\n                }\n              });\n              return;\n            }\n          })\n        }\n      ]\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2ludGVncmF0aW9ucy9uZXh0LWpzLm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBaUM7QUFDRjtBQUNJO0FBQ0Y7QUFDRTtBQUM0QztBQUNYOztBQUVwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLG1CQUFtQixrRkFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsbUVBQW9CO0FBQ2pELHNCQUFzQixVQUFVLFFBQVEsb1RBQXNCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXdDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2ludGVncmF0aW9ucy9uZXh0LWpzLm1qcz9mZTlkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCB7IHAgYXMgcGFyc2VTZXRDb29raWVIZWFkZXIgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguSWg4Qzc2Vm8ubWpzJztcbmltcG9ydCB7IGNyZWF0ZUF1dGhNaWRkbGV3YXJlIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvbWlkZGxld2FyZSc7XG5cbmZ1bmN0aW9uIHRvTmV4dEpzSGFuZGxlcihhdXRoKSB7XG4gIGNvbnN0IGhhbmRsZXIgPSBhc3luYyAocmVxdWVzdCkgPT4ge1xuICAgIHJldHVybiBcImhhbmRsZXJcIiBpbiBhdXRoID8gYXV0aC5oYW5kbGVyKHJlcXVlc3QpIDogYXV0aChyZXF1ZXN0KTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBHRVQ6IGhhbmRsZXIsXG4gICAgUE9TVDogaGFuZGxlclxuICB9O1xufVxuY29uc3QgbmV4dENvb2tpZXMgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibmV4dC1jb29raWVzXCIsXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGN0eCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXR1cm5lZCA9IGN0eC5jb250ZXh0LnJlc3BvbnNlSGVhZGVycztcbiAgICAgICAgICAgIGlmIChcIl9mbGFnXCIgaW4gY3R4ICYmIGN0eC5fZmxhZyA9PT0gXCJyb3V0ZXJcIikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmV0dXJuZWQgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHNldENvb2tpZXMgPSByZXR1cm5lZD8uZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICAgICAgICAgICAgaWYgKCFzZXRDb29raWVzKSByZXR1cm47XG4gICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlU2V0Q29va2llSGVhZGVyKHNldENvb2tpZXMpO1xuICAgICAgICAgICAgICBjb25zdCB7IGNvb2tpZXMgfSA9IGF3YWl0IGltcG9ydCgnbmV4dC9oZWFkZXJzJyk7XG4gICAgICAgICAgICAgIGxldCBjb29raWVIZWxwZXI7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29va2llSGVscGVyID0gYXdhaXQgY29va2llcygpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2Uuc3RhcnRzV2l0aChcbiAgICAgICAgICAgICAgICAgIFwiYGNvb2tpZXNgIHdhcyBjYWxsZWQgb3V0c2lkZSBhIHJlcXVlc3Qgc2NvcGUuXCJcbiAgICAgICAgICAgICAgICApKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHBhcnNlZC5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFrZXkpIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRzID0ge1xuICAgICAgICAgICAgICAgICAgc2FtZVNpdGU6IHZhbHVlLnNhbWVzaXRlLFxuICAgICAgICAgICAgICAgICAgc2VjdXJlOiB2YWx1ZS5zZWN1cmUsXG4gICAgICAgICAgICAgICAgICBtYXhBZ2U6IHZhbHVlW1wibWF4LWFnZVwiXSxcbiAgICAgICAgICAgICAgICAgIGh0dHBPbmx5OiB2YWx1ZS5odHRwb25seSxcbiAgICAgICAgICAgICAgICAgIGRvbWFpbjogdmFsdWUuZG9tYWluLFxuICAgICAgICAgICAgICAgICAgcGF0aDogdmFsdWUucGF0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGNvb2tpZUhlbHBlci5zZXQoa2V5LCBkZWNvZGVVUklDb21wb25lbnQodmFsdWUudmFsdWUpLCBvcHRzKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgeyBuZXh0Q29va2llcywgdG9OZXh0SnNIYW5kbGVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/integrations/next-js.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ generateRandomString)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\nconst generateRandomString = (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\n  \"a-z\",\n  \"0-9\",\n  \"A-Z\",\n  \"-_\"\n);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CNFFveGRnYy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBd0U7O0FBRXhFLDZCQUE2QixzRkFBMkI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFcUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcz9kZjc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuXG5jb25zdCBnZW5lcmF0ZVJhbmRvbVN0cmluZyA9IGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvcihcbiAgXCJhLXpcIixcbiAgXCIwLTlcIixcbiAgXCJBLVpcIixcbiAgXCItX1wiXG4pO1xuXG5leHBvcnQgeyBnZW5lcmF0ZVJhbmRvbVN0cmluZyBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getAdapter),\n/* harmony export */   b: () => (/* binding */ convertToDB),\n/* harmony export */   c: () => (/* binding */ createInternalAdapter),\n/* harmony export */   d: () => (/* binding */ convertFromDB),\n/* harmony export */   e: () => (/* binding */ getMigrations),\n/* harmony export */   f: () => (/* binding */ getSchema),\n/* harmony export */   g: () => (/* binding */ getWithHooks),\n/* harmony export */   m: () => (/* binding */ matchType)\n/* harmony export */ });\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.ClH5r3NH.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.CBTS2OzX.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _better_auth_BNpIwq4C_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./better-auth.BNpIwq4C.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/raw-builder/sql.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getWithHooks(adapter, ctx) {\n  const hooks = ctx.hooks;\n  async function createWithHooks(data, model, customCreateFn, context, trxAdapter) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.before;\n      if (toRun) {\n        const result = await toRun(actualData, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\" && \"data\" in result;\n        if (isObject) {\n          actualData = {\n            ...actualData,\n            ...result.data\n          };\n        }\n      }\n    }\n    const customCreated = customCreateFn ? await customCreateFn.fn(actualData) : null;\n    const created = !customCreateFn || customCreateFn.executeMainFn ? await (trxAdapter || adapter).create({\n      model,\n      data: actualData,\n      forceAllowId: true\n    }) : customCreated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.after;\n      if (toRun) {\n        await toRun(created, context);\n      }\n    }\n    return created;\n  }\n  async function updateWithHooks(data, where, model, customUpdateFn, context, trxAdapter) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await (trxAdapter || adapter).update({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated, context);\n      }\n    }\n    return updated;\n  }\n  async function updateManyWithHooks(data, where, model, customUpdateFn, context, trxAdapter) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await (trxAdapter || adapter).updateMany({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated, context);\n      }\n    }\n    return updated;\n  }\n  return {\n    createWithHooks,\n    updateWithHooks,\n    updateManyWithHooks\n  };\n}\n\nconst createInternalAdapter = (adapter, ctx) => {\n  const logger = ctx.logger;\n  const options = ctx.options;\n  const secondaryStorage = options.secondaryStorage;\n  const sessionExpiration = options.session?.expiresIn || 60 * 60 * 24 * 7;\n  const { createWithHooks, updateWithHooks, updateManyWithHooks } = getWithHooks(adapter, ctx);\n  async function refreshUserSessions(user) {\n    if (!secondaryStorage) return;\n    const listRaw = await secondaryStorage.get(`active-sessions-${user.id}`);\n    if (!listRaw) return;\n    const now = Date.now();\n    const list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(listRaw) || [];\n    const validSessions = list.filter((s) => s.expiresAt > now);\n    await Promise.all(\n      validSessions.map(async ({ token }) => {\n        const cached = await secondaryStorage.get(token);\n        if (!cached) return;\n        const parsed = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(cached);\n        if (!parsed) return;\n        const sessionTTL = Math.max(\n          Math.floor(new Date(parsed.session.expiresAt).getTime() - now) / 1e3,\n          0\n        );\n        await secondaryStorage.set(\n          token,\n          JSON.stringify({\n            session: parsed.session,\n            user\n          }),\n          Math.floor(sessionTTL)\n        );\n      })\n    );\n  }\n  return {\n    createOAuthUser: async (user, account, context) => {\n      return adapter.transaction(async (trxAdapter) => {\n        const createdUser = await createWithHooks(\n          {\n            // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n            createdAt: /* @__PURE__ */ new Date(),\n            updatedAt: /* @__PURE__ */ new Date(),\n            ...user\n          },\n          \"user\",\n          void 0,\n          context,\n          trxAdapter\n        );\n        const createdAccount = await createWithHooks(\n          {\n            ...account,\n            userId: createdUser.id,\n            // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n            createdAt: /* @__PURE__ */ new Date(),\n            updatedAt: /* @__PURE__ */ new Date()\n          },\n          \"account\",\n          void 0,\n          context,\n          trxAdapter\n        );\n        return {\n          user: createdUser,\n          account: createdAccount\n        };\n      });\n    },\n    createUser: async (user, context, trxAdapter) => {\n      const createdUser = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...user,\n          email: user.email?.toLowerCase()\n        },\n        \"user\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return createdUser;\n    },\n    createAccount: async (account, context, trxAdapter) => {\n      const createdAccount = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return createdAccount;\n    },\n    listSessions: async (userId, trxAdapter) => {\n      if (secondaryStorage) {\n        const currentList = await secondaryStorage.get(\n          `active-sessions-${userId}`\n        );\n        if (!currentList) return [];\n        const list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n        const now = Date.now();\n        const validSessions = list.filter((s) => s.expiresAt > now);\n        const sessions2 = [];\n        for (const session of validSessions) {\n          const sessionStringified = await secondaryStorage.get(session.token);\n          if (sessionStringified) {\n            const s = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n            if (!s) return [];\n            const parsedSession = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, {\n              ...s.session,\n              expiresAt: new Date(s.session.expiresAt)\n            });\n            sessions2.push(parsedSession);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await (trxAdapter || adapter).findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return sessions;\n    },\n    listUsers: async (limit, offset, sortBy, where, trxAdapter) => {\n      const users = await (trxAdapter || adapter).findMany({\n        model: \"user\",\n        limit,\n        offset,\n        sortBy,\n        where\n      });\n      return users;\n    },\n    countTotalUsers: async (where, trxAdapter) => {\n      const total = await (trxAdapter || adapter).count({\n        model: \"user\",\n        where\n      });\n      if (typeof total === \"string\") {\n        return parseInt(total);\n      }\n      return total;\n    },\n    deleteUser: async (userId, trxAdapter) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(`active-sessions-${userId}`);\n      }\n      if (!secondaryStorage || options.session?.storeSessionInDatabase) {\n        await (trxAdapter || adapter).deleteMany({\n          model: \"session\",\n          where: [\n            {\n              field: \"userId\",\n              value: userId\n            }\n          ]\n        });\n      }\n      await (trxAdapter || adapter).deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      await (trxAdapter || adapter).delete({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n    },\n    createSession: async (userId, ctx2, dontRememberMe, override, overrideAll, trxAdapter) => {\n      const headers = ctx2.headers || ctx2.request?.headers;\n      const { id: _, ...rest } = override || {};\n      const data = {\n        ipAddress: ctx2.request || ctx2.headers ? (0,_better_auth_ClH5r3NH_mjs__WEBPACK_IMPORTED_MODULE_2__.g)(ctx2.request || ctx2.headers, ctx2.context.options) || \"\" : \"\",\n        userAgent: headers?.get(\"user-agent\") || \"\",\n        ...rest,\n        /**\n         * If the user doesn't want to be remembered\n         * set the session to expire in 1 day.\n         * The cookie will be set to expire at the end of the session\n         */\n        expiresAt: dontRememberMe ? (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(60 * 60 * 24, \"sec\") : (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(sessionExpiration, \"sec\"),\n        userId,\n        token: (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__.g)(32),\n        // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n        createdAt: /* @__PURE__ */ new Date(),\n        updatedAt: /* @__PURE__ */ new Date(),\n        ...overrideAll ? rest : {}\n      };\n      const res = await createWithHooks(\n        data,\n        \"session\",\n        secondaryStorage ? {\n          fn: async (sessionData) => {\n            const currentList = await secondaryStorage.get(\n              `active-sessions-${userId}`\n            );\n            let list = [];\n            const now = Date.now();\n            if (currentList) {\n              list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n              list = list.filter((session) => session.expiresAt > now);\n            }\n            const sorted = list.sort((a, b) => a.expiresAt - b.expiresAt);\n            let furthestSessionExp = sorted.at(-1)?.expiresAt;\n            sorted.push({\n              token: data.token,\n              expiresAt: data.expiresAt.getTime()\n            });\n            if (!furthestSessionExp || furthestSessionExp < data.expiresAt.getTime()) {\n              furthestSessionExp = data.expiresAt.getTime();\n            }\n            const furthestSessionTTL = Math.max(\n              Math.floor((furthestSessionExp - now) / 1e3),\n              0\n            );\n            if (furthestSessionTTL > 0) {\n              await secondaryStorage.set(\n                `active-sessions-${userId}`,\n                JSON.stringify(sorted),\n                furthestSessionTTL\n              );\n            }\n            const user = await adapter.findOne({\n              model: \"user\",\n              where: [\n                {\n                  field: \"id\",\n                  value: userId\n                }\n              ]\n            });\n            const sessionTTL = Math.max(\n              Math.floor((data.expiresAt.getTime() - now) / 1e3),\n              0\n            );\n            if (sessionTTL > 0) {\n              await secondaryStorage.set(\n                data.token,\n                JSON.stringify({\n                  session: sessionData,\n                  user\n                }),\n                sessionTTL\n              );\n            }\n            return sessionData;\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0,\n        ctx2,\n        trxAdapter\n      );\n      return res;\n    },\n    findSession: async (token, trxAdapter) => {\n      if (secondaryStorage) {\n        const sessionStringified = await secondaryStorage.get(token);\n        if (!sessionStringified && !options.session?.storeSessionInDatabase) {\n          return null;\n        }\n        if (sessionStringified) {\n          const s = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n          if (!s) return null;\n          const parsedSession2 = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, {\n            ...s.session,\n            expiresAt: new Date(s.session.expiresAt),\n            createdAt: new Date(s.session.createdAt),\n            updatedAt: new Date(s.session.updatedAt)\n          });\n          const parsedUser2 = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.p)(ctx.options, {\n            ...s.user,\n            createdAt: new Date(s.user.createdAt),\n            updatedAt: new Date(s.user.updatedAt)\n          });\n          return {\n            session: parsedSession2,\n            user: parsedUser2\n          };\n        }\n      }\n      const session = await (trxAdapter || adapter).findOne({\n        model: \"session\",\n        where: [\n          {\n            value: token,\n            field: \"token\"\n          }\n        ]\n      });\n      if (!session) {\n        return null;\n      }\n      const user = await (trxAdapter || adapter).findOne({\n        model: \"user\",\n        where: [\n          {\n            value: session.userId,\n            field: \"id\"\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const parsedSession = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, session);\n      const parsedUser = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_1__.p)(ctx.options, user);\n      return {\n        session: parsedSession,\n        user: parsedUser\n      };\n    },\n    findSessions: async (sessionTokens, trxAdapter) => {\n      if (secondaryStorage) {\n        const sessions2 = [];\n        for (const sessionToken of sessionTokens) {\n          const sessionStringified = await secondaryStorage.get(sessionToken);\n          if (sessionStringified) {\n            const s = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n            if (!s) return [];\n            const session = {\n              session: {\n                ...s.session,\n                expiresAt: new Date(s.session.expiresAt)\n              },\n              user: {\n                ...s.user,\n                createdAt: new Date(s.user.createdAt),\n                updatedAt: new Date(s.user.updatedAt)\n              }\n            };\n            sessions2.push(session);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await (trxAdapter || adapter).findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: sessionTokens,\n            operator: \"in\"\n          }\n        ]\n      });\n      const userIds = sessions.map((session) => {\n        return session.userId;\n      });\n      if (!userIds.length) return [];\n      const users = await (trxAdapter || adapter).findMany({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return sessions.map((session) => {\n        const user = users.find((u) => u.id === session.userId);\n        if (!user) return null;\n        return {\n          session,\n          user\n        };\n      });\n    },\n    updateSession: async (sessionToken, session, context, trxAdapter) => {\n      const updatedSession = await updateWithHooks(\n        session,\n        [{ field: \"token\", value: sessionToken }],\n        \"session\",\n        secondaryStorage ? {\n          async fn(data) {\n            const currentSession = await secondaryStorage.get(sessionToken);\n            let updatedSession2 = null;\n            if (currentSession) {\n              const parsedSession = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentSession);\n              if (!parsedSession) return null;\n              updatedSession2 = {\n                ...parsedSession.session,\n                ...data\n              };\n              return updatedSession2;\n            } else {\n              return null;\n            }\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0,\n        context,\n        trxAdapter\n      );\n      return updatedSession;\n    },\n    deleteSession: async (token, trxAdapter) => {\n      if (secondaryStorage) {\n        const data = await secondaryStorage.get(token);\n        if (data) {\n          const { session } = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(data) ?? {};\n          if (!session) {\n            logger.error(\"Session not found in secondary storage\");\n            return;\n          }\n          const userId = session.userId;\n          const currentList = await secondaryStorage.get(\n            `active-sessions-${userId}`\n          );\n          if (currentList) {\n            let list = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n            const now = Date.now();\n            const filtered = list.filter(\n              (session2) => session2.expiresAt > now && session2.token !== token\n            );\n            const sorted = filtered.sort((a, b) => a.expiresAt - b.expiresAt);\n            const furthestSessionExp = sorted.at(-1)?.expiresAt;\n            if (filtered.length > 0 && furthestSessionExp && furthestSessionExp > Date.now()) {\n              await secondaryStorage.set(\n                `active-sessions-${userId}`,\n                JSON.stringify(filtered),\n                Math.floor((furthestSessionExp - now) / 1e3)\n              );\n            } else {\n              await secondaryStorage.delete(`active-sessions-${userId}`);\n            }\n          } else {\n            logger.error(\"Active sessions list not found in secondary storage\");\n          }\n        }\n        await secondaryStorage.delete(token);\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await (trxAdapter || adapter).delete({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: token\n          }\n        ]\n      });\n    },\n    deleteAccounts: async (userId, trxAdapter) => {\n      await (trxAdapter || adapter).deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteAccount: async (accountId, trxAdapter) => {\n      await (trxAdapter || adapter).delete({\n        model: \"account\",\n        where: [\n          {\n            field: \"id\",\n            value: accountId\n          }\n        ]\n      });\n    },\n    deleteSessions: async (userIdOrSessionTokens, trxAdapter) => {\n      if (secondaryStorage) {\n        if (typeof userIdOrSessionTokens === \"string\") {\n          const activeSession = await secondaryStorage.get(\n            `active-sessions-${userIdOrSessionTokens}`\n          );\n          const sessions = activeSession ? (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(activeSession) : [];\n          if (!sessions) return;\n          for (const session of sessions) {\n            await secondaryStorage.delete(session.token);\n          }\n        } else {\n          for (const sessionToken of userIdOrSessionTokens) {\n            const session = await secondaryStorage.get(sessionToken);\n            if (session) {\n              await secondaryStorage.delete(sessionToken);\n            }\n          }\n        }\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await (trxAdapter || adapter).deleteMany({\n        model: \"session\",\n        where: [\n          {\n            field: Array.isArray(userIdOrSessionTokens) ? \"token\" : \"userId\",\n            value: userIdOrSessionTokens,\n            operator: Array.isArray(userIdOrSessionTokens) ? \"in\" : void 0\n          }\n        ]\n      });\n    },\n    findOAuthUser: async (email, accountId, providerId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findMany({\n        model: \"account\",\n        where: [\n          {\n            value: accountId,\n            field: \"accountId\"\n          }\n        ]\n      }).then((accounts) => {\n        return accounts.find((a) => a.providerId === providerId);\n      });\n      if (account) {\n        const user = await (trxAdapter || adapter).findOne({\n          model: \"user\",\n          where: [\n            {\n              value: account.userId,\n              field: \"id\"\n            }\n          ]\n        });\n        if (user) {\n          return {\n            user,\n            accounts: [account]\n          };\n        } else {\n          const user2 = await (trxAdapter || adapter).findOne({\n            model: \"user\",\n            where: [\n              {\n                value: email.toLowerCase(),\n                field: \"email\"\n              }\n            ]\n          });\n          if (user2) {\n            return {\n              user: user2,\n              accounts: [account]\n            };\n          }\n          return null;\n        }\n      } else {\n        const user = await (trxAdapter || adapter).findOne({\n          model: \"user\",\n          where: [\n            {\n              value: email.toLowerCase(),\n              field: \"email\"\n            }\n          ]\n        });\n        if (user) {\n          const accounts = await (trxAdapter || adapter).findMany({\n            model: \"account\",\n            where: [\n              {\n                value: user.id,\n                field: \"userId\"\n              }\n            ]\n          });\n          return {\n            user,\n            accounts: accounts || []\n          };\n        } else {\n          return null;\n        }\n      }\n    },\n    findUserByEmail: async (email, options2, trxAdapter) => {\n      const user = await (trxAdapter || adapter).findOne({\n        model: \"user\",\n        where: [\n          {\n            value: email.toLowerCase(),\n            field: \"email\"\n          }\n        ]\n      });\n      if (!user) return null;\n      if (options2?.includeAccounts) {\n        const accounts = await (trxAdapter || adapter).findMany({\n          model: \"account\",\n          where: [\n            {\n              value: user.id,\n              field: \"userId\"\n            }\n          ]\n        });\n        return {\n          user,\n          accounts\n        };\n      }\n      return {\n        user,\n        accounts: []\n      };\n    },\n    findUserById: async (userId, trxAdapter) => {\n      const user = await (trxAdapter || adapter).findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n      return user;\n    },\n    linkAccount: async (account, context, trxAdapter) => {\n      const _account = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return _account;\n    },\n    updateUser: async (userId, data, context, trxAdapter) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ],\n        \"user\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      await refreshUserSessions(user);\n      await refreshUserSessions(user);\n      return user;\n    },\n    updateUserByEmail: async (email, data, context, trxAdapter) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"email\",\n            value: email.toLowerCase()\n          }\n        ],\n        \"user\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      await refreshUserSessions(user);\n      await refreshUserSessions(user);\n      return user;\n    },\n    updatePassword: async (userId, password, context, trxAdapter) => {\n      await updateManyWithHooks(\n        {\n          password\n        },\n        [\n          {\n            field: \"userId\",\n            value: userId\n          },\n          {\n            field: \"providerId\",\n            value: \"credential\"\n          }\n        ],\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n    },\n    findAccounts: async (userId, trxAdapter) => {\n      const accounts = await (trxAdapter || adapter).findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return accounts;\n    },\n    findAccount: async (accountId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByProviderId: async (accountId, providerId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          },\n          {\n            field: \"providerId\",\n            value: providerId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByUserId: async (userId, trxAdapter) => {\n      const account = await (trxAdapter || adapter).findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return account;\n    },\n    updateAccount: async (id, data, context, trxAdapter) => {\n      const account = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"account\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return account;\n    },\n    createVerificationValue: async (data, context, trxAdapter) => {\n      const verification = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...data\n        },\n        \"verification\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return verification;\n    },\n    findVerificationValue: async (identifier, trxAdapter) => {\n      const verification = await (trxAdapter || adapter).findMany(\n        {\n          model: \"verification\",\n          where: [\n            {\n              field: \"identifier\",\n              value: identifier\n            }\n          ],\n          sortBy: {\n            field: \"createdAt\",\n            direction: \"desc\"\n          },\n          limit: 1\n        }\n      );\n      if (!options.verification?.disableCleanup) {\n        await (trxAdapter || adapter).deleteMany({\n          model: \"verification\",\n          where: [\n            {\n              field: \"expiresAt\",\n              value: /* @__PURE__ */ new Date(),\n              operator: \"lt\"\n            }\n          ]\n        });\n      }\n      const lastVerification = verification[0];\n      return lastVerification;\n    },\n    deleteVerificationValue: async (id, trxAdapter) => {\n      await (trxAdapter || adapter).delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n    },\n    deleteVerificationByIdentifier: async (identifier, trxAdapter) => {\n      await (trxAdapter || adapter).delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ]\n      });\n    },\n    updateVerificationValue: async (id, data, context, trxAdapter) => {\n      const verification = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"verification\",\n        void 0,\n        context,\n        trxAdapter\n      );\n      return verification;\n    }\n  };\n};\n\nasync function getAdapter(options) {\n  if (!options.database) {\n    const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_14__.g)(options);\n    const memoryDB = Object.keys(tables).reduce((acc, key) => {\n      acc[key] = [];\n      return acc;\n    }, {});\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_12__.logger.warn(\n      \"No database configuration provided. Using memory adapter in development\"\n    );\n    return (0,_better_auth_BNpIwq4C_mjs__WEBPACK_IMPORTED_MODULE_17__.m)(memoryDB)(options);\n  }\n  if (typeof options.database === \"function\") {\n    return options.database(options);\n  }\n  const { kysely, databaseType, transaction } = await (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__.c)(options);\n  if (!kysely) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_9__.BetterAuthError(\"Failed to initialize database adapter\");\n  }\n  return (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__.k)(kysely, {\n    type: databaseType || \"sqlite\",\n    debugLogs: \"debugLogs\" in options.database ? options.database.debugLogs : false,\n    transaction\n  })(options);\n}\nfunction convertToDB(fields, values) {\n  let result = values.id ? {\n    id: values.id\n  } : {};\n  for (const key in fields) {\n    const field = fields[key];\n    const value = values[key];\n    if (value === void 0) {\n      continue;\n    }\n    result[field.fieldName || key] = value;\n  }\n  return result;\n}\nfunction convertFromDB(fields, values) {\n  if (!values) {\n    return null;\n  }\n  let result = {\n    id: values.id\n  };\n  for (const [key, value] of Object.entries(fields)) {\n    result[key] = values[value.fieldName || key];\n  }\n  return result;\n}\n\nfunction getSchema(config) {\n  const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_14__.g)(config);\n  let schema = {};\n  for (const key in tables) {\n    const table = tables[key];\n    const fields = table.fields;\n    let actualFields = {};\n    Object.entries(fields).forEach(([key2, field]) => {\n      actualFields[field.fieldName || key2] = field;\n      if (field.references) {\n        const refTable = tables[field.references.model];\n        if (refTable) {\n          actualFields[field.fieldName || key2].references = {\n            ...field.references,\n            model: refTable.modelName,\n            field: field.references.field\n          };\n        }\n      }\n    });\n    if (schema[table.modelName]) {\n      schema[table.modelName].fields = {\n        ...schema[table.modelName].fields,\n        ...actualFields\n      };\n      continue;\n    }\n    schema[table.modelName] = {\n      fields: actualFields,\n      order: table.order || Infinity\n    };\n  }\n  return schema;\n}\n\nconst postgresMap = {\n  string: [\"character varying\", \"varchar\", \"text\"],\n  number: [\n    \"int4\",\n    \"integer\",\n    \"bigint\",\n    \"smallint\",\n    \"numeric\",\n    \"real\",\n    \"double precision\"\n  ],\n  boolean: [\"bool\", \"boolean\"],\n  date: [\"timestamptz\", \"timestamp\", \"date\"],\n  json: [\"json\", \"jsonb\"]\n};\nconst mysqlMap = {\n  string: [\"varchar\", \"text\"],\n  number: [\n    \"integer\",\n    \"int\",\n    \"bigint\",\n    \"smallint\",\n    \"decimal\",\n    \"float\",\n    \"double\"\n  ],\n  boolean: [\"boolean\", \"tinyint\"],\n  date: [\"timestamp\", \"datetime\", \"date\"],\n  json: [\"json\"]\n};\nconst sqliteMap = {\n  string: [\"TEXT\"],\n  number: [\"INTEGER\", \"REAL\"],\n  boolean: [\"INTEGER\", \"BOOLEAN\"],\n  // 0 or 1\n  date: [\"DATE\", \"INTEGER\"],\n  json: [\"TEXT\"]\n};\nconst mssqlMap = {\n  string: [\"varchar\", \"nvarchar\"],\n  number: [\"int\", \"bigint\", \"smallint\", \"decimal\", \"float\", \"double\"],\n  boolean: [\"bit\", \"smallint\"],\n  date: [\"datetime2\", \"date\", \"datetime\"],\n  json: [\"varchar\", \"nvarchar\"]\n};\nconst map = {\n  postgres: postgresMap,\n  mysql: mysqlMap,\n  sqlite: sqliteMap,\n  mssql: mssqlMap\n};\nfunction matchType(columnDataType, fieldType, dbType) {\n  function normalize(type) {\n    return type.toLowerCase().split(\"(\")[0].trim();\n  }\n  if (fieldType === \"string[]\" || fieldType === \"number[]\") {\n    return columnDataType.toLowerCase().includes(\"json\");\n  }\n  const types = map[dbType];\n  const expected = Array.isArray(fieldType) ? types[\"string\"].map((t) => t.toLowerCase()) : types[fieldType].map((t) => t.toLowerCase());\n  return expected.includes(normalize(columnDataType));\n}\nasync function getPostgresSchema(db) {\n  try {\n    const result = await (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`SHOW search_path`.execute(\n      db\n    );\n    if (result.rows[0]?.search_path) {\n      const schemas = result.rows[0].search_path.split(\",\").map((s) => s.trim()).map((s) => s.replace(/^[\"']|[\"']$/g, \"\")).filter((s) => !s.startsWith(\"$\"));\n      return schemas[0] || \"public\";\n    }\n  } catch (error) {\n  }\n  return \"public\";\n}\nasync function getMigrations(config) {\n  const betterAuthSchema = getSchema(config);\n  const logger = (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_12__.createLogger)(config.logger);\n  let { kysely: db, databaseType: dbType } = await (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_15__.c)(config);\n  if (!dbType) {\n    logger.warn(\n      \"Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this.\"\n    );\n    dbType = \"sqlite\";\n  }\n  if (!db) {\n    logger.error(\n      \"Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter.\"\n    );\n    process.exit(1);\n  }\n  let currentSchema = \"public\";\n  if (dbType === \"postgres\") {\n    currentSchema = await getPostgresSchema(db);\n    logger.debug(\n      `PostgreSQL migration: Using schema '${currentSchema}' (from search_path)`\n    );\n    try {\n      const schemaCheck = await (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`\n\t\t\t\tSELECT schema_name \n\t\t\t\tFROM information_schema.schemata \n\t\t\t\tWHERE schema_name = ${currentSchema}\n\t\t\t`.execute(db);\n      if (!schemaCheck.rows[0]) {\n        logger.warn(\n          `Schema '${currentSchema}' does not exist. Tables will be inspected from available schemas. Consider creating the schema first or checking your database configuration.`\n        );\n      }\n    } catch (error) {\n      logger.debug(\n        `Could not verify schema existence: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n  const allTableMetadata = await db.introspection.getTables();\n  let tableMetadata = allTableMetadata;\n  if (dbType === \"postgres\") {\n    try {\n      const tablesInSchema = await (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`\n\t\t\t\tSELECT table_name \n\t\t\t\tFROM information_schema.tables \n\t\t\t\tWHERE table_schema = ${currentSchema}\n\t\t\t\tAND table_type = 'BASE TABLE'\n\t\t\t`.execute(db);\n      const tableNamesInSchema = new Set(\n        tablesInSchema.rows.map((row) => row.table_name)\n      );\n      tableMetadata = allTableMetadata.filter(\n        (table) => table.schema === currentSchema && tableNamesInSchema.has(table.name)\n      );\n      logger.debug(\n        `Found ${tableMetadata.length} table(s) in schema '${currentSchema}': ${tableMetadata.map((t) => t.name).join(\", \") || \"(none)\"}`\n      );\n    } catch (error) {\n      logger.warn(\n        `Could not filter tables by schema. Using all discovered tables. Error: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n  const toBeCreated = [];\n  const toBeAdded = [];\n  for (const [key, value] of Object.entries(betterAuthSchema)) {\n    const table = tableMetadata.find((t) => t.name === key);\n    if (!table) {\n      const tIndex = toBeCreated.findIndex((t) => t.table === key);\n      const tableData = {\n        table: key,\n        fields: value.fields,\n        order: value.order || Infinity\n      };\n      const insertIndex = toBeCreated.findIndex(\n        (t) => (t.order || Infinity) > tableData.order\n      );\n      if (insertIndex === -1) {\n        if (tIndex === -1) {\n          toBeCreated.push(tableData);\n        } else {\n          toBeCreated[tIndex].fields = {\n            ...toBeCreated[tIndex].fields,\n            ...value.fields\n          };\n        }\n      } else {\n        toBeCreated.splice(insertIndex, 0, tableData);\n      }\n      continue;\n    }\n    let toBeAddedFields = {};\n    for (const [fieldName, field] of Object.entries(value.fields)) {\n      const column = table.columns.find((c) => c.name === fieldName);\n      if (!column) {\n        toBeAddedFields[fieldName] = field;\n        continue;\n      }\n      if (matchType(column.dataType, field.type, dbType)) {\n        continue;\n      } else {\n        logger.warn(\n          `Field ${fieldName} in table ${key} has a different type in the database. Expected ${field.type} but got ${column.dataType}.`\n        );\n      }\n    }\n    if (Object.keys(toBeAddedFields).length > 0) {\n      toBeAdded.push({\n        table: key,\n        fields: toBeAddedFields,\n        order: value.order || Infinity\n      });\n    }\n  }\n  const migrations = [];\n  function getType(field, fieldName) {\n    const type = field.type;\n    const typeMap = {\n      string: {\n        sqlite: \"text\",\n        postgres: \"text\",\n        mysql: field.unique ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\",\n        mssql: field.unique || field.sortable ? \"varchar(255)\" : field.references ? \"varchar(36)\" : (\n          // mssql deprecated `text`, and the alternative is `varchar(max)`.\n          // Kysely type interface doesn't support `text`, so we set this to `varchar(8000)` as\n          // that's the max length for `varchar`\n          \"varchar(8000)\"\n        )\n      },\n      boolean: {\n        sqlite: \"integer\",\n        postgres: \"boolean\",\n        mysql: \"boolean\",\n        mssql: \"smallint\"\n      },\n      number: {\n        sqlite: field.bigint ? \"bigint\" : \"integer\",\n        postgres: field.bigint ? \"bigint\" : \"integer\",\n        mysql: field.bigint ? \"bigint\" : \"integer\",\n        mssql: field.bigint ? \"bigint\" : \"integer\"\n      },\n      date: {\n        sqlite: \"date\",\n        postgres: \"timestamptz\",\n        mysql: \"timestamp(3)\",\n        mssql: (0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`datetime2(3)`\n      },\n      json: {\n        sqlite: \"text\",\n        postgres: \"jsonb\",\n        mysql: \"json\",\n        mssql: \"varchar(8000)\"\n      },\n      id: {\n        postgres: config.advanced?.database?.useNumberId ? \"serial\" : \"text\",\n        mysql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        mssql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        sqlite: config.advanced?.database?.useNumberId ? \"integer\" : \"text\"\n      },\n      foreignKeyId: {\n        postgres: config.advanced?.database?.useNumberId ? \"integer\" : \"text\",\n        mysql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        mssql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        sqlite: config.advanced?.database?.useNumberId ? \"integer\" : \"text\"\n      }\n    };\n    if (fieldName === \"id\" || field.references?.field === \"id\") {\n      if (fieldName === \"id\") {\n        return typeMap.id[dbType];\n      }\n      return typeMap.foreignKeyId[dbType];\n    }\n    if (dbType === \"sqlite\" && (type === \"string[]\" || type === \"number[]\")) {\n      return \"text\";\n    }\n    if (type === \"string[]\" || type === \"number[]\") {\n      return \"jsonb\";\n    }\n    if (Array.isArray(type)) {\n      return \"text\";\n    }\n    return typeMap[type][dbType || \"sqlite\"];\n  }\n  if (toBeAdded.length) {\n    for (const table of toBeAdded) {\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field, fieldName);\n        const exec = db.schema.alterTable(table.table).addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            ).onDelete(field.references.onDelete || \"cascade\");\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          if (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) {\n            if (dbType === \"mysql\") {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP(3)`);\n            } else {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP`);\n            }\n          }\n          return col;\n        });\n        migrations.push(exec);\n      }\n    }\n  }\n  if (toBeCreated.length) {\n    for (const table of toBeCreated) {\n      let dbT = db.schema.createTable(table.table).addColumn(\n        \"id\",\n        config.advanced?.database?.useNumberId ? dbType === \"postgres\" ? \"serial\" : \"integer\" : dbType === \"mysql\" || dbType === \"mssql\" ? \"varchar(36)\" : \"text\",\n        (col) => {\n          if (config.advanced?.database?.useNumberId) {\n            if (dbType === \"postgres\" || dbType === \"sqlite\") {\n              return col.primaryKey().notNull();\n            } else if (dbType === \"mssql\") {\n              return col.identity().primaryKey().notNull();\n            }\n            return col.autoIncrement().primaryKey().notNull();\n          }\n          return col.primaryKey().notNull();\n        }\n      );\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field, fieldName);\n        dbT = dbT.addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(`${field.references.model}.${field.references.field}`).onDelete(field.references.onDelete || \"cascade\");\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          if (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) {\n            if (dbType === \"mysql\") {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP(3)`);\n            } else {\n              col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_18__.sql)`CURRENT_TIMESTAMP`);\n            }\n          }\n          return col;\n        });\n      }\n      migrations.push(dbT);\n    }\n  }\n  async function runMigrations() {\n    for (const migration of migrations) {\n      await migration.execute();\n    }\n  }\n  async function compileMigrations() {\n    const compiled = migrations.map((m) => m.compile().sql);\n    return compiled.join(\";\\n\\n\") + \";\";\n  }\n  return { toBeCreated, toBeAdded, runMigrations, compileMigrations };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CRzQyT1FHQy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTBEO0FBQ2lDO0FBQ25DO0FBQ1E7QUFDSDtBQUNoRDtBQUNRO0FBQ1k7QUFDQztBQUNEO0FBQ0U7QUFDckI7QUFDbUI7QUFDRDtBQUNBO0FBQzBCO0FBQ3RCO0FBQ047QUFDK0I7QUFDMUI7QUFDNkI7QUFDMEI7QUFDcEQ7QUFDMEI7QUFDbkM7O0FBRTdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHdEQUF3RDtBQUNsRTtBQUNBO0FBQ0Es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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHVCQUF1QixHQUFHLHVCQUF1QjtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw0Q0FBRztBQUNyQyxjQUFjO0FBQ2Qsa0NBQWtDLDRDQUFHO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsdUJBQXVCLEdBQUcsdUJBQXVCO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw0Q0FBRztBQUNyQyxjQUFjO0FBQ2Qsa0NBQWtDLDRDQUFHO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQSxXQUFXO0FBQ1g7O0FBRW9LIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CRzQyT1FHQy5tanM/NjZhZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnIGFzIGdldERhdGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgeyBiIGFzIHBhcnNlU2Vzc2lvbk91dHB1dCwgcCBhcyBwYXJzZVVzZXJPdXRwdXQgfSBmcm9tICcuL2JldHRlci1hdXRoLkN3ajlkdDZpLm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdldElwIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DbEg1cjNOSC5tanMnO1xuaW1wb3J0IHsgcyBhcyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CS0V0RXB0MC5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICd6b2QnO1xuaW1wb3J0ICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0ICcuL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL2RiJztcbmltcG9ydCB7IGxvZ2dlciwgY3JlYXRlTG9nZ2VyIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5pbXBvcnQgeyBnIGFzIGdldEF1dGhUYWJsZXMgfSBmcm9tICcuL2JldHRlci1hdXRoLnBRamVSa3pOLm1qcyc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZUt5c2VseUFkYXB0ZXIsIGsgYXMga3lzZWx5QWRhcHRlciB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ0JUUzJPelgubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGIvYWRhcHRlcic7XG5pbXBvcnQgeyBtIGFzIG1lbW9yeUFkYXB0ZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLkJOcEl3cTRDLm1qcyc7XG5pbXBvcnQgeyBzcWwgfSBmcm9tICdreXNlbHknO1xuXG5mdW5jdGlvbiBnZXRXaXRoSG9va3MoYWRhcHRlciwgY3R4KSB7XG4gIGNvbnN0IGhvb2tzID0gY3R4Lmhvb2tzO1xuICBhc3luYyBmdW5jdGlvbiBjcmVhdGVXaXRoSG9va3MoZGF0YSwgbW9kZWwsIGN1c3RvbUNyZWF0ZUZuLCBjb250ZXh0LCB0cnhBZGFwdGVyKSB7XG4gICAgbGV0IGFjdHVhbERhdGEgPSBkYXRhO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8uY3JlYXRlPy5iZWZvcmU7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9SdW4oYWN0dWFsRGF0YSwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNPYmplY3QgPSB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiICYmIFwiZGF0YVwiIGluIHJlc3VsdDtcbiAgICAgICAgaWYgKGlzT2JqZWN0KSB7XG4gICAgICAgICAgYWN0dWFsRGF0YSA9IHtcbiAgICAgICAgICAgIC4uLmFjdHVhbERhdGEsXG4gICAgICAgICAgICAuLi5yZXN1bHQuZGF0YVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY3VzdG9tQ3JlYXRlZCA9IGN1c3RvbUNyZWF0ZUZuID8gYXdhaXQgY3VzdG9tQ3JlYXRlRm4uZm4oYWN0dWFsRGF0YSkgOiBudWxsO1xuICAgIGNvbnN0IGNyZWF0ZWQgPSAhY3VzdG9tQ3JlYXRlRm4gfHwgY3VzdG9tQ3JlYXRlRm4uZXhlY3V0ZU1haW5GbiA/IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmNyZWF0ZSh7XG4gICAgICBtb2RlbCxcbiAgICAgIGRhdGE6IGFjdHVhbERhdGEsXG4gICAgICBmb3JjZUFsbG93SWQ6IHRydWVcbiAgICB9KSA6IGN1c3RvbUNyZWF0ZWQ7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy5jcmVhdGU/LmFmdGVyO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGF3YWl0IHRvUnVuKGNyZWF0ZWQsIGNvbnRleHQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlZDtcbiAgfVxuICBhc3luYyBmdW5jdGlvbiB1cGRhdGVXaXRoSG9va3MoZGF0YSwgd2hlcmUsIG1vZGVsLCBjdXN0b21VcGRhdGVGbiwgY29udGV4dCwgdHJ4QWRhcHRlcikge1xuICAgIGxldCBhY3R1YWxEYXRhID0gZGF0YTtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYmVmb3JlO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvUnVuKGRhdGEsIGNvbnRleHQpO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzT2JqZWN0ID0gdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIjtcbiAgICAgICAgYWN0dWFsRGF0YSA9IGlzT2JqZWN0ID8gcmVzdWx0LmRhdGEgOiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbVVwZGF0ZWQgPSBjdXN0b21VcGRhdGVGbiA/IGF3YWl0IGN1c3RvbVVwZGF0ZUZuLmZuKGFjdHVhbERhdGEpIDogbnVsbDtcbiAgICBjb25zdCB1cGRhdGVkID0gIWN1c3RvbVVwZGF0ZUZuIHx8IGN1c3RvbVVwZGF0ZUZuLmV4ZWN1dGVNYWluRm4gPyBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS51cGRhdGUoe1xuICAgICAgbW9kZWwsXG4gICAgICB1cGRhdGU6IGFjdHVhbERhdGEsXG4gICAgICB3aGVyZVxuICAgIH0pIDogY3VzdG9tVXBkYXRlZDtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYWZ0ZXI7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgYXdhaXQgdG9SdW4odXBkYXRlZCwgY29udGV4dCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVkO1xuICB9XG4gIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU1hbnlXaXRoSG9va3MoZGF0YSwgd2hlcmUsIG1vZGVsLCBjdXN0b21VcGRhdGVGbiwgY29udGV4dCwgdHJ4QWRhcHRlcikge1xuICAgIGxldCBhY3R1YWxEYXRhID0gZGF0YTtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYmVmb3JlO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvUnVuKGRhdGEsIGNvbnRleHQpO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzT2JqZWN0ID0gdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIjtcbiAgICAgICAgYWN0dWFsRGF0YSA9IGlzT2JqZWN0ID8gcmVzdWx0LmRhdGEgOiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbVVwZGF0ZWQgPSBjdXN0b21VcGRhdGVGbiA/IGF3YWl0IGN1c3RvbVVwZGF0ZUZuLmZuKGFjdHVhbERhdGEpIDogbnVsbDtcbiAgICBjb25zdCB1cGRhdGVkID0gIWN1c3RvbVVwZGF0ZUZuIHx8IGN1c3RvbVVwZGF0ZUZuLmV4ZWN1dGVNYWluRm4gPyBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS51cGRhdGVNYW55KHtcbiAgICAgIG1vZGVsLFxuICAgICAgdXBkYXRlOiBhY3R1YWxEYXRhLFxuICAgICAgd2hlcmVcbiAgICB9KSA6IGN1c3RvbVVwZGF0ZWQ7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy51cGRhdGU/LmFmdGVyO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGF3YWl0IHRvUnVuKHVwZGF0ZWQsIGNvbnRleHQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlZDtcbiAgfVxuICByZXR1cm4ge1xuICAgIGNyZWF0ZVdpdGhIb29rcyxcbiAgICB1cGRhdGVXaXRoSG9va3MsXG4gICAgdXBkYXRlTWFueVdpdGhIb29rc1xuICB9O1xufVxuXG5jb25zdCBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIgPSAoYWRhcHRlciwgY3R4KSA9PiB7XG4gIGNvbnN0IGxvZ2dlciA9IGN0eC5sb2dnZXI7XG4gIGNvbnN0IG9wdGlvbnMgPSBjdHgub3B0aW9ucztcbiAgY29uc3Qgc2Vjb25kYXJ5U3RvcmFnZSA9IG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZTtcbiAgY29uc3Qgc2Vzc2lvbkV4cGlyYXRpb24gPSBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQgKiA3O1xuICBjb25zdCB7IGNyZWF0ZVdpdGhIb29rcywgdXBkYXRlV2l0aEhvb2tzLCB1cGRhdGVNYW55V2l0aEhvb2tzIH0gPSBnZXRXaXRoSG9va3MoYWRhcHRlciwgY3R4KTtcbiAgYXN5bmMgZnVuY3Rpb24gcmVmcmVzaFVzZXJTZXNzaW9ucyh1c2VyKSB7XG4gICAgaWYgKCFzZWNvbmRhcnlTdG9yYWdlKSByZXR1cm47XG4gICAgY29uc3QgbGlzdFJhdyA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VyLmlkfWApO1xuICAgIGlmICghbGlzdFJhdykgcmV0dXJuO1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgY29uc3QgbGlzdCA9IHNhZmVKU09OUGFyc2UobGlzdFJhdykgfHwgW107XG4gICAgY29uc3QgdmFsaWRTZXNzaW9ucyA9IGxpc3QuZmlsdGVyKChzKSA9PiBzLmV4cGlyZXNBdCA+IG5vdyk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICB2YWxpZFNlc3Npb25zLm1hcChhc3luYyAoeyB0b2tlbiB9KSA9PiB7XG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHRva2VuKTtcbiAgICAgICAgaWYgKCFjYWNoZWQpIHJldHVybjtcbiAgICAgICAgY29uc3QgcGFyc2VkID0gc2FmZUpTT05QYXJzZShjYWNoZWQpO1xuICAgICAgICBpZiAoIXBhcnNlZCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBzZXNzaW9uVFRMID0gTWF0aC5tYXgoXG4gICAgICAgICAgTWF0aC5mbG9vcihuZXcgRGF0ZShwYXJzZWQuc2Vzc2lvbi5leHBpcmVzQXQpLmdldFRpbWUoKSAtIG5vdykgLyAxZTMsXG4gICAgICAgICAgMFxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLnNldChcbiAgICAgICAgICB0b2tlbixcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzZXNzaW9uOiBwYXJzZWQuc2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBNYXRoLmZsb29yKHNlc3Npb25UVEwpXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVPQXV0aFVzZXI6IGFzeW5jICh1c2VyLCBhY2NvdW50LCBjb250ZXh0KSA9PiB7XG4gICAgICByZXR1cm4gYWRhcHRlci50cmFuc2FjdGlvbihhc3luYyAodHJ4QWRhcHRlcikgPT4ge1xuICAgICAgICBjb25zdCBjcmVhdGVkVXNlciA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAgICB7XG4gICAgICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAgIC4uLnVzZXJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXNlclwiLFxuICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgY3JlYXRlZEFjY291bnQgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4uYWNjb3VudCxcbiAgICAgICAgICAgIHVzZXJJZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJhY2NvdW50XCIsXG4gICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXI6IGNyZWF0ZWRVc2VyLFxuICAgICAgICAgIGFjY291bnQ6IGNyZWF0ZWRBY2NvdW50XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGNyZWF0ZVVzZXI6IGFzeW5jICh1c2VyLCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVkVXNlciA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIC8vIHRvZG86IHdlIHNob3VsZCByZW1vdmUgYXV0byBzZXR0aW5nIGNyZWF0ZWRBdCBhbmQgdXBkYXRlZEF0IGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UsIHNpbmNlIHRoZSBkYiBnZW5lcmF0b3JzIGFscmVhZHkgaGFuZGxlIHRoYXRcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgLi4udXNlcixcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbD8udG9Mb3dlckNhc2UoKVxuICAgICAgICB9LFxuICAgICAgICBcInVzZXJcIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0cnhBZGFwdGVyXG4gICAgICApO1xuICAgICAgcmV0dXJuIGNyZWF0ZWRVc2VyO1xuICAgIH0sXG4gICAgY3JlYXRlQWNjb3VudDogYXN5bmMgKGFjY291bnQsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZWRBY2NvdW50ID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5hY2NvdW50XG4gICAgICAgIH0sXG4gICAgICAgIFwiYWNjb3VudFwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3JlYXRlZEFjY291bnQ7XG4gICAgfSxcbiAgICBsaXN0U2Vzc2lvbnM6IGFzeW5jICh1c2VySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRMaXN0ID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoXG4gICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gXG4gICAgICAgICk7XG4gICAgICAgIGlmICghY3VycmVudExpc3QpIHJldHVybiBbXTtcbiAgICAgICAgY29uc3QgbGlzdCA9IHNhZmVKU09OUGFyc2UoY3VycmVudExpc3QpIHx8IFtdO1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zdCB2YWxpZFNlc3Npb25zID0gbGlzdC5maWx0ZXIoKHMpID0+IHMuZXhwaXJlc0F0ID4gbm93KTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbnMyID0gW107XG4gICAgICAgIGZvciAoY29uc3Qgc2Vzc2lvbiBvZiB2YWxpZFNlc3Npb25zKSB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoc2Vzc2lvbi50b2tlbik7XG4gICAgICAgICAgaWYgKHNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IHNhZmVKU09OUGFyc2Uoc2Vzc2lvblN0cmluZ2lmaWVkKTtcbiAgICAgICAgICAgIGlmICghcykgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbiA9IHBhcnNlU2Vzc2lvbk91dHB1dChjdHgub3B0aW9ucywge1xuICAgICAgICAgICAgICAuLi5zLnNlc3Npb24sXG4gICAgICAgICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUocy5zZXNzaW9uLmV4cGlyZXNBdClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2Vzc2lvbnMyLnB1c2gocGFyc2VkU2Vzc2lvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXNzaW9uczI7XG4gICAgICB9XG4gICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gc2Vzc2lvbnM7XG4gICAgfSxcbiAgICBsaXN0VXNlcnM6IGFzeW5jIChsaW1pdCwgb2Zmc2V0LCBzb3J0QnksIHdoZXJlLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgb2Zmc2V0LFxuICAgICAgICBzb3J0QnksXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1c2VycztcbiAgICB9LFxuICAgIGNvdW50VG90YWxVc2VyczogYXN5bmMgKHdoZXJlLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB0b3RhbCA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmNvdW50KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZVxuICAgICAgfSk7XG4gICAgICBpZiAodHlwZW9mIHRvdGFsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludCh0b3RhbCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdG90YWw7XG4gICAgfSxcbiAgICBkZWxldGVVc2VyOiBhc3luYyAodXNlcklkLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmRlbGV0ZShgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWApO1xuICAgICAgfVxuICAgICAgaWYgKCFzZWNvbmRhcnlTdG9yYWdlIHx8IG9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5kZWxldGVNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGNyZWF0ZVNlc3Npb246IGFzeW5jICh1c2VySWQsIGN0eDIsIGRvbnRSZW1lbWJlck1lLCBvdmVycmlkZSwgb3ZlcnJpZGVBbGwsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSBjdHgyLmhlYWRlcnMgfHwgY3R4Mi5yZXF1ZXN0Py5oZWFkZXJzO1xuICAgICAgY29uc3QgeyBpZDogXywgLi4ucmVzdCB9ID0gb3ZlcnJpZGUgfHwge307XG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBpcEFkZHJlc3M6IGN0eDIucmVxdWVzdCB8fCBjdHgyLmhlYWRlcnMgPyBnZXRJcChjdHgyLnJlcXVlc3QgfHwgY3R4Mi5oZWFkZXJzLCBjdHgyLmNvbnRleHQub3B0aW9ucykgfHwgXCJcIiA6IFwiXCIsXG4gICAgICAgIHVzZXJBZ2VudDogaGVhZGVycz8uZ2V0KFwidXNlci1hZ2VudFwiKSB8fCBcIlwiLFxuICAgICAgICAuLi5yZXN0LFxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdGhlIHVzZXIgZG9lc24ndCB3YW50IHRvIGJlIHJlbWVtYmVyZWRcbiAgICAgICAgICogc2V0IHRoZSBzZXNzaW9uIHRvIGV4cGlyZSBpbiAxIGRheS5cbiAgICAgICAgICogVGhlIGNvb2tpZSB3aWxsIGJlIHNldCB0byBleHBpcmUgYXQgdGhlIGVuZCBvZiB0aGUgc2Vzc2lvblxuICAgICAgICAgKi9cbiAgICAgICAgZXhwaXJlc0F0OiBkb250UmVtZW1iZXJNZSA/IGdldERhdGUoNjAgKiA2MCAqIDI0LCBcInNlY1wiKSA6IGdldERhdGUoc2Vzc2lvbkV4cGlyYXRpb24sIFwic2VjXCIpLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHRva2VuOiBnZW5lcmF0ZUlkKDMyKSxcbiAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAuLi5vdmVycmlkZUFsbCA/IHJlc3QgOiB7fVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAgZGF0YSxcbiAgICAgICAgXCJzZXNzaW9uXCIsXG4gICAgICAgIHNlY29uZGFyeVN0b3JhZ2UgPyB7XG4gICAgICAgICAgZm46IGFzeW5jIChzZXNzaW9uRGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudExpc3QgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChcbiAgICAgICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgbGV0IGxpc3QgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBpZiAoY3VycmVudExpc3QpIHtcbiAgICAgICAgICAgICAgbGlzdCA9IHNhZmVKU09OUGFyc2UoY3VycmVudExpc3QpIHx8IFtdO1xuICAgICAgICAgICAgICBsaXN0ID0gbGlzdC5maWx0ZXIoKHNlc3Npb24pID0+IHNlc3Npb24uZXhwaXJlc0F0ID4gbm93KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNvcnRlZCA9IGxpc3Quc29ydCgoYSwgYikgPT4gYS5leHBpcmVzQXQgLSBiLmV4cGlyZXNBdCk7XG4gICAgICAgICAgICBsZXQgZnVydGhlc3RTZXNzaW9uRXhwID0gc29ydGVkLmF0KC0xKT8uZXhwaXJlc0F0O1xuICAgICAgICAgICAgc29ydGVkLnB1c2goe1xuICAgICAgICAgICAgICB0b2tlbjogZGF0YS50b2tlbixcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBkYXRhLmV4cGlyZXNBdC5nZXRUaW1lKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCFmdXJ0aGVzdFNlc3Npb25FeHAgfHwgZnVydGhlc3RTZXNzaW9uRXhwIDwgZGF0YS5leHBpcmVzQXQuZ2V0VGltZSgpKSB7XG4gICAgICAgICAgICAgIGZ1cnRoZXN0U2Vzc2lvbkV4cCA9IGRhdGEuZXhwaXJlc0F0LmdldFRpbWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGZ1cnRoZXN0U2Vzc2lvblRUTCA9IE1hdGgubWF4KFxuICAgICAgICAgICAgICBNYXRoLmZsb29yKChmdXJ0aGVzdFNlc3Npb25FeHAgLSBub3cpIC8gMWUzKSxcbiAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChmdXJ0aGVzdFNlc3Npb25UVEwgPiAwKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2Uuc2V0KFxuICAgICAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCxcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzb3J0ZWQpLFxuICAgICAgICAgICAgICAgIGZ1cnRoZXN0U2Vzc2lvblRUTFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uVFRMID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgIE1hdGguZmxvb3IoKGRhdGEuZXhwaXJlc0F0LmdldFRpbWUoKSAtIG5vdykgLyAxZTMpLFxuICAgICAgICAgICAgICAwXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKHNlc3Npb25UVEwgPiAwKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2Uuc2V0KFxuICAgICAgICAgICAgICAgIGRhdGEudG9rZW4sXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbkRhdGEsXG4gICAgICAgICAgICAgICAgICB1c2VyXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgc2Vzc2lvblRUTFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNlc3Npb25EYXRhO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0ZU1haW5Gbjogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlXG4gICAgICAgIH0gOiB2b2lkIDAsXG4gICAgICAgIGN0eDIsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgZmluZFNlc3Npb246IGFzeW5jICh0b2tlbiwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQodG9rZW4pO1xuICAgICAgICBpZiAoIXNlc3Npb25TdHJpbmdpZmllZCAmJiAhb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgIGNvbnN0IHMgPSBzYWZlSlNPTlBhcnNlKHNlc3Npb25TdHJpbmdpZmllZCk7XG4gICAgICAgICAgaWYgKCFzKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICBjb25zdCBwYXJzZWRTZXNzaW9uMiA9IHBhcnNlU2Vzc2lvbk91dHB1dChjdHgub3B0aW9ucywge1xuICAgICAgICAgICAgLi4ucy5zZXNzaW9uLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy5zZXNzaW9uLmNyZWF0ZWRBdCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi51cGRhdGVkQXQpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgcGFyc2VkVXNlcjIgPSBwYXJzZVVzZXJPdXRwdXQoY3R4Lm9wdGlvbnMsIHtcbiAgICAgICAgICAgIC4uLnMudXNlcixcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy51c2VyLmNyZWF0ZWRBdCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMudXNlci51cGRhdGVkQXQpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlc3Npb246IHBhcnNlZFNlc3Npb24yLFxuICAgICAgICAgICAgdXNlcjogcGFyc2VkVXNlcjJcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB2YWx1ZTogdG9rZW4sXG4gICAgICAgICAgICBmaWVsZDogXCJ0b2tlblwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uLnVzZXJJZCxcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbiA9IHBhcnNlU2Vzc2lvbk91dHB1dChjdHgub3B0aW9ucywgc2Vzc2lvbik7XG4gICAgICBjb25zdCBwYXJzZWRVc2VyID0gcGFyc2VVc2VyT3V0cHV0KGN0eC5vcHRpb25zLCB1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNlc3Npb246IHBhcnNlZFNlc3Npb24sXG4gICAgICAgIHVzZXI6IHBhcnNlZFVzZXJcbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kU2Vzc2lvbnM6IGFzeW5jIChzZXNzaW9uVG9rZW5zLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBjb25zdCBzZXNzaW9uczIgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzZXNzaW9uVG9rZW4gb2Ygc2Vzc2lvblRva2Vucykge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25TdHJpbmdpZmllZCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHNlc3Npb25Ub2tlbik7XG4gICAgICAgICAgaWYgKHNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IHNhZmVKU09OUGFyc2Uoc2Vzc2lvblN0cmluZ2lmaWVkKTtcbiAgICAgICAgICAgIGlmICghcykgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IHtcbiAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgIC4uLnMuc2Vzc2lvbixcbiAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi5leHBpcmVzQXQpXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAuLi5zLnVzZXIsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShzLnVzZXIuY3JlYXRlZEF0KSxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMudXNlci51cGRhdGVkQXQpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzZXNzaW9uczIucHVzaChzZXNzaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlc3Npb25zMjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidG9rZW5cIixcbiAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uVG9rZW5zLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFwiaW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBjb25zdCB1c2VySWRzID0gc2Vzc2lvbnMubWFwKChzZXNzaW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBzZXNzaW9uLnVzZXJJZDtcbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VySWRzLmxlbmd0aCkgcmV0dXJuIFtdO1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZHMsXG4gICAgICAgICAgICBvcGVyYXRvcjogXCJpblwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzZXNzaW9ucy5tYXAoKHNlc3Npb24pID0+IHtcbiAgICAgICAgY29uc3QgdXNlciA9IHVzZXJzLmZpbmQoKHUpID0+IHUuaWQgPT09IHNlc3Npb24udXNlcklkKTtcbiAgICAgICAgaWYgKCF1c2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgIHVzZXJcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdXBkYXRlU2Vzc2lvbjogYXN5bmMgKHNlc3Npb25Ub2tlbiwgc2Vzc2lvbiwgY29udGV4dCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdXBkYXRlZFNlc3Npb24gPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIHNlc3Npb24sXG4gICAgICAgIFt7IGZpZWxkOiBcInRva2VuXCIsIHZhbHVlOiBzZXNzaW9uVG9rZW4gfV0sXG4gICAgICAgIFwic2Vzc2lvblwiLFxuICAgICAgICBzZWNvbmRhcnlTdG9yYWdlID8ge1xuICAgICAgICAgIGFzeW5jIGZuKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICAgIGxldCB1cGRhdGVkU2Vzc2lvbjIgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRTZXNzaW9uKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHBhcnNlZFNlc3Npb24gPSBzYWZlSlNPTlBhcnNlKGN1cnJlbnRTZXNzaW9uKTtcbiAgICAgICAgICAgICAgaWYgKCFwYXJzZWRTZXNzaW9uKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgdXBkYXRlZFNlc3Npb24yID0ge1xuICAgICAgICAgICAgICAgIC4uLnBhcnNlZFNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgICAgICAgICAuLi5kYXRhXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIHJldHVybiB1cGRhdGVkU2Vzc2lvbjI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGV4ZWN1dGVNYWluRm46IG9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZVxuICAgICAgICB9IDogdm9pZCAwLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0cnhBZGFwdGVyXG4gICAgICApO1xuICAgICAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9uO1xuICAgIH0sXG4gICAgZGVsZXRlU2Vzc2lvbjogYXN5bmMgKHRva2VuLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQodG9rZW4pO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgIGNvbnN0IHsgc2Vzc2lvbiB9ID0gc2FmZUpTT05QYXJzZShkYXRhKSA/PyB7fTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIlNlc3Npb24gbm90IGZvdW5kIGluIHNlY29uZGFyeSBzdG9yYWdlXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1c2VySWQgPSBzZXNzaW9uLnVzZXJJZDtcbiAgICAgICAgICBjb25zdCBjdXJyZW50TGlzdCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KFxuICAgICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoY3VycmVudExpc3QpIHtcbiAgICAgICAgICAgIGxldCBsaXN0ID0gc2FmZUpTT05QYXJzZShjdXJyZW50TGlzdCkgfHwgW107XG4gICAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBsaXN0LmZpbHRlcihcbiAgICAgICAgICAgICAgKHNlc3Npb24yKSA9PiBzZXNzaW9uMi5leHBpcmVzQXQgPiBub3cgJiYgc2Vzc2lvbjIudG9rZW4gIT09IHRva2VuXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3Qgc29ydGVkID0gZmlsdGVyZWQuc29ydCgoYSwgYikgPT4gYS5leHBpcmVzQXQgLSBiLmV4cGlyZXNBdCk7XG4gICAgICAgICAgICBjb25zdCBmdXJ0aGVzdFNlc3Npb25FeHAgPSBzb3J0ZWQuYXQoLTEpPy5leHBpcmVzQXQ7XG4gICAgICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID4gMCAmJiBmdXJ0aGVzdFNlc3Npb25FeHAgJiYgZnVydGhlc3RTZXNzaW9uRXhwID4gRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLnNldChcbiAgICAgICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWAsXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoZmlsdGVyZWQpLFxuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoKGZ1cnRoZXN0U2Vzc2lvbkV4cCAtIG5vdykgLyAxZTMpXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmRlbGV0ZShgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJBY3RpdmUgc2Vzc2lvbnMgbGlzdCBub3QgZm91bmQgaW4gc2Vjb25kYXJ5IHN0b3JhZ2VcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKHRva2VuKTtcbiAgICAgICAgaWYgKCFvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgfHwgY3R4Lm9wdGlvbnMuc2Vzc2lvbj8ucHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInRva2VuXCIsXG4gICAgICAgICAgICB2YWx1ZTogdG9rZW5cbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlQWNjb3VudHM6IGFzeW5jICh1c2VySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmRlbGV0ZU1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZUFjY291bnQ6IGFzeW5jIChhY2NvdW50SWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGFjY291bnRJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGVTZXNzaW9uczogYXN5bmMgKHVzZXJJZE9yU2Vzc2lvblRva2VucywgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1c2VySWRPclNlc3Npb25Ub2tlbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICBjb25zdCBhY3RpdmVTZXNzaW9uID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoXG4gICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkT3JTZXNzaW9uVG9rZW5zfWBcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25zID0gYWN0aXZlU2Vzc2lvbiA/IHNhZmVKU09OUGFyc2UoYWN0aXZlU2Vzc2lvbikgOiBbXTtcbiAgICAgICAgICBpZiAoIXNlc3Npb25zKSByZXR1cm47XG4gICAgICAgICAgZm9yIChjb25zdCBzZXNzaW9uIG9mIHNlc3Npb25zKSB7XG4gICAgICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmRlbGV0ZShzZXNzaW9uLnRva2VuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yIChjb25zdCBzZXNzaW9uVG9rZW4gb2YgdXNlcklkT3JTZXNzaW9uVG9rZW5zKSB7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICAgIGlmIChzZXNzaW9uKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKHNlc3Npb25Ub2tlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlIHx8IGN0eC5vcHRpb25zLnNlc3Npb24/LnByZXNlcnZlU2Vzc2lvbkluRGF0YWJhc2UpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmRlbGV0ZU1hbnkoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IEFycmF5LmlzQXJyYXkodXNlcklkT3JTZXNzaW9uVG9rZW5zKSA/IFwidG9rZW5cIiA6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkT3JTZXNzaW9uVG9rZW5zLFxuICAgICAgICAgICAgb3BlcmF0b3I6IEFycmF5LmlzQXJyYXkodXNlcklkT3JTZXNzaW9uVG9rZW5zKSA/IFwiaW5cIiA6IHZvaWQgMFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBmaW5kT0F1dGhVc2VyOiBhc3luYyAoZW1haWwsIGFjY291bnRJZCwgcHJvdmlkZXJJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBhY2NvdW50SWQsXG4gICAgICAgICAgICBmaWVsZDogXCJhY2NvdW50SWRcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSkudGhlbigoYWNjb3VudHMpID0+IHtcbiAgICAgICAgcmV0dXJuIGFjY291bnRzLmZpbmQoKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXJJZCk7XG4gICAgICB9KTtcbiAgICAgIGlmIChhY2NvdW50KSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IGFjY291bnQudXNlcklkLFxuICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgIGFjY291bnRzOiBbYWNjb3VudF1cbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IHVzZXIyID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE9uZSh7XG4gICAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKHVzZXIyKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB1c2VyOiB1c2VyMixcbiAgICAgICAgICAgICAgYWNjb3VudHM6IFthY2NvdW50XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkLFxuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgIGFjY291bnRzOiBhY2NvdW50cyB8fCBbXVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGZpbmRVc2VyQnlFbWFpbDogYXN5bmMgKGVtYWlsLCBvcHRpb25zMiwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdXNlcikgcmV0dXJuIG51bGw7XG4gICAgICBpZiAob3B0aW9uczI/LmluY2x1ZGVBY2NvdW50cykge1xuICAgICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWQsXG4gICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIGFjY291bnRzXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyLFxuICAgICAgICBhY2NvdW50czogW11cbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kVXNlckJ5SWQ6IGFzeW5jICh1c2VySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1c2VyO1xuICAgIH0sXG4gICAgbGlua0FjY291bnQ6IGFzeW5jIChhY2NvdW50LCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBfYWNjb3VudCA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIC8vIHRvZG86IHdlIHNob3VsZCByZW1vdmUgYXV0byBzZXR0aW5nIGNyZWF0ZWRBdCBhbmQgdXBkYXRlZEF0IGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UsIHNpbmNlIHRoZSBkYiBnZW5lcmF0b3JzIGFscmVhZHkgaGFuZGxlIHRoYXRcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgLi4uYWNjb3VudFxuICAgICAgICB9LFxuICAgICAgICBcImFjY291bnRcIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0cnhBZGFwdGVyXG4gICAgICApO1xuICAgICAgcmV0dXJuIF9hY2NvdW50O1xuICAgIH0sXG4gICAgdXBkYXRlVXNlcjogYXN5bmMgKHVzZXJJZCwgZGF0YSwgY29udGV4dCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgZGF0YSxcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcInVzZXJcIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0cnhBZGFwdGVyXG4gICAgICApO1xuICAgICAgYXdhaXQgcmVmcmVzaFVzZXJTZXNzaW9ucyh1c2VyKTtcbiAgICAgIGF3YWl0IHJlZnJlc2hVc2VyU2Vzc2lvbnModXNlcik7XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9LFxuICAgIHVwZGF0ZVVzZXJCeUVtYWlsOiBhc3luYyAoZW1haWwsIGRhdGEsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwidXNlclwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICBhd2FpdCByZWZyZXNoVXNlclNlc3Npb25zKHVzZXIpO1xuICAgICAgYXdhaXQgcmVmcmVzaFVzZXJTZXNzaW9ucyh1c2VyKTtcbiAgICAgIHJldHVybiB1c2VyO1xuICAgIH0sXG4gICAgdXBkYXRlUGFzc3dvcmQ6IGFzeW5jICh1c2VySWQsIHBhc3N3b3JkLCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBhd2FpdCB1cGRhdGVNYW55V2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgcGFzc3dvcmRcbiAgICAgICAgfSxcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwicHJvdmlkZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IFwiY3JlZGVudGlhbFwiXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcImFjY291bnRcIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0cnhBZGFwdGVyXG4gICAgICApO1xuICAgIH0sXG4gICAgZmluZEFjY291bnRzOiBhc3luYyAodXNlcklkLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjb3VudHM7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudDogYXN5bmMgKGFjY291bnRJZCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiYWNjb3VudElkXCIsXG4gICAgICAgICAgICB2YWx1ZTogYWNjb3VudElkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2NvdW50O1xuICAgIH0sXG4gICAgZmluZEFjY291bnRCeVByb3ZpZGVySWQ6IGFzeW5jIChhY2NvdW50SWQsIHByb3ZpZGVySWQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImFjY291bnRJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGFjY291bnRJZFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwicHJvdmlkZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHByb3ZpZGVySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudEJ5VXNlcklkOiBhc3luYyAodXNlcklkLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2NvdW50O1xuICAgIH0sXG4gICAgdXBkYXRlQWNjb3VudDogYXN5bmMgKGlkLCBkYXRhLCBjb250ZXh0LCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbeyBmaWVsZDogXCJpZFwiLCB2YWx1ZTogaWQgfV0sXG4gICAgICAgIFwiYWNjb3VudFwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gYWNjb3VudDtcbiAgICB9LFxuICAgIGNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoZGF0YSwgY29udGV4dCwgdHJ4QWRhcHRlcikgPT4ge1xuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5kYXRhXG4gICAgICAgIH0sXG4gICAgICAgIFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgdHJ4QWRhcHRlclxuICAgICAgKTtcbiAgICAgIHJldHVybiB2ZXJpZmljYXRpb247XG4gICAgfSxcbiAgICBmaW5kVmVyaWZpY2F0aW9uVmFsdWU6IGFzeW5jIChpZGVudGlmaWVyLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5maW5kTWFueShcbiAgICAgICAge1xuICAgICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZpZWxkOiBcImlkZW50aWZpZXJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGlkZW50aWZpZXJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIHNvcnRCeToge1xuICAgICAgICAgICAgZmllbGQ6IFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgICBkaXJlY3Rpb246IFwiZGVzY1wiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBsaW1pdDogMVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKCFvcHRpb25zLnZlcmlmaWNhdGlvbj8uZGlzYWJsZUNsZWFudXApIHtcbiAgICAgICAgYXdhaXQgKHRyeEFkYXB0ZXIgfHwgYWRhcHRlcikuZGVsZXRlTWFueSh7XG4gICAgICAgICAgbW9kZWw6IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwiZXhwaXJlc0F0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgb3BlcmF0b3I6IFwibHRcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCBsYXN0VmVyaWZpY2F0aW9uID0gdmVyaWZpY2F0aW9uWzBdO1xuICAgICAgcmV0dXJuIGxhc3RWZXJpZmljYXRpb247XG4gICAgfSxcbiAgICBkZWxldGVWZXJpZmljYXRpb25WYWx1ZTogYXN5bmMgKGlkLCB0cnhBZGFwdGVyKSA9PiB7XG4gICAgICBhd2FpdCAodHJ4QWRhcHRlciB8fCBhZGFwdGVyKS5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZVZlcmlmaWNhdGlvbkJ5SWRlbnRpZmllcjogYXN5bmMgKGlkZW50aWZpZXIsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGF3YWl0ICh0cnhBZGFwdGVyIHx8IGFkYXB0ZXIpLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkZW50aWZpZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBpZGVudGlmaWVyXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHVwZGF0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWQsIGRhdGEsIGNvbnRleHQsIHRyeEFkYXB0ZXIpID0+IHtcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgZGF0YSxcbiAgICAgICAgW3sgZmllbGQ6IFwiaWRcIiwgdmFsdWU6IGlkIH1dLFxuICAgICAgICBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHRyeEFkYXB0ZXJcbiAgICAgICk7XG4gICAgICByZXR1cm4gdmVyaWZpY2F0aW9uO1xuICAgIH1cbiAgfTtcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEFkYXB0ZXIob3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMuZGF0YWJhc2UpIHtcbiAgICBjb25zdCB0YWJsZXMgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICAgIGNvbnN0IG1lbW9yeURCID0gT2JqZWN0LmtleXModGFibGVzKS5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgICBhY2Nba2V5XSA9IFtdO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG4gICAgbG9nZ2VyLndhcm4oXG4gICAgICBcIk5vIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24gcHJvdmlkZWQuIFVzaW5nIG1lbW9yeSBhZGFwdGVyIGluIGRldmVsb3BtZW50XCJcbiAgICApO1xuICAgIHJldHVybiBtZW1vcnlBZGFwdGVyKG1lbW9yeURCKShvcHRpb25zKTtcbiAgfVxuICBpZiAodHlwZW9mIG9wdGlvbnMuZGF0YWJhc2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIHJldHVybiBvcHRpb25zLmRhdGFiYXNlKG9wdGlvbnMpO1xuICB9XG4gIGNvbnN0IHsga3lzZWx5LCBkYXRhYmFzZVR5cGUsIHRyYW5zYWN0aW9uIH0gPSBhd2FpdCBjcmVhdGVLeXNlbHlBZGFwdGVyKG9wdGlvbnMpO1xuICBpZiAoIWt5c2VseSkge1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBhZGFwdGVyXCIpO1xuICB9XG4gIHJldHVybiBreXNlbHlBZGFwdGVyKGt5c2VseSwge1xuICAgIHR5cGU6IGRhdGFiYXNlVHlwZSB8fCBcInNxbGl0ZVwiLFxuICAgIGRlYnVnTG9nczogXCJkZWJ1Z0xvZ3NcIiBpbiBvcHRpb25zLmRhdGFiYXNlID8gb3B0aW9ucy5kYXRhYmFzZS5kZWJ1Z0xvZ3MgOiBmYWxzZSxcbiAgICB0cmFuc2FjdGlvblxuICB9KShvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRUb0RCKGZpZWxkcywgdmFsdWVzKSB7XG4gIGxldCByZXN1bHQgPSB2YWx1ZXMuaWQgPyB7XG4gICAgaWQ6IHZhbHVlcy5pZFxuICB9IDoge307XG4gIGZvciAoY29uc3Qga2V5IGluIGZpZWxkcykge1xuICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2tleV07XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHJlc3VsdFtmaWVsZC5maWVsZE5hbWUgfHwga2V5XSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb252ZXJ0RnJvbURCKGZpZWxkcywgdmFsdWVzKSB7XG4gIGlmICghdmFsdWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgbGV0IHJlc3VsdCA9IHtcbiAgICBpZDogdmFsdWVzLmlkXG4gIH07XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGZpZWxkcykpIHtcbiAgICByZXN1bHRba2V5XSA9IHZhbHVlc1t2YWx1ZS5maWVsZE5hbWUgfHwga2V5XTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBnZXRTY2hlbWEoY29uZmlnKSB7XG4gIGNvbnN0IHRhYmxlcyA9IGdldEF1dGhUYWJsZXMoY29uZmlnKTtcbiAgbGV0IHNjaGVtYSA9IHt9O1xuICBmb3IgKGNvbnN0IGtleSBpbiB0YWJsZXMpIHtcbiAgICBjb25zdCB0YWJsZSA9IHRhYmxlc1trZXldO1xuICAgIGNvbnN0IGZpZWxkcyA9IHRhYmxlLmZpZWxkcztcbiAgICBsZXQgYWN0dWFsRmllbGRzID0ge307XG4gICAgT2JqZWN0LmVudHJpZXMoZmllbGRzKS5mb3JFYWNoKChba2V5MiwgZmllbGRdKSA9PiB7XG4gICAgICBhY3R1YWxGaWVsZHNbZmllbGQuZmllbGROYW1lIHx8IGtleTJdID0gZmllbGQ7XG4gICAgICBpZiAoZmllbGQucmVmZXJlbmNlcykge1xuICAgICAgICBjb25zdCByZWZUYWJsZSA9IHRhYmxlc1tmaWVsZC5yZWZlcmVuY2VzLm1vZGVsXTtcbiAgICAgICAgaWYgKHJlZlRhYmxlKSB7XG4gICAgICAgICAgYWN0dWFsRmllbGRzW2ZpZWxkLmZpZWxkTmFtZSB8fCBrZXkyXS5yZWZlcmVuY2VzID0ge1xuICAgICAgICAgICAgLi4uZmllbGQucmVmZXJlbmNlcyxcbiAgICAgICAgICAgIG1vZGVsOiByZWZUYWJsZS5tb2RlbE5hbWUsXG4gICAgICAgICAgICBmaWVsZDogZmllbGQucmVmZXJlbmNlcy5maWVsZFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0pIHtcbiAgICAgIHNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdLmZpZWxkcyA9IHtcbiAgICAgICAgLi4uc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0uZmllbGRzLFxuICAgICAgICAuLi5hY3R1YWxGaWVsZHNcbiAgICAgIH07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0gPSB7XG4gICAgICBmaWVsZHM6IGFjdHVhbEZpZWxkcyxcbiAgICAgIG9yZGVyOiB0YWJsZS5vcmRlciB8fCBJbmZpbml0eVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHNjaGVtYTtcbn1cblxuY29uc3QgcG9zdGdyZXNNYXAgPSB7XG4gIHN0cmluZzogW1wiY2hhcmFjdGVyIHZhcnlpbmdcIiwgXCJ2YXJjaGFyXCIsIFwidGV4dFwiXSxcbiAgbnVtYmVyOiBbXG4gICAgXCJpbnQ0XCIsXG4gICAgXCJpbnRlZ2VyXCIsXG4gICAgXCJiaWdpbnRcIixcbiAgICBcInNtYWxsaW50XCIsXG4gICAgXCJudW1lcmljXCIsXG4gICAgXCJyZWFsXCIsXG4gICAgXCJkb3VibGUgcHJlY2lzaW9uXCJcbiAgXSxcbiAgYm9vbGVhbjogW1wiYm9vbFwiLCBcImJvb2xlYW5cIl0sXG4gIGRhdGU6IFtcInRpbWVzdGFtcHR6XCIsIFwidGltZXN0YW1wXCIsIFwiZGF0ZVwiXSxcbiAganNvbjogW1wianNvblwiLCBcImpzb25iXCJdXG59O1xuY29uc3QgbXlzcWxNYXAgPSB7XG4gIHN0cmluZzogW1widmFyY2hhclwiLCBcInRleHRcIl0sXG4gIG51bWJlcjogW1xuICAgIFwiaW50ZWdlclwiLFxuICAgIFwiaW50XCIsXG4gICAgXCJiaWdpbnRcIixcbiAgICBcInNtYWxsaW50XCIsXG4gICAgXCJkZWNpbWFsXCIsXG4gICAgXCJmbG9hdFwiLFxuICAgIFwiZG91YmxlXCJcbiAgXSxcbiAgYm9vbGVhbjogW1wiYm9vbGVhblwiLCBcInRpbnlpbnRcIl0sXG4gIGRhdGU6IFtcInRpbWVzdGFtcFwiLCBcImRhdGV0aW1lXCIsIFwiZGF0ZVwiXSxcbiAganNvbjogW1wianNvblwiXVxufTtcbmNvbnN0IHNxbGl0ZU1hcCA9IHtcbiAgc3RyaW5nOiBbXCJURVhUXCJdLFxuICBudW1iZXI6IFtcIklOVEVHRVJcIiwgXCJSRUFMXCJdLFxuICBib29sZWFuOiBbXCJJTlRFR0VSXCIsIFwiQk9PTEVBTlwiXSxcbiAgLy8gMCBvciAxXG4gIGRhdGU6IFtcIkRBVEVcIiwgXCJJTlRFR0VSXCJdLFxuICBqc29uOiBbXCJURVhUXCJdXG59O1xuY29uc3QgbXNzcWxNYXAgPSB7XG4gIHN0cmluZzogW1widmFyY2hhclwiLCBcIm52YXJjaGFyXCJdLFxuICBudW1iZXI6IFtcImludFwiLCBcImJpZ2ludFwiLCBcInNtYWxsaW50XCIsIFwiZGVjaW1hbFwiLCBcImZsb2F0XCIsIFwiZG91YmxlXCJdLFxuICBib29sZWFuOiBbXCJiaXRcIiwgXCJzbWFsbGludFwiXSxcbiAgZGF0ZTogW1wiZGF0ZXRpbWUyXCIsIFwiZGF0ZVwiLCBcImRhdGV0aW1lXCJdLFxuICBqc29uOiBbXCJ2YXJjaGFyXCIsIFwibnZhcmNoYXJcIl1cbn07XG5jb25zdCBtYXAgPSB7XG4gIHBvc3RncmVzOiBwb3N0Z3Jlc01hcCxcbiAgbXlzcWw6IG15c3FsTWFwLFxuICBzcWxpdGU6IHNxbGl0ZU1hcCxcbiAgbXNzcWw6IG1zc3FsTWFwXG59O1xuZnVuY3Rpb24gbWF0Y2hUeXBlKGNvbHVtbkRhdGFUeXBlLCBmaWVsZFR5cGUsIGRiVHlwZSkge1xuICBmdW5jdGlvbiBub3JtYWxpemUodHlwZSkge1xuICAgIHJldHVybiB0eXBlLnRvTG93ZXJDYXNlKCkuc3BsaXQoXCIoXCIpWzBdLnRyaW0oKTtcbiAgfVxuICBpZiAoZmllbGRUeXBlID09PSBcInN0cmluZ1tdXCIgfHwgZmllbGRUeXBlID09PSBcIm51bWJlcltdXCIpIHtcbiAgICByZXR1cm4gY29sdW1uRGF0YVR5cGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImpzb25cIik7XG4gIH1cbiAgY29uc3QgdHlwZXMgPSBtYXBbZGJUeXBlXTtcbiAgY29uc3QgZXhwZWN0ZWQgPSBBcnJheS5pc0FycmF5KGZpZWxkVHlwZSkgPyB0eXBlc1tcInN0cmluZ1wiXS5tYXAoKHQpID0+IHQudG9Mb3dlckNhc2UoKSkgOiB0eXBlc1tmaWVsZFR5cGVdLm1hcCgodCkgPT4gdC50b0xvd2VyQ2FzZSgpKTtcbiAgcmV0dXJuIGV4cGVjdGVkLmluY2x1ZGVzKG5vcm1hbGl6ZShjb2x1bW5EYXRhVHlwZSkpO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0UG9zdGdyZXNTY2hlbWEoZGIpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzcWxgU0hPVyBzZWFyY2hfcGF0aGAuZXhlY3V0ZShcbiAgICAgIGRiXG4gICAgKTtcbiAgICBpZiAocmVzdWx0LnJvd3NbMF0/LnNlYXJjaF9wYXRoKSB7XG4gICAgICBjb25zdCBzY2hlbWFzID0gcmVzdWx0LnJvd3NbMF0uc2VhcmNoX3BhdGguc3BsaXQoXCIsXCIpLm1hcCgocykgPT4gcy50cmltKCkpLm1hcCgocykgPT4gcy5yZXBsYWNlKC9eW1wiJ118W1wiJ10kL2csIFwiXCIpKS5maWx0ZXIoKHMpID0+ICFzLnN0YXJ0c1dpdGgoXCIkXCIpKTtcbiAgICAgIHJldHVybiBzY2hlbWFzWzBdIHx8IFwicHVibGljXCI7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICB9XG4gIHJldHVybiBcInB1YmxpY1wiO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0TWlncmF0aW9ucyhjb25maWcpIHtcbiAgY29uc3QgYmV0dGVyQXV0aFNjaGVtYSA9IGdldFNjaGVtYShjb25maWcpO1xuICBjb25zdCBsb2dnZXIgPSBjcmVhdGVMb2dnZXIoY29uZmlnLmxvZ2dlcik7XG4gIGxldCB7IGt5c2VseTogZGIsIGRhdGFiYXNlVHlwZTogZGJUeXBlIH0gPSBhd2FpdCBjcmVhdGVLeXNlbHlBZGFwdGVyKGNvbmZpZyk7XG4gIGlmICghZGJUeXBlKSB7XG4gICAgbG9nZ2VyLndhcm4oXG4gICAgICBcIkNvdWxkIG5vdCBkZXRlcm1pbmUgZGF0YWJhc2UgdHlwZSwgZGVmYXVsdGluZyB0byBzcWxpdGUuIFBsZWFzZSBwcm92aWRlIGEgdHlwZSBpbiB0aGUgZGF0YWJhc2Ugb3B0aW9ucyB0byBhdm9pZCB0aGlzLlwiXG4gICAgKTtcbiAgICBkYlR5cGUgPSBcInNxbGl0ZVwiO1xuICB9XG4gIGlmICghZGIpIHtcbiAgICBsb2dnZXIuZXJyb3IoXG4gICAgICBcIk9ubHkga3lzZWx5IGFkYXB0ZXIgaXMgc3VwcG9ydGVkIGZvciBtaWdyYXRpb25zLiBZb3UgY2FuIHVzZSBgZ2VuZXJhdGVgIGNvbW1hbmQgdG8gZ2VuZXJhdGUgdGhlIHNjaGVtYSwgaWYgeW91J3JlIHVzaW5nIGEgZGlmZmVyZW50IGFkYXB0ZXIuXCJcbiAgICApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuICBsZXQgY3VycmVudFNjaGVtYSA9IFwicHVibGljXCI7XG4gIGlmIChkYlR5cGUgPT09IFwicG9zdGdyZXNcIikge1xuICAgIGN1cnJlbnRTY2hlbWEgPSBhd2FpdCBnZXRQb3N0Z3Jlc1NjaGVtYShkYik7XG4gICAgbG9nZ2VyLmRlYnVnKFxuICAgICAgYFBvc3RncmVTUUwgbWlncmF0aW9uOiBVc2luZyBzY2hlbWEgJyR7Y3VycmVudFNjaGVtYX0nIChmcm9tIHNlYXJjaF9wYXRoKWBcbiAgICApO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzY2hlbWFDaGVjayA9IGF3YWl0IHNxbGBcblx0XHRcdFx0U0VMRUNUIHNjaGVtYV9uYW1lIFxuXHRcdFx0XHRGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS5zY2hlbWF0YSBcblx0XHRcdFx0V0hFUkUgc2NoZW1hX25hbWUgPSAke2N1cnJlbnRTY2hlbWF9XG5cdFx0XHRgLmV4ZWN1dGUoZGIpO1xuICAgICAgaWYgKCFzY2hlbWFDaGVjay5yb3dzWzBdKSB7XG4gICAgICAgIGxvZ2dlci53YXJuKFxuICAgICAgICAgIGBTY2hlbWEgJyR7Y3VycmVudFNjaGVtYX0nIGRvZXMgbm90IGV4aXN0LiBUYWJsZXMgd2lsbCBiZSBpbnNwZWN0ZWQgZnJvbSBhdmFpbGFibGUgc2NoZW1hcy4gQ29uc2lkZXIgY3JlYXRpbmcgdGhlIHNjaGVtYSBmaXJzdCBvciBjaGVja2luZyB5b3VyIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24uYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZGVidWcoXG4gICAgICAgIGBDb3VsZCBub3QgdmVyaWZ5IHNjaGVtYSBleGlzdGVuY2U6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWBcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGNvbnN0IGFsbFRhYmxlTWV0YWRhdGEgPSBhd2FpdCBkYi5pbnRyb3NwZWN0aW9uLmdldFRhYmxlcygpO1xuICBsZXQgdGFibGVNZXRhZGF0YSA9IGFsbFRhYmxlTWV0YWRhdGE7XG4gIGlmIChkYlR5cGUgPT09IFwicG9zdGdyZXNcIikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0YWJsZXNJblNjaGVtYSA9IGF3YWl0IHNxbGBcblx0XHRcdFx0U0VMRUNUIHRhYmxlX25hbWUgXG5cdFx0XHRcdEZST00gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyBcblx0XHRcdFx0V0hFUkUgdGFibGVfc2NoZW1hID0gJHtjdXJyZW50U2NoZW1hfVxuXHRcdFx0XHRBTkQgdGFibGVfdHlwZSA9ICdCQVNFIFRBQkxFJ1xuXHRcdFx0YC5leGVjdXRlKGRiKTtcbiAgICAgIGNvbnN0IHRhYmxlTmFtZXNJblNjaGVtYSA9IG5ldyBTZXQoXG4gICAgICAgIHRhYmxlc0luU2NoZW1hLnJvd3MubWFwKChyb3cpID0+IHJvdy50YWJsZV9uYW1lKVxuICAgICAgKTtcbiAgICAgIHRhYmxlTWV0YWRhdGEgPSBhbGxUYWJsZU1ldGFkYXRhLmZpbHRlcihcbiAgICAgICAgKHRhYmxlKSA9PiB0YWJsZS5zY2hlbWEgPT09IGN1cnJlbnRTY2hlbWEgJiYgdGFibGVOYW1lc0luU2NoZW1hLmhhcyh0YWJsZS5uYW1lKVxuICAgICAgKTtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgYEZvdW5kICR7dGFibGVNZXRhZGF0YS5sZW5ndGh9IHRhYmxlKHMpIGluIHNjaGVtYSAnJHtjdXJyZW50U2NoZW1hfSc6ICR7dGFibGVNZXRhZGF0YS5tYXAoKHQpID0+IHQubmFtZSkuam9pbihcIiwgXCIpIHx8IFwiKG5vbmUpXCJ9YFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgIGBDb3VsZCBub3QgZmlsdGVyIHRhYmxlcyBieSBzY2hlbWEuIFVzaW5nIGFsbCBkaXNjb3ZlcmVkIHRhYmxlcy4gRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWBcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGNvbnN0IHRvQmVDcmVhdGVkID0gW107XG4gIGNvbnN0IHRvQmVBZGRlZCA9IFtdO1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhiZXR0ZXJBdXRoU2NoZW1hKSkge1xuICAgIGNvbnN0IHRhYmxlID0gdGFibGVNZXRhZGF0YS5maW5kKCh0KSA9PiB0Lm5hbWUgPT09IGtleSk7XG4gICAgaWYgKCF0YWJsZSkge1xuICAgICAgY29uc3QgdEluZGV4ID0gdG9CZUNyZWF0ZWQuZmluZEluZGV4KCh0KSA9PiB0LnRhYmxlID09PSBrZXkpO1xuICAgICAgY29uc3QgdGFibGVEYXRhID0ge1xuICAgICAgICB0YWJsZToga2V5LFxuICAgICAgICBmaWVsZHM6IHZhbHVlLmZpZWxkcyxcbiAgICAgICAgb3JkZXI6IHZhbHVlLm9yZGVyIHx8IEluZmluaXR5XG4gICAgICB9O1xuICAgICAgY29uc3QgaW5zZXJ0SW5kZXggPSB0b0JlQ3JlYXRlZC5maW5kSW5kZXgoXG4gICAgICAgICh0KSA9PiAodC5vcmRlciB8fCBJbmZpbml0eSkgPiB0YWJsZURhdGEub3JkZXJcbiAgICAgICk7XG4gICAgICBpZiAoaW5zZXJ0SW5kZXggPT09IC0xKSB7XG4gICAgICAgIGlmICh0SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgdG9CZUNyZWF0ZWQucHVzaCh0YWJsZURhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRvQmVDcmVhdGVkW3RJbmRleF0uZmllbGRzID0ge1xuICAgICAgICAgICAgLi4udG9CZUNyZWF0ZWRbdEluZGV4XS5maWVsZHMsXG4gICAgICAgICAgICAuLi52YWx1ZS5maWVsZHNcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b0JlQ3JlYXRlZC5zcGxpY2UoaW5zZXJ0SW5kZXgsIDAsIHRhYmxlRGF0YSk7XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgbGV0IHRvQmVBZGRlZEZpZWxkcyA9IHt9O1xuICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgZmllbGRdIG9mIE9iamVjdC5lbnRyaWVzKHZhbHVlLmZpZWxkcykpIHtcbiAgICAgIGNvbnN0IGNvbHVtbiA9IHRhYmxlLmNvbHVtbnMuZmluZCgoYykgPT4gYy5uYW1lID09PSBmaWVsZE5hbWUpO1xuICAgICAgaWYgKCFjb2x1bW4pIHtcbiAgICAgICAgdG9CZUFkZGVkRmllbGRzW2ZpZWxkTmFtZV0gPSBmaWVsZDtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAobWF0Y2hUeXBlKGNvbHVtbi5kYXRhVHlwZSwgZmllbGQudHlwZSwgZGJUeXBlKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlci53YXJuKFxuICAgICAgICAgIGBGaWVsZCAke2ZpZWxkTmFtZX0gaW4gdGFibGUgJHtrZXl9IGhhcyBhIGRpZmZlcmVudCB0eXBlIGluIHRoZSBkYXRhYmFzZS4gRXhwZWN0ZWQgJHtmaWVsZC50eXBlfSBidXQgZ290ICR7Y29sdW1uLmRhdGFUeXBlfS5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChPYmplY3Qua2V5cyh0b0JlQWRkZWRGaWVsZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgIHRvQmVBZGRlZC5wdXNoKHtcbiAgICAgICAgdGFibGU6IGtleSxcbiAgICAgICAgZmllbGRzOiB0b0JlQWRkZWRGaWVsZHMsXG4gICAgICAgIG9yZGVyOiB2YWx1ZS5vcmRlciB8fCBJbmZpbml0eVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGNvbnN0IG1pZ3JhdGlvbnMgPSBbXTtcbiAgZnVuY3Rpb24gZ2V0VHlwZShmaWVsZCwgZmllbGROYW1lKSB7XG4gICAgY29uc3QgdHlwZSA9IGZpZWxkLnR5cGU7XG4gICAgY29uc3QgdHlwZU1hcCA9IHtcbiAgICAgIHN0cmluZzoge1xuICAgICAgICBzcWxpdGU6IFwidGV4dFwiLFxuICAgICAgICBwb3N0Z3JlczogXCJ0ZXh0XCIsXG4gICAgICAgIG15c3FsOiBmaWVsZC51bmlxdWUgPyBcInZhcmNoYXIoMjU1KVwiIDogZmllbGQucmVmZXJlbmNlcyA/IFwidmFyY2hhcigzNilcIiA6IFwidGV4dFwiLFxuICAgICAgICBtc3NxbDogZmllbGQudW5pcXVlIHx8IGZpZWxkLnNvcnRhYmxlID8gXCJ2YXJjaGFyKDI1NSlcIiA6IGZpZWxkLnJlZmVyZW5jZXMgPyBcInZhcmNoYXIoMzYpXCIgOiAoXG4gICAgICAgICAgLy8gbXNzcWwgZGVwcmVjYXRlZCBgdGV4dGAsIGFuZCB0aGUgYWx0ZXJuYXRpdmUgaXMgYHZhcmNoYXIobWF4KWAuXG4gICAgICAgICAgLy8gS3lzZWx5IHR5cGUgaW50ZXJmYWNlIGRvZXNuJ3Qgc3VwcG9ydCBgdGV4dGAsIHNvIHdlIHNldCB0aGlzIHRvIGB2YXJjaGFyKDgwMDApYCBhc1xuICAgICAgICAgIC8vIHRoYXQncyB0aGUgbWF4IGxlbmd0aCBmb3IgYHZhcmNoYXJgXG4gICAgICAgICAgXCJ2YXJjaGFyKDgwMDApXCJcbiAgICAgICAgKVxuICAgICAgfSxcbiAgICAgIGJvb2xlYW46IHtcbiAgICAgICAgc3FsaXRlOiBcImludGVnZXJcIixcbiAgICAgICAgcG9zdGdyZXM6IFwiYm9vbGVhblwiLFxuICAgICAgICBteXNxbDogXCJib29sZWFuXCIsXG4gICAgICAgIG1zc3FsOiBcInNtYWxsaW50XCJcbiAgICAgIH0sXG4gICAgICBudW1iZXI6IHtcbiAgICAgICAgc3FsaXRlOiBmaWVsZC5iaWdpbnQgPyBcImJpZ2ludFwiIDogXCJpbnRlZ2VyXCIsXG4gICAgICAgIHBvc3RncmVzOiBmaWVsZC5iaWdpbnQgPyBcImJpZ2ludFwiIDogXCJpbnRlZ2VyXCIsXG4gICAgICAgIG15c3FsOiBmaWVsZC5iaWdpbnQgPyBcImJpZ2ludFwiIDogXCJpbnRlZ2VyXCIsXG4gICAgICAgIG1zc3FsOiBmaWVsZC5iaWdpbnQgPyBcImJpZ2ludFwiIDogXCJpbnRlZ2VyXCJcbiAgICAgIH0sXG4gICAgICBkYXRlOiB7XG4gICAgICAgIHNxbGl0ZTogXCJkYXRlXCIsXG4gICAgICAgIHBvc3RncmVzOiBcInRpbWVzdGFtcHR6XCIsXG4gICAgICAgIG15c3FsOiBcInRpbWVzdGFtcCgzKVwiLFxuICAgICAgICBtc3NxbDogc3FsYGRhdGV0aW1lMigzKWBcbiAgICAgIH0sXG4gICAgICBqc29uOiB7XG4gICAgICAgIHNxbGl0ZTogXCJ0ZXh0XCIsXG4gICAgICAgIHBvc3RncmVzOiBcImpzb25iXCIsXG4gICAgICAgIG15c3FsOiBcImpzb25cIixcbiAgICAgICAgbXNzcWw6IFwidmFyY2hhcig4MDAwKVwiXG4gICAgICB9LFxuICAgICAgaWQ6IHtcbiAgICAgICAgcG9zdGdyZXM6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJzZXJpYWxcIiA6IFwidGV4dFwiLFxuICAgICAgICBteXNxbDogY29uZmlnLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcImludGVnZXJcIiA6IFwidmFyY2hhcigzNilcIixcbiAgICAgICAgbXNzcWw6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJpbnRlZ2VyXCIgOiBcInZhcmNoYXIoMzYpXCIsXG4gICAgICAgIHNxbGl0ZTogY29uZmlnLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcImludGVnZXJcIiA6IFwidGV4dFwiXG4gICAgICB9LFxuICAgICAgZm9yZWlnbktleUlkOiB7XG4gICAgICAgIHBvc3RncmVzOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ0ZXh0XCIsXG4gICAgICAgIG15c3FsOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ2YXJjaGFyKDM2KVwiLFxuICAgICAgICBtc3NxbDogY29uZmlnLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcImludGVnZXJcIiA6IFwidmFyY2hhcigzNilcIixcbiAgICAgICAgc3FsaXRlOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ0ZXh0XCJcbiAgICAgIH1cbiAgICB9O1xuICAgIGlmIChmaWVsZE5hbWUgPT09IFwiaWRcIiB8fCBmaWVsZC5yZWZlcmVuY2VzPy5maWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICBpZiAoZmllbGROYW1lID09PSBcImlkXCIpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVNYXAuaWRbZGJUeXBlXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0eXBlTWFwLmZvcmVpZ25LZXlJZFtkYlR5cGVdO1xuICAgIH1cbiAgICBpZiAoZGJUeXBlID09PSBcInNxbGl0ZVwiICYmICh0eXBlID09PSBcInN0cmluZ1tdXCIgfHwgdHlwZSA9PT0gXCJudW1iZXJbXVwiKSkge1xuICAgICAgcmV0dXJuIFwidGV4dFwiO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gXCJzdHJpbmdbXVwiIHx8IHR5cGUgPT09IFwibnVtYmVyW11cIikge1xuICAgICAgcmV0dXJuIFwianNvbmJcIjtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodHlwZSkpIHtcbiAgICAgIHJldHVybiBcInRleHRcIjtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVNYXBbdHlwZV1bZGJUeXBlIHx8IFwic3FsaXRlXCJdO1xuICB9XG4gIGlmICh0b0JlQWRkZWQubGVuZ3RoKSB7XG4gICAgZm9yIChjb25zdCB0YWJsZSBvZiB0b0JlQWRkZWQpIHtcbiAgICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgZmllbGRdIG9mIE9iamVjdC5lbnRyaWVzKHRhYmxlLmZpZWxkcykpIHtcbiAgICAgICAgY29uc3QgdHlwZSA9IGdldFR5cGUoZmllbGQsIGZpZWxkTmFtZSk7XG4gICAgICAgIGNvbnN0IGV4ZWMgPSBkYi5zY2hlbWEuYWx0ZXJUYWJsZSh0YWJsZS50YWJsZSkuYWRkQ29sdW1uKGZpZWxkTmFtZSwgdHlwZSwgKGNvbCkgPT4ge1xuICAgICAgICAgIGNvbCA9IGZpZWxkLnJlcXVpcmVkICE9PSBmYWxzZSA/IGNvbC5ub3ROdWxsKCkgOiBjb2w7XG4gICAgICAgICAgaWYgKGZpZWxkLnJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNvbCA9IGNvbC5yZWZlcmVuY2VzKFxuICAgICAgICAgICAgICBgJHtmaWVsZC5yZWZlcmVuY2VzLm1vZGVsfS4ke2ZpZWxkLnJlZmVyZW5jZXMuZmllbGR9YFxuICAgICAgICAgICAgKS5vbkRlbGV0ZShmaWVsZC5yZWZlcmVuY2VzLm9uRGVsZXRlIHx8IFwiY2FzY2FkZVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnVuaXF1ZSkge1xuICAgICAgICAgICAgY29sID0gY29sLnVuaXF1ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gXCJkYXRlXCIgJiYgdHlwZW9mIGZpZWxkLmRlZmF1bHRWYWx1ZSA9PT0gXCJmdW5jdGlvblwiICYmIChkYlR5cGUgPT09IFwicG9zdGdyZXNcIiB8fCBkYlR5cGUgPT09IFwibXlzcWxcIiB8fCBkYlR5cGUgPT09IFwibXNzcWxcIikpIHtcbiAgICAgICAgICAgIGlmIChkYlR5cGUgPT09IFwibXlzcWxcIikge1xuICAgICAgICAgICAgICBjb2wgPSBjb2wuZGVmYXVsdFRvKHNxbGBDVVJSRU5UX1RJTUVTVEFNUCgzKWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29sID0gY29sLmRlZmF1bHRUbyhzcWxgQ1VSUkVOVF9USU1FU1RBTVBgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNvbDtcbiAgICAgICAgfSk7XG4gICAgICAgIG1pZ3JhdGlvbnMucHVzaChleGVjKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKHRvQmVDcmVhdGVkLmxlbmd0aCkge1xuICAgIGZvciAoY29uc3QgdGFibGUgb2YgdG9CZUNyZWF0ZWQpIHtcbiAgICAgIGxldCBkYlQgPSBkYi5zY2hlbWEuY3JlYXRlVGFibGUodGFibGUudGFibGUpLmFkZENvbHVtbihcbiAgICAgICAgXCJpZFwiLFxuICAgICAgICBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiID8gXCJzZXJpYWxcIiA6IFwiaW50ZWdlclwiIDogZGJUeXBlID09PSBcIm15c3FsXCIgfHwgZGJUeXBlID09PSBcIm1zc3FsXCIgPyBcInZhcmNoYXIoMzYpXCIgOiBcInRleHRcIixcbiAgICAgICAgKGNvbCkgPT4ge1xuICAgICAgICAgIGlmIChjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCkge1xuICAgICAgICAgICAgaWYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiIHx8IGRiVHlwZSA9PT0gXCJzcWxpdGVcIikge1xuICAgICAgICAgICAgICByZXR1cm4gY29sLnByaW1hcnlLZXkoKS5ub3ROdWxsKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRiVHlwZSA9PT0gXCJtc3NxbFwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjb2wuaWRlbnRpdHkoKS5wcmltYXJ5S2V5KCkubm90TnVsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbC5hdXRvSW5jcmVtZW50KCkucHJpbWFyeUtleSgpLm5vdE51bGwoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNvbC5wcmltYXJ5S2V5KCkubm90TnVsbCgpO1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModGFibGUuZmllbGRzKSkge1xuICAgICAgICBjb25zdCB0eXBlID0gZ2V0VHlwZShmaWVsZCwgZmllbGROYW1lKTtcbiAgICAgICAgZGJUID0gZGJULmFkZENvbHVtbihmaWVsZE5hbWUsIHR5cGUsIChjb2wpID0+IHtcbiAgICAgICAgICBjb2wgPSBmaWVsZC5yZXF1aXJlZCAhPT0gZmFsc2UgPyBjb2wubm90TnVsbCgpIDogY29sO1xuICAgICAgICAgIGlmIChmaWVsZC5yZWZlcmVuY2VzKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wucmVmZXJlbmNlcyhgJHtmaWVsZC5yZWZlcmVuY2VzLm1vZGVsfS4ke2ZpZWxkLnJlZmVyZW5jZXMuZmllbGR9YCkub25EZWxldGUoZmllbGQucmVmZXJlbmNlcy5vbkRlbGV0ZSB8fCBcImNhc2NhZGVcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC51bmlxdWUpIHtcbiAgICAgICAgICAgIGNvbCA9IGNvbC51bmlxdWUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09IFwiZGF0ZVwiICYmIHR5cGVvZiBmaWVsZC5kZWZhdWx0VmFsdWUgPT09IFwiZnVuY3Rpb25cIiAmJiAoZGJUeXBlID09PSBcInBvc3RncmVzXCIgfHwgZGJUeXBlID09PSBcIm15c3FsXCIgfHwgZGJUeXBlID09PSBcIm1zc3FsXCIpKSB7XG4gICAgICAgICAgICBpZiAoZGJUeXBlID09PSBcIm15c3FsXCIpIHtcbiAgICAgICAgICAgICAgY29sID0gY29sLmRlZmF1bHRUbyhzcWxgQ1VSUkVOVF9USU1FU1RBTVAoMylgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbCA9IGNvbC5kZWZhdWx0VG8oc3FsYENVUlJFTlRfVElNRVNUQU1QYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjb2w7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgbWlncmF0aW9ucy5wdXNoKGRiVCk7XG4gICAgfVxuICB9XG4gIGFzeW5jIGZ1bmN0aW9uIHJ1bk1pZ3JhdGlvbnMoKSB7XG4gICAgZm9yIChjb25zdCBtaWdyYXRpb24gb2YgbWlncmF0aW9ucykge1xuICAgICAgYXdhaXQgbWlncmF0aW9uLmV4ZWN1dGUoKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gY29tcGlsZU1pZ3JhdGlvbnMoKSB7XG4gICAgY29uc3QgY29tcGlsZWQgPSBtaWdyYXRpb25zLm1hcCgobSkgPT4gbS5jb21waWxlKCkuc3FsKTtcbiAgICByZXR1cm4gY29tcGlsZWQuam9pbihcIjtcXG5cXG5cIikgKyBcIjtcIjtcbiAgfVxuICByZXR1cm4geyB0b0JlQ3JlYXRlZCwgdG9CZUFkZGVkLCBydW5NaWdyYXRpb25zLCBjb21waWxlTWlncmF0aW9ucyB9O1xufVxuXG5leHBvcnQgeyBnZXRBZGFwdGVyIGFzIGEsIGNvbnZlcnRUb0RCIGFzIGIsIGNyZWF0ZUludGVybmFsQWRhcHRlciBhcyBjLCBjb252ZXJ0RnJvbURCIGFzIGQsIGdldE1pZ3JhdGlvbnMgYXMgZSwgZ2V0U2NoZW1hIGFzIGYsIGdldFdpdGhIb29rcyBhcyBnLCBtYXRjaFR5cGUgYXMgbSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   s: () => (/* binding */ safeJSONParse)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n\n\nfunction safeJSONParse(data) {\n  function reviver(_, value) {\n    if (typeof value === \"string\") {\n      const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z$/;\n      if (iso8601Regex.test(value)) {\n        const date = new Date(value);\n        if (!isNaN(date.getTime())) {\n          return date;\n        }\n      }\n    }\n    return value;\n  }\n  try {\n    if (typeof data !== \"string\") {\n      return data;\n    }\n    return JSON.parse(data, reviver);\n  } catch (e) {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error parsing JSON\", { error: e });\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CS0V0RXB0MC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBK0M7O0FBRS9DO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUU7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixJQUFJLHlEQUFNLCtCQUErQixVQUFVO0FBQ25EO0FBQ0E7QUFDQTs7QUFFOEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcz8zZTkwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5cbmZ1bmN0aW9uIHNhZmVKU09OUGFyc2UoZGF0YSkge1xuICBmdW5jdGlvbiByZXZpdmVyKF8sIHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgaXNvODYwMVJlZ2V4ID0gL15cXGR7NH0tXFxkezJ9LVxcZHsyfVRcXGR7Mn06XFxkezJ9OlxcZHsyfSg/OlxcLlxcZCspP1okLztcbiAgICAgIGlmIChpc284NjAxUmVnZXgudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICAgICAgaWYgKCFpc05hTihkYXRlLmdldFRpbWUoKSkpIHtcbiAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIGRhdGEgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhLCByZXZpdmVyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZ2dlci5lcnJvcihcIkVycm9yIHBhcnNpbmcgSlNPTlwiLCB7IGVycm9yOiBlIH0pO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCB7IHNhZmVKU09OUGFyc2UgYXMgcyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   m: () => (/* binding */ memoryAdapter)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n\n\n\nconst memoryAdapter = (db, config) => {\n  let lazyOptions = null;\n  let adapterCreator = (0,_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_1__.c)({\n    config: {\n      adapterId: \"memory\",\n      adapterName: \"Memory Adapter\",\n      usePlural: false,\n      debugLogs: config?.debugLogs || false,\n      customTransformInput(props) {\n        if (props.options.advanced?.database?.useNumberId && props.field === \"id\" && props.action === \"create\") {\n          return db[props.model].length + 1;\n        }\n        return props.data;\n      },\n      transaction: async (cb) => {\n        let clone = structuredClone(db);\n        try {\n          const r = await cb(adapterCreator(lazyOptions));\n          return r;\n        } catch (error) {\n          Object.keys(db).forEach((key) => {\n            db[key] = clone[key];\n          });\n          throw error;\n        }\n      }\n    },\n    adapter: ({ getFieldName, options, debugLog }) => {\n      function convertWhereClause(where, model) {\n        const table = db[model];\n        if (!table) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger.error(\n            `[MemoryAdapter] Model ${model} not found in the DB`,\n            Object.keys(db)\n          );\n          throw new Error(`Model ${model} not found`);\n        }\n        const evalClause = (record, clause) => {\n          const { field, value, operator } = clause;\n          switch (operator) {\n            case \"in\":\n              if (!Array.isArray(value)) {\n                throw new Error(\"Value must be an array\");\n              }\n              return value.includes(record[field]);\n            case \"not_in\":\n              if (!Array.isArray(value)) {\n                throw new Error(\"Value must be an array\");\n              }\n              return !value.includes(record[field]);\n            case \"contains\":\n              return record[field].includes(value);\n            case \"starts_with\":\n              return record[field].startsWith(value);\n            case \"ends_with\":\n              return record[field].endsWith(value);\n            case \"ne\":\n              return record[field] !== value;\n            case \"gt\":\n              return value != null && Boolean(record[field] > value);\n            case \"gte\":\n              return value != null && Boolean(record[field] >= value);\n            case \"lt\":\n              return value != null && Boolean(record[field] < value);\n            case \"lte\":\n              return value != null && Boolean(record[field] <= value);\n            default:\n              return record[field] === value;\n          }\n        };\n        return table.filter((record) => {\n          if (!where.length || where.length === 0) {\n            return true;\n          }\n          let result = evalClause(record, where[0]);\n          for (const clause of where) {\n            const clauseResult = evalClause(record, clause);\n            if (clause.connector === \"OR\") {\n              result = result || clauseResult;\n            } else {\n              result = result && clauseResult;\n            }\n          }\n          return result;\n        });\n      }\n      return {\n        create: async ({ model, data }) => {\n          if (options.advanced?.database?.useNumberId) {\n            data.id = db[model].length + 1;\n          }\n          if (!db[model]) {\n            db[model] = [];\n          }\n          db[model].push(data);\n          return data;\n        },\n        findOne: async ({ model, where }) => {\n          const res = convertWhereClause(where, model);\n          const record = res[0] || null;\n          return record;\n        },\n        findMany: async ({ model, where, sortBy, limit, offset }) => {\n          let table = db[model];\n          if (where) {\n            table = convertWhereClause(where, model);\n          }\n          if (sortBy) {\n            table = table.sort((a, b) => {\n              const field = getFieldName({ model, field: sortBy.field });\n              const aValue = a[field];\n              const bValue = b[field];\n              let comparison = 0;\n              if (aValue == null && bValue == null) {\n                comparison = 0;\n              } else if (aValue == null) {\n                comparison = -1;\n              } else if (bValue == null) {\n                comparison = 1;\n              } else if (typeof aValue === \"string\" && typeof bValue === \"string\") {\n                comparison = aValue.localeCompare(bValue);\n              } else if (aValue instanceof Date && bValue instanceof Date) {\n                comparison = aValue.getTime() - bValue.getTime();\n              } else if (typeof aValue === \"number\" && typeof bValue === \"number\") {\n                comparison = aValue - bValue;\n              } else if (typeof aValue === \"boolean\" && typeof bValue === \"boolean\") {\n                comparison = aValue === bValue ? 0 : aValue ? 1 : -1;\n              } else {\n                comparison = String(aValue).localeCompare(String(bValue));\n              }\n              return sortBy.direction === \"asc\" ? comparison : -comparison;\n            });\n          }\n          if (offset !== void 0) {\n            table = table.slice(offset);\n          }\n          if (limit !== void 0) {\n            table = table.slice(0, limit);\n          }\n          return table || [];\n        },\n        count: async ({ model, where }) => {\n          if (where) {\n            const filteredRecords = convertWhereClause(where, model);\n            return filteredRecords.length;\n          }\n          return db[model].length;\n        },\n        update: async ({ model, where, update }) => {\n          const res = convertWhereClause(where, model);\n          res.forEach((record) => {\n            Object.assign(record, update);\n          });\n          return res[0] || null;\n        },\n        delete: async ({ model, where }) => {\n          const table = db[model];\n          const res = convertWhereClause(where, model);\n          db[model] = table.filter((record) => !res.includes(record));\n        },\n        deleteMany: async ({ model, where }) => {\n          const table = db[model];\n          const res = convertWhereClause(where, model);\n          let count = 0;\n          db[model] = table.filter((record) => {\n            if (res.includes(record)) {\n              count++;\n              return false;\n            }\n            return !res.includes(record);\n          });\n          return count;\n        },\n        updateMany({ model, where, update }) {\n          const res = convertWhereClause(where, model);\n          res.forEach((record) => {\n            Object.assign(record, update);\n          });\n          return res[0] || null;\n        }\n      };\n    }\n  });\n  return (options) => {\n    lazyOptions = options;\n    return adapterCreator(options);\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CTnBJd3E0Qy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQStDO0FBQ3dCOztBQUV2RTtBQUNBO0FBQ0EsdUJBQXVCLDREQUFvQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGdCQUFnQixpQ0FBaUM7QUFDakQ7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5REFBTTtBQUNoQixxQ0FBcUMsT0FBTztBQUM1QztBQUNBO0FBQ0EsbUNBQW1DLE9BQU87QUFDMUM7QUFDQTtBQUNBLGtCQUFrQix5QkFBeUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHlCQUF5QixhQUFhO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsMEJBQTBCLGNBQWM7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULDJCQUEyQixxQ0FBcUM7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLDRCQUE0QjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHdCQUF3QixjQUFjO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QseUJBQXlCLHNCQUFzQjtBQUMvQztBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1QseUJBQXlCLGNBQWM7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULDZCQUE2QixjQUFjO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVCxxQkFBcUIsc0JBQXNCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU4QiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQk5wSXdxNEMubWpzP2MxOGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCB7IGMgYXMgY3JlYXRlQWRhcHRlckZhY3RvcnkgfSBmcm9tICcuL2JldHRlci1hdXRoLkVCeEtlVk5aLm1qcyc7XG5cbmNvbnN0IG1lbW9yeUFkYXB0ZXIgPSAoZGIsIGNvbmZpZykgPT4ge1xuICBsZXQgbGF6eU9wdGlvbnMgPSBudWxsO1xuICBsZXQgYWRhcHRlckNyZWF0b3IgPSBjcmVhdGVBZGFwdGVyRmFjdG9yeSh7XG4gICAgY29uZmlnOiB7XG4gICAgICBhZGFwdGVySWQ6IFwibWVtb3J5XCIsXG4gICAgICBhZGFwdGVyTmFtZTogXCJNZW1vcnkgQWRhcHRlclwiLFxuICAgICAgdXNlUGx1cmFsOiBmYWxzZSxcbiAgICAgIGRlYnVnTG9nczogY29uZmlnPy5kZWJ1Z0xvZ3MgfHwgZmFsc2UsXG4gICAgICBjdXN0b21UcmFuc2Zvcm1JbnB1dChwcm9wcykge1xuICAgICAgICBpZiAocHJvcHMub3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkICYmIHByb3BzLmZpZWxkID09PSBcImlkXCIgJiYgcHJvcHMuYWN0aW9uID09PSBcImNyZWF0ZVwiKSB7XG4gICAgICAgICAgcmV0dXJuIGRiW3Byb3BzLm1vZGVsXS5sZW5ndGggKyAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9wcy5kYXRhO1xuICAgICAgfSxcbiAgICAgIHRyYW5zYWN0aW9uOiBhc3luYyAoY2IpID0+IHtcbiAgICAgICAgbGV0IGNsb25lID0gc3RydWN0dXJlZENsb25lKGRiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByID0gYXdhaXQgY2IoYWRhcHRlckNyZWF0b3IobGF6eU9wdGlvbnMpKTtcbiAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBPYmplY3Qua2V5cyhkYikuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBkYltrZXldID0gY2xvbmVba2V5XTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYWRhcHRlcjogKHsgZ2V0RmllbGROYW1lLCBvcHRpb25zLCBkZWJ1Z0xvZyB9KSA9PiB7XG4gICAgICBmdW5jdGlvbiBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKSB7XG4gICAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgICBpZiAoIXRhYmxlKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgYFtNZW1vcnlBZGFwdGVyXSBNb2RlbCAke21vZGVsfSBub3QgZm91bmQgaW4gdGhlIERCYCxcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGRiKVxuICAgICAgICAgICk7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNb2RlbCAke21vZGVsfSBub3QgZm91bmRgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBldmFsQ2xhdXNlID0gKHJlY29yZCwgY2xhdXNlKSA9PiB7XG4gICAgICAgICAgY29uc3QgeyBmaWVsZCwgdmFsdWUsIG9wZXJhdG9yIH0gPSBjbGF1c2U7XG4gICAgICAgICAgc3dpdGNoIChvcGVyYXRvcikge1xuICAgICAgICAgICAgY2FzZSBcImluXCI6XG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBtdXN0IGJlIGFuIGFycmF5XCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5pbmNsdWRlcyhyZWNvcmRbZmllbGRdKTtcbiAgICAgICAgICAgIGNhc2UgXCJub3RfaW5cIjpcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIG11c3QgYmUgYW4gYXJyYXlcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuICF2YWx1ZS5pbmNsdWRlcyhyZWNvcmRbZmllbGRdKTtcbiAgICAgICAgICAgIGNhc2UgXCJjb250YWluc1wiOlxuICAgICAgICAgICAgICByZXR1cm4gcmVjb3JkW2ZpZWxkXS5pbmNsdWRlcyh2YWx1ZSk7XG4gICAgICAgICAgICBjYXNlIFwic3RhcnRzX3dpdGhcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0uc3RhcnRzV2l0aCh2YWx1ZSk7XG4gICAgICAgICAgICBjYXNlIFwiZW5kc193aXRoXCI6XG4gICAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLmVuZHNXaXRoKHZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJuZVwiOlxuICAgICAgICAgICAgICByZXR1cm4gcmVjb3JkW2ZpZWxkXSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBjYXNlIFwiZ3RcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgQm9vbGVhbihyZWNvcmRbZmllbGRdID4gdmFsdWUpO1xuICAgICAgICAgICAgY2FzZSBcImd0ZVwiOlxuICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiBCb29sZWFuKHJlY29yZFtmaWVsZF0gPj0gdmFsdWUpO1xuICAgICAgICAgICAgY2FzZSBcImx0XCI6XG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsICYmIEJvb2xlYW4ocmVjb3JkW2ZpZWxkXSA8IHZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJsdGVcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgQm9vbGVhbihyZWNvcmRbZmllbGRdIDw9IHZhbHVlKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdID09PSB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0YWJsZS5maWx0ZXIoKHJlY29yZCkgPT4ge1xuICAgICAgICAgIGlmICghd2hlcmUubGVuZ3RoIHx8IHdoZXJlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCByZXN1bHQgPSBldmFsQ2xhdXNlKHJlY29yZCwgd2hlcmVbMF0pO1xuICAgICAgICAgIGZvciAoY29uc3QgY2xhdXNlIG9mIHdoZXJlKSB7XG4gICAgICAgICAgICBjb25zdCBjbGF1c2VSZXN1bHQgPSBldmFsQ2xhdXNlKHJlY29yZCwgY2xhdXNlKTtcbiAgICAgICAgICAgIGlmIChjbGF1c2UuY29ubmVjdG9yID09PSBcIk9SXCIpIHtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IHx8IGNsYXVzZVJlc3VsdDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBjbGF1c2VSZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3JlYXRlOiBhc3luYyAoeyBtb2RlbCwgZGF0YSB9KSA9PiB7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCkge1xuICAgICAgICAgICAgZGF0YS5pZCA9IGRiW21vZGVsXS5sZW5ndGggKyAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWRiW21vZGVsXSkge1xuICAgICAgICAgICAgZGJbbW9kZWxdID0gW107XG4gICAgICAgICAgfVxuICAgICAgICAgIGRiW21vZGVsXS5wdXNoKGRhdGEpO1xuICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9LFxuICAgICAgICBmaW5kT25lOiBhc3luYyAoeyBtb2RlbCwgd2hlcmUgfSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICAgIGNvbnN0IHJlY29yZCA9IHJlc1swXSB8fCBudWxsO1xuICAgICAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgICAgIH0sXG4gICAgICAgIGZpbmRNYW55OiBhc3luYyAoeyBtb2RlbCwgd2hlcmUsIHNvcnRCeSwgbGltaXQsIG9mZnNldCB9KSA9PiB7XG4gICAgICAgICAgbGV0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgICAgIGlmICh3aGVyZSkge1xuICAgICAgICAgICAgdGFibGUgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHNvcnRCeSkge1xuICAgICAgICAgICAgdGFibGUgPSB0YWJsZS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiBzb3J0QnkuZmllbGQgfSk7XG4gICAgICAgICAgICAgIGNvbnN0IGFWYWx1ZSA9IGFbZmllbGRdO1xuICAgICAgICAgICAgICBjb25zdCBiVmFsdWUgPSBiW2ZpZWxkXTtcbiAgICAgICAgICAgICAgbGV0IGNvbXBhcmlzb24gPSAwO1xuICAgICAgICAgICAgICBpZiAoYVZhbHVlID09IG51bGwgJiYgYlZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhVmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSAtMTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSAxO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhVmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIGJWYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBhVmFsdWUubG9jYWxlQ29tcGFyZShiVmFsdWUpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFWYWx1ZSBpbnN0YW5jZW9mIERhdGUgJiYgYlZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBhVmFsdWUuZ2V0VGltZSgpIC0gYlZhbHVlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYVZhbHVlID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBiVmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gYVZhbHVlIC0gYlZhbHVlO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhVmFsdWUgPT09IFwiYm9vbGVhblwiICYmIHR5cGVvZiBiVmFsdWUgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IGFWYWx1ZSA9PT0gYlZhbHVlID8gMCA6IGFWYWx1ZSA/IDEgOiAtMTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gU3RyaW5nKGFWYWx1ZSkubG9jYWxlQ29tcGFyZShTdHJpbmcoYlZhbHVlKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRCeS5kaXJlY3Rpb24gPT09IFwiYXNjXCIgPyBjb21wYXJpc29uIDogLWNvbXBhcmlzb247XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9mZnNldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICB0YWJsZSA9IHRhYmxlLnNsaWNlKG9mZnNldCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChsaW1pdCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICB0YWJsZSA9IHRhYmxlLnNsaWNlKDAsIGxpbWl0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRhYmxlIHx8IFtdO1xuICAgICAgICB9LFxuICAgICAgICBjb3VudDogYXN5bmMgKHsgbW9kZWwsIHdoZXJlIH0pID0+IHtcbiAgICAgICAgICBpZiAod2hlcmUpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkUmVjb3JkcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkUmVjb3Jkcy5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkYlttb2RlbF0ubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSwgdXBkYXRlIH0pID0+IHtcbiAgICAgICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgICByZXMuZm9yRWFjaCgocmVjb3JkKSA9PiB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHJlY29yZCwgdXBkYXRlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gcmVzWzBdIHx8IG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlIH0pID0+IHtcbiAgICAgICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgICBkYlttb2RlbF0gPSB0YWJsZS5maWx0ZXIoKHJlY29yZCkgPT4gIXJlcy5pbmNsdWRlcyhyZWNvcmQpKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlTWFueTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlIH0pID0+IHtcbiAgICAgICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgICBsZXQgY291bnQgPSAwO1xuICAgICAgICAgIGRiW21vZGVsXSA9IHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzLmluY2x1ZGVzKHJlY29yZCkpIHtcbiAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICFyZXMuaW5jbHVkZXMocmVjb3JkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZU1hbnkoeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZSB9KSB7XG4gICAgICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgICAgcmVzLmZvckVhY2goKHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihyZWNvcmQsIHVwZGF0ZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHJlc1swXSB8fCBudWxsO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiAob3B0aW9ucykgPT4ge1xuICAgIGxhenlPcHRpb25zID0gb3B0aW9ucztcbiAgICByZXR1cm4gYWRhcHRlckNyZWF0b3Iob3B0aW9ucyk7XG4gIH07XG59O1xuXG5leHBvcnQgeyBtZW1vcnlBZGFwdGVyIGFzIG0gfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BNpIwq4C.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ generateId)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\nconst generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBd0U7O0FBRXhFO0FBQ0EsU0FBUyxzRkFBMkI7QUFDcEM7O0FBRTJCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanM/ZjE3MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcblxuY29uc3QgZ2VuZXJhdGVJZCA9IChzaXplKSA9PiB7XG4gIHJldHVybiBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IoXCJhLXpcIiwgXCJBLVpcIiwgXCIwLTlcIikoc2l6ZSB8fCAzMik7XG59O1xuXG5leHBvcnQgeyBnZW5lcmF0ZUlkIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: () => (/* binding */ changeEmail),\n/* harmony export */   B: () => (/* binding */ sendVerificationEmail),\n/* harmony export */   C: () => (/* binding */ verifyEmail),\n/* harmony export */   D: () => (/* binding */ resetPassword),\n/* harmony export */   E: () => (/* binding */ forgetPassword),\n/* harmony export */   F: () => (/* binding */ signInEmail),\n/* harmony export */   G: () => (/* binding */ signOut),\n/* harmony export */   H: () => (/* binding */ HIDE_METADATA),\n/* harmony export */   I: () => (/* binding */ callbackOAuth),\n/* harmony export */   J: () => (/* binding */ signInSocial),\n/* harmony export */   K: () => (/* binding */ sendVerificationEmailFn),\n/* harmony export */   L: () => (/* binding */ isSimpleRequest),\n/* harmony export */   a: () => (/* binding */ originCheckMiddleware),\n/* harmony export */   b: () => (/* binding */ ok),\n/* harmony export */   c: () => (/* binding */ createEmailVerificationToken),\n/* harmony export */   d: () => (/* binding */ decryptOAuthToken),\n/* harmony export */   e: () => (/* binding */ error),\n/* harmony export */   f: () => (/* binding */ accountInfo),\n/* harmony export */   g: () => (/* binding */ generateState),\n/* harmony export */   h: () => (/* binding */ handleOAuthUserInfo),\n/* harmony export */   i: () => (/* binding */ getAccessToken),\n/* harmony export */   j: () => (/* binding */ unlinkAccount),\n/* harmony export */   k: () => (/* binding */ deleteUserCallback),\n/* harmony export */   l: () => (/* binding */ listUserAccounts),\n/* harmony export */   m: () => (/* binding */ linkSocialAccount),\n/* harmony export */   n: () => (/* binding */ requestPasswordResetCallback),\n/* harmony export */   o: () => (/* binding */ originCheck),\n/* harmony export */   p: () => (/* binding */ parseState),\n/* harmony export */   q: () => (/* binding */ requestPasswordReset),\n/* harmony export */   r: () => (/* binding */ refreshToken),\n/* harmony export */   s: () => (/* binding */ setTokenUtil),\n/* harmony export */   t: () => (/* binding */ toAuthEndpoints),\n/* harmony export */   u: () => (/* binding */ updateUser),\n/* harmony export */   v: () => (/* binding */ forgetPasswordCallback),\n/* harmony export */   w: () => (/* binding */ wildcardMatch),\n/* harmony export */   x: () => (/* binding */ deleteUser),\n/* harmony export */   y: () => (/* binding */ setPassword),\n/* harmony export */   z: () => (/* binding */ changePassword)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.1.12/node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./better-auth.DEBtROF9.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@6.1.0/node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.Cwj9dt6i.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var jose_errors__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! jose/errors */ \"(rsc)/./node_modules/.pnpm/jose@6.1.0/node_modules/jose/dist/webapi/util/errors.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction escapeRegExpChar(char) {\n  if (char === \"-\" || char === \"^\" || char === \"$\" || char === \"+\" || char === \".\" || char === \"(\" || char === \")\" || char === \"|\" || char === \"[\" || char === \"]\" || char === \"{\" || char === \"}\" || char === \"*\" || char === \"?\" || char === \"\\\\\") {\n    return `\\\\${char}`;\n  } else {\n    return char;\n  }\n}\nfunction escapeRegExpString(str) {\n  let result = \"\";\n  for (let i = 0; i < str.length; i++) {\n    result += escapeRegExpChar(str[i]);\n  }\n  return result;\n}\nfunction transform(pattern, separator = true) {\n  if (Array.isArray(pattern)) {\n    let regExpPatterns = pattern.map((p) => `^${transform(p, separator)}$`);\n    return `(?:${regExpPatterns.join(\"|\")})`;\n  }\n  let separatorSplitter = \"\";\n  let separatorMatcher = \"\";\n  let wildcard = \".\";\n  if (separator === true) {\n    separatorSplitter = \"/\";\n    separatorMatcher = \"[/\\\\\\\\]\";\n    wildcard = \"[^/\\\\\\\\]\";\n  } else if (separator) {\n    separatorSplitter = separator;\n    separatorMatcher = escapeRegExpString(separatorSplitter);\n    if (separatorMatcher.length > 1) {\n      separatorMatcher = `(?:${separatorMatcher})`;\n      wildcard = `((?!${separatorMatcher}).)`;\n    } else {\n      wildcard = `[^${separatorMatcher}]`;\n    }\n  }\n  let requiredSeparator = separator ? `${separatorMatcher}+?` : \"\";\n  let optionalSeparator = separator ? `${separatorMatcher}*?` : \"\";\n  let segments = separator ? pattern.split(separatorSplitter) : [pattern];\n  let result = \"\";\n  for (let s = 0; s < segments.length; s++) {\n    let segment = segments[s];\n    let nextSegment = segments[s + 1];\n    let currentSeparator = \"\";\n    if (!segment && s > 0) {\n      continue;\n    }\n    if (separator) {\n      if (s === segments.length - 1) {\n        currentSeparator = optionalSeparator;\n      } else if (nextSegment !== \"**\") {\n        currentSeparator = requiredSeparator;\n      } else {\n        currentSeparator = \"\";\n      }\n    }\n    if (separator && segment === \"**\") {\n      if (currentSeparator) {\n        result += s === 0 ? \"\" : currentSeparator;\n        result += `(?:${wildcard}*?${currentSeparator})*?`;\n      }\n      continue;\n    }\n    for (let c = 0; c < segment.length; c++) {\n      let char = segment[c];\n      if (char === \"\\\\\") {\n        if (c < segment.length - 1) {\n          result += escapeRegExpChar(segment[c + 1]);\n          c++;\n        }\n      } else if (char === \"?\") {\n        result += wildcard;\n      } else if (char === \"*\") {\n        result += `${wildcard}*?`;\n      } else {\n        result += escapeRegExpChar(char);\n      }\n    }\n    result += currentSeparator;\n  }\n  return result;\n}\nfunction isMatch(regexp, sample) {\n  if (typeof sample !== \"string\") {\n    throw new TypeError(`Sample must be a string, but ${typeof sample} given`);\n  }\n  return regexp.test(sample);\n}\nfunction wildcardMatch(pattern, options) {\n  if (typeof pattern !== \"string\" && !Array.isArray(pattern)) {\n    throw new TypeError(\n      `The first argument must be a single pattern string or an array of patterns, but ${typeof pattern} given`\n    );\n  }\n  if (typeof options === \"string\" || typeof options === \"boolean\") {\n    options = { separator: options };\n  }\n  if (arguments.length === 2 && !(typeof options === \"undefined\" || typeof options === \"object\" && options !== null && !Array.isArray(options))) {\n    throw new TypeError(\n      `The second argument must be an options object or a string/boolean separator, but ${typeof options} given`\n    );\n  }\n  options = options || {};\n  if (options.separator === \"\\\\\") {\n    throw new Error(\n      \"\\\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead\"\n    );\n  }\n  let regexpPattern = transform(pattern, options.separator);\n  let regexp = new RegExp(`^${regexpPattern}$`, options.flags);\n  let fn = isMatch.bind(null, regexp);\n  fn.options = options;\n  fn.pattern = pattern;\n  fn.regexp = regexp;\n  return fn;\n}\n\nconst originCheckMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(async (ctx) => {\n  if (ctx.request?.method !== \"POST\" || !ctx.request) {\n    return;\n  }\n  const headers = ctx.request?.headers;\n  const request = ctx.request;\n  const { body, query, context } = ctx;\n  if (isSimpleRequest(headers) && !ctx.context.skipCSRFCheck) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: \"Invalid request\" });\n  }\n  const originHeader = headers?.get(\"origin\") || headers?.get(\"referer\") || \"\";\n  const callbackURL = body?.callbackURL || query?.callbackURL;\n  const redirectURL = body?.redirectTo;\n  const errorCallbackURL = body?.errorCallbackURL;\n  const newUserCallbackURL = body?.newUserCallbackURL;\n  const trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...await context.options.trustedOrigins?.(request) || []\n  ];\n  const useCookies = headers?.has(\"cookie\");\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      if (pattern.includes(\"://\")) {\n        return wildcardMatch(pattern)((0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) || url);\n      }\n      const host = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.b)(url);\n      if (!host) {\n        return false;\n      }\n      return wildcardMatch(pattern)(host);\n    }\n    const protocol = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.c)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(url)\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  if (useCookies && !ctx.context.skipCSRFCheck && !ctx.context.skipOriginCheck) {\n    if (!originHeader || originHeader === \"null\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: \"Missing or null Origin\" });\n    }\n    validateURL(originHeader, \"origin\");\n  }\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n  redirectURL && validateURL(redirectURL, \"redirectURL\");\n  errorCallbackURL && validateURL(errorCallbackURL, \"errorCallbackURL\");\n  newUserCallbackURL && validateURL(newUserCallbackURL, \"newUserCallbackURL\");\n});\nconst originCheck = (getValue) => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(async (ctx) => {\n  if (!ctx.request) {\n    return;\n  }\n  const { context } = ctx;\n  const callbackURL = getValue(ctx);\n  const trustedOrigins = Array.isArray(\n    context.options.trustedOrigins\n  ) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...await context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      if (pattern.includes(\"://\")) {\n        return wildcardMatch(pattern)((0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) || url);\n      }\n      const host = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.b)(url);\n      if (!host) {\n        return false;\n      }\n      return wildcardMatch(pattern)(host);\n    }\n    const protocol = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.c)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_22__.g)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(\n        url\n      )\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  const callbacks = Array.isArray(callbackURL) ? callbackURL : [callbackURL];\n  for (const url of callbacks) {\n    validateURL(url, \"callbackURL\");\n  }\n});\nfunction isSimpleRequest(headers) {\n  const SIMPLE_HEADERS = [\n    \"accept\",\n    \"accept-language\",\n    \"content-language\",\n    \"content-type\"\n  ];\n  const SIMPLE_CONTENT_TYPES = [\n    \"application/x-www-form-urlencoded\",\n    \"multipart/form-data\",\n    \"text/plain\"\n  ];\n  for (const [key, value] of headers.entries()) {\n    if (!SIMPLE_HEADERS.includes(key.toLowerCase())) {\n      return false;\n    }\n    if (key.toLowerCase() === \"content-type\" && !SIMPLE_CONTENT_TYPES.includes(\n      value?.split(\";\")[0]?.trim()?.toLowerCase() || \"\"\n    )) {\n      return false;\n    }\n  }\n  return true;\n}\n\nasync function createEmailVerificationToken(secret, email, updateTo, expiresIn = 3600) {\n  const token = await (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__.signJWT)(\n    {\n      email: email.toLowerCase(),\n      updateTo\n    },\n    secret,\n    expiresIn\n  );\n  return token;\n}\nasync function sendVerificationEmailFn(ctx, user) {\n  if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n    ctx.context.logger.error(\"Verification email isn't enabled.\");\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"Verification email isn't enabled\"\n    });\n  }\n  const token = await createEmailVerificationToken(\n    ctx.context.secret,\n    user.email,\n    void 0,\n    ctx.context.options.emailVerification?.expiresIn\n  );\n  const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n  await ctx.context.options.emailVerification.sendVerificationEmail(\n    {\n      user,\n      url,\n      token\n    },\n    ctx.request\n  );\n}\nconst sendVerificationEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/send-verification-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.email().meta({\n        description: \"The email to send the verification email to\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to use for email verification callback\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a verification email to the user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  email: {\n                    type: \"string\",\n                    description: \"The email to send the verification email to\",\n                    example: \"user@example.com\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\",\n                    example: \"https://example.com/callback\",\n                    nullable: true\n                  }\n                },\n                required: [\"email\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the email was sent successfully\",\n                      example: true\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"400\": {\n            description: \"Bad Request\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\",\n                      description: \"Error message\",\n                      example: \"Verification email isn't enabled\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const { email } = ctx.body;\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (!session) {\n      const user = await ctx.context.internalAdapter.findUserByEmail(email);\n      if (!user) {\n        return ctx.json({\n          status: true\n        });\n      }\n      await sendVerificationEmailFn(ctx, user.user);\n      return ctx.json({\n        status: true\n      });\n    }\n    if (session?.user.emailVerified) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"You can only send a verification email to an unverified email\"\n      });\n    }\n    if (session?.user.email !== email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"You can only send a verification email to your own email\"\n      });\n    }\n    await sendVerificationEmailFn(ctx, session.user);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst verifyEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/verify-email\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to verify the email\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Verify the email of the user\",\n        parameters: [\n          {\n            name: \"token\",\n            in: \"query\",\n            description: \"The token to verify the email\",\n            required: true,\n            schema: {\n              type: \"string\"\n            }\n          },\n          {\n            name: \"callbackURL\",\n            in: \"query\",\n            description: \"The URL to redirect to after email verification\",\n            required: false,\n            schema: {\n              type: \"string\"\n            }\n          }\n        ],\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"User ID\"\n                        },\n                        email: {\n                          type: \"string\",\n                          description: \"User email\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"User name\"\n                        },\n                        image: {\n                          type: \"string\",\n                          description: \"User image URL\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Indicates if the user email is verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          description: \"User creation date\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          description: \"User update date\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"image\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    },\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the email was verified successfully\"\n                    }\n                  },\n                  required: [\"user\", \"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    function redirectOnError(error) {\n      if (ctx.query.callbackURL) {\n        if (ctx.query.callbackURL.includes(\"?\")) {\n          throw ctx.redirect(`${ctx.query.callbackURL}&error=${error}`);\n        }\n        throw ctx.redirect(`${ctx.query.callbackURL}?error=${error}`);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: error\n      });\n    }\n    const { token } = ctx.query;\n    let jwt;\n    try {\n      jwt = await (0,jose__WEBPACK_IMPORTED_MODULE_24__.jwtVerify)(\n        token,\n        new TextEncoder().encode(ctx.context.secret),\n        {\n          algorithms: [\"HS256\"]\n        }\n      );\n    } catch (e) {\n      if (e instanceof jose_errors__WEBPACK_IMPORTED_MODULE_25__.JWTExpired) {\n        return redirectOnError(\"token_expired\");\n      }\n      return redirectOnError(\"invalid_token\");\n    }\n    const schema = zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string().email(),\n      updateTo: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n    });\n    const parsed = schema.parse(jwt.payload);\n    const user = await ctx.context.internalAdapter.findUserByEmail(\n      parsed.email\n    );\n    if (!user) {\n      return redirectOnError(\"user_not_found\");\n    }\n    if (parsed.updateTo) {\n      const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n      if (!session) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      if (session.user.email !== parsed.email) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      const updatedUser2 = await ctx.context.internalAdapter.updateUserByEmail(\n        parsed.email,\n        {\n          email: parsed.updateTo,\n          emailVerified: false\n        },\n        ctx\n      );\n      const newToken = await createEmailVerificationToken(\n        ctx.context.secret,\n        parsed.updateTo\n      );\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: updatedUser2,\n          url: `${ctx.context.baseURL}/verify-email?token=${newToken}&callbackURL=${ctx.query.callbackURL || \"/\"}`,\n          token: newToken\n        },\n        ctx.request\n      );\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n        session: session.session,\n        user: {\n          ...session.user,\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      });\n      if (ctx.query.callbackURL) {\n        throw ctx.redirect(ctx.query.callbackURL);\n      }\n      return ctx.json({\n        status: true,\n        user: {\n          id: updatedUser2.id,\n          email: updatedUser2.email,\n          name: updatedUser2.name,\n          image: updatedUser2.image,\n          emailVerified: updatedUser2.emailVerified,\n          createdAt: updatedUser2.createdAt,\n          updatedAt: updatedUser2.updatedAt\n        }\n      });\n    }\n    if (ctx.context.options.emailVerification?.onEmailVerification) {\n      await ctx.context.options.emailVerification.onEmailVerification(\n        user.user,\n        ctx.request\n      );\n    }\n    const updatedUser = await ctx.context.internalAdapter.updateUserByEmail(\n      parsed.email,\n      {\n        emailVerified: true\n      },\n      ctx\n    );\n    if (ctx.context.options.emailVerification?.afterEmailVerification) {\n      await ctx.context.options.emailVerification.afterEmailVerification(\n        updatedUser,\n        ctx.request\n      );\n    }\n    if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n      const currentSession = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n      if (!currentSession || currentSession.user.email !== parsed.email) {\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx\n        );\n        if (!session) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n            message: \"Failed to create session\"\n          });\n        }\n        await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n          session,\n          user: {\n            ...user.user,\n            emailVerified: true\n          }\n        });\n      } else {\n        await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n          session: currentSession.session,\n          user: {\n            ...currentSession.user,\n            emailVerified: true\n          }\n        });\n      }\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL);\n    }\n    return ctx.json({\n      status: true,\n      user: null\n    });\n  }\n);\n\nconst HIDE_METADATA = {\n  isAction: false\n};\n\nasync function generateState(c, link) {\n  const callbackURL = c.body?.callbackURL || c.context.options.baseURL;\n  if (!callbackURL) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"callbackURL is required\"\n    });\n  }\n  const codeVerifier = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__.g)(128);\n  const state = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__.g)(32);\n  const stateCookie = c.context.createAuthCookie(\"state\", {\n    maxAge: 5 * 60 * 1e3\n    // 5 minutes\n  });\n  await c.setSignedCookie(\n    stateCookie.name,\n    state,\n    c.context.secret,\n    stateCookie.attributes\n  );\n  const data = JSON.stringify({\n    callbackURL,\n    codeVerifier,\n    errorURL: c.body?.errorCallbackURL,\n    newUserURL: c.body?.newUserCallbackURL,\n    link,\n    /**\n     * This is the actual expiry time of the state\n     */\n    expiresAt: Date.now() + 10 * 60 * 1e3,\n    requestSignUp: c.body?.requestSignUp\n  });\n  const expiresAt = /* @__PURE__ */ new Date();\n  expiresAt.setMinutes(expiresAt.getMinutes() + 10);\n  const verification = await c.context.internalAdapter.createVerificationValue(\n    {\n      value: data,\n      identifier: state,\n      expiresAt\n    },\n    c\n  );\n  if (!verification) {\n    c.context.logger.error(\n      \"Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database\"\n    );\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"Unable to create verification\"\n    });\n  }\n  return {\n    state: verification.identifier,\n    codeVerifier\n  };\n}\nasync function parseState(c) {\n  const state = c.query.state || c.body.state;\n  const data = await c.context.internalAdapter.findVerificationValue(state);\n  if (!data) {\n    c.context.logger.error(\"State Mismatch. Verification not found\", {\n      state\n    });\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=please_restart_the_process`);\n  }\n  const parsedData = zod__WEBPACK_IMPORTED_MODULE_23__.object({\n    callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n    codeVerifier: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n    errorURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n    newUserURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n    expiresAt: zod__WEBPACK_IMPORTED_MODULE_23__.number(),\n    link: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_23__.coerce.string()\n    }).optional(),\n    requestSignUp: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().optional()\n  }).parse(JSON.parse(data.value));\n  if (!parsedData.errorURL) {\n    parsedData.errorURL = `${c.context.baseURL}/error`;\n  }\n  const stateCookie = c.context.createAuthCookie(\"state\");\n  const stateCookieValue = await c.getSignedCookie(\n    stateCookie.name,\n    c.context.secret\n  );\n  const skipStateCookieCheck = c.context.oauthConfig?.skipStateCookieCheck;\n  if (!skipStateCookieCheck && (!stateCookieValue || stateCookieValue !== state)) {\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=state_mismatch`);\n  }\n  c.setCookie(stateCookie.name, \"\", {\n    maxAge: 0\n  });\n  if (parsedData.expiresAt < Date.now()) {\n    await c.context.internalAdapter.deleteVerificationValue(data.id);\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=please_restart_the_process`);\n  }\n  await c.context.internalAdapter.deleteVerificationValue(data.id);\n  return parsedData;\n}\n\nfunction decryptOAuthToken(token, ctx) {\n  if (!token) return token;\n  if (ctx.options.account?.encryptOAuthTokens) {\n    return (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__.symmetricDecrypt)({\n      key: ctx.secret,\n      data: token\n    });\n  }\n  return token;\n}\nfunction setTokenUtil(token, ctx) {\n  if (ctx.options.account?.encryptOAuthTokens && token) {\n    return (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__.symmetricEncrypt)({\n      key: ctx.secret,\n      data: token\n    });\n  }\n  return token;\n}\n\nasync function handleOAuthUserInfo(c, {\n  userInfo,\n  account,\n  callbackURL,\n  disableSignUp,\n  overrideUserInfo\n}) {\n  const dbUser = await c.context.internalAdapter.findOAuthUser(\n    userInfo.email.toLowerCase(),\n    account.accountId,\n    account.providerId\n  ).catch((e) => {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.error(\n      \"Better auth was unable to query your database.\\nError: \",\n      e\n    );\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=internal_server_error`);\n  });\n  let user = dbUser?.user;\n  let isRegister = !user;\n  if (dbUser) {\n    const hasBeenLinked = dbUser.accounts.find(\n      (a) => a.providerId === account.providerId && a.accountId === account.accountId\n    );\n    if (!hasBeenLinked) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        account.providerId\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.isDevelopment)()) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.warn(\n            `User already exist but account isn't linked to ${account.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`\n          );\n        }\n        return {\n          error: \"account not linked\",\n          data: null\n        };\n      }\n      try {\n        await c.context.internalAdapter.linkAccount(\n          {\n            providerId: account.providerId,\n            accountId: userInfo.id.toString(),\n            userId: dbUser.user.id,\n            accessToken: await setTokenUtil(account.accessToken, c.context),\n            refreshToken: await setTokenUtil(account.refreshToken, c.context),\n            idToken: account.idToken,\n            accessTokenExpiresAt: account.accessTokenExpiresAt,\n            refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n            scope: account.scope\n          },\n          c\n        );\n      } catch (e) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.error(\"Unable to link account\", e);\n        return {\n          error: \"unable to link account\",\n          data: null\n        };\n      }\n      if (userInfo.emailVerified && !dbUser.user.emailVerified && userInfo.email.toLowerCase() === dbUser.user.email) {\n        await c.context.internalAdapter.updateUser(dbUser.user.id, {\n          emailVerified: true\n        });\n      }\n    } else {\n      if (c.context.options.account?.updateAccountOnSignIn !== false) {\n        const updateData = Object.fromEntries(\n          Object.entries({\n            idToken: account.idToken,\n            accessToken: await setTokenUtil(account.accessToken, c.context),\n            refreshToken: await setTokenUtil(account.refreshToken, c.context),\n            accessTokenExpiresAt: account.accessTokenExpiresAt,\n            refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n            scope: account.scope\n          }).filter(([_, value]) => value !== void 0)\n        );\n        if (Object.keys(updateData).length > 0) {\n          await c.context.internalAdapter.updateAccount(\n            hasBeenLinked.id,\n            updateData,\n            c\n          );\n        }\n      }\n      if (userInfo.emailVerified && !dbUser.user.emailVerified && userInfo.email.toLowerCase() === dbUser.user.email) {\n        await c.context.internalAdapter.updateUser(dbUser.user.id, {\n          emailVerified: true\n        });\n      }\n    }\n    if (overrideUserInfo) {\n      const { id: _, ...restUserInfo } = userInfo;\n      await c.context.internalAdapter.updateUser(dbUser.user.id, {\n        ...restUserInfo,\n        email: userInfo.email.toLowerCase(),\n        emailVerified: userInfo.email.toLowerCase() === dbUser.user.email ? dbUser.user.emailVerified || userInfo.emailVerified : userInfo.emailVerified\n      });\n    }\n  } else {\n    if (disableSignUp) {\n      return {\n        error: \"signup disabled\",\n        data: null,\n        isRegister: false\n      };\n    }\n    try {\n      const { id: _, ...restUserInfo } = userInfo;\n      user = await c.context.internalAdapter.createOAuthUser(\n        {\n          ...restUserInfo,\n          email: userInfo.email.toLowerCase()\n        },\n        {\n          accessToken: await setTokenUtil(account.accessToken, c.context),\n          refreshToken: await setTokenUtil(account.refreshToken, c.context),\n          idToken: account.idToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope,\n          providerId: account.providerId,\n          accountId: userInfo.id.toString()\n        },\n        c\n      ).then((res) => res?.user);\n      if (!userInfo.emailVerified && user && c.context.options.emailVerification?.sendOnSignUp) {\n        const token = await createEmailVerificationToken(\n          c.context.secret,\n          user.email,\n          void 0,\n          c.context.options.emailVerification?.expiresIn\n        );\n        const url = `${c.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n        await c.context.options.emailVerification?.sendVerificationEmail?.(\n          {\n            user,\n            url,\n            token\n          },\n          c.request\n        );\n      }\n    } catch (e) {\n      _better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.logger.error(e);\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError) {\n        return {\n          error: e.message,\n          data: null,\n          isRegister: false\n        };\n      }\n      return {\n        error: \"unable to create user\",\n        data: null,\n        isRegister: false\n      };\n    }\n  }\n  if (!user) {\n    return {\n      error: \"unable to create user\",\n      data: null,\n      isRegister: false\n    };\n  }\n  const session = await c.context.internalAdapter.createSession(user.id, c);\n  if (!session) {\n    return {\n      error: \"unable to create session\",\n      data: null,\n      isRegister: false\n    };\n  }\n  return {\n    data: {\n      session,\n      user\n    },\n    error: null,\n    isRegister\n  };\n}\n\nconst signInSocial = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/sign-in/social\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * Callback URL to redirect to after the user\n       * has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Callback URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * callback url to redirect if the user is newly registered.\n       *\n       * useful if you have different routes for existing users and new users\n       */\n      newUserCallbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n      /**\n       * Callback url to redirect to if an error happens\n       *\n       * If it's initiated from the client sdk this defaults to\n       * the current url.\n       */\n      errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Callback URL to redirect to if an error happens\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_5__.SocialProviderListEnum,\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional(),\n      /**\n       * ID token from the provider\n       *\n       * This is used to sign in the user\n       * if the user is already signed in with the\n       * provider in the frontend.\n       *\n       * Only applicable if the provider supports\n       * it. Currently only `apple` and `google` is\n       * supported out of the box.\n       */\n      idToken: zod__WEBPACK_IMPORTED_MODULE_23__.optional(\n        zod__WEBPACK_IMPORTED_MODULE_23__.object({\n          /**\n           * ID token from the provider\n           */\n          token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"ID token from the provider\"\n          }),\n          /**\n           * The nonce used to generate the token\n           */\n          nonce: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"Nonce used to generate the token\"\n          }).optional(),\n          /**\n           * Access token from the provider\n           */\n          accessToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"Access token from the provider\"\n          }).optional(),\n          /**\n           * Refresh token from the provider\n           */\n          refreshToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n            description: \"Refresh token from the provider\"\n          }).optional(),\n          /**\n           * Expiry date of the token\n           */\n          expiresAt: zod__WEBPACK_IMPORTED_MODULE_23__.number().meta({\n            description: \"Expiry date of the token\"\n          }).optional()\n        })\n      ),\n      scopes: zod__WEBPACK_IMPORTED_MODULE_23__.array(zod__WEBPACK_IMPORTED_MODULE_23__.string()).meta({\n        description: \"Array of scopes to request from the provider. This will override the default scopes passed.\"\n      }).optional(),\n      /**\n       * Explicitly request sign-up\n       *\n       * Should be used to allow sign up when\n       * disableImplicitSignUp for this provider is\n       * true\n       */\n      requestSignUp: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider\"\n      }).optional(),\n      /**\n       * The login hint to use for the authorization code request\n       */\n      loginHint: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The login hint to use for the authorization code request\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with a social provider\",\n        operationId: \"socialSignIn\",\n        responses: {\n          \"200\": {\n            description: \"Success - Returns either session details or redirect URL\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  // todo: we need support for multiple schema\n                  type: \"object\",\n                  description: \"Session response when idToken is provided\",\n                  properties: {\n                    redirect: {\n                      type: \"boolean\",\n                      enum: [false]\n                    },\n                    token: {\n                      type: \"string\",\n                      description: \"Session token\",\n                      url: {\n                        type: \"null\",\n                        nullable: true\n                      },\n                      user: {\n                        type: \"object\",\n                        properties: {\n                          id: { type: \"string\" },\n                          email: { type: \"string\" },\n                          name: {\n                            type: \"string\",\n                            nullable: true\n                          },\n                          image: {\n                            type: \"string\",\n                            nullable: true\n                          },\n                          emailVerified: {\n                            type: \"boolean\"\n                          },\n                          createdAt: {\n                            type: \"string\",\n                            format: \"date-time\"\n                          },\n                          updatedAt: {\n                            type: \"string\",\n                            format: \"date-time\"\n                          }\n                        },\n                        required: [\n                          \"id\",\n                          \"email\",\n                          \"emailVerified\",\n                          \"createdAt\",\n                          \"updatedAt\"\n                        ]\n                      }\n                    }\n                  },\n                  required: [\"redirect\", \"token\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n        });\n      }\n      const userInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!userInfo || !userInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n        });\n      }\n      if (!userInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const data = await handleOAuthUserInfo(c, {\n        userInfo: {\n          ...userInfo.user,\n          email: userInfo.user.email,\n          id: String(userInfo.user.id),\n          name: userInfo.user.name || \"\",\n          image: userInfo.user.image,\n          emailVerified: userInfo.user.emailVerified || false\n        },\n        account: {\n          providerId: provider.id,\n          accountId: String(userInfo.user.id),\n          accessToken: c.body.idToken.accessToken\n        },\n        callbackURL: c.body.callbackURL,\n        disableSignUp: provider.disableImplicitSignUp && !c.body.requestSignUp || provider.disableSignUp\n      });\n      if (data.error) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: data.error\n        });\n      }\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(c, data.data);\n      return c.json({\n        redirect: false,\n        token: data.data.session.token,\n        url: void 0,\n        user: {\n          id: data.data.user.id,\n          email: data.data.user.email,\n          name: data.data.user.name,\n          image: data.data.user.image,\n          emailVerified: data.data.user.emailVerified,\n          createdAt: data.data.user.createdAt,\n          updatedAt: data.data.user.updatedAt\n        }\n      });\n    }\n    const { codeVerifier, state } = await generateState(c);\n    const url = await provider.createAuthorizationURL({\n      state,\n      codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n      scopes: c.body.scopes,\n      loginHint: c.body.loginHint\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nconst signInEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/sign-in/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * Email of the user\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Email of the user\"\n      }),\n      /**\n       * Password of the user\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Password of the user\"\n      }),\n      /**\n       * Callback URL to use as a redirect for email\n       * verification and for possible redirects\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Callback URL to use as a redirect for email verification\"\n      }).optional(),\n      /**\n       * If this is false, the session will not be remembered\n       * @default true\n       */\n      rememberMe: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"If this is false, the session will not be remembered. Default is `true`.\"\n      }).default(true).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with email and password\",\n        responses: {\n          \"200\": {\n            description: \"Success - Returns either session details or redirect URL\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  // todo: we need support for multiple schema\n                  type: \"object\",\n                  description: \"Session response when idToken is provided\",\n                  properties: {\n                    redirect: {\n                      type: \"boolean\",\n                      enum: [false]\n                    },\n                    token: {\n                      type: \"string\",\n                      description: \"Session token\"\n                    },\n                    url: {\n                      type: \"null\",\n                      nullable: true\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: { type: \"string\" },\n                        email: { type: \"string\" },\n                        name: {\n                          type: \"string\",\n                          nullable: true\n                        },\n                        image: {\n                          type: \"string\",\n                          nullable: true\n                        },\n                        emailVerified: {\n                          type: \"boolean\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"redirect\", \"token\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options?.emailAndPassword?.enabled) {\n      ctx.context.logger.error(\n        \"Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password is not enabled\"\n      });\n    }\n    const { email, password } = ctx.body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_23__.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      await ctx.context.password.hash(password);\n      ctx.context.logger.error(\"User not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const credentialAccount = user.accounts.find(\n      (a) => a.providerId === \"credential\"\n    );\n    if (!credentialAccount) {\n      ctx.context.logger.error(\"Credential account not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const currentPassword = credentialAccount?.password;\n    if (!currentPassword) {\n      ctx.context.logger.error(\"Password not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const validPassword = await ctx.context.password.verify({\n      hash: currentPassword,\n      password\n    });\n    if (!validPassword) {\n      ctx.context.logger.error(\"Invalid password\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    if (ctx.context.options?.emailAndPassword?.requireEmailVerification && !user.user.emailVerified) {\n      if (!ctx.context.options?.emailVerification?.sendVerificationEmail) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n        });\n      }\n      if (ctx.context.options?.emailVerification?.sendOnSignIn) {\n        const token = await createEmailVerificationToken(\n          ctx.context.secret,\n          user.user.email,\n          void 0,\n          ctx.context.options.emailVerification?.expiresIn\n        );\n        const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n        await ctx.context.options.emailVerification.sendVerificationEmail(\n          {\n            user: user.user,\n            url,\n            token\n          },\n          ctx.request\n        );\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"FORBIDDEN\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      user.user.id,\n      ctx,\n      ctx.body.rememberMe === false\n    );\n    if (!session) {\n      ctx.context.logger.error(\"Failed to create session\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(\n      ctx,\n      {\n        session,\n        user: user.user\n      },\n      ctx.body.rememberMe === false\n    );\n    return ctx.json({\n      redirect: !!ctx.body.callbackURL,\n      token: session.token,\n      url: ctx.body.callbackURL,\n      user: {\n        id: user.user.id,\n        email: user.user.email,\n        name: user.user.name,\n        image: user.user.image,\n        emailVerified: user.user.emailVerified,\n        createdAt: user.user.createdAt,\n        updatedAt: user.user.updatedAt\n      }\n    });\n  }\n);\n\nconst schema = zod__WEBPACK_IMPORTED_MODULE_23__.object({\n  code: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  error: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  device_id: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  error_description: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  state: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n  user: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n});\nconst callbackOAuth = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/callback/:id\",\n  {\n    method: [\"GET\", \"POST\"],\n    body: schema.optional(),\n    query: schema.optional(),\n    metadata: HIDE_METADATA\n  },\n  async (c) => {\n    let queryOrBody;\n    const defaultErrorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    try {\n      if (c.method === \"GET\") {\n        queryOrBody = schema.parse(c.query);\n      } else if (c.method === \"POST\") {\n        queryOrBody = schema.parse(c.body);\n      } else {\n        throw new Error(\"Unsupported method\");\n      }\n    } catch (e) {\n      c.context.logger.error(\"INVALID_CALLBACK_REQUEST\", e);\n      throw c.redirect(`${defaultErrorURL}?error=invalid_callback_request`);\n    }\n    const { code, error, state, error_description, device_id } = queryOrBody;\n    if (!state) {\n      c.context.logger.error(\"State not found\", error);\n      const sep = defaultErrorURL.includes(\"?\") ? \"&\" : \"?\";\n      const url = `${defaultErrorURL}${sep}state=state_not_found`;\n      throw c.redirect(url);\n    }\n    const {\n      codeVerifier,\n      callbackURL,\n      link,\n      errorURL,\n      newUserURL,\n      requestSignUp\n    } = await parseState(c);\n    function redirectOnError(error2, description) {\n      const baseURL = errorURL ?? defaultErrorURL;\n      const params = new URLSearchParams({ error: error2 });\n      if (description) params.set(\"error_description\", description);\n      const sep = baseURL.includes(\"?\") ? \"&\" : \"?\";\n      const url = `${baseURL}${sep}${params.toString()}`;\n      throw c.redirect(url);\n    }\n    if (error) {\n      redirectOnError(error, error_description);\n    }\n    if (!code) {\n      c.context.logger.error(\"Code not found\");\n      throw redirectOnError(\"no_code\");\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.params.id\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Oauth provider with id\",\n        c.params.id,\n        \"not found\"\n      );\n      throw redirectOnError(\"oauth_provider_not_found\");\n    }\n    let tokens;\n    try {\n      tokens = await provider.validateAuthorizationCode({\n        code,\n        codeVerifier,\n        deviceId: device_id,\n        redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n      });\n    } catch (e) {\n      c.context.logger.error(\"\", e);\n      throw redirectOnError(\"invalid_code\");\n    }\n    const userInfo = await provider.getUserInfo({\n      ...tokens,\n      user: c.body?.user ? (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_6__.s)(c.body.user) : void 0\n    }).then((res) => res?.user);\n    if (!userInfo) {\n      c.context.logger.error(\"Unable to get user info\");\n      return redirectOnError(\"unable_to_get_user_info\");\n    }\n    if (!callbackURL) {\n      c.context.logger.error(\"No callback URL found\");\n      throw redirectOnError(\"no_callback_url\");\n    }\n    if (link) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        provider.id\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        c.context.logger.error(\"Unable to link account - untrusted provider\");\n        return redirectOnError(\"unable_to_link_account\");\n      }\n      if (userInfo.email !== link.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) {\n        return redirectOnError(\"email_doesn't_match\");\n      }\n      const existingAccount = await c.context.internalAdapter.findAccount(\n        String(userInfo.id)\n      );\n      if (existingAccount) {\n        if (existingAccount.userId.toString() !== link.userId.toString()) {\n          return redirectOnError(\"account_already_linked_to_different_user\");\n        }\n        const updateData = Object.fromEntries(\n          Object.entries({\n            accessToken: await setTokenUtil(tokens.accessToken, c.context),\n            refreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n            idToken: tokens.idToken,\n            accessTokenExpiresAt: tokens.accessTokenExpiresAt,\n            refreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n            scope: tokens.scopes?.join(\",\")\n          }).filter(([_, value]) => value !== void 0)\n        );\n        await c.context.internalAdapter.updateAccount(\n          existingAccount.id,\n          updateData\n        );\n      } else {\n        const newAccount = await c.context.internalAdapter.createAccount(\n          {\n            userId: link.userId,\n            providerId: provider.id,\n            accountId: String(userInfo.id),\n            ...tokens,\n            accessToken: await setTokenUtil(tokens.accessToken, c.context),\n            refreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n            scope: tokens.scopes?.join(\",\")\n          },\n          c\n        );\n        if (!newAccount) {\n          return redirectOnError(\"unable_to_link_account\");\n        }\n      }\n      let toRedirectTo2;\n      try {\n        const url = callbackURL;\n        toRedirectTo2 = url.toString();\n      } catch {\n        toRedirectTo2 = callbackURL;\n      }\n      throw c.redirect(toRedirectTo2);\n    }\n    if (!userInfo.email) {\n      c.context.logger.error(\n        \"Provider did not return email. This could be due to misconfiguration in the provider settings.\"\n      );\n      return redirectOnError(\"email_not_found\");\n    }\n    const result = await handleOAuthUserInfo(c, {\n      userInfo: {\n        ...userInfo,\n        id: String(userInfo.id),\n        email: userInfo.email,\n        name: userInfo.name || userInfo.email\n      },\n      account: {\n        providerId: provider.id,\n        accountId: String(userInfo.id),\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      },\n      callbackURL,\n      disableSignUp: provider.disableImplicitSignUp && !requestSignUp || provider.options?.disableSignUp,\n      overrideUserInfo: provider.options?.overrideUserInfoOnSignIn\n    });\n    if (result.error) {\n      c.context.logger.error(result.error.split(\" \").join(\"_\"));\n      return redirectOnError(result.error.split(\" \").join(\"_\"));\n    }\n    const { session, user } = result.data;\n    await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(c, {\n      session,\n      user\n    });\n    let toRedirectTo;\n    try {\n      const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n      toRedirectTo = url.toString();\n    } catch {\n      toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n    }\n    throw c.redirect(toRedirectTo);\n  }\n);\n\nconst signOut = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/sign-out\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Sign out the current user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessionCookieToken = await ctx.getSignedCookie(\n      ctx.context.authCookies.sessionToken.name,\n      ctx.context.secret\n    );\n    if (!sessionCookieToken) {\n      (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n    await ctx.context.internalAdapter.deleteSession(sessionCookieToken);\n    (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n    return ctx.json({\n      success: true\n    });\n  }\n);\n\nfunction redirectError(ctx, callbackURL, query) {\n  const url = callbackURL ? new URL(callbackURL, ctx.baseURL) : new URL(`${ctx.baseURL}/error`);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nfunction redirectCallback(ctx, callbackURL, query) {\n  const url = new URL(callbackURL, ctx.baseURL);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nconst requestPasswordReset = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/request-password-reset\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.email().meta({\n        description: \"The email address of the user to send a password reset email to\"\n      }),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    },\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json({\n        status: true,\n        message: \"If this email exists in our system, check your email for the reset link\"\n      });\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_8__.g)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_9__.g)(24);\n    await ctx.context.internalAdapter.createVerificationValue(\n      {\n        value: user.user.id,\n        identifier: `reset-password:${verificationToken}`,\n        expiresAt\n      },\n      ctx\n    );\n    const callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true,\n      message: \"If this email exists in our system, check your email for the reset link\"\n    });\n  }\n);\nconst forgetPassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/forget-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_23__.string().email().meta({\n        description: \"The email address of the user to send a password reset email to\"\n      }),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    },\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json({\n        status: true,\n        message: \"If this email exists in our system, check your email for the reset link\"\n      });\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_8__.g)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_9__.g)(24);\n    await ctx.context.internalAdapter.createVerificationValue(\n      {\n        value: user.user.id,\n        identifier: `reset-password:${verificationToken}`,\n        expiresAt\n      },\n      ctx\n    );\n    const callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst requestPasswordResetCallback = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/reset-password/:token\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect the user to reset their password\"\n      })\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Redirects the user to the callback URL with the token\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { token } = ctx.params;\n    const { callbackURL } = ctx.query;\n    if (!token || !callbackURL) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    const verification = await ctx.context.internalAdapter.findVerificationValue(\n      `reset-password:${token}`\n    );\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    throw ctx.redirect(redirectCallback(ctx.context, callbackURL, { token }));\n  }\n);\nconst forgetPasswordCallback = requestPasswordResetCallback;\nconst resetPassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/reset-password\",\n  {\n    method: \"POST\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n    }).optional(),\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The new password to set\"\n      }),\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to reset the password\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Reset the password for a user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token || ctx.query?.token;\n    if (!token) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const { newPassword } = ctx.body;\n    const minLength = ctx.context.password?.config.minPasswordLength;\n    const maxLength = ctx.context.password?.config.maxPasswordLength;\n    if (newPassword.length < minLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    if (newPassword.length > maxLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const id = `reset-password:${token}`;\n    const verification = await ctx.context.internalAdapter.findVerificationValue(id);\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const userId = verification.value;\n    const hashedPassword = await ctx.context.password.hash(newPassword);\n    const accounts = await ctx.context.internalAdapter.findAccounts(userId);\n    const account = accounts.find((ac) => ac.providerId === \"credential\");\n    if (!account) {\n      await ctx.context.internalAdapter.createAccount(\n        {\n          userId,\n          providerId: \"credential\",\n          password: hashedPassword,\n          accountId: userId\n        },\n        ctx\n      );\n    } else {\n      await ctx.context.internalAdapter.updatePassword(\n        userId,\n        hashedPassword,\n        ctx\n      );\n    }\n    await ctx.context.internalAdapter.deleteVerificationValue(verification.id);\n    if (ctx.context.options.emailAndPassword?.onPasswordReset) {\n      const user = await ctx.context.internalAdapter.findUserById(userId);\n      if (user) {\n        await ctx.context.options.emailAndPassword.onPasswordReset(\n          {\n            user\n          },\n          ctx.request\n        );\n      }\n    }\n    if (ctx.context.options.emailAndPassword?.revokeSessionsOnPasswordReset) {\n      await ctx.context.internalAdapter.deleteSessions(userId);\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\nconst updateUser = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/update-user\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.record(\n      zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"Field name must be a string\"\n      }),\n      zod__WEBPACK_IMPORTED_MODULE_23__.any()\n    ),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Update the current user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The image of the user\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the update was successful\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const body = ctx.body;\n    if (body.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.EMAIL_CAN_NOT_BE_UPDATED\n      });\n    }\n    const { name, image, ...rest } = body;\n    const session = ctx.context.session;\n    const additionalFields = (0,_better_auth_Cwj9dt6i_mjs__WEBPACK_IMPORTED_MODULE_14__.d)(\n      ctx.context.options,\n      rest,\n      \"update\"\n    );\n    if (image === void 0 && name === void 0 && Object.keys(additionalFields).length === 0) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"No fields to update\"\n      });\n    }\n    const user = await ctx.context.internalAdapter.updateUser(\n      session.user.id,\n      {\n        name,\n        image,\n        ...additionalFields\n      },\n      ctx\n    );\n    await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n      session: session.session,\n      user\n    });\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst changePassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/change-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The new password to set\"\n      }),\n      /**\n       * The current password of the user\n       */\n      currentPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The current password is required\"\n      }),\n      /**\n       * revoke all sessions that are not the\n       * current one logged in by the user\n       */\n      revokeOtherSessions: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Must be a boolean value\"\n      }).optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e],\n    metadata: {\n      openapi: {\n        description: \"Change the password of the user\",\n        responses: {\n          \"200\": {\n            description: \"Password successfully changed\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\",\n                      nullable: true,\n                      // Only present if revokeOtherSessions is true\n                      description: \"New session token if other sessions were revoked\"\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"The unique identifier of the user\"\n                        },\n                        email: {\n                          type: \"string\",\n                          format: \"email\",\n                          description: \"The email address of the user\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"The name of the user\"\n                        },\n                        image: {\n                          type: \"string\",\n                          format: \"uri\",\n                          nullable: true,\n                          description: \"The profile image URL of the user\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Whether the email has been verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was created\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was last updated\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { newPassword, currentPassword, revokeOtherSessions } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    if (!account || !account.password) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n      });\n    }\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    const verify = await ctx.context.password.verify({\n      hash: account.password,\n      password: currentPassword\n    });\n    if (!verify) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_PASSWORD\n      });\n    }\n    await ctx.context.internalAdapter.updateAccount(account.id, {\n      password: passwordHash\n    });\n    let token = null;\n    if (revokeOtherSessions) {\n      await ctx.context.internalAdapter.deleteSessions(session.user.id);\n      const newSession = await ctx.context.internalAdapter.createSession(\n        session.user.id,\n        ctx\n      );\n      if (!newSession) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n        });\n      }\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n        session: newSession,\n        user: session.user\n      });\n      token = newSession.token;\n    }\n    return ctx.json({\n      token,\n      user: {\n        id: session.user.id,\n        email: session.user.email,\n        name: session.user.name,\n        image: session.user.image,\n        emailVerified: session.user.emailVerified,\n        createdAt: session.user.createdAt,\n        updatedAt: session.user.updatedAt\n      }\n    });\n  }\n);\nconst setPassword = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/set-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The new password to set is required\"\n      })\n    }),\n    metadata: {\n      SERVER_ONLY: true\n    },\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e]\n  },\n  async (ctx) => {\n    const { newPassword } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    if (!account) {\n      await ctx.context.internalAdapter.linkAccount(\n        {\n          userId: session.user.id,\n          providerId: \"credential\",\n          accountId: session.user.id,\n          password: passwordHash\n        },\n        ctx\n      );\n      return ctx.json({\n        status: true\n      });\n    }\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"user already has a password\"\n    });\n  }\n);\nconst deleteUser = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/delete-user\",\n  {\n    method: \"POST\",\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e],\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * The callback URL to redirect to after the user is deleted\n       * this is only used on delete user callback\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The callback URL to redirect to after the user is deleted\"\n      }).optional(),\n      /**\n       * The password of the user. If the password isn't provided, session freshness\n       * will be checked.\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The password of the user is required to delete the user\"\n      }).optional(),\n      /**\n       * The token to delete the user. If the token is provided, the user will be deleted\n       */\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to delete the user is required\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Delete the user\",\n        responses: {\n          \"200\": {\n            description: \"User deletion processed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\",\n                      description: \"Indicates if the operation was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"User deleted\", \"Verification email sent\"],\n                      description: \"Status message of the deletion process\"\n                    }\n                  },\n                  required: [\"success\", \"message\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\");\n    }\n    const session = ctx.context.session;\n    if (ctx.body.password) {\n      const accounts = await ctx.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const account = accounts.find(\n        (account2) => account2.providerId === \"credential\" && account2.password\n      );\n      if (!account || !account.password) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n        });\n      }\n      const verify = await ctx.context.password.verify({\n        hash: account.password,\n        password: ctx.body.password\n      });\n      if (!verify) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_PASSWORD\n        });\n      }\n    }\n    if (ctx.body.token) {\n      await deleteUserCallback({\n        ...ctx,\n        query: {\n          token: ctx.body.token\n        }\n      });\n      return ctx.json({\n        success: true,\n        message: \"User deleted\"\n      });\n    }\n    if (ctx.context.options.user.deleteUser?.sendDeleteAccountVerification) {\n      const token = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__.g)(32, \"0-9\", \"a-z\");\n      await ctx.context.internalAdapter.createVerificationValue(\n        {\n          value: session.user.id,\n          identifier: `delete-account-${token}`,\n          expiresAt: new Date(\n            Date.now() + (ctx.context.options.user.deleteUser?.deleteTokenExpiresIn || 60 * 60 * 24) * 1e3\n          )\n        },\n        ctx\n      );\n      const url = `${ctx.context.baseURL}/delete-user/callback?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.user.deleteUser.sendDeleteAccountVerification(\n        {\n          user: session.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      return ctx.json({\n        success: true,\n        message: \"Verification email sent\"\n      });\n    }\n    if (!ctx.body.password && ctx.context.sessionConfig.freshAge !== 0) {\n      const currentAge = new Date(session.session.createdAt).getTime();\n      const freshAge = ctx.context.sessionConfig.freshAge * 1e3;\n      const now = Date.now();\n      if (now - currentAge > freshAge * 1e3) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.SESSION_EXPIRED\n        });\n      }\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nconst deleteUserCallback = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/delete-user/callback\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The token to verify the deletion request\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after deletion\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Callback to complete user deletion with verification token\",\n        responses: {\n          \"200\": {\n            description: \"User successfully deleted\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\",\n                      description: \"Indicates if the deletion was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"User deleted\"],\n                      description: \"Confirmation message\"\n                    }\n                  },\n                  required: [\"success\", \"message\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\");\n    }\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n      });\n    }\n    const token = await ctx.context.internalAdapter.findVerificationValue(\n      `delete-account-${ctx.query.token}`\n    );\n    if (!token || token.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    if (token.value !== session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n    (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.d)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL || \"/\");\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nconst changeEmail = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/change-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      newEmail: zod__WEBPACK_IMPORTED_MODULE_23__.email().meta({\n        description: \"The new email address to set must be a valid email address\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.e],\n    metadata: {\n      openapi: {\n        responses: {\n          \"200\": {\n            description: \"Email change request processed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the request was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"Email updated\", \"Verification email sent\"],\n                      description: \"Status message of the email change process\",\n                      nullable: true\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          },\n          \"422\": {\n            description: \"Unprocessable Entity. Email already exists\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.changeEmail?.enabled) {\n      ctx.context.logger.error(\"Change email is disabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Change email is disabled\"\n      });\n    }\n    const newEmail = ctx.body.newEmail.toLowerCase();\n    if (newEmail === ctx.context.session.user.email) {\n      ctx.context.logger.error(\"Email is the same\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Email is the same\"\n      });\n    }\n    const existingUser = await ctx.context.internalAdapter.findUserByEmail(newEmail);\n    if (existingUser) {\n      ctx.context.logger.error(\"Email already exists\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Couldn't update your email\"\n      });\n    }\n    if (ctx.context.session.user.emailVerified !== true) {\n      const existing = await ctx.context.internalAdapter.findUserByEmail(newEmail);\n      if (existing) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNPROCESSABLE_ENTITY\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL\n        });\n      }\n      await ctx.context.internalAdapter.updateUserByEmail(\n        ctx.context.session.user.email,\n        {\n          email: newEmail\n        },\n        ctx\n      );\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(ctx, {\n        session: ctx.context.session.session,\n        user: {\n          ...ctx.context.session.user,\n          email: newEmail\n        }\n      });\n      if (ctx.context.options.emailVerification?.sendVerificationEmail) {\n        const token2 = await createEmailVerificationToken(\n          ctx.context.secret,\n          newEmail,\n          void 0,\n          ctx.context.options.emailVerification?.expiresIn\n        );\n        const url2 = `${ctx.context.baseURL}/verify-email?token=${token2}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n        await ctx.context.options.emailVerification.sendVerificationEmail(\n          {\n            user: {\n              ...ctx.context.session.user,\n              email: newEmail\n            },\n            url: url2,\n            token: token2\n          },\n          ctx.request\n        );\n      }\n      return ctx.json({\n        status: true\n      });\n    }\n    if (!ctx.context.options.user.changeEmail.sendChangeEmailVerification) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const token = await createEmailVerificationToken(\n      ctx.context.secret,\n      ctx.context.session.user.email,\n      newEmail,\n      ctx.context.options.emailVerification?.expiresIn\n    );\n    const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n    await ctx.context.options.user.changeEmail.sendChangeEmailVerification(\n      {\n        user: ctx.context.session.user,\n        newEmail,\n        url,\n        token\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\nfunction sanitize(input) {\n  return input.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\");\n}\nconst html = (errorCode = \"Unknown\") => `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Authentication Error</title>\n    <style>\n        :root {\n            --bg-color: #f8f9fa;\n            --text-color: #212529;\n            --accent-color: #000000;\n            --error-color: #dc3545;\n            --border-color: #e9ecef;\n        }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            line-height: 1.5;\n        }\n        .error-container {\n            background-color: #ffffff;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n            padding: 2.5rem;\n            text-align: center;\n            max-width: 90%;\n            width: 400px;\n        }\n        h1 {\n            color: var(--error-color);\n            font-size: 1.75rem;\n            margin-bottom: 1rem;\n            font-weight: 600;\n        }\n        p {\n            margin-bottom: 1.5rem;\n            color: #495057;\n        }\n        .btn {\n            background-color: var(--accent-color);\n            color: #ffffff;\n            text-decoration: none;\n            padding: 0.75rem 1.5rem;\n            border-radius: 6px;\n            transition: all 0.3s ease;\n            display: inline-block;\n            font-weight: 500;\n            border: 2px solid var(--accent-color);\n        }\n        .btn:hover {\n            background-color: #131721;\n        }\n        .error-code {\n            font-size: 0.875rem;\n            color: #6c757d;\n            margin-top: 1.5rem;\n            padding-top: 1.5rem;\n            border-top: 1px solid var(--border-color);\n        }\n        .icon {\n            font-size: 3rem;\n            margin-bottom: 1rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"error-container\">\n        <div class=\"icon\">\\u26A0\\uFE0F</div>\n        <h1>Better Auth Error</h1>\n        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>\n        <a href=\"/\" id=\"returnLink\" class=\"btn\">Return to Application</a>\n        <div class=\"error-code\">Error Code: <span id=\"errorCode\">${sanitize(\n  errorCode\n)}</span></div>\n    </div>\n</body>\n</html>`;\nconst error = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/error\",\n  {\n    method: \"GET\",\n    metadata: {\n      ...HIDE_METADATA,\n      openapi: {\n        description: \"Displays an error page\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"text/html\": {\n                schema: {\n                  type: \"string\",\n                  description: \"The HTML content of the error page\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const query = new URL(c.request?.url || \"\").searchParams.get(\"error\") || \"Unknown\";\n    return new Response(html(query), {\n      headers: {\n        \"Content-Type\": \"text/html\"\n      }\n    });\n  }\n);\n\nconst ok = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/ok\",\n  {\n    method: \"GET\",\n    metadata: {\n      ...HIDE_METADATA,\n      openapi: {\n        description: \"Check if the API is working\",\n        responses: {\n          \"200\": {\n            description: \"API is working\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    ok: {\n                      type: \"boolean\",\n                      description: \"Indicates if the API is working\"\n                    }\n                  },\n                  required: [\"ok\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    return ctx.json({\n      ok: true\n    });\n  }\n);\n\nconst listUserAccounts = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/list-accounts\",\n  {\n    method: \"GET\",\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      openapi: {\n        description: \"List all accounts linked to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      id: {\n                        type: \"string\"\n                      },\n                      providerId: {\n                        type: \"string\"\n                      },\n                      createdAt: {\n                        type: \"string\",\n                        format: \"date-time\"\n                      },\n                      updatedAt: {\n                        type: \"string\",\n                        format: \"date-time\"\n                      },\n                      accountId: {\n                        type: \"string\"\n                      },\n                      scopes: {\n                        type: \"array\",\n                        items: {\n                          type: \"string\"\n                        }\n                      }\n                    },\n                    required: [\n                      \"id\",\n                      \"providerId\",\n                      \"createdAt\",\n                      \"updatedAt\",\n                      \"accountId\",\n                      \"scopes\"\n                    ]\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const accounts = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    return c.json(\n      accounts.map((a) => ({\n        id: a.id,\n        providerId: a.providerId,\n        createdAt: a.createdAt,\n        updatedAt: a.updatedAt,\n        accountId: a.accountId,\n        scopes: a.scope?.split(\",\") || []\n      }))\n    );\n  }\n);\nconst linkSocialAccount = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/link-social\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      /**\n       * Callback URL to redirect to after the user has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use\n       */\n      provider: _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_5__.SocialProviderListEnum,\n      /**\n       * ID Token for direct authentication without redirect\n       */\n      idToken: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n        token: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n        nonce: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n        accessToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n        refreshToken: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional(),\n        scopes: zod__WEBPACK_IMPORTED_MODULE_23__.array(zod__WEBPACK_IMPORTED_MODULE_23__.string()).optional()\n      }).optional(),\n      /**\n       * Whether to allow sign up for new users\n       */\n      requestSignUp: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().optional(),\n      /**\n       * Additional scopes to request when linking the account.\n       * This is useful for requesting additional permissions when\n       * linking a social account compared to the initial authentication.\n       */\n      scopes: zod__WEBPACK_IMPORTED_MODULE_23__.array(zod__WEBPACK_IMPORTED_MODULE_23__.string()).meta({\n        description: \"Additional scopes to request from the provider\"\n      }).optional(),\n      /**\n       * The URL to redirect to if there is an error during the link process.\n       */\n      errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The URL to redirect to if there is an error during the link process\"\n      }).optional(),\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod__WEBPACK_IMPORTED_MODULE_23__.boolean().meta({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      openapi: {\n        description: \"Link a social account to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    url: {\n                      type: \"string\",\n                      description: \"The authorization URL to redirect the user to\"\n                    },\n                    redirect: {\n                      type: \"boolean\",\n                      description: \"Indicates if the user should be redirected to the authorization URL\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"NOT_FOUND\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.INVALID_TOKEN\n        });\n      }\n      const linkingUserInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!linkingUserInfo || !linkingUserInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n        });\n      }\n      const linkingUserId = String(linkingUserInfo.user.id);\n      if (!linkingUserInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const existingAccounts = await c.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const hasBeenLinked = existingAccounts.find(\n        (a) => a.providerId === provider.id && a.accountId === linkingUserId\n      );\n      if (hasBeenLinked) {\n        return c.json({\n          url: \"\",\n          // this is for type inference\n          status: true,\n          redirect: false\n        });\n      }\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(provider.id);\n      if (!isTrustedProvider && !linkingUserInfo.user.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: \"Account not linked - linking not allowed\"\n        });\n      }\n      if (linkingUserInfo.user.email !== session.user.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"UNAUTHORIZED\", {\n          message: \"Account not linked - different emails not allowed\"\n        });\n      }\n      try {\n        await c.context.internalAdapter.createAccount(\n          {\n            userId: session.user.id,\n            providerId: provider.id,\n            accountId: linkingUserId,\n            accessToken: c.body.idToken.accessToken,\n            idToken: token,\n            refreshToken: c.body.idToken.refreshToken,\n            scope: c.body.idToken.scopes?.join(\",\")\n          },\n          c\n        );\n      } catch (e) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"EXPECTATION_FAILED\", {\n          message: \"Account not linked - unable to create account\"\n        });\n      }\n      if (c.context.options.account?.accountLinking?.updateUserInfoOnLink === true) {\n        try {\n          await c.context.internalAdapter.updateUser(session.user.id, {\n            name: linkingUserInfo.user?.name,\n            image: linkingUserInfo.user?.image\n          });\n        } catch (e) {\n          console.warn(\"Could not update user - \" + e.toString());\n        }\n      }\n      return c.json({\n        url: \"\",\n        // this is for type inference\n        status: true,\n        redirect: false\n      });\n    }\n    const state = await generateState(c, {\n      userId: session.user.id,\n      email: session.user.email\n    });\n    const url = await provider.createAuthorizationURL({\n      state: state.state,\n      codeVerifier: state.codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n      scopes: c.body.scopes\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nconst unlinkAccount = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/unlink-account\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_23__.string(),\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().optional()\n    }),\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.f],\n    metadata: {\n      openapi: {\n        description: \"Unlink an account\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId } = ctx.body;\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      ctx.context.session.user.id\n    );\n    if (accounts.length === 1 && !ctx.context.options.account?.accountLinking?.allowUnlinkingAll) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.FAILED_TO_UNLINK_LAST_ACCOUNT\n      });\n    }\n    const accountExist = accounts.find(\n      (account) => accountId ? account.accountId === accountId && account.providerId === providerId : account.providerId === providerId\n    );\n    if (!accountExist) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_4__.BASE_ERROR_CODES.ACCOUNT_NOT_FOUND\n      });\n    }\n    await ctx.context.internalAdapter.deleteAccount(accountExist.id);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst getAccessToken = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/get-access-token\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The provider ID for the OAuth provider\"\n      }),\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The account ID associated with the refresh token\"\n      }).optional(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The user ID associated with the account\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Get a valid access token, doing a refresh if needed\",\n        responses: {\n          200: {\n            description: \"A Valid access token\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    tokenType: {\n                      type: \"string\"\n                    },\n                    idToken: {\n                      type: \"string\"\n                    },\n                    accessToken: {\n                      type: \"string\"\n                    },\n                    refreshToken: {\n                      type: \"string\"\n                    },\n                    accessTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    },\n                    refreshTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          400: {\n            description: \"Invalid refresh token or provider configuration\"\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId, userId } = ctx.body;\n    const req = ctx.request;\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (req && !session) {\n      throw ctx.error(\"UNAUTHORIZED\");\n    }\n    let resolvedUserId = session?.user?.id || userId;\n    if (!resolvedUserId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Either userId or session is required`\n      });\n    }\n    if (!ctx.context.socialProviders.find((p) => p.id === providerId)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} is not supported.`\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(resolvedUserId);\n    const account = accounts.find(\n      (acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId\n    );\n    if (!account) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} not found.`\n      });\n    }\n    try {\n      let newTokens = null;\n      const accessTokenExpired = account.accessTokenExpiresAt && new Date(account.accessTokenExpiresAt).getTime() - Date.now() < 5e3;\n      if (account.refreshToken && accessTokenExpired && provider.refreshAccessToken) {\n        newTokens = await provider.refreshAccessToken(\n          account.refreshToken\n        );\n        await ctx.context.internalAdapter.updateAccount(account.id, {\n          accessToken: await setTokenUtil(newTokens.accessToken, ctx.context),\n          accessTokenExpiresAt: newTokens.accessTokenExpiresAt,\n          refreshToken: await setTokenUtil(newTokens.refreshToken, ctx.context),\n          refreshTokenExpiresAt: newTokens.refreshTokenExpiresAt\n        });\n      }\n      const tokens = {\n        accessToken: await decryptOAuthToken(\n          newTokens?.accessToken ?? account.accessToken ?? \"\",\n          ctx.context\n        ),\n        accessTokenExpiresAt: newTokens?.accessTokenExpiresAt ?? account.accessTokenExpiresAt ?? void 0,\n        scopes: account.scope?.split(\",\") ?? [],\n        idToken: newTokens?.idToken ?? account.idToken ?? void 0\n      };\n      return ctx.json(tokens);\n    } catch (error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Failed to get a valid access token\",\n        cause: error\n      });\n    }\n  }\n);\nconst refreshToken = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/refresh-token\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The provider ID for the OAuth provider\"\n      }),\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The account ID associated with the refresh token\"\n      }).optional(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The user ID associated with the account\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Refresh the access token using a refresh token\",\n        responses: {\n          200: {\n            description: \"Access token refreshed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    tokenType: {\n                      type: \"string\"\n                    },\n                    idToken: {\n                      type: \"string\"\n                    },\n                    accessToken: {\n                      type: \"string\"\n                    },\n                    refreshToken: {\n                      type: \"string\"\n                    },\n                    accessTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    },\n                    refreshTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          400: {\n            description: \"Invalid refresh token or provider configuration\"\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId, userId } = ctx.body;\n    const req = ctx.request;\n    const session = await (0,_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(ctx);\n    if (req && !session) {\n      throw ctx.error(\"UNAUTHORIZED\");\n    }\n    let resolvedUserId = session?.user?.id || userId;\n    if (!resolvedUserId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Either userId or session is required`\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(resolvedUserId);\n    const account = accounts.find(\n      (acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId\n    );\n    if (!account) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} not found.`\n      });\n    }\n    if (!provider.refreshAccessToken) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} does not support token refreshing.`\n      });\n    }\n    try {\n      const tokens = await provider.refreshAccessToken(\n        account.refreshToken\n      );\n      await ctx.context.internalAdapter.updateAccount(account.id, {\n        accessToken: await setTokenUtil(tokens.accessToken, ctx.context),\n        refreshToken: await setTokenUtil(tokens.refreshToken, ctx.context),\n        accessTokenExpiresAt: tokens.accessTokenExpiresAt,\n        refreshTokenExpiresAt: tokens.refreshTokenExpiresAt\n      });\n      return ctx.json(tokens);\n    } catch (error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Failed to refresh access token\",\n        cause: error\n      });\n    }\n  }\n);\nconst accountInfo = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n  \"/account-info\",\n  {\n    method: \"POST\",\n    use: [_better_auth_DEBtROF9_mjs__WEBPACK_IMPORTED_MODULE_7__.s],\n    metadata: {\n      openapi: {\n        description: \"Get the account info provided by the provider\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        name: {\n                          type: \"string\"\n                        },\n                        email: {\n                          type: \"string\"\n                        },\n                        image: {\n                          type: \"string\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\"\n                        }\n                      },\n                      required: [\"id\", \"emailVerified\"]\n                    },\n                    data: {\n                      type: \"object\",\n                      properties: {},\n                      additionalProperties: true\n                    }\n                  },\n                  required: [\"user\", \"data\"],\n                  additionalProperties: false\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    body: zod__WEBPACK_IMPORTED_MODULE_23__.object({\n      accountId: zod__WEBPACK_IMPORTED_MODULE_23__.string().meta({\n        description: \"The provider given account id for which to get the account info\"\n      })\n    })\n  },\n  async (ctx) => {\n    const account = await ctx.context.internalAdapter.findAccount(\n      ctx.body.accountId\n    );\n    if (!account || account.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === account.providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: `Provider account provider is ${account.providerId} but it is not configured`\n      });\n    }\n    const tokens = await getAccessToken({\n      ...ctx,\n      body: {\n        accountId: account.id,\n        providerId: account.providerId\n      },\n      returnHeaders: false\n    });\n    if (!tokens.accessToken) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Access token not found\"\n      });\n    }\n    const info = await provider.getUserInfo({\n      ...tokens,\n      accessToken: tokens.accessToken\n    });\n    return ctx.json(info);\n  }\n);\n\nconst defuReplaceArrays = (0,defu__WEBPACK_IMPORTED_MODULE_20__.createDefu)((obj, key, value) => {\n  if (Array.isArray(obj[key]) && Array.isArray(value)) {\n    obj[key] = value;\n    return true;\n  }\n});\nfunction toAuthEndpoints(endpoints, ctx) {\n  const api = {};\n  for (const [key, endpoint] of Object.entries(endpoints)) {\n    api[key] = async (context) => {\n      const authContext = await ctx;\n      let internalContext = {\n        ...context,\n        context: {\n          ...authContext,\n          returned: void 0,\n          responseHeaders: void 0,\n          session: null\n        },\n        path: endpoint.path,\n        headers: context?.headers ? new Headers(context?.headers) : void 0\n      };\n      const { beforeHooks, afterHooks } = getHooks(authContext);\n      const before = await runBeforeHooks(internalContext, beforeHooks);\n      if (\"context\" in before && before.context && typeof before.context === \"object\") {\n        const { headers, ...rest } = before.context;\n        if (headers) {\n          headers.forEach((value, key2) => {\n            internalContext.headers.set(key2, value);\n          });\n        }\n        internalContext = defuReplaceArrays(rest, internalContext);\n      } else if (before) {\n        return context?.asResponse ? (0,better_call__WEBPACK_IMPORTED_MODULE_1__.toResponse)(before, {\n          headers: context?.headers\n        }) : context?.returnHeaders ? {\n          headers: context?.headers,\n          response: before\n        } : before;\n      }\n      internalContext.asResponse = false;\n      internalContext.returnHeaders = true;\n      const result = await endpoint(internalContext).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError) {\n          return {\n            response: e,\n            headers: e.headers ? new Headers(e.headers) : null\n          };\n        }\n        throw e;\n      });\n      if (result && result instanceof Response) {\n        return result;\n      }\n      internalContext.context.returned = result.response;\n      internalContext.context.responseHeaders = result.headers;\n      const after = await runAfterHooks(internalContext, afterHooks);\n      if (after.response) {\n        result.response = after.response;\n      }\n      if (result.response instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError && (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.shouldPublishLog)(authContext.logger.level, \"debug\")) {\n        result.response.stack = result.response.errorStack;\n      }\n      if (result.response instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError && !context?.asResponse) {\n        throw result.response;\n      }\n      const response = context?.asResponse ? (0,better_call__WEBPACK_IMPORTED_MODULE_1__.toResponse)(result.response, {\n        headers: result.headers\n      }) : context?.returnHeaders ? {\n        headers: result.headers,\n        response: result.response\n      } : result.response;\n      return response;\n    };\n    api[key].path = endpoint.path;\n    api[key].options = endpoint.options;\n  }\n  return api;\n}\nasync function runBeforeHooks(context, hooks) {\n  let modifiedContext = {};\n  for (const hook of hooks) {\n    if (hook.matcher(context)) {\n      const result = await hook.handler({\n        ...context,\n        returnHeaders: false\n      }).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError && (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.shouldPublishLog)(context.context.logger.level, \"debug\")) {\n          e.stack = e.errorStack;\n        }\n        throw e;\n      });\n      if (result && typeof result === \"object\") {\n        if (\"context\" in result && typeof result.context === \"object\") {\n          const { headers, ...rest } = result.context;\n          if (headers instanceof Headers) {\n            if (modifiedContext.headers) {\n              headers.forEach((value, key) => {\n                modifiedContext.headers?.set(key, value);\n              });\n            } else {\n              modifiedContext.headers = headers;\n            }\n          }\n          modifiedContext = defuReplaceArrays(rest, modifiedContext);\n          continue;\n        }\n        return result;\n      }\n    }\n  }\n  return { context: modifiedContext };\n}\nasync function runAfterHooks(context, hooks) {\n  for (const hook of hooks) {\n    if (hook.matcher(context)) {\n      const result = await hook.handler(context).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_1__.APIError) {\n          if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_15__.shouldPublishLog)(context.context.logger.level, \"debug\")) {\n            e.stack = e.errorStack;\n          }\n          return {\n            response: e,\n            headers: e.headers ? new Headers(e.headers) : null\n          };\n        }\n        throw e;\n      });\n      if (result.headers) {\n        result.headers.forEach((value, key) => {\n          if (!context.context.responseHeaders) {\n            context.context.responseHeaders = new Headers({\n              [key]: value\n            });\n          } else {\n            if (key.toLowerCase() === \"set-cookie\") {\n              context.context.responseHeaders.append(key, value);\n            } else {\n              context.context.responseHeaders.set(key, value);\n            }\n          }\n        });\n      }\n      if (result.response) {\n        context.context.returned = result.response;\n      }\n    }\n  }\n  return {\n    response: context.context.returned,\n    headers: context.context.responseHeaders\n  };\n}\nfunction getHooks(authContext) {\n  const plugins = authContext.options.plugins || [];\n  const beforeHooks = [];\n  const afterHooks = [];\n  if (authContext.options.hooks?.before) {\n    beforeHooks.push({\n      matcher: () => true,\n      handler: authContext.options.hooks.before\n    });\n  }\n  if (authContext.options.hooks?.after) {\n    afterHooks.push({\n      matcher: () => true,\n      handler: authContext.options.hooks.after\n    });\n  }\n  const pluginBeforeHooks = plugins.map((plugin) => {\n    if (plugin.hooks?.before) {\n      return plugin.hooks.before;\n    }\n  }).filter((plugin) => plugin !== void 0).flat();\n  const pluginAfterHooks = plugins.map((plugin) => {\n    if (plugin.hooks?.after) {\n      return plugin.hooks.after;\n    }\n  }).filter((plugin) => plugin !== void 0).flat();\n  pluginBeforeHooks.length && beforeHooks.push(...pluginBeforeHooks);\n  pluginAfterHooks.length && afterHooks.push(...pluginAfterHooks);\n  return {\n    beforeHooks,\n    afterHooks\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CWDlVQjhFUC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF5QjtBQUNvRTtBQUMxQztBQUNxQztBQUNyRDtBQUN3QjtBQUNpQjtBQUNaO0FBQzBGO0FBQ2hHO0FBQ0c7QUFDNUI7QUFDQztBQUNEO0FBQ0U7QUFDRjtBQUNBO0FBQ0Q7QUFDQTtBQUN1QztBQUNOO0FBQ2U7QUFDL0M7QUFDRTtBQUNMO0FBQ2Q7QUFDc0I7QUFDSjtBQUNnRDtBQUNVO0FBQ25EOztBQUV6QztBQUNBLGlMQUFpTCxnQkFBZ0I7QUFDak0sZ0JBQWdCLEtBQUs7QUFDckIsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsZ0JBQWdCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCx3QkFBd0I7QUFDeEUsaUJBQWlCLHlCQUF5QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpQkFBaUI7QUFDaEQsd0JBQXdCLGlCQUFpQjtBQUN6QyxNQUFNO0FBQ04sc0JBQXNCLGlCQUFpQjtBQUN2QztBQUNBO0FBQ0EseUNBQXlDLGlCQUFpQjtBQUMxRCx5Q0FBeUMsaUJBQWlCO0FBQzFEO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDQSxhQUFhO0FBQ2IsWUFBWTtBQUNaO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5CWDlVQjhFUC5tanM/ZWJlZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB6IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBzIGFzIHNldFNlc3Npb25Db29raWUsIGQgYXMgZGVsZXRlU2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguRDlfdlFSODMubWpzJztcbmltcG9ydCB7IEFQSUVycm9yLCB0b1Jlc3BvbnNlIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIGNyZWF0ZUF1dGhFbmRwb2ludCB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL21pZGRsZXdhcmUnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCB7IEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgeyBTb2NpYWxQcm92aWRlckxpc3RFbnVtIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvc29jaWFsLXByb3ZpZGVycyc7XG5pbXBvcnQgeyBzIGFzIHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFNlc3Npb25Gcm9tQ3R4LCBlIGFzIHNlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlLCBzIGFzIHNlc3Npb25NaWRkbGV3YXJlLCBmIGFzIGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUgfSBmcm9tICcuL2JldHRlci1hdXRoLkRFQnRST0Y5Lm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdldERhdGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdlbmVyYXRlSWQgfSBmcm9tICcuL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IGp3dFZlcmlmeSB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCB7IGcgYXMgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgeyBkIGFzIHBhcnNlVXNlcklucHV0IH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5Dd2o5ZHQ2aS5tanMnO1xuaW1wb3J0IHsgbG9nZ2VyLCBpc0RldmVsb3BtZW50LCBzaG91bGRQdWJsaXNoTG9nIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGInO1xuaW1wb3J0ICdreXNlbHknO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvY29yZS9kYi9hZGFwdGVyJztcbmltcG9ydCB7IGNyZWF0ZURlZnUgfSBmcm9tICdkZWZ1JztcbmltcG9ydCB7IHNpZ25KV1QsIHN5bW1ldHJpY0VuY3J5cHQsIHN5bW1ldHJpY0RlY3J5cHQgfSBmcm9tICcuLi9jcnlwdG8vaW5kZXgubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0T3JpZ2luLCBiIGFzIGdldEhvc3QsIGMgYXMgZ2V0UHJvdG9jb2wgfSBmcm9tICcuL2JldHRlci1hdXRoLkRSM1I1d2RVLm1qcyc7XG5pbXBvcnQgeyBKV1RFeHBpcmVkIH0gZnJvbSAnam9zZS9lcnJvcnMnO1xuXG5mdW5jdGlvbiBlc2NhcGVSZWdFeHBDaGFyKGNoYXIpIHtcbiAgaWYgKGNoYXIgPT09IFwiLVwiIHx8IGNoYXIgPT09IFwiXlwiIHx8IGNoYXIgPT09IFwiJFwiIHx8IGNoYXIgPT09IFwiK1wiIHx8IGNoYXIgPT09IFwiLlwiIHx8IGNoYXIgPT09IFwiKFwiIHx8IGNoYXIgPT09IFwiKVwiIHx8IGNoYXIgPT09IFwifFwiIHx8IGNoYXIgPT09IFwiW1wiIHx8IGNoYXIgPT09IFwiXVwiIHx8IGNoYXIgPT09IFwie1wiIHx8IGNoYXIgPT09IFwifVwiIHx8IGNoYXIgPT09IFwiKlwiIHx8IGNoYXIgPT09IFwiP1wiIHx8IGNoYXIgPT09IFwiXFxcXFwiKSB7XG4gICAgcmV0dXJuIGBcXFxcJHtjaGFyfWA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGNoYXI7XG4gIH1cbn1cbmZ1bmN0aW9uIGVzY2FwZVJlZ0V4cFN0cmluZyhzdHIpIHtcbiAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgcmVzdWx0ICs9IGVzY2FwZVJlZ0V4cENoYXIoc3RyW2ldKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gdHJhbnNmb3JtKHBhdHRlcm4sIHNlcGFyYXRvciA9IHRydWUpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkocGF0dGVybikpIHtcbiAgICBsZXQgcmVnRXhwUGF0dGVybnMgPSBwYXR0ZXJuLm1hcCgocCkgPT4gYF4ke3RyYW5zZm9ybShwLCBzZXBhcmF0b3IpfSRgKTtcbiAgICByZXR1cm4gYCg/OiR7cmVnRXhwUGF0dGVybnMuam9pbihcInxcIil9KWA7XG4gIH1cbiAgbGV0IHNlcGFyYXRvclNwbGl0dGVyID0gXCJcIjtcbiAgbGV0IHNlcGFyYXRvck1hdGNoZXIgPSBcIlwiO1xuICBsZXQgd2lsZGNhcmQgPSBcIi5cIjtcbiAgaWYgKHNlcGFyYXRvciA9PT0gdHJ1ZSkge1xuICAgIHNlcGFyYXRvclNwbGl0dGVyID0gXCIvXCI7XG4gICAgc2VwYXJhdG9yTWF0Y2hlciA9IFwiWy9cXFxcXFxcXF1cIjtcbiAgICB3aWxkY2FyZCA9IFwiW14vXFxcXFxcXFxdXCI7XG4gIH0gZWxzZSBpZiAoc2VwYXJhdG9yKSB7XG4gICAgc2VwYXJhdG9yU3BsaXR0ZXIgPSBzZXBhcmF0b3I7XG4gICAgc2VwYXJhdG9yTWF0Y2hlciA9IGVzY2FwZVJlZ0V4cFN0cmluZyhzZXBhcmF0b3JTcGxpdHRlcik7XG4gICAgaWYgKHNlcGFyYXRvck1hdGNoZXIubGVuZ3RoID4gMSkge1xuICAgICAgc2VwYXJhdG9yTWF0Y2hlciA9IGAoPzoke3NlcGFyYXRvck1hdGNoZXJ9KWA7XG4gICAgICB3aWxkY2FyZCA9IGAoKD8hJHtzZXBhcmF0b3JNYXRjaGVyfSkuKWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbGRjYXJkID0gYFteJHtzZXBhcmF0b3JNYXRjaGVyfV1gO1xuICAgIH1cbiAgfVxuICBsZXQgcmVxdWlyZWRTZXBhcmF0b3IgPSBzZXBhcmF0b3IgPyBgJHtzZXBhcmF0b3JNYXRjaGVyfSs/YCA6IFwiXCI7XG4gIGxldCBvcHRpb25hbFNlcGFyYXRvciA9IHNlcGFyYXRvciA/IGAke3NlcGFyYXRvck1hdGNoZXJ9Kj9gIDogXCJcIjtcbiAgbGV0IHNlZ21lbnRzID0gc2VwYXJhdG9yID8gcGF0dGVybi5zcGxpdChzZXBhcmF0b3JTcGxpdHRlcikgOiBbcGF0dGVybl07XG4gIGxldCByZXN1bHQgPSBcIlwiO1xuICBmb3IgKGxldCBzID0gMDsgcyA8IHNlZ21lbnRzLmxlbmd0aDsgcysrKSB7XG4gICAgbGV0IHNlZ21lbnQgPSBzZWdtZW50c1tzXTtcbiAgICBsZXQgbmV4dFNlZ21lbnQgPSBzZWdtZW50c1tzICsgMV07XG4gICAgbGV0IGN1cnJlbnRTZXBhcmF0b3IgPSBcIlwiO1xuICAgIGlmICghc2VnbWVudCAmJiBzID4gMCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChzZXBhcmF0b3IpIHtcbiAgICAgIGlmIChzID09PSBzZWdtZW50cy5sZW5ndGggLSAxKSB7XG4gICAgICAgIGN1cnJlbnRTZXBhcmF0b3IgPSBvcHRpb25hbFNlcGFyYXRvcjtcbiAgICAgIH0gZWxzZSBpZiAobmV4dFNlZ21lbnQgIT09IFwiKipcIikge1xuICAgICAgICBjdXJyZW50U2VwYXJhdG9yID0gcmVxdWlyZWRTZXBhcmF0b3I7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50U2VwYXJhdG9yID0gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHNlcGFyYXRvciAmJiBzZWdtZW50ID09PSBcIioqXCIpIHtcbiAgICAgIGlmIChjdXJyZW50U2VwYXJhdG9yKSB7XG4gICAgICAgIHJlc3VsdCArPSBzID09PSAwID8gXCJcIiA6IGN1cnJlbnRTZXBhcmF0b3I7XG4gICAgICAgIHJlc3VsdCArPSBgKD86JHt3aWxkY2FyZH0qPyR7Y3VycmVudFNlcGFyYXRvcn0pKj9gO1xuICAgICAgfVxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGZvciAobGV0IGMgPSAwOyBjIDwgc2VnbWVudC5sZW5ndGg7IGMrKykge1xuICAgICAgbGV0IGNoYXIgPSBzZWdtZW50W2NdO1xuICAgICAgaWYgKGNoYXIgPT09IFwiXFxcXFwiKSB7XG4gICAgICAgIGlmIChjIDwgc2VnbWVudC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgcmVzdWx0ICs9IGVzY2FwZVJlZ0V4cENoYXIoc2VnbWVudFtjICsgMV0pO1xuICAgICAgICAgIGMrKztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjaGFyID09PSBcIj9cIikge1xuICAgICAgICByZXN1bHQgKz0gd2lsZGNhcmQ7XG4gICAgICB9IGVsc2UgaWYgKGNoYXIgPT09IFwiKlwiKSB7XG4gICAgICAgIHJlc3VsdCArPSBgJHt3aWxkY2FyZH0qP2A7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgKz0gZXNjYXBlUmVnRXhwQ2hhcihjaGFyKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0ICs9IGN1cnJlbnRTZXBhcmF0b3I7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGlzTWF0Y2gocmVnZXhwLCBzYW1wbGUpIHtcbiAgaWYgKHR5cGVvZiBzYW1wbGUgIT09IFwic3RyaW5nXCIpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBTYW1wbGUgbXVzdCBiZSBhIHN0cmluZywgYnV0ICR7dHlwZW9mIHNhbXBsZX0gZ2l2ZW5gKTtcbiAgfVxuICByZXR1cm4gcmVnZXhwLnRlc3Qoc2FtcGxlKTtcbn1cbmZ1bmN0aW9uIHdpbGRjYXJkTWF0Y2gocGF0dGVybiwgb3B0aW9ucykge1xuICBpZiAodHlwZW9mIHBhdHRlcm4gIT09IFwic3RyaW5nXCIgJiYgIUFycmF5LmlzQXJyYXkocGF0dGVybikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgYFRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc2luZ2xlIHBhdHRlcm4gc3RyaW5nIG9yIGFuIGFycmF5IG9mIHBhdHRlcm5zLCBidXQgJHt0eXBlb2YgcGF0dGVybn0gZ2l2ZW5gXG4gICAgKTtcbiAgfVxuICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIG9wdGlvbnMgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgb3B0aW9ucyA9IHsgc2VwYXJhdG9yOiBvcHRpb25zIH07XG4gIH1cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgISh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zICE9PSBudWxsICYmICFBcnJheS5pc0FycmF5KG9wdGlvbnMpKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICBgVGhlIHNlY29uZCBhcmd1bWVudCBtdXN0IGJlIGFuIG9wdGlvbnMgb2JqZWN0IG9yIGEgc3RyaW5nL2Jvb2xlYW4gc2VwYXJhdG9yLCBidXQgJHt0eXBlb2Ygb3B0aW9uc30gZ2l2ZW5gXG4gICAgKTtcbiAgfVxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgaWYgKG9wdGlvbnMuc2VwYXJhdG9yID09PSBcIlxcXFxcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiXFxcXCBpcyBub3QgYSB2YWxpZCBzZXBhcmF0b3IgYmVjYXVzZSBpdCBpcyB1c2VkIGZvciBlc2NhcGluZy4gVHJ5IHNldHRpbmcgdGhlIHNlcGFyYXRvciB0byBgdHJ1ZWAgaW5zdGVhZFwiXG4gICAgKTtcbiAgfVxuICBsZXQgcmVnZXhwUGF0dGVybiA9IHRyYW5zZm9ybShwYXR0ZXJuLCBvcHRpb25zLnNlcGFyYXRvcik7XG4gIGxldCByZWdleHAgPSBuZXcgUmVnRXhwKGBeJHtyZWdleHBQYXR0ZXJufSRgLCBvcHRpb25zLmZsYWdzKTtcbiAgbGV0IGZuID0gaXNNYXRjaC5iaW5kKG51bGwsIHJlZ2V4cCk7XG4gIGZuLm9wdGlvbnMgPSBvcHRpb25zO1xuICBmbi5wYXR0ZXJuID0gcGF0dGVybjtcbiAgZm4ucmVnZXhwID0gcmVnZXhwO1xuICByZXR1cm4gZm47XG59XG5cbmNvbnN0IG9yaWdpbkNoZWNrTWlkZGxld2FyZSA9IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgaWYgKGN0eC5yZXF1ZXN0Py5tZXRob2QgIT09IFwiUE9TVFwiIHx8ICFjdHgucmVxdWVzdCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBoZWFkZXJzID0gY3R4LnJlcXVlc3Q/LmhlYWRlcnM7XG4gIGNvbnN0IHJlcXVlc3QgPSBjdHgucmVxdWVzdDtcbiAgY29uc3QgeyBib2R5LCBxdWVyeSwgY29udGV4dCB9ID0gY3R4O1xuICBpZiAoaXNTaW1wbGVSZXF1ZXN0KGhlYWRlcnMpICYmICFjdHguY29udGV4dC5za2lwQ1NSRkNoZWNrKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogXCJJbnZhbGlkIHJlcXVlc3RcIiB9KTtcbiAgfVxuICBjb25zdCBvcmlnaW5IZWFkZXIgPSBoZWFkZXJzPy5nZXQoXCJvcmlnaW5cIikgfHwgaGVhZGVycz8uZ2V0KFwicmVmZXJlclwiKSB8fCBcIlwiO1xuICBjb25zdCBjYWxsYmFja1VSTCA9IGJvZHk/LmNhbGxiYWNrVVJMIHx8IHF1ZXJ5Py5jYWxsYmFja1VSTDtcbiAgY29uc3QgcmVkaXJlY3RVUkwgPSBib2R5Py5yZWRpcmVjdFRvO1xuICBjb25zdCBlcnJvckNhbGxiYWNrVVJMID0gYm9keT8uZXJyb3JDYWxsYmFja1VSTDtcbiAgY29uc3QgbmV3VXNlckNhbGxiYWNrVVJMID0gYm9keT8ubmV3VXNlckNhbGxiYWNrVVJMO1xuICBjb25zdCB0cnVzdGVkT3JpZ2lucyA9IEFycmF5LmlzQXJyYXkoY29udGV4dC5vcHRpb25zLnRydXN0ZWRPcmlnaW5zKSA/IGNvbnRleHQudHJ1c3RlZE9yaWdpbnMgOiBbXG4gICAgLi4uY29udGV4dC50cnVzdGVkT3JpZ2lucyxcbiAgICAuLi5hd2FpdCBjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnM/LihyZXF1ZXN0KSB8fCBbXVxuICBdO1xuICBjb25zdCB1c2VDb29raWVzID0gaGVhZGVycz8uaGFzKFwiY29va2llXCIpO1xuICBjb25zdCBtYXRjaGVzUGF0dGVybiA9ICh1cmwsIHBhdHRlcm4pID0+IHtcbiAgICBpZiAodXJsLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChwYXR0ZXJuLmluY2x1ZGVzKFwiKlwiKSkge1xuICAgICAgaWYgKHBhdHRlcm4uaW5jbHVkZXMoXCI6Ly9cIikpIHtcbiAgICAgICAgcmV0dXJuIHdpbGRjYXJkTWF0Y2gocGF0dGVybikoZ2V0T3JpZ2luKHVybCkgfHwgdXJsKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGhvc3QgPSBnZXRIb3N0KHVybCk7XG4gICAgICBpZiAoIWhvc3QpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHdpbGRjYXJkTWF0Y2gocGF0dGVybikoaG9zdCk7XG4gICAgfVxuICAgIGNvbnN0IHByb3RvY29sID0gZ2V0UHJvdG9jb2wodXJsKTtcbiAgICByZXR1cm4gcHJvdG9jb2wgPT09IFwiaHR0cDpcIiB8fCBwcm90b2NvbCA9PT0gXCJodHRwczpcIiB8fCAhcHJvdG9jb2wgPyBwYXR0ZXJuID09PSBnZXRPcmlnaW4odXJsKSA6IHVybC5zdGFydHNXaXRoKHBhdHRlcm4pO1xuICB9O1xuICBjb25zdCB2YWxpZGF0ZVVSTCA9ICh1cmwsIGxhYmVsKSA9PiB7XG4gICAgaWYgKCF1cmwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaXNUcnVzdGVkT3JpZ2luID0gdHJ1c3RlZE9yaWdpbnMuc29tZShcbiAgICAgIChvcmlnaW4pID0+IG1hdGNoZXNQYXR0ZXJuKHVybCwgb3JpZ2luKSB8fCB1cmw/LnN0YXJ0c1dpdGgoXCIvXCIpICYmIGxhYmVsICE9PSBcIm9yaWdpblwiICYmIC9eXFwvKD8hXFwvfFxcXFx8JTJmfCU1YylbXFx3XFwtLlxcKy9AXSooPzpcXD9bXFx3XFwtLlxcKy89JiVAXSopPyQvLnRlc3QodXJsKVxuICAgICk7XG4gICAgaWYgKCFpc1RydXN0ZWRPcmlnaW4pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihgSW52YWxpZCAke2xhYmVsfTogJHt1cmx9YCk7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuaW5mbyhcbiAgICAgICAgYElmIGl0J3MgYSB2YWxpZCBVUkwsIHBsZWFzZSBhZGQgJHt1cmx9IHRvIHRydXN0ZWRPcmlnaW5zIGluIHlvdXIgYXV0aCBjb25maWdcbmAsXG4gICAgICAgIGBDdXJyZW50IGxpc3Qgb2YgdHJ1c3RlZE9yaWdpbnM6ICR7dHJ1c3RlZE9yaWdpbnN9YFxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7IG1lc3NhZ2U6IGBJbnZhbGlkICR7bGFiZWx9YCB9KTtcbiAgICB9XG4gIH07XG4gIGlmICh1c2VDb29raWVzICYmICFjdHguY29udGV4dC5za2lwQ1NSRkNoZWNrICYmICFjdHguY29udGV4dC5za2lwT3JpZ2luQ2hlY2spIHtcbiAgICBpZiAoIW9yaWdpbkhlYWRlciB8fCBvcmlnaW5IZWFkZXIgPT09IFwibnVsbFwiKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwgeyBtZXNzYWdlOiBcIk1pc3Npbmcgb3IgbnVsbCBPcmlnaW5cIiB9KTtcbiAgICB9XG4gICAgdmFsaWRhdGVVUkwob3JpZ2luSGVhZGVyLCBcIm9yaWdpblwiKTtcbiAgfVxuICBjYWxsYmFja1VSTCAmJiB2YWxpZGF0ZVVSTChjYWxsYmFja1VSTCwgXCJjYWxsYmFja1VSTFwiKTtcbiAgcmVkaXJlY3RVUkwgJiYgdmFsaWRhdGVVUkwocmVkaXJlY3RVUkwsIFwicmVkaXJlY3RVUkxcIik7XG4gIGVycm9yQ2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwoZXJyb3JDYWxsYmFja1VSTCwgXCJlcnJvckNhbGxiYWNrVVJMXCIpO1xuICBuZXdVc2VyQ2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwobmV3VXNlckNhbGxiYWNrVVJMLCBcIm5ld1VzZXJDYWxsYmFja1VSTFwiKTtcbn0pO1xuY29uc3Qgb3JpZ2luQ2hlY2sgPSAoZ2V0VmFsdWUpID0+IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgaWYgKCFjdHgucmVxdWVzdCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB7IGNvbnRleHQgfSA9IGN0eDtcbiAgY29uc3QgY2FsbGJhY2tVUkwgPSBnZXRWYWx1ZShjdHgpO1xuICBjb25zdCB0cnVzdGVkT3JpZ2lucyA9IEFycmF5LmlzQXJyYXkoXG4gICAgY29udGV4dC5vcHRpb25zLnRydXN0ZWRPcmlnaW5zXG4gICkgPyBjb250ZXh0LnRydXN0ZWRPcmlnaW5zIDogW1xuICAgIC4uLmNvbnRleHQudHJ1c3RlZE9yaWdpbnMsXG4gICAgLi4uYXdhaXQgY29udGV4dC5vcHRpb25zLnRydXN0ZWRPcmlnaW5zPy4oY3R4LnJlcXVlc3QpIHx8IFtdXG4gIF07XG4gIGNvbnN0IG1hdGNoZXNQYXR0ZXJuID0gKHVybCwgcGF0dGVybikgPT4ge1xuICAgIGlmICh1cmwuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBhdHRlcm4uaW5jbHVkZXMoXCIqXCIpKSB7XG4gICAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShnZXRPcmlnaW4odXJsKSB8fCB1cmwpO1xuICAgICAgfVxuICAgICAgY29uc3QgaG9zdCA9IGdldEhvc3QodXJsKTtcbiAgICAgIGlmICghaG9zdCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShob3N0KTtcbiAgICB9XG4gICAgY29uc3QgcHJvdG9jb2wgPSBnZXRQcm90b2NvbCh1cmwpO1xuICAgIHJldHVybiBwcm90b2NvbCA9PT0gXCJodHRwOlwiIHx8IHByb3RvY29sID09PSBcImh0dHBzOlwiIHx8ICFwcm90b2NvbCA/IHBhdHRlcm4gPT09IGdldE9yaWdpbih1cmwpIDogdXJsLnN0YXJ0c1dpdGgocGF0dGVybik7XG4gIH07XG4gIGNvbnN0IHZhbGlkYXRlVVJMID0gKHVybCwgbGFiZWwpID0+IHtcbiAgICBpZiAoIXVybCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc1RydXN0ZWRPcmlnaW4gPSB0cnVzdGVkT3JpZ2lucy5zb21lKFxuICAgICAgKG9yaWdpbikgPT4gbWF0Y2hlc1BhdHRlcm4odXJsLCBvcmlnaW4pIHx8IHVybD8uc3RhcnRzV2l0aChcIi9cIikgJiYgbGFiZWwgIT09IFwib3JpZ2luXCIgJiYgL15cXC8oPyFcXC98XFxcXHwlMmZ8JTVjKVtcXHdcXC0uXFwrL0BdKig/OlxcP1tcXHdcXC0uXFwrLz0mJUBdKik/JC8udGVzdChcbiAgICAgICAgdXJsXG4gICAgICApXG4gICAgKTtcbiAgICBpZiAoIWlzVHJ1c3RlZE9yaWdpbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGBJbnZhbGlkICR7bGFiZWx9OiAke3VybH1gKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKFxuICAgICAgICBgSWYgaXQncyBhIHZhbGlkIFVSTCwgcGxlYXNlIGFkZCAke3VybH0gdG8gdHJ1c3RlZE9yaWdpbnMgaW4geW91ciBhdXRoIGNvbmZpZ1xuYCxcbiAgICAgICAgYEN1cnJlbnQgbGlzdCBvZiB0cnVzdGVkT3JpZ2luczogJHt0cnVzdGVkT3JpZ2luc31gXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogYEludmFsaWQgJHtsYWJlbH1gIH0pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgY2FsbGJhY2tzID0gQXJyYXkuaXNBcnJheShjYWxsYmFja1VSTCkgPyBjYWxsYmFja1VSTCA6IFtjYWxsYmFja1VSTF07XG4gIGZvciAoY29uc3QgdXJsIG9mIGNhbGxiYWNrcykge1xuICAgIHZhbGlkYXRlVVJMKHVybCwgXCJjYWxsYmFja1VSTFwiKTtcbiAgfVxufSk7XG5mdW5jdGlvbiBpc1NpbXBsZVJlcXVlc3QoaGVhZGVycykge1xuICBjb25zdCBTSU1QTEVfSEVBREVSUyA9IFtcbiAgICBcImFjY2VwdFwiLFxuICAgIFwiYWNjZXB0LWxhbmd1YWdlXCIsXG4gICAgXCJjb250ZW50LWxhbmd1YWdlXCIsXG4gICAgXCJjb250ZW50LXR5cGVcIlxuICBdO1xuICBjb25zdCBTSU1QTEVfQ09OVEVOVF9UWVBFUyA9IFtcbiAgICBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgIFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiLFxuICAgIFwidGV4dC9wbGFpblwiXG4gIF07XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIGhlYWRlcnMuZW50cmllcygpKSB7XG4gICAgaWYgKCFTSU1QTEVfSEVBREVSUy5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGtleS50b0xvd2VyQ2FzZSgpID09PSBcImNvbnRlbnQtdHlwZVwiICYmICFTSU1QTEVfQ09OVEVOVF9UWVBFUy5pbmNsdWRlcyhcbiAgICAgIHZhbHVlPy5zcGxpdChcIjtcIilbMF0/LnRyaW0oKT8udG9Mb3dlckNhc2UoKSB8fCBcIlwiXG4gICAgKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihzZWNyZXQsIGVtYWlsLCB1cGRhdGVUbywgZXhwaXJlc0luID0gMzYwMCkge1xuICBjb25zdCB0b2tlbiA9IGF3YWl0IHNpZ25KV1QoXG4gICAge1xuICAgICAgZW1haWw6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICB1cGRhdGVUb1xuICAgIH0sXG4gICAgc2VjcmV0LFxuICAgIGV4cGlyZXNJblxuICApO1xuICByZXR1cm4gdG9rZW47XG59XG5hc3luYyBmdW5jdGlvbiBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbihjdHgsIHVzZXIpIHtcbiAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWwpIHtcbiAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZC5cIik7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICB1c2VyLmVtYWlsLFxuICAgIHZvaWQgMCxcbiAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgKTtcbiAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5zZW5kVmVyaWZpY2F0aW9uRW1haWwoXG4gICAge1xuICAgICAgdXNlcixcbiAgICAgIHVybCxcbiAgICAgIHRva2VuXG4gICAgfSxcbiAgICBjdHgucmVxdWVzdFxuICApO1xufVxuY29uc3Qgc2VuZFZlcmlmaWNhdGlvbkVtYWlsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zZW5kLXZlcmlmaWNhdGlvbi1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5lbWFpbCgpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgdG8gc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGVtYWlsIHRvXCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gdXNlIGZvciBlbWFpbCB2ZXJpZmljYXRpb24gY2FsbGJhY2tcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbmQgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCB0byBzZW5kIHRoZSB2ZXJpZmljYXRpb24gZW1haWwgdG9cIixcbiAgICAgICAgICAgICAgICAgICAgZXhhbXBsZTogXCJ1c2VyQGV4YW1wbGUuY29tXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBjYWxsYmFja1VSTDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHVzZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGNhbGxiYWNrXCIsXG4gICAgICAgICAgICAgICAgICAgIGV4YW1wbGU6IFwiaHR0cHM6Ly9leGFtcGxlLmNvbS9jYWxsYmFja1wiLFxuICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcImVtYWlsXCJdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgZW1haWwgd2FzIHNlbnQgc3VjY2Vzc2Z1bGx5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgZXhhbXBsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIjQwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJCYWQgUmVxdWVzdFwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRXJyb3IgbWVzc2FnZVwiLFxuICAgICAgICAgICAgICAgICAgICAgIGV4YW1wbGU6IFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWRcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWwpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbihjdHgsIHVzZXIudXNlcik7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoc2Vzc2lvbj8udXNlci5lbWFpbFZlcmlmaWVkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiWW91IGNhbiBvbmx5IHNlbmQgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gYW4gdW52ZXJpZmllZCBlbWFpbFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHNlc3Npb24/LnVzZXIuZW1haWwgIT09IGVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiWW91IGNhbiBvbmx5IHNlbmQgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8geW91ciBvd24gZW1haWxcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IHNlbmRWZXJpZmljYXRpb25FbWFpbEZuKGN0eCwgc2Vzc2lvbi51c2VyKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCB2ZXJpZnlFbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvdmVyaWZ5LWVtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gdmVyaWZ5IHRoZSBlbWFpbFwiXG4gICAgICB9KSxcbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIGVtYWlsIHZlcmlmaWNhdGlvblwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbb3JpZ2luQ2hlY2soKGN0eCkgPT4gY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVmVyaWZ5IHRoZSBlbWFpbCBvZiB0aGUgdXNlclwiLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJ0b2tlblwiLFxuICAgICAgICAgICAgaW46IFwicXVlcnlcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byB2ZXJpZnkgdGhlIGVtYWlsXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcImNhbGxiYWNrVVJMXCIsXG4gICAgICAgICAgICBpbjogXCJxdWVyeVwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciBlbWFpbCB2ZXJpZmljYXRpb25cIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIElEXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIGVtYWlsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBpbWFnZSBVUkxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgdXNlciBlbWFpbCBpcyB2ZXJpZmllZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgY3JlYXRpb24gZGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgdXBkYXRlIGRhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbWFnZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cGRhdGVkQXRcIlxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSBlbWFpbCB3YXMgdmVyaWZpZWQgc3VjY2Vzc2Z1bGx5XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ1c2VyXCIsIFwic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgZnVuY3Rpb24gcmVkaXJlY3RPbkVycm9yKGVycm9yKSB7XG4gICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwuaW5jbHVkZXMoXCI/XCIpKSB7XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5xdWVyeS5jYWxsYmFja1VSTH0mZXJyb3I9JHtlcnJvcn1gKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMfT9lcnJvcj0ke2Vycm9yfWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IHRva2VuIH0gPSBjdHgucXVlcnk7XG4gICAgbGV0IGp3dDtcbiAgICB0cnkge1xuICAgICAgand0ID0gYXdhaXQgand0VmVyaWZ5KFxuICAgICAgICB0b2tlbixcbiAgICAgICAgbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGN0eC5jb250ZXh0LnNlY3JldCksXG4gICAgICAgIHtcbiAgICAgICAgICBhbGdvcml0aG1zOiBbXCJIUzI1NlwiXVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgSldURXhwaXJlZCkge1xuICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidG9rZW5fZXhwaXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJpbnZhbGlkX3Rva2VuXCIpO1xuICAgIH1cbiAgICBjb25zdCBzY2hlbWEgPSB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgpLFxuICAgICAgdXBkYXRlVG86IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pO1xuICAgIGNvbnN0IHBhcnNlZCA9IHNjaGVtYS5wYXJzZShqd3QucGF5bG9hZCk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoXG4gICAgICBwYXJzZWQuZW1haWxcbiAgICApO1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVzZXJfbm90X2ZvdW5kXCIpO1xuICAgIH1cbiAgICBpZiAocGFyc2VkLnVwZGF0ZVRvKSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5xdWVyeS5jYWxsYmFja1VSTH0/ZXJyb3I9dW5hdXRob3JpemVkYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYXV0aG9yaXplZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChzZXNzaW9uLnVzZXIuZW1haWwgIT09IHBhcnNlZC5lbWFpbCkge1xuICAgICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5xdWVyeS5jYWxsYmFja1VSTH0/ZXJyb3I9dW5hdXRob3JpemVkYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYXV0aG9yaXplZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyMiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyQnlFbWFpbChcbiAgICAgICAgcGFyc2VkLmVtYWlsLFxuICAgICAgICB7XG4gICAgICAgICAgZW1haWw6IHBhcnNlZC51cGRhdGVUbyxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICBjb25zdCBuZXdUb2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgcGFyc2VkLnVwZGF0ZVRvXG4gICAgICApO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsPy4oXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiB1cGRhdGVkVXNlcjIsXG4gICAgICAgICAgdXJsOiBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHtuZXdUb2tlbn0mY2FsbGJhY2tVUkw9JHtjdHgucXVlcnkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YCxcbiAgICAgICAgICB0b2tlbjogbmV3VG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiBzZXNzaW9uLnNlc3Npb24sXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAuLi5zZXNzaW9uLnVzZXIsXG4gICAgICAgICAgZW1haWw6IHBhcnNlZC51cGRhdGVUbyxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGN0eC5xdWVyeS5jYWxsYmFja1VSTCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXBkYXRlZFVzZXIyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1cGRhdGVkVXNlcjIuZW1haWwsXG4gICAgICAgICAgbmFtZTogdXBkYXRlZFVzZXIyLm5hbWUsXG4gICAgICAgICAgaW1hZ2U6IHVwZGF0ZWRVc2VyMi5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1cGRhdGVkVXNlcjIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHVwZGF0ZWRVc2VyMi5jcmVhdGVkQXQsXG4gICAgICAgICAgdXBkYXRlZEF0OiB1cGRhdGVkVXNlcjIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8ub25FbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5vbkVtYWlsVmVyaWZpY2F0aW9uKFxuICAgICAgICB1c2VyLnVzZXIsXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyQnlFbWFpbChcbiAgICAgIHBhcnNlZC5lbWFpbCxcbiAgICAgIHtcbiAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgfSxcbiAgICAgIGN0eFxuICAgICk7XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmFmdGVyRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24uYWZ0ZXJFbWFpbFZlcmlmaWNhdGlvbihcbiAgICAgICAgdXBkYXRlZFVzZXIsXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uYXV0b1NpZ25JbkFmdGVyVmVyaWZpY2F0aW9uKSB7XG4gICAgICBjb25zdCBjdXJyZW50U2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgICBpZiAoIWN1cnJlbnRTZXNzaW9uIHx8IGN1cnJlbnRTZXNzaW9uLnVzZXIuZW1haWwgIT09IHBhcnNlZC5lbWFpbCkge1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgdXNlci51c2VyLmlkLFxuICAgICAgICAgIGN0eFxuICAgICAgICApO1xuICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi51c2VyLnVzZXIsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgc2Vzc2lvbjogY3VycmVudFNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi5jdXJyZW50U2Vzc2lvbi51c2VyLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgIHRocm93IGN0eC5yZWRpcmVjdChjdHgucXVlcnkuY2FsbGJhY2tVUkwpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgdXNlcjogbnVsbFxuICAgIH0pO1xuICB9XG4pO1xuXG5jb25zdCBISURFX01FVEFEQVRBID0ge1xuICBpc0FjdGlvbjogZmFsc2Vcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlU3RhdGUoYywgbGluaykge1xuICBjb25zdCBjYWxsYmFja1VSTCA9IGMuYm9keT8uY2FsbGJhY2tVUkwgfHwgYy5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTDtcbiAgaWYgKCFjYWxsYmFja1VSTCkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiY2FsbGJhY2tVUkwgaXMgcmVxdWlyZWRcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IGNvZGVWZXJpZmllciA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDEyOCk7XG4gIGNvbnN0IHN0YXRlID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIpO1xuICBjb25zdCBzdGF0ZUNvb2tpZSA9IGMuY29udGV4dC5jcmVhdGVBdXRoQ29va2llKFwic3RhdGVcIiwge1xuICAgIG1heEFnZTogNSAqIDYwICogMWUzXG4gICAgLy8gNSBtaW51dGVzXG4gIH0pO1xuICBhd2FpdCBjLnNldFNpZ25lZENvb2tpZShcbiAgICBzdGF0ZUNvb2tpZS5uYW1lLFxuICAgIHN0YXRlLFxuICAgIGMuY29udGV4dC5zZWNyZXQsXG4gICAgc3RhdGVDb29raWUuYXR0cmlidXRlc1xuICApO1xuICBjb25zdCBkYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgIGNhbGxiYWNrVVJMLFxuICAgIGNvZGVWZXJpZmllcixcbiAgICBlcnJvclVSTDogYy5ib2R5Py5lcnJvckNhbGxiYWNrVVJMLFxuICAgIG5ld1VzZXJVUkw6IGMuYm9keT8ubmV3VXNlckNhbGxiYWNrVVJMLFxuICAgIGxpbmssXG4gICAgLyoqXG4gICAgICogVGhpcyBpcyB0aGUgYWN0dWFsIGV4cGlyeSB0aW1lIG9mIHRoZSBzdGF0ZVxuICAgICAqL1xuICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArIDEwICogNjAgKiAxZTMsXG4gICAgcmVxdWVzdFNpZ25VcDogYy5ib2R5Py5yZXF1ZXN0U2lnblVwXG4gIH0pO1xuICBjb25zdCBleHBpcmVzQXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgZXhwaXJlc0F0LnNldE1pbnV0ZXMoZXhwaXJlc0F0LmdldE1pbnV0ZXMoKSArIDEwKTtcbiAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICB7XG4gICAgICB2YWx1ZTogZGF0YSxcbiAgICAgIGlkZW50aWZpZXI6IHN0YXRlLFxuICAgICAgZXhwaXJlc0F0XG4gICAgfSxcbiAgICBjXG4gICk7XG4gIGlmICghdmVyaWZpY2F0aW9uKSB7XG4gICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgIFwiVW5hYmxlIHRvIGNyZWF0ZSB2ZXJpZmljYXRpb24uIE1ha2Ugc3VyZSB0aGUgZGF0YWJhc2UgYWRhcHRlciBpcyBwcm9wZXJseSB3b3JraW5nIGFuZCB0aGVyZSBpcyBhIHZlcmlmaWNhdGlvbiB0YWJsZSBpbiB0aGUgZGF0YWJhc2VcIlxuICAgICk7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiVW5hYmxlIHRvIGNyZWF0ZSB2ZXJpZmljYXRpb25cIlxuICAgIH0pO1xuICB9XG4gIHJldHVybiB7XG4gICAgc3RhdGU6IHZlcmlmaWNhdGlvbi5pZGVudGlmaWVyLFxuICAgIGNvZGVWZXJpZmllclxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcGFyc2VTdGF0ZShjKSB7XG4gIGNvbnN0IHN0YXRlID0gYy5xdWVyeS5zdGF0ZSB8fCBjLmJvZHkuc3RhdGU7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShzdGF0ZSk7XG4gIGlmICghZGF0YSkge1xuICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJTdGF0ZSBNaXNtYXRjaC4gVmVyaWZpY2F0aW9uIG5vdCBmb3VuZFwiLCB7XG4gICAgICBzdGF0ZVxuICAgIH0pO1xuICAgIGNvbnN0IGVycm9yVVJMID0gYy5jb250ZXh0Lm9wdGlvbnMub25BUElFcnJvcj8uZXJyb3JVUkwgfHwgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYDtcbiAgICB0aHJvdyBjLnJlZGlyZWN0KGAke2Vycm9yVVJMfT9lcnJvcj1wbGVhc2VfcmVzdGFydF90aGVfcHJvY2Vzc2ApO1xuICB9XG4gIGNvbnN0IHBhcnNlZERhdGEgPSB6Lm9iamVjdCh7XG4gICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCksXG4gICAgY29kZVZlcmlmaWVyOiB6LnN0cmluZygpLFxuICAgIGVycm9yVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgbmV3VXNlclVSTDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIGV4cGlyZXNBdDogei5udW1iZXIoKSxcbiAgICBsaW5rOiB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5zdHJpbmcoKSxcbiAgICAgIHVzZXJJZDogei5jb2VyY2Uuc3RyaW5nKClcbiAgICB9KS5vcHRpb25hbCgpLFxuICAgIHJlcXVlc3RTaWduVXA6IHouYm9vbGVhbigpLm9wdGlvbmFsKClcbiAgfSkucGFyc2UoSlNPTi5wYXJzZShkYXRhLnZhbHVlKSk7XG4gIGlmICghcGFyc2VkRGF0YS5lcnJvclVSTCkge1xuICAgIHBhcnNlZERhdGEuZXJyb3JVUkwgPSBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICB9XG4gIGNvbnN0IHN0YXRlQ29va2llID0gYy5jb250ZXh0LmNyZWF0ZUF1dGhDb29raWUoXCJzdGF0ZVwiKTtcbiAgY29uc3Qgc3RhdGVDb29raWVWYWx1ZSA9IGF3YWl0IGMuZ2V0U2lnbmVkQ29va2llKFxuICAgIHN0YXRlQ29va2llLm5hbWUsXG4gICAgYy5jb250ZXh0LnNlY3JldFxuICApO1xuICBjb25zdCBza2lwU3RhdGVDb29raWVDaGVjayA9IGMuY29udGV4dC5vYXV0aENvbmZpZz8uc2tpcFN0YXRlQ29va2llQ2hlY2s7XG4gIGlmICghc2tpcFN0YXRlQ29va2llQ2hlY2sgJiYgKCFzdGF0ZUNvb2tpZVZhbHVlIHx8IHN0YXRlQ29va2llVmFsdWUgIT09IHN0YXRlKSkge1xuICAgIGNvbnN0IGVycm9yVVJMID0gYy5jb250ZXh0Lm9wdGlvbnMub25BUElFcnJvcj8uZXJyb3JVUkwgfHwgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYDtcbiAgICB0aHJvdyBjLnJlZGlyZWN0KGAke2Vycm9yVVJMfT9lcnJvcj1zdGF0ZV9taXNtYXRjaGApO1xuICB9XG4gIGMuc2V0Q29va2llKHN0YXRlQ29va2llLm5hbWUsIFwiXCIsIHtcbiAgICBtYXhBZ2U6IDBcbiAgfSk7XG4gIGlmIChwYXJzZWREYXRhLmV4cGlyZXNBdCA8IERhdGUubm93KCkpIHtcbiAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKGRhdGEuaWQpO1xuICAgIGNvbnN0IGVycm9yVVJMID0gYy5jb250ZXh0Lm9wdGlvbnMub25BUElFcnJvcj8uZXJyb3JVUkwgfHwgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYDtcbiAgICB0aHJvdyBjLnJlZGlyZWN0KGAke2Vycm9yVVJMfT9lcnJvcj1wbGVhc2VfcmVzdGFydF90aGVfcHJvY2Vzc2ApO1xuICB9XG4gIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoZGF0YS5pZCk7XG4gIHJldHVybiBwYXJzZWREYXRhO1xufVxuXG5mdW5jdGlvbiBkZWNyeXB0T0F1dGhUb2tlbih0b2tlbiwgY3R4KSB7XG4gIGlmICghdG9rZW4pIHJldHVybiB0b2tlbjtcbiAgaWYgKGN0eC5vcHRpb25zLmFjY291bnQ/LmVuY3J5cHRPQXV0aFRva2Vucykge1xuICAgIHJldHVybiBzeW1tZXRyaWNEZWNyeXB0KHtcbiAgICAgIGtleTogY3R4LnNlY3JldCxcbiAgICAgIGRhdGE6IHRva2VuXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRva2VuO1xufVxuZnVuY3Rpb24gc2V0VG9rZW5VdGlsKHRva2VuLCBjdHgpIHtcbiAgaWYgKGN0eC5vcHRpb25zLmFjY291bnQ/LmVuY3J5cHRPQXV0aFRva2VucyAmJiB0b2tlbikge1xuICAgIHJldHVybiBzeW1tZXRyaWNFbmNyeXB0KHtcbiAgICAgIGtleTogY3R4LnNlY3JldCxcbiAgICAgIGRhdGE6IHRva2VuXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRva2VuO1xufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVPQXV0aFVzZXJJbmZvKGMsIHtcbiAgdXNlckluZm8sXG4gIGFjY291bnQsXG4gIGNhbGxiYWNrVVJMLFxuICBkaXNhYmxlU2lnblVwLFxuICBvdmVycmlkZVVzZXJJbmZvXG59KSB7XG4gIGNvbnN0IGRiVXNlciA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZE9BdXRoVXNlcihcbiAgICB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgIGFjY291bnQuYWNjb3VudElkLFxuICAgIGFjY291bnQucHJvdmlkZXJJZFxuICApLmNhdGNoKChlKSA9PiB7XG4gICAgbG9nZ2VyLmVycm9yKFxuICAgICAgXCJCZXR0ZXIgYXV0aCB3YXMgdW5hYmxlIHRvIHF1ZXJ5IHlvdXIgZGF0YWJhc2UuXFxuRXJyb3I6IFwiLFxuICAgICAgZVxuICAgICk7XG4gICAgY29uc3QgZXJyb3JVUkwgPSBjLmNvbnRleHQub3B0aW9ucy5vbkFQSUVycm9yPy5lcnJvclVSTCB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICAgIHRocm93IGMucmVkaXJlY3QoYCR7ZXJyb3JVUkx9P2Vycm9yPWludGVybmFsX3NlcnZlcl9lcnJvcmApO1xuICB9KTtcbiAgbGV0IHVzZXIgPSBkYlVzZXI/LnVzZXI7XG4gIGxldCBpc1JlZ2lzdGVyID0gIXVzZXI7XG4gIGlmIChkYlVzZXIpIHtcbiAgICBjb25zdCBoYXNCZWVuTGlua2VkID0gZGJVc2VyLmFjY291bnRzLmZpbmQoXG4gICAgICAoYSkgPT4gYS5wcm92aWRlcklkID09PSBhY2NvdW50LnByb3ZpZGVySWQgJiYgYS5hY2NvdW50SWQgPT09IGFjY291bnQuYWNjb3VudElkXG4gICAgKTtcbiAgICBpZiAoIWhhc0JlZW5MaW5rZWQpIHtcbiAgICAgIGNvbnN0IHRydXN0ZWRQcm92aWRlcnMgPSBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8udHJ1c3RlZFByb3ZpZGVycztcbiAgICAgIGNvbnN0IGlzVHJ1c3RlZFByb3ZpZGVyID0gdHJ1c3RlZFByb3ZpZGVycz8uaW5jbHVkZXMoXG4gICAgICAgIGFjY291bnQucHJvdmlkZXJJZFxuICAgICAgKTtcbiAgICAgIGlmICghaXNUcnVzdGVkUHJvdmlkZXIgJiYgIXVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgfHwgYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmVuYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIGlmIChpc0RldmVsb3BtZW50KCkpIHtcbiAgICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICAgIGBVc2VyIGFscmVhZHkgZXhpc3QgYnV0IGFjY291bnQgaXNuJ3QgbGlua2VkIHRvICR7YWNjb3VudC5wcm92aWRlcklkfS4gVG8gcmVhZCBtb3JlIGFib3V0IGhvdyBhY2NvdW50IGxpbmtpbmcgd29ya3MgaW4gQmV0dGVyIEF1dGggc2VlIGh0dHBzOi8vd3d3LmJldHRlci1hdXRoLmNvbS9kb2NzL2NvbmNlcHRzL3VzZXJzLWFjY291bnRzI2FjY291bnQtbGlua2luZy5gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBcImFjY291bnQgbm90IGxpbmtlZFwiLFxuICAgICAgICAgIGRhdGE6IG51bGxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoXG4gICAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkLFxuICAgICAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgdXNlcklkOiBkYlVzZXIudXNlci5pZCxcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgaWRUb2tlbjogYWNjb3VudC5pZFRva2VuLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNcbiAgICAgICAgKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiVW5hYmxlIHRvIGxpbmsgYWNjb3VudFwiLCBlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBlcnJvcjogXCJ1bmFibGUgdG8gbGluayBhY2NvdW50XCIsXG4gICAgICAgICAgZGF0YTogbnVsbFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKHVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgJiYgIWRiVXNlci51c2VyLmVtYWlsVmVyaWZpZWQgJiYgdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSA9PT0gZGJVc2VyLnVzZXIuZW1haWwpIHtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKGRiVXNlci51c2VyLmlkLCB7XG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LnVwZGF0ZUFjY291bnRPblNpZ25JbiAhPT0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgICBPYmplY3QuZW50cmllcyh7XG4gICAgICAgICAgICBpZFRva2VuOiBhY2NvdW50LmlkVG9rZW4sXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQuYWNjZXNzVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChhY2NvdW50LnJlZnJlc2hUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiBhY2NvdW50LnJlZnJlc2hUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICAgIHNjb3BlOiBhY2NvdW50LnNjb3BlXG4gICAgICAgICAgfSkuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gdm9pZCAwKVxuICAgICAgICApO1xuICAgICAgICBpZiAoT2JqZWN0LmtleXModXBkYXRlRGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChcbiAgICAgICAgICAgIGhhc0JlZW5MaW5rZWQuaWQsXG4gICAgICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICAgICAgY1xuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh1c2VySW5mby5lbWFpbFZlcmlmaWVkICYmICFkYlVzZXIudXNlci5lbWFpbFZlcmlmaWVkICYmIHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCkgPT09IGRiVXNlci51c2VyLmVtYWlsKSB7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihkYlVzZXIudXNlci5pZCwge1xuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChvdmVycmlkZVVzZXJJbmZvKSB7XG4gICAgICBjb25zdCB7IGlkOiBfLCAuLi5yZXN0VXNlckluZm8gfSA9IHVzZXJJbmZvO1xuICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKGRiVXNlci51c2VyLmlkLCB7XG4gICAgICAgIC4uLnJlc3RVc2VySW5mbyxcbiAgICAgICAgZW1haWw6IHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCkgPT09IGRiVXNlci51c2VyLmVtYWlsID8gZGJVc2VyLnVzZXIuZW1haWxWZXJpZmllZCB8fCB1c2VySW5mby5lbWFpbFZlcmlmaWVkIDogdXNlckluZm8uZW1haWxWZXJpZmllZFxuICAgICAgfSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChkaXNhYmxlU2lnblVwKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlcnJvcjogXCJzaWdudXAgZGlzYWJsZWRcIixcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGlkOiBfLCAuLi5yZXN0VXNlckluZm8gfSA9IHVzZXJJbmZvO1xuICAgICAgdXNlciA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlT0F1dGhVc2VyKFxuICAgICAgICB7XG4gICAgICAgICAgLi4ucmVzdFVzZXJJbmZvLFxuICAgICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQuYWNjZXNzVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5yZWZyZXNoVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgaWRUb2tlbjogYWNjb3VudC5pZFRva2VuLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5yZWZyZXNoVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGUsXG4gICAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkLFxuICAgICAgICAgIGFjY291bnRJZDogdXNlckluZm8uaWQudG9TdHJpbmcoKVxuICAgICAgICB9LFxuICAgICAgICBjXG4gICAgICApLnRoZW4oKHJlcykgPT4gcmVzPy51c2VyKTtcbiAgICAgIGlmICghdXNlckluZm8uZW1haWxWZXJpZmllZCAmJiB1c2VyICYmIGMuY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduVXApIHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICAgIGMuY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgdXNlci5lbWFpbCxcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgYy5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICAgICApO1xuICAgICAgICBjb25zdCB1cmwgPSBgJHtjLmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y2FsbGJhY2tVUkx9YDtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB0b2tlblxuICAgICAgICAgIH0sXG4gICAgICAgICAgYy5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nZ2VyLmVycm9yKGUpO1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBlLm1lc3NhZ2UsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXJyb3I6IFwidW5hYmxlIHRvIGNyZWF0ZSB1c2VyXCIsXG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBpZiAoIXVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3I6IFwidW5hYmxlIHRvIGNyZWF0ZSB1c2VyXCIsXG4gICAgICBkYXRhOiBudWxsLFxuICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICB9O1xuICB9XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24odXNlci5pZCwgYyk7XG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7XG4gICAgICBlcnJvcjogXCJ1bmFibGUgdG8gY3JlYXRlIHNlc3Npb25cIixcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBkYXRhOiB7XG4gICAgICBzZXNzaW9uLFxuICAgICAgdXNlclxuICAgIH0sXG4gICAgZXJyb3I6IG51bGwsXG4gICAgaXNSZWdpc3RlclxuICB9O1xufVxuXG5jb25zdCBzaWduSW5Tb2NpYWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NpZ24taW4vc29jaWFsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyXG4gICAgICAgKiBoYXMgc2lnbmVkIGluLlxuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGhhcyBzaWduZWQgaW5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogY2FsbGJhY2sgdXJsIHRvIHJlZGlyZWN0IGlmIHRoZSB1c2VyIGlzIG5ld2x5IHJlZ2lzdGVyZWQuXG4gICAgICAgKlxuICAgICAgICogdXNlZnVsIGlmIHlvdSBoYXZlIGRpZmZlcmVudCByb3V0ZXMgZm9yIGV4aXN0aW5nIHVzZXJzIGFuZCBuZXcgdXNlcnNcbiAgICAgICAqL1xuICAgICAgbmV3VXNlckNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIHVybCB0byByZWRpcmVjdCB0byBpZiBhbiBlcnJvciBoYXBwZW5zXG4gICAgICAgKlxuICAgICAgICogSWYgaXQncyBpbml0aWF0ZWQgZnJvbSB0aGUgY2xpZW50IHNkayB0aGlzIGRlZmF1bHRzIHRvXG4gICAgICAgKiB0aGUgY3VycmVudCB1cmwuXG4gICAgICAgKi9cbiAgICAgIGVycm9yQ2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBpZiBhbiBlcnJvciBoYXBwZW5zXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIE9BdXRoMiBwcm92aWRlciB0byB1c2VgXG4gICAgICAgKi9cbiAgICAgIHByb3ZpZGVyOiBTb2NpYWxQcm92aWRlckxpc3RFbnVtLFxuICAgICAgLyoqXG4gICAgICAgKiBEaXNhYmxlIGF1dG9tYXRpYyByZWRpcmVjdGlvbiB0byB0aGUgcHJvdmlkZXJcbiAgICAgICAqXG4gICAgICAgKiBUaGlzIGlzIHVzZWZ1bCBpZiB5b3Ugd2FudCB0byBoYW5kbGUgdGhlIHJlZGlyZWN0aW9uXG4gICAgICAgKiB5b3Vyc2VsZiBsaWtlIGluIGEgcG9wdXAgb3IgYSBkaWZmZXJlbnQgdGFiLlxuICAgICAgICovXG4gICAgICBkaXNhYmxlUmVkaXJlY3Q6IHouYm9vbGVhbigpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIGF1dG9tYXRpYyByZWRpcmVjdGlvbiB0byB0aGUgcHJvdmlkZXIuIFVzZWZ1bCBmb3IgaGFuZGxpbmcgdGhlIHJlZGlyZWN0aW9uIHlvdXJzZWxmXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIElEIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXG4gICAgICAgKlxuICAgICAgICogVGhpcyBpcyB1c2VkIHRvIHNpZ24gaW4gdGhlIHVzZXJcbiAgICAgICAqIGlmIHRoZSB1c2VyIGlzIGFscmVhZHkgc2lnbmVkIGluIHdpdGggdGhlXG4gICAgICAgKiBwcm92aWRlciBpbiB0aGUgZnJvbnRlbmQuXG4gICAgICAgKlxuICAgICAgICogT25seSBhcHBsaWNhYmxlIGlmIHRoZSBwcm92aWRlciBzdXBwb3J0c1xuICAgICAgICogaXQuIEN1cnJlbnRseSBvbmx5IGBhcHBsZWAgYW5kIGBnb29nbGVgIGlzXG4gICAgICAgKiBzdXBwb3J0ZWQgb3V0IG9mIHRoZSBib3guXG4gICAgICAgKi9cbiAgICAgIGlkVG9rZW46IHoub3B0aW9uYWwoXG4gICAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICAgICAqL1xuICAgICAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSUQgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcIlxuICAgICAgICAgIH0pLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFRoZSBub25jZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSB0b2tlblxuICAgICAgICAgICAqL1xuICAgICAgICAgIG5vbmNlOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTm9uY2UgdXNlZCB0byBnZW5lcmF0ZSB0aGUgdG9rZW5cIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQWNjZXNzIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXG4gICAgICAgICAgICovXG4gICAgICAgICAgYWNjZXNzVG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogUmVmcmVzaCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICAgICAqL1xuICAgICAgICAgIHJlZnJlc2hUb2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlZnJlc2ggdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogRXhwaXJ5IGRhdGUgb2YgdGhlIHRva2VuXG4gICAgICAgICAgICovXG4gICAgICAgICAgZXhwaXJlc0F0OiB6Lm51bWJlcigpLm1ldGEoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRXhwaXJ5IGRhdGUgb2YgdGhlIHRva2VuXCJcbiAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgc2NvcGVzOiB6LmFycmF5KHouc3RyaW5nKCkpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJBcnJheSBvZiBzY29wZXMgdG8gcmVxdWVzdCBmcm9tIHRoZSBwcm92aWRlci4gVGhpcyB3aWxsIG92ZXJyaWRlIHRoZSBkZWZhdWx0IHNjb3BlcyBwYXNzZWQuXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIEV4cGxpY2l0bHkgcmVxdWVzdCBzaWduLXVwXG4gICAgICAgKlxuICAgICAgICogU2hvdWxkIGJlIHVzZWQgdG8gYWxsb3cgc2lnbiB1cCB3aGVuXG4gICAgICAgKiBkaXNhYmxlSW1wbGljaXRTaWduVXAgZm9yIHRoaXMgcHJvdmlkZXIgaXNcbiAgICAgICAqIHRydWVcbiAgICAgICAqL1xuICAgICAgcmVxdWVzdFNpZ25VcDogei5ib29sZWFuKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkV4cGxpY2l0bHkgcmVxdWVzdCBzaWduLXVwLiBVc2VmdWwgd2hlbiBkaXNhYmxlSW1wbGljaXRTaWduVXAgaXMgdHJ1ZSBmb3IgdGhpcyBwcm92aWRlclwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgbG9naW4gaGludCB0byB1c2UgZm9yIHRoZSBhdXRob3JpemF0aW9uIGNvZGUgcmVxdWVzdFxuICAgICAgICovXG4gICAgICBsb2dpbkhpbnQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBsb2dpbiBoaW50IHRvIHVzZSBmb3IgdGhlIGF1dGhvcml6YXRpb24gY29kZSByZXF1ZXN0XCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggYSBzb2NpYWwgcHJvdmlkZXJcIixcbiAgICAgICAgb3BlcmF0aW9uSWQ6IFwic29jaWFsU2lnbkluXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3MgLSBSZXR1cm5zIGVpdGhlciBzZXNzaW9uIGRldGFpbHMgb3IgcmVkaXJlY3QgVVJMXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAvLyB0b2RvOiB3ZSBuZWVkIHN1cHBvcnQgZm9yIG11bHRpcGxlIHNjaGVtYVxuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlc3Npb24gcmVzcG9uc2Ugd2hlbiBpZFRva2VuIGlzIHByb3ZpZGVkXCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZW51bTogW2ZhbHNlXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2Vzc2lvbiB0b2tlblwiLFxuICAgICAgICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJudWxsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsVmVyaWZpZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cGRhdGVkQXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJyZWRpcmVjdFwiLCBcInRva2VuXCIsIFwidXNlclwiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGMpID0+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLmJvZHkucHJvdmlkZXJcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gYWRkIHRoZSBwcm92aWRlciBpbiB5b3VyIGF1dGggY29uZmlnXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBST1ZJREVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjLmJvZHkuaWRUb2tlbikge1xuICAgICAgaWYgKCFwcm92aWRlci52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJQcm92aWRlciBkb2VzIG5vdCBzdXBwb3J0IGlkIHRva2VuIHZlcmlmaWNhdGlvblwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JRF9UT0tFTl9OT1RfU1VQUE9SVEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyB0b2tlbiwgbm9uY2UgfSA9IGMuYm9keS5pZFRva2VuO1xuICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIGlkIHRva2VuXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJJbmZvID0gYXdhaXQgcHJvdmlkZXIuZ2V0VXNlckluZm8oe1xuICAgICAgICBpZFRva2VuOiB0b2tlbixcbiAgICAgICAgYWNjZXNzVG9rZW46IGMuYm9keS5pZFRva2VuLmFjY2Vzc1Rva2VuLFxuICAgICAgICByZWZyZXNoVG9rZW46IGMuYm9keS5pZFRva2VuLnJlZnJlc2hUb2tlblxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXJJbmZvIHx8ICF1c2VySW5mbz8udXNlcikge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9cIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICghdXNlckluZm8udXNlci5lbWFpbCkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlciBlbWFpbCBub3QgZm91bmRcIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX0VNQUlMX05PVF9GT1VORFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBoYW5kbGVPQXV0aFVzZXJJbmZvKGMsIHtcbiAgICAgICAgdXNlckluZm86IHtcbiAgICAgICAgICAuLi51c2VySW5mby51c2VyLFxuICAgICAgICAgIGVtYWlsOiB1c2VySW5mby51c2VyLmVtYWlsLFxuICAgICAgICAgIGlkOiBTdHJpbmcodXNlckluZm8udXNlci5pZCksXG4gICAgICAgICAgbmFtZTogdXNlckluZm8udXNlci5uYW1lIHx8IFwiXCIsXG4gICAgICAgICAgaW1hZ2U6IHVzZXJJbmZvLnVzZXIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlckluZm8udXNlci5lbWFpbFZlcmlmaWVkIHx8IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGFjY291bnQ6IHtcbiAgICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgICBhY2NvdW50SWQ6IFN0cmluZyh1c2VySW5mby51c2VyLmlkKSxcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogYy5ib2R5LmlkVG9rZW4uYWNjZXNzVG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY2FsbGJhY2tVUkw6IGMuYm9keS5jYWxsYmFja1VSTCxcbiAgICAgICAgZGlzYWJsZVNpZ25VcDogcHJvdmlkZXIuZGlzYWJsZUltcGxpY2l0U2lnblVwICYmICFjLmJvZHkucmVxdWVzdFNpZ25VcCB8fCBwcm92aWRlci5kaXNhYmxlU2lnblVwXG4gICAgICB9KTtcbiAgICAgIGlmIChkYXRhLmVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogZGF0YS5lcnJvclxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoYywgZGF0YS5kYXRhKTtcbiAgICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgICByZWRpcmVjdDogZmFsc2UsXG4gICAgICAgIHRva2VuOiBkYXRhLmRhdGEuc2Vzc2lvbi50b2tlbixcbiAgICAgICAgdXJsOiB2b2lkIDAsXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogZGF0YS5kYXRhLnVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IGRhdGEuZGF0YS51c2VyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IGRhdGEuZGF0YS51c2VyLm5hbWUsXG4gICAgICAgICAgaW1hZ2U6IGRhdGEuZGF0YS51c2VyLmltYWdlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGRhdGEuZGF0YS51c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmRhdGEudXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgdXBkYXRlZEF0OiBkYXRhLmRhdGEudXNlci51cGRhdGVkQXRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgY29kZVZlcmlmaWVyLCBzdGF0ZSB9ID0gYXdhaXQgZ2VuZXJhdGVTdGF0ZShjKTtcbiAgICBjb25zdCB1cmwgPSBhd2FpdCBwcm92aWRlci5jcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgIHN0YXRlLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUkk6IGAke2MuY29udGV4dC5iYXNlVVJMfS9jYWxsYmFjay8ke3Byb3ZpZGVyLmlkfWAsXG4gICAgICBzY29wZXM6IGMuYm9keS5zY29wZXMsXG4gICAgICBsb2dpbkhpbnQ6IGMuYm9keS5sb2dpbkhpbnRcbiAgICB9KTtcbiAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgIHVybDogdXJsLnRvU3RyaW5nKCksXG4gICAgICByZWRpcmVjdDogIWMuYm9keS5kaXNhYmxlUmVkaXJlY3RcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHNpZ25JbkVtYWlsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLWluL2VtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogRW1haWwgb2YgdGhlIHVzZXJcbiAgICAgICAqL1xuICAgICAgZW1haWw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIG9mIHRoZSB1c2VyXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBQYXNzd29yZCBvZiB0aGUgdXNlclxuICAgICAgICovXG4gICAgICBwYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUGFzc3dvcmQgb2YgdGhlIHVzZXJcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byB1c2UgYXMgYSByZWRpcmVjdCBmb3IgZW1haWxcbiAgICAgICAqIHZlcmlmaWNhdGlvbiBhbmQgZm9yIHBvc3NpYmxlIHJlZGlyZWN0c1xuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgVVJMIHRvIHVzZSBhcyBhIHJlZGlyZWN0IGZvciBlbWFpbCB2ZXJpZmljYXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogSWYgdGhpcyBpcyBmYWxzZSwgdGhlIHNlc3Npb24gd2lsbCBub3QgYmUgcmVtZW1iZXJlZFxuICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICovXG4gICAgICByZW1lbWJlck1lOiB6LmJvb2xlYW4oKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiSWYgdGhpcyBpcyBmYWxzZSwgdGhlIHNlc3Npb24gd2lsbCBub3QgYmUgcmVtZW1iZXJlZC4gRGVmYXVsdCBpcyBgdHJ1ZWAuXCJcbiAgICAgIH0pLmRlZmF1bHQodHJ1ZSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gaW4gd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmRcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2VzcyAtIFJldHVybnMgZWl0aGVyIHNlc3Npb24gZGV0YWlscyBvciByZWRpcmVjdCBVUkxcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIC8vIHRvZG86IHdlIG5lZWQgc3VwcG9ydCBmb3IgbXVsdGlwbGUgc2NoZW1hXG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2Vzc2lvbiByZXNwb25zZSB3aGVuIGlkVG9rZW4gaXMgcHJvdmlkZWRcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbZmFsc2VdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXNzaW9uIHRva2VuXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJudWxsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cGRhdGVkQXRcIlxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJyZWRpcmVjdFwiLCBcInRva2VuXCIsIFwidXNlclwiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucz8uZW1haWxBbmRQYXNzd29yZD8uZW5hYmxlZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIkVtYWlsIGFuZCBwYXNzd29yZCBpcyBub3QgZW5hYmxlZC4gTWFrZSBzdXJlIHRvIGVuYWJsZSBpdCBpbiB0aGUgb3B0aW9ucyBvbiB5b3UgYGF1dGgudHNgIGZpbGUuIENoZWNrIGBodHRwczovL2JldHRlci1hdXRoLmNvbS9kb2NzL2F1dGhlbnRpY2F0aW9uL2VtYWlsLXBhc3N3b3JkYCBmb3IgbW9yZSFcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJFbWFpbCBhbmQgcGFzc3dvcmQgaXMgbm90IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBpc1ZhbGlkRW1haWwgPSB6LnN0cmluZygpLmVtYWlsKCkuc2FmZVBhcnNlKGVtYWlsKTtcbiAgICBpZiAoIWlzVmFsaWRFbWFpbC5zdWNjZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsLCB7XG4gICAgICBpbmNsdWRlQWNjb3VudHM6IHRydWVcbiAgICB9KTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2gocGFzc3dvcmQpO1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlciBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNyZWRlbnRpYWxBY2NvdW50ID0gdXNlci5hY2NvdW50cy5maW5kKFxuICAgICAgKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCJcbiAgICApO1xuICAgIGlmICghY3JlZGVudGlhbEFjY291bnQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkNyZWRlbnRpYWwgYWNjb3VudCBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGN1cnJlbnRQYXNzd29yZCA9IGNyZWRlbnRpYWxBY2NvdW50Py5wYXNzd29yZDtcbiAgICBpZiAoIWN1cnJlbnRQYXNzd29yZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB2YWxpZFBhc3N3b3JkID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICAgIGhhc2g6IGN1cnJlbnRQYXNzd29yZCxcbiAgICAgIHBhc3N3b3JkXG4gICAgfSk7XG4gICAgaWYgKCF2YWxpZFBhc3N3b3JkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIHBhc3N3b3JkXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnM/LmVtYWlsQW5kUGFzc3dvcmQ/LnJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbiAmJiAhdXNlci51c2VyLmVtYWlsVmVyaWZpZWQpIHtcbiAgICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucz8uZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRU1BSUxfTk9UX1ZFUklGSUVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnM/LmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduSW4pIHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICB1c2VyLnVzZXIuZW1haWwsXG4gICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICAgICApO1xuICAgICAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLnNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VyOiB1c2VyLnVzZXIsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB0b2tlblxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRU1BSUxfTk9UX1ZFUklGSUVEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgdXNlci51c2VyLmlkLFxuICAgICAgY3R4LFxuICAgICAgY3R4LmJvZHkucmVtZW1iZXJNZSA9PT0gZmFsc2VcbiAgICApO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgY3R4LFxuICAgICAge1xuICAgICAgICBzZXNzaW9uLFxuICAgICAgICB1c2VyOiB1c2VyLnVzZXJcbiAgICAgIH0sXG4gICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHJlZGlyZWN0OiAhIWN0eC5ib2R5LmNhbGxiYWNrVVJMLFxuICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICB1cmw6IGN0eC5ib2R5LmNhbGxiYWNrVVJMLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogdXNlci51c2VyLmlkLFxuICAgICAgICBlbWFpbDogdXNlci51c2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiB1c2VyLnVzZXIubmFtZSxcbiAgICAgICAgaW1hZ2U6IHVzZXIudXNlci5pbWFnZSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci51c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogdXNlci51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVzZXIudXBkYXRlZEF0XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbik7XG5cbmNvbnN0IHNjaGVtYSA9IHoub2JqZWN0KHtcbiAgY29kZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBlcnJvcjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBkZXZpY2VfaWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZXJyb3JfZGVzY3JpcHRpb246IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgc3RhdGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdXNlcjogei5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbmNvbnN0IGNhbGxiYWNrT0F1dGggPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2NhbGxiYWNrLzppZFwiLFxuICB7XG4gICAgbWV0aG9kOiBbXCJHRVRcIiwgXCJQT1NUXCJdLFxuICAgIGJvZHk6IHNjaGVtYS5vcHRpb25hbCgpLFxuICAgIHF1ZXJ5OiBzY2hlbWEub3B0aW9uYWwoKSxcbiAgICBtZXRhZGF0YTogSElERV9NRVRBREFUQVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGxldCBxdWVyeU9yQm9keTtcbiAgICBjb25zdCBkZWZhdWx0RXJyb3JVUkwgPSBjLmNvbnRleHQub3B0aW9ucy5vbkFQSUVycm9yPy5lcnJvclVSTCB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICAgIHRyeSB7XG4gICAgICBpZiAoYy5tZXRob2QgPT09IFwiR0VUXCIpIHtcbiAgICAgICAgcXVlcnlPckJvZHkgPSBzY2hlbWEucGFyc2UoYy5xdWVyeSk7XG4gICAgICB9IGVsc2UgaWYgKGMubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgICAgICBxdWVyeU9yQm9keSA9IHNjaGVtYS5wYXJzZShjLmJvZHkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgbWV0aG9kXCIpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJTlZBTElEX0NBTExCQUNLX1JFUVVFU1RcIiwgZSk7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KGAke2RlZmF1bHRFcnJvclVSTH0/ZXJyb3I9aW52YWxpZF9jYWxsYmFja19yZXF1ZXN0YCk7XG4gICAgfVxuICAgIGNvbnN0IHsgY29kZSwgZXJyb3IsIHN0YXRlLCBlcnJvcl9kZXNjcmlwdGlvbiwgZGV2aWNlX2lkIH0gPSBxdWVyeU9yQm9keTtcbiAgICBpZiAoIXN0YXRlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiU3RhdGUgbm90IGZvdW5kXCIsIGVycm9yKTtcbiAgICAgIGNvbnN0IHNlcCA9IGRlZmF1bHRFcnJvclVSTC5pbmNsdWRlcyhcIj9cIikgPyBcIiZcIiA6IFwiP1wiO1xuICAgICAgY29uc3QgdXJsID0gYCR7ZGVmYXVsdEVycm9yVVJMfSR7c2VwfXN0YXRlPXN0YXRlX25vdF9mb3VuZGA7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KHVybCk7XG4gICAgfVxuICAgIGNvbnN0IHtcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIGNhbGxiYWNrVVJMLFxuICAgICAgbGluayxcbiAgICAgIGVycm9yVVJMLFxuICAgICAgbmV3VXNlclVSTCxcbiAgICAgIHJlcXVlc3RTaWduVXBcbiAgICB9ID0gYXdhaXQgcGFyc2VTdGF0ZShjKTtcbiAgICBmdW5jdGlvbiByZWRpcmVjdE9uRXJyb3IoZXJyb3IyLCBkZXNjcmlwdGlvbikge1xuICAgICAgY29uc3QgYmFzZVVSTCA9IGVycm9yVVJMID8/IGRlZmF1bHRFcnJvclVSTDtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoeyBlcnJvcjogZXJyb3IyIH0pO1xuICAgICAgaWYgKGRlc2NyaXB0aW9uKSBwYXJhbXMuc2V0KFwiZXJyb3JfZGVzY3JpcHRpb25cIiwgZGVzY3JpcHRpb24pO1xuICAgICAgY29uc3Qgc2VwID0gYmFzZVVSTC5pbmNsdWRlcyhcIj9cIikgPyBcIiZcIiA6IFwiP1wiO1xuICAgICAgY29uc3QgdXJsID0gYCR7YmFzZVVSTH0ke3NlcH0ke3BhcmFtcy50b1N0cmluZygpfWA7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KHVybCk7XG4gICAgfVxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmVkaXJlY3RPbkVycm9yKGVycm9yLCBlcnJvcl9kZXNjcmlwdGlvbik7XG4gICAgfVxuICAgIGlmICghY29kZSkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkNvZGUgbm90IGZvdW5kXCIpO1xuICAgICAgdGhyb3cgcmVkaXJlY3RPbkVycm9yKFwibm9fY29kZVwiKTtcbiAgICB9XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjLmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gYy5wYXJhbXMuaWRcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiT2F1dGggcHJvdmlkZXIgd2l0aCBpZFwiLFxuICAgICAgICBjLnBhcmFtcy5pZCxcbiAgICAgICAgXCJub3QgZm91bmRcIlxuICAgICAgKTtcbiAgICAgIHRocm93IHJlZGlyZWN0T25FcnJvcihcIm9hdXRoX3Byb3ZpZGVyX25vdF9mb3VuZFwiKTtcbiAgICB9XG4gICAgbGV0IHRva2VucztcbiAgICB0cnkge1xuICAgICAgdG9rZW5zID0gYXdhaXQgcHJvdmlkZXIudmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgZGV2aWNlSWQ6IGRldmljZV9pZCxcbiAgICAgICAgcmVkaXJlY3RVUkk6IGAke2MuY29udGV4dC5iYXNlVVJMfS9jYWxsYmFjay8ke3Byb3ZpZGVyLmlkfWBcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJcIiwgZSk7XG4gICAgICB0aHJvdyByZWRpcmVjdE9uRXJyb3IoXCJpbnZhbGlkX2NvZGVcIik7XG4gICAgfVxuICAgIGNvbnN0IHVzZXJJbmZvID0gYXdhaXQgcHJvdmlkZXIuZ2V0VXNlckluZm8oe1xuICAgICAgLi4udG9rZW5zLFxuICAgICAgdXNlcjogYy5ib2R5Py51c2VyID8gc2FmZUpTT05QYXJzZShjLmJvZHkudXNlcikgOiB2b2lkIDBcbiAgICB9KS50aGVuKChyZXMpID0+IHJlcz8udXNlcik7XG4gICAgaWYgKCF1c2VySW5mbykge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVuYWJsZSB0byBnZXQgdXNlciBpbmZvXCIpO1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYWJsZV90b19nZXRfdXNlcl9pbmZvXCIpO1xuICAgIH1cbiAgICBpZiAoIWNhbGxiYWNrVVJMKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiTm8gY2FsbGJhY2sgVVJMIGZvdW5kXCIpO1xuICAgICAgdGhyb3cgcmVkaXJlY3RPbkVycm9yKFwibm9fY2FsbGJhY2tfdXJsXCIpO1xuICAgIH1cbiAgICBpZiAobGluaykge1xuICAgICAgY29uc3QgdHJ1c3RlZFByb3ZpZGVycyA9IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzO1xuICAgICAgY29uc3QgaXNUcnVzdGVkUHJvdmlkZXIgPSB0cnVzdGVkUHJvdmlkZXJzPy5pbmNsdWRlcyhcbiAgICAgICAgcHJvdmlkZXIuaWRcbiAgICAgICk7XG4gICAgICBpZiAoIWlzVHJ1c3RlZFByb3ZpZGVyICYmICF1c2VySW5mby5lbWFpbFZlcmlmaWVkIHx8IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVW5hYmxlIHRvIGxpbmsgYWNjb3VudCAtIHVudHJ1c3RlZCBwcm92aWRlclwiKTtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYWJsZV90b19saW5rX2FjY291bnRcIik7XG4gICAgICB9XG4gICAgICBpZiAodXNlckluZm8uZW1haWwgIT09IGxpbmsuZW1haWwgJiYgYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93RGlmZmVyZW50RW1haWxzICE9PSB0cnVlKSB7XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJlbWFpbF9kb2Vzbid0X21hdGNoXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgZXhpc3RpbmdBY2NvdW50ID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudChcbiAgICAgICAgU3RyaW5nKHVzZXJJbmZvLmlkKVxuICAgICAgKTtcbiAgICAgIGlmIChleGlzdGluZ0FjY291bnQpIHtcbiAgICAgICAgaWYgKGV4aXN0aW5nQWNjb3VudC51c2VySWQudG9TdHJpbmcoKSAhPT0gbGluay51c2VySWQudG9TdHJpbmcoKSkge1xuICAgICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJhY2NvdW50X2FscmVhZHlfbGlua2VkX3RvX2RpZmZlcmVudF91c2VyXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICAgICAgT2JqZWN0LmVudHJpZXMoe1xuICAgICAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMuYWNjZXNzVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgaWRUb2tlbjogdG9rZW5zLmlkVG9rZW4sXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogdG9rZW5zLmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiB0b2tlbnMucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgc2NvcGU6IHRva2Vucy5zY29wZXM/LmpvaW4oXCIsXCIpXG4gICAgICAgICAgfSkuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gdm9pZCAwKVxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZUFjY291bnQoXG4gICAgICAgICAgZXhpc3RpbmdBY2NvdW50LmlkLFxuICAgICAgICAgIHVwZGF0ZURhdGFcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG5ld0FjY291bnQgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcklkOiBsaW5rLnVzZXJJZCxcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICAgICAgYWNjb3VudElkOiBTdHJpbmcodXNlckluZm8uaWQpLFxuICAgICAgICAgICAgLi4udG9rZW5zLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMuYWNjZXNzVG9rZW4sIGMuY29udGV4dCksXG4gICAgICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgc2NvcGU6IHRva2Vucy5zY29wZXM/LmpvaW4oXCIsXCIpXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjXG4gICAgICAgICk7XG4gICAgICAgIGlmICghbmV3QWNjb3VudCkge1xuICAgICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmFibGVfdG9fbGlua19hY2NvdW50XCIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsZXQgdG9SZWRpcmVjdFRvMjtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVybCA9IGNhbGxiYWNrVVJMO1xuICAgICAgICB0b1JlZGlyZWN0VG8yID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgdG9SZWRpcmVjdFRvMiA9IGNhbGxiYWNrVVJMO1xuICAgICAgfVxuICAgICAgdGhyb3cgYy5yZWRpcmVjdCh0b1JlZGlyZWN0VG8yKTtcbiAgICB9XG4gICAgaWYgKCF1c2VySW5mby5lbWFpbCkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJQcm92aWRlciBkaWQgbm90IHJldHVybiBlbWFpbC4gVGhpcyBjb3VsZCBiZSBkdWUgdG8gbWlzY29uZmlndXJhdGlvbiBpbiB0aGUgcHJvdmlkZXIgc2V0dGluZ3MuXCJcbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiZW1haWxfbm90X2ZvdW5kXCIpO1xuICAgIH1cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVPQXV0aFVzZXJJbmZvKGMsIHtcbiAgICAgIHVzZXJJbmZvOiB7XG4gICAgICAgIC4uLnVzZXJJbmZvLFxuICAgICAgICBpZDogU3RyaW5nKHVzZXJJbmZvLmlkKSxcbiAgICAgICAgZW1haWw6IHVzZXJJbmZvLmVtYWlsLFxuICAgICAgICBuYW1lOiB1c2VySW5mby5uYW1lIHx8IHVzZXJJbmZvLmVtYWlsXG4gICAgICB9LFxuICAgICAgYWNjb3VudDoge1xuICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgYWNjb3VudElkOiBTdHJpbmcodXNlckluZm8uaWQpLFxuICAgICAgICAuLi50b2tlbnMsXG4gICAgICAgIHNjb3BlOiB0b2tlbnMuc2NvcGVzPy5qb2luKFwiLFwiKVxuICAgICAgfSxcbiAgICAgIGNhbGxiYWNrVVJMLFxuICAgICAgZGlzYWJsZVNpZ25VcDogcHJvdmlkZXIuZGlzYWJsZUltcGxpY2l0U2lnblVwICYmICFyZXF1ZXN0U2lnblVwIHx8IHByb3ZpZGVyLm9wdGlvbnM/LmRpc2FibGVTaWduVXAsXG4gICAgICBvdmVycmlkZVVzZXJJbmZvOiBwcm92aWRlci5vcHRpb25zPy5vdmVycmlkZVVzZXJJbmZvT25TaWduSW5cbiAgICB9KTtcbiAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKHJlc3VsdC5lcnJvci5zcGxpdChcIiBcIikuam9pbihcIl9cIikpO1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihyZXN1bHQuZXJyb3Iuc3BsaXQoXCIgXCIpLmpvaW4oXCJfXCIpKTtcbiAgICB9XG4gICAgY29uc3QgeyBzZXNzaW9uLCB1c2VyIH0gPSByZXN1bHQuZGF0YTtcbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGMsIHtcbiAgICAgIHNlc3Npb24sXG4gICAgICB1c2VyXG4gICAgfSk7XG4gICAgbGV0IHRvUmVkaXJlY3RUbztcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXJsID0gcmVzdWx0LmlzUmVnaXN0ZXIgPyBuZXdVc2VyVVJMIHx8IGNhbGxiYWNrVVJMIDogY2FsbGJhY2tVUkw7XG4gICAgICB0b1JlZGlyZWN0VG8gPSB1cmwudG9TdHJpbmcoKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHRvUmVkaXJlY3RUbyA9IHJlc3VsdC5pc1JlZ2lzdGVyID8gbmV3VXNlclVSTCB8fCBjYWxsYmFja1VSTCA6IGNhbGxiYWNrVVJMO1xuICAgIH1cbiAgICB0aHJvdyBjLnJlZGlyZWN0KHRvUmVkaXJlY3RUbyk7XG4gIH1cbik7XG5cbmNvbnN0IHNpZ25PdXQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NpZ24tb3V0XCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gb3V0IHRoZSBjdXJyZW50IHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uQ29va2llVG9rZW4gPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICApO1xuICAgIGlmICghc2Vzc2lvbkNvb2tpZVRva2VuKSB7XG4gICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0dFVF9TRVNTSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oc2Vzc2lvbkNvb2tpZVRva2VuKTtcbiAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcblxuZnVuY3Rpb24gcmVkaXJlY3RFcnJvcihjdHgsIGNhbGxiYWNrVVJMLCBxdWVyeSkge1xuICBjb25zdCB1cmwgPSBjYWxsYmFja1VSTCA/IG5ldyBVUkwoY2FsbGJhY2tVUkwsIGN0eC5iYXNlVVJMKSA6IG5ldyBVUkwoYCR7Y3R4LmJhc2VVUkx9L2Vycm9yYCk7XG4gIGlmIChxdWVyeSlcbiAgICBPYmplY3QuZW50cmllcyhxdWVyeSkuZm9yRWFjaCgoW2ssIHZdKSA9PiB1cmwuc2VhcmNoUGFyYW1zLnNldChrLCB2KSk7XG4gIHJldHVybiB1cmwuaHJlZjtcbn1cbmZ1bmN0aW9uIHJlZGlyZWN0Q2FsbGJhY2soY3R4LCBjYWxsYmFja1VSTCwgcXVlcnkpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChjYWxsYmFja1VSTCwgY3R4LmJhc2VVUkwpO1xuICBpZiAocXVlcnkpXG4gICAgT2JqZWN0LmVudHJpZXMocXVlcnkpLmZvckVhY2goKFtrLCB2XSkgPT4gdXJsLnNlYXJjaFBhcmFtcy5zZXQoaywgdikpO1xuICByZXR1cm4gdXJsLmhyZWY7XG59XG5jb25zdCByZXF1ZXN0UGFzc3dvcmRSZXNldCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVxdWVzdC1wYXNzd29yZC1yZXNldFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyIHRvIHNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0by5cbiAgICAgICAqL1xuICAgICAgZW1haWw6IHouZW1haWwoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHJlc2V0IHRoZWlyIHBhc3N3b3JkLlxuICAgICAgICogSWYgdGhlIHRva2VuIGlzbid0IHZhbGlkIG9yIGV4cGlyZWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP1xuICAgICAgICogZXJyb3I9SU5WQUxJRF9UT0tFTmAuIElmIHRoZSB0b2tlbiBpcyB2YWxpZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/XG4gICAgICAgKiB0b2tlbj1WQUxJRF9UT0tFTlxuICAgICAgICovXG4gICAgICByZWRpcmVjdFRvOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHJlc2V0IHRoZWlyIHBhc3N3b3JkLiBJZiB0aGUgdG9rZW4gaXNuJ3QgdmFsaWQgb3IgZXhwaXJlZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/ZXJyb3I9SU5WQUxJRF9UT0tFTmAuIElmIHRoZSB0b2tlbiBpcyB2YWxpZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/dG9rZW49VkFMSURfVE9LRU5cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnNlbmRSZXNldFBhc3N3b3JkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUmVzZXQgcGFzc3dvcmQgaXNuJ3QgZW5hYmxlZC5QbGVhc2UgcGFzcyBhbiBlbWFpbEFuZFBhc3N3b3JkLnNlbmRSZXNldFBhc3N3b3JkIGZ1bmN0aW9uIGluIHlvdXIgYXV0aCBjb25maWchXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiUmVzZXQgcGFzc3dvcmQgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCwgcmVkaXJlY3RUbyB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwsIHtcbiAgICAgIGluY2x1ZGVBY2NvdW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGlmICghdXNlcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUmVzZXQgUGFzc3dvcmQ6IFVzZXIgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiSWYgdGhpcyBlbWFpbCBleGlzdHMgaW4gb3VyIHN5c3RlbSwgY2hlY2sgeW91ciBlbWFpbCBmb3IgdGhlIHJlc2V0IGxpbmtcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGRlZmF1bHRFeHBpcmVzSW4gPSA2MCAqIDYwICogMTtcbiAgICBjb25zdCBleHBpcmVzQXQgPSBnZXREYXRlKFxuICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnJlc2V0UGFzc3dvcmRUb2tlbkV4cGlyZXNJbiB8fCBkZWZhdWx0RXhwaXJlc0luLFxuICAgICAgXCJzZWNcIlxuICAgICk7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uVG9rZW4gPSBnZW5lcmF0ZUlkKDI0KTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICB7XG4gICAgICAgIHZhbHVlOiB1c2VyLnVzZXIuaWQsXG4gICAgICAgIGlkZW50aWZpZXI6IGByZXNldC1wYXNzd29yZDoke3ZlcmlmaWNhdGlvblRva2VufWAsXG4gICAgICAgIGV4cGlyZXNBdFxuICAgICAgfSxcbiAgICAgIGN0eFxuICAgICk7XG4gICAgY29uc3QgY2FsbGJhY2tVUkwgPSByZWRpcmVjdFRvID8gZW5jb2RlVVJJQ29tcG9uZW50KHJlZGlyZWN0VG8pIDogXCJcIjtcbiAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9yZXNldC1wYXNzd29yZC8ke3ZlcmlmaWNhdGlvblRva2VufT9jYWxsYmFja1VSTD0ke2NhbGxiYWNrVVJMfWA7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnNlbmRSZXNldFBhc3N3b3JkKFxuICAgICAge1xuICAgICAgICB1c2VyOiB1c2VyLnVzZXIsXG4gICAgICAgIHVybCxcbiAgICAgICAgdG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICB9LFxuICAgICAgY3R4LnJlcXVlc3RcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIklmIHRoaXMgZW1haWwgZXhpc3RzIGluIG91ciBzeXN0ZW0sIGNoZWNrIHlvdXIgZW1haWwgZm9yIHRoZSByZXNldCBsaW5rXCJcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IGZvcmdldFBhc3N3b3JkID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9mb3JnZXQtcGFzc3dvcmRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgZW1haWwgYWRkcmVzcyBvZiB0aGUgdXNlciB0byBzZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8uXG4gICAgICAgKi9cbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLmVtYWlsKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyIHRvIHNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0b1wiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZC5cbiAgICAgICAqIElmIHRoZSB0b2tlbiBpc24ndCB2YWxpZCBvciBleHBpcmVkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9cbiAgICAgICAqIGVycm9yPUlOVkFMSURfVE9LRU5gLiBJZiB0aGUgdG9rZW4gaXMgdmFsaWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP1xuICAgICAgICogdG9rZW49VkFMSURfVE9LRU5cbiAgICAgICAqL1xuICAgICAgcmVkaXJlY3RUbzogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZC4gSWYgdGhlIHRva2VuIGlzbid0IHZhbGlkIG9yIGV4cGlyZWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP2Vycm9yPUlOVkFMSURfVE9LRU5gLiBJZiB0aGUgdG9rZW4gaXMgdmFsaWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP3Rva2VuPVZBTElEX1RPS0VOXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5zZW5kUmVzZXRQYXNzd29yZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlJlc2V0IHBhc3N3b3JkIGlzbid0IGVuYWJsZWQuUGxlYXNlIHBhc3MgYW4gZW1haWxBbmRQYXNzd29yZC5zZW5kUmVzZXRQYXNzd29yZCBmdW5jdGlvbiBpbiB5b3VyIGF1dGggY29uZmlnIVwiXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlJlc2V0IHBhc3N3b3JkIGlzbid0IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgZW1haWwsIHJlZGlyZWN0VG8gfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsLCB7XG4gICAgICBpbmNsdWRlQWNjb3VudHM6IHRydWVcbiAgICB9KTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlJlc2V0IFBhc3N3b3JkOiBVc2VyIG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBcIklmIHRoaXMgZW1haWwgZXhpc3RzIGluIG91ciBzeXN0ZW0sIGNoZWNrIHlvdXIgZW1haWwgZm9yIHRoZSByZXNldCBsaW5rXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBkZWZhdWx0RXhwaXJlc0luID0gNjAgKiA2MCAqIDE7XG4gICAgY29uc3QgZXhwaXJlc0F0ID0gZ2V0RGF0ZShcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5yZXNldFBhc3N3b3JkVG9rZW5FeHBpcmVzSW4gfHwgZGVmYXVsdEV4cGlyZXNJbixcbiAgICAgIFwic2VjXCJcbiAgICApO1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvblRva2VuID0gZ2VuZXJhdGVJZCgyNCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAge1xuICAgICAgICB2YWx1ZTogdXNlci51c2VyLmlkLFxuICAgICAgICBpZGVudGlmaWVyOiBgcmVzZXQtcGFzc3dvcmQ6JHt2ZXJpZmljYXRpb25Ub2tlbn1gLFxuICAgICAgICBleHBpcmVzQXRcbiAgICAgIH0sXG4gICAgICBjdHhcbiAgICApO1xuICAgIGNvbnN0IGNhbGxiYWNrVVJMID0gcmVkaXJlY3RUbyA/IGVuY29kZVVSSUNvbXBvbmVudChyZWRpcmVjdFRvKSA6IFwiXCI7XG4gICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vcmVzZXQtcGFzc3dvcmQvJHt2ZXJpZmljYXRpb25Ub2tlbn0/Y2FsbGJhY2tVUkw9JHtjYWxsYmFja1VSTH1gO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5zZW5kUmVzZXRQYXNzd29yZChcbiAgICAgIHtcbiAgICAgICAgdXNlcjogdXNlci51c2VyLFxuICAgICAgICB1cmwsXG4gICAgICAgIHRva2VuOiB2ZXJpZmljYXRpb25Ub2tlblxuICAgICAgfSxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCByZXF1ZXN0UGFzc3dvcmRSZXNldENhbGxiYWNrID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXNldC1wYXNzd29yZC86dG9rZW5cIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmRcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtvcmlnaW5DaGVjaygoY3R4KSA9PiBjdHgucXVlcnkuY2FsbGJhY2tVUkwpXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZWRpcmVjdHMgdGhlIHVzZXIgdG8gdGhlIGNhbGxiYWNrIFVSTCB3aXRoIHRoZSB0b2tlblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHsgdG9rZW4gfSA9IGN0eC5wYXJhbXM7XG4gICAgY29uc3QgeyBjYWxsYmFja1VSTCB9ID0gY3R4LnF1ZXJ5O1xuICAgIGlmICghdG9rZW4gfHwgIWNhbGxiYWNrVVJMKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgIHJlZGlyZWN0RXJyb3IoY3R4LmNvbnRleHQsIGNhbGxiYWNrVVJMLCB7IGVycm9yOiBcIklOVkFMSURfVE9LRU5cIiB9KVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIGByZXNldC1wYXNzd29yZDoke3Rva2VufWBcbiAgICApO1xuICAgIGlmICghdmVyaWZpY2F0aW9uIHx8IHZlcmlmaWNhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgICByZWRpcmVjdEVycm9yKGN0eC5jb250ZXh0LCBjYWxsYmFja1VSTCwgeyBlcnJvcjogXCJJTlZBTElEX1RPS0VOXCIgfSlcbiAgICAgICk7XG4gICAgfVxuICAgIHRocm93IGN0eC5yZWRpcmVjdChyZWRpcmVjdENhbGxiYWNrKGN0eC5jb250ZXh0LCBjYWxsYmFja1VSTCwgeyB0b2tlbiB9KSk7XG4gIH1cbik7XG5jb25zdCBmb3JnZXRQYXNzd29yZENhbGxiYWNrID0gcmVxdWVzdFBhc3N3b3JkUmVzZXRDYWxsYmFjaztcbmNvbnN0IHJlc2V0UGFzc3dvcmQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jlc2V0LXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICB0b2tlbjogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSkub3B0aW9uYWwoKSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBuZXdQYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcIlxuICAgICAgfSksXG4gICAgICB0b2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIHJlc2V0IHRoZSBwYXNzd29yZFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVzZXQgdGhlIHBhc3N3b3JkIGZvciBhIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHRva2VuID0gY3R4LmJvZHkudG9rZW4gfHwgY3R4LnF1ZXJ5Py50b2tlbjtcbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgbmV3UGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IG1pbkxlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkPy5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgY29uc3QgbWF4TGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQ/LmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgaWQgPSBgcmVzZXQtcGFzc3dvcmQ6JHt0b2tlbn1gO1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoaWQpO1xuICAgIGlmICghdmVyaWZpY2F0aW9uIHx8IHZlcmlmaWNhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1c2VySWQgPSB2ZXJpZmljYXRpb24udmFsdWU7XG4gICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHModXNlcklkKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZCgoYWMpID0+IGFjLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVBY2NvdW50KFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXNzd29yZCxcbiAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJZFxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVQYXNzd29yZChcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBoYXNoZWRQYXNzd29yZCxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUodmVyaWZpY2F0aW9uLmlkKTtcbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5vblBhc3N3b3JkUmVzZXQpIHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUlkKHVzZXJJZCk7XG4gICAgICBpZiAodXNlcikge1xuICAgICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQub25QYXNzd29yZFJlc2V0KFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnJldm9rZVNlc3Npb25zT25QYXNzd29yZFJlc2V0KSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnModXNlcklkKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG5jb25zdCB1cGRhdGVVc2VyID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi91cGRhdGUtdXNlclwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6LnJlY29yZChcbiAgICAgIHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkZpZWxkIG5hbWUgbXVzdCBiZSBhIHN0cmluZ1wiXG4gICAgICB9KSxcbiAgICAgIHouYW55KClcbiAgICApLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgJEluZmVyOiB7XG4gICAgICAgIGJvZHk6IHt9XG4gICAgICB9LFxuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJVcGRhdGUgdGhlIGN1cnJlbnQgdXNlclwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGltYWdlIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgdXBkYXRlIHdhcyBzdWNjZXNzZnVsXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IGJvZHkgPSBjdHguYm9keTtcbiAgICBpZiAoYm9keS5lbWFpbCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkVNQUlMX0NBTl9OT1RfQkVfVVBEQVRFRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgbmFtZSwgaW1hZ2UsIC4uLnJlc3QgfSA9IGJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgYWRkaXRpb25hbEZpZWxkcyA9IHBhcnNlVXNlcklucHV0KFxuICAgICAgY3R4LmNvbnRleHQub3B0aW9ucyxcbiAgICAgIHJlc3QsXG4gICAgICBcInVwZGF0ZVwiXG4gICAgKTtcbiAgICBpZiAoaW1hZ2UgPT09IHZvaWQgMCAmJiBuYW1lID09PSB2b2lkIDAgJiYgT2JqZWN0LmtleXMoYWRkaXRpb25hbEZpZWxkcykubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiTm8gZmllbGRzIHRvIHVwZGF0ZVwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkLFxuICAgICAge1xuICAgICAgICBuYW1lLFxuICAgICAgICBpbWFnZSxcbiAgICAgICAgLi4uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfSxcbiAgICAgIGN0eFxuICAgICk7XG4gICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvbixcbiAgICAgIHVzZXJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBjaGFuZ2VQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2hhbmdlLXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcbiAgICAgICAqL1xuICAgICAgbmV3UGFzc3dvcmQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgY3VycmVudCBwYXNzd29yZCBvZiB0aGUgdXNlclxuICAgICAgICovXG4gICAgICBjdXJyZW50UGFzc3dvcmQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBjdXJyZW50IHBhc3N3b3JkIGlzIHJlcXVpcmVkXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiByZXZva2UgYWxsIHNlc3Npb25zIHRoYXQgYXJlIG5vdCB0aGVcbiAgICAgICAqIGN1cnJlbnQgb25lIGxvZ2dlZCBpbiBieSB0aGUgdXNlclxuICAgICAgICovXG4gICAgICByZXZva2VPdGhlclNlc3Npb25zOiB6LmJvb2xlYW4oKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTXVzdCBiZSBhIGJvb2xlYW4gdmFsdWVcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3NlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDaGFuZ2UgdGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlBhc3N3b3JkIHN1Y2Nlc3NmdWxseSBjaGFuZ2VkXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBwcmVzZW50IGlmIHJldm9rZU90aGVyU2Vzc2lvbnMgaXMgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk5ldyBzZXNzaW9uIHRva2VuIGlmIG90aGVyIHNlc3Npb25zIHdlcmUgcmV2b2tlZFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwidXJpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvZmlsZSBpbWFnZSBVUkwgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZXRoZXIgdGhlIGVtYWlsIGhhcyBiZWVuIHZlcmlmaWVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGVuIHRoZSB1c2VyIHdhcyBjcmVhdGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGVuIHRoZSB1c2VyIHdhcyBsYXN0IHVwZGF0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cGRhdGVkQXRcIlxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCwgY3VycmVudFBhc3N3b3JkLCByZXZva2VPdGhlclNlc3Npb25zIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoIDwgbWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBzaG9ydFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoID4gbWF4UGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBsb25nXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2NvdW50MikgPT4gYWNjb3VudDIucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIgJiYgYWNjb3VudDIucGFzc3dvcmRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCB8fCAhYWNjb3VudC5wYXNzd29yZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkNSRURFTlRJQUxfQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBjb25zdCB2ZXJpZnkgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgaGFzaDogYWNjb3VudC5wYXNzd29yZCxcbiAgICAgIHBhc3N3b3JkOiBjdXJyZW50UGFzc3dvcmRcbiAgICB9KTtcbiAgICBpZiAoIXZlcmlmeSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChhY2NvdW50LmlkLCB7XG4gICAgICBwYXNzd29yZDogcGFzc3dvcmRIYXNoXG4gICAgfSk7XG4gICAgbGV0IHRva2VuID0gbnVsbDtcbiAgICBpZiAocmV2b2tlT3RoZXJTZXNzaW9ucykge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKHNlc3Npb24udXNlci5pZCk7XG4gICAgICBjb25zdCBuZXdTZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgIHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgaWYgKCFuZXdTZXNzaW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiBuZXdTZXNzaW9uLFxuICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgIH0pO1xuICAgICAgdG9rZW4gPSBuZXdTZXNzaW9uLnRva2VuO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgdG9rZW4sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICAgIG5hbWU6IHNlc3Npb24udXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogc2Vzc2lvbi51c2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBzZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgY3JlYXRlZEF0OiBzZXNzaW9uLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IHNlc3Npb24udXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHNldFBhc3N3b3JkID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zZXQtcGFzc3dvcmRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgbmV3IHBhc3N3b3JkIHRvIHNldFxuICAgICAgICovXG4gICAgICBuZXdQYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5ldyBwYXNzd29yZCB0byBzZXQgaXMgcmVxdWlyZWRcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgU0VSVkVSX09OTFk6IHRydWVcbiAgICB9LFxuICAgIHVzZTogW3NlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlXVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgbWluUGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA8IG1pblBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gc2hvcnRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWF4UGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA+IG1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gbG9uZ1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fTE9OR1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiICYmIGFjY291bnQyLnBhc3N3b3JkXG4gICAgKTtcbiAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudChcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgICAgIGFjY291bnRJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZEhhc2hcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJ1c2VyIGFscmVhZHkgaGFzIGEgcGFzc3dvcmRcIlxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgZGVsZXRlVXNlciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZGVsZXRlLXVzZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGNhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBpcyBkZWxldGVkXG4gICAgICAgKiB0aGlzIGlzIG9ubHkgdXNlZCBvbiBkZWxldGUgdXNlciBjYWxsYmFja1xuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGNhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBpcyBkZWxldGVkXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBwYXNzd29yZCBvZiB0aGUgdXNlci4gSWYgdGhlIHBhc3N3b3JkIGlzbid0IHByb3ZpZGVkLCBzZXNzaW9uIGZyZXNobmVzc1xuICAgICAgICogd2lsbCBiZSBjaGVja2VkLlxuICAgICAgICovXG4gICAgICBwYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyIGlzIHJlcXVpcmVkIHRvIGRlbGV0ZSB0aGUgdXNlclwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgdG9rZW4gdG8gZGVsZXRlIHRoZSB1c2VyLiBJZiB0aGUgdG9rZW4gaXMgcHJvdmlkZWQsIHRoZSB1c2VyIHdpbGwgYmUgZGVsZXRlZFxuICAgICAgICovXG4gICAgICB0b2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIGRlbGV0ZSB0aGUgdXNlciBpcyByZXF1aXJlZFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGVsZXRlIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgZGVsZXRpb24gcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseVwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZW51bTogW1wiVXNlciBkZWxldGVkXCIsIFwiVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3RhdHVzIG1lc3NhZ2Ugb2YgdGhlIGRlbGV0aW9uIHByb2Nlc3NcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN1Y2Nlc3NcIiwgXCJtZXNzYWdlXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLnVzZXI/LmRlbGV0ZVVzZXI/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJEZWxldGUgdXNlciBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHRoZSBvcHRpb25zXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIik7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGlmIChjdHguYm9keS5wYXNzd29yZCkge1xuICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICAgICk7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgICAgKGFjY291bnQyKSA9PiBhY2NvdW50Mi5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIiAmJiBhY2NvdW50Mi5wYXNzd29yZFxuICAgICAgKTtcbiAgICAgIGlmICghYWNjb3VudCB8fCAhYWNjb3VudC5wYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5DUkVERU5USUFMX0FDQ09VTlRfTk9UX0ZPVU5EXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdmVyaWZ5ID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICAgICAgaGFzaDogYWNjb3VudC5wYXNzd29yZCxcbiAgICAgICAgcGFzc3dvcmQ6IGN0eC5ib2R5LnBhc3N3b3JkXG4gICAgICB9KTtcbiAgICAgIGlmICghdmVyaWZ5KSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfUEFTU1dPUkRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdHguYm9keS50b2tlbikge1xuICAgICAgYXdhaXQgZGVsZXRlVXNlckNhbGxiYWNrKHtcbiAgICAgICAgLi4uY3R4LFxuICAgICAgICBxdWVyeToge1xuICAgICAgICAgIHRva2VuOiBjdHguYm9keS50b2tlblxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiVXNlciBkZWxldGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXI/LnNlbmREZWxldGVBY2NvdW50VmVyaWZpY2F0aW9uKSB7XG4gICAgICBjb25zdCB0b2tlbiA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcIjAtOVwiLCBcImEtelwiKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAge1xuICAgICAgICAgIHZhbHVlOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgaWRlbnRpZmllcjogYGRlbGV0ZS1hY2NvdW50LSR7dG9rZW59YCxcbiAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKFxuICAgICAgICAgICAgRGF0ZS5ub3coKSArIChjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uZGVsZXRlVG9rZW5FeHBpcmVzSW4gfHwgNjAgKiA2MCAqIDI0KSAqIDFlM1xuICAgICAgICAgIClcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vZGVsZXRlLXVzZXIvY2FsbGJhY2s/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXIuc2VuZERlbGV0ZUFjY291bnRWZXJpZmljYXRpb24oXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXIsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHRva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgc2VudFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFjdHguYm9keS5wYXNzd29yZCAmJiBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlICE9PSAwKSB7XG4gICAgICBjb25zdCBjdXJyZW50QWdlID0gbmV3IERhdGUoc2Vzc2lvbi5zZXNzaW9uLmNyZWF0ZWRBdCkuZ2V0VGltZSgpO1xuICAgICAgY29uc3QgZnJlc2hBZ2UgPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlICogMWUzO1xuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChub3cgLSBjdXJyZW50QWdlID4gZnJlc2hBZ2UgKiAxZTMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuU0VTU0lPTl9FWFBJUkVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBiZWZvcmVEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYmVmb3JlRGVsZXRlO1xuICAgIGlmIChiZWZvcmVEZWxldGUpIHtcbiAgICAgIGF3YWl0IGJlZm9yZURlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudHMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgY29uc3QgYWZ0ZXJEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYWZ0ZXJEZWxldGU7XG4gICAgaWYgKGFmdGVyRGVsZXRlKSB7XG4gICAgICBhd2FpdCBhZnRlckRlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZFwiXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBkZWxldGVVc2VyQ2FsbGJhY2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2RlbGV0ZS11c2VyL2NhbGxiYWNrXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gdmVyaWZ5IHRoZSBkZWxldGlvbiByZXF1ZXN0XCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZGVsZXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbGxiYWNrIHRvIGNvbXBsZXRlIHVzZXIgZGVsZXRpb24gd2l0aCB2ZXJpZmljYXRpb24gdG9rZW5cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBzdWNjZXNzZnVsbHkgZGVsZXRlZFwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgZGVsZXRpb24gd2FzIHN1Y2Nlc3NmdWxcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbXCJVc2VyIGRlbGV0ZWRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQ29uZmlybWF0aW9uIG1lc3NhZ2VcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN1Y2Nlc3NcIiwgXCJtZXNzYWdlXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLnVzZXI/LmRlbGV0ZVVzZXI/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJEZWxldGUgdXNlciBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHRoZSBvcHRpb25zXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIik7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIGBkZWxldGUtYWNjb3VudC0ke2N0eC5xdWVyeS50b2tlbn1gXG4gICAgKTtcbiAgICBpZiAoIXRva2VuIHx8IHRva2VuLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAodG9rZW4udmFsdWUgIT09IHNlc3Npb24udXNlci5pZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYmVmb3JlRGVsZXRlID0gY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXI/LmJlZm9yZURlbGV0ZTtcbiAgICBpZiAoYmVmb3JlRGVsZXRlKSB7XG4gICAgICBhd2FpdCBiZWZvcmVEZWxldGUoc2Vzc2lvbi51c2VyLCBjdHgucmVxdWVzdCk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVVc2VyKHNlc3Npb24udXNlci5pZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKHNlc3Npb24udXNlci5pZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZUFjY291bnRzKHNlc3Npb24udXNlci5pZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKHRva2VuLmlkKTtcbiAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgY29uc3QgYWZ0ZXJEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYWZ0ZXJEZWxldGU7XG4gICAgaWYgKGFmdGVyRGVsZXRlKSB7XG4gICAgICBhd2FpdCBhZnRlckRlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGN0eC5xdWVyeS5jYWxsYmFja1VSTCB8fCBcIi9cIik7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogXCJVc2VyIGRlbGV0ZWRcIlxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgY2hhbmdlRW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2NoYW5nZS1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBuZXdFbWFpbDogei5lbWFpbCgpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmV3IGVtYWlsIGFkZHJlc3MgdG8gc2V0IG11c3QgYmUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzXCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZW1haWwgdmVyaWZpY2F0aW9uXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtzZW5zaXRpdmVTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgY2hhbmdlIHJlcXVlc3QgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseVwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSByZXF1ZXN0IHdhcyBzdWNjZXNzZnVsXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZW51bTogW1wiRW1haWwgdXBkYXRlZFwiLCBcIlZlcmlmaWNhdGlvbiBlbWFpbCBzZW50XCJdLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN0YXR1cyBtZXNzYWdlIG9mIHRoZSBlbWFpbCBjaGFuZ2UgcHJvY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIjQyMlwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVbnByb2Nlc3NhYmxlIEVudGl0eS4gRW1haWwgYWxyZWFkeSBleGlzdHNcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uY2hhbmdlRW1haWw/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkNoYW5nZSBlbWFpbCBpcyBkaXNhYmxlZC5cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ2hhbmdlIGVtYWlsIGlzIGRpc2FibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBuZXdFbWFpbCA9IGN0eC5ib2R5Lm5ld0VtYWlsLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKG5ld0VtYWlsID09PSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWwpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkVtYWlsIGlzIHRoZSBzYW1lXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGlzIHRoZSBzYW1lXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKG5ld0VtYWlsKTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJFbWFpbCBhbHJlYWR5IGV4aXN0c1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJDb3VsZG4ndCB1cGRhdGUgeW91ciBlbWFpbFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5lbWFpbFZlcmlmaWVkICE9PSB0cnVlKSB7XG4gICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwobmV3RW1haWwpO1xuICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfQUxSRUFEWV9FWElTVFNfVVNFX0FOT1RIRVJfRU1BSUxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlckJ5RW1haWwoXG4gICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5lbWFpbCxcbiAgICAgICAge1xuICAgICAgICAgIGVtYWlsOiBuZXdFbWFpbFxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24sXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAuLi5jdHguY29udGV4dC5zZXNzaW9uLnVzZXIsXG4gICAgICAgICAgZW1haWw6IG5ld0VtYWlsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCkge1xuICAgICAgICBjb25zdCB0b2tlbjIgPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICBuZXdFbWFpbCxcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHVybDIgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbjJ9JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5zZW5kVmVyaWZpY2F0aW9uRW1haWwoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAuLi5jdHguY29udGV4dC5zZXNzaW9uLnVzZXIsXG4gICAgICAgICAgICAgIGVtYWlsOiBuZXdFbWFpbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVybDogdXJsMixcbiAgICAgICAgICAgIHRva2VuOiB0b2tlbjJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5jaGFuZ2VFbWFpbC5zZW5kQ2hhbmdlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgbmV3RW1haWwsXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICApO1xuICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmNoYW5nZUVtYWlsLnNlbmRDaGFuZ2VFbWFpbFZlcmlmaWNhdGlvbihcbiAgICAgIHtcbiAgICAgICAgdXNlcjogY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLFxuICAgICAgICBuZXdFbWFpbCxcbiAgICAgICAgdXJsLFxuICAgICAgICB0b2tlblxuICAgICAgfSxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5cbmZ1bmN0aW9uIHNhbml0aXplKGlucHV0KSB7XG4gIHJldHVybiBpbnB1dC5yZXBsYWNlKC8mL2csIFwiJmFtcDtcIikucmVwbGFjZSgvPC9nLCBcIiZsdDtcIikucmVwbGFjZSgvPi9nLCBcIiZndDtcIikucmVwbGFjZSgvXCIvZywgXCImcXVvdDtcIikucmVwbGFjZSgvJy9nLCBcIiYjMzk7XCIpO1xufVxuY29uc3QgaHRtbCA9IChlcnJvckNvZGUgPSBcIlVua25vd25cIikgPT4gYDwhRE9DVFlQRSBodG1sPlxuPGh0bWwgbGFuZz1cImVuXCI+XG48aGVhZD5cbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgICA8bWV0YSBuYW1lPVwidmlld3BvcnRcIiBjb250ZW50PVwid2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMFwiPlxuICAgIDx0aXRsZT5BdXRoZW50aWNhdGlvbiBFcnJvcjwvdGl0bGU+XG4gICAgPHN0eWxlPlxuICAgICAgICA6cm9vdCB7XG4gICAgICAgICAgICAtLWJnLWNvbG9yOiAjZjhmOWZhO1xuICAgICAgICAgICAgLS10ZXh0LWNvbG9yOiAjMjEyNTI5O1xuICAgICAgICAgICAgLS1hY2NlbnQtY29sb3I6ICMwMDAwMDA7XG4gICAgICAgICAgICAtLWVycm9yLWNvbG9yOiAjZGMzNTQ1O1xuICAgICAgICAgICAgLS1ib3JkZXItY29sb3I6ICNlOWVjZWY7XG4gICAgICAgIH1cbiAgICAgICAgYm9keSB7XG4gICAgICAgICAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBSb2JvdG8sICdIZWx2ZXRpY2EgTmV1ZScsIEFyaWFsLCBzYW5zLXNlcmlmO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmctY29sb3IpO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpO1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGhlaWdodDogMTAwdmg7XG4gICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMS41O1xuICAgICAgICB9XG4gICAgICAgIC5lcnJvci1jb250YWluZXIge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjA1KTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDIuNXJlbTtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIG1heC13aWR0aDogOTAlO1xuICAgICAgICAgICAgd2lkdGg6IDQwMHB4O1xuICAgICAgICB9XG4gICAgICAgIGgxIHtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNzVyZW07XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgfVxuICAgICAgICBwIHtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEuNXJlbTtcbiAgICAgICAgICAgIGNvbG9yOiAjNDk1MDU3O1xuICAgICAgICB9XG4gICAgICAgIC5idG4ge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTtcbiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgICAgICAgICAgcGFkZGluZzogMC43NXJlbSAxLjVyZW07XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlO1xuICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWFjY2VudC1jb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0bjpob3ZlciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTMxNzIxO1xuICAgICAgICB9XG4gICAgICAgIC5lcnJvci1jb2RlIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NzVyZW07XG4gICAgICAgICAgICBjb2xvcjogIzZjNzU3ZDtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEuNXJlbTtcbiAgICAgICAgICAgIHBhZGRpbmctdG9wOiAxLjVyZW07XG4gICAgICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICAuaWNvbiB7XG4gICAgICAgICAgICBmb250LXNpemU6IDNyZW07XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICAgICAgICB9XG4gICAgPC9zdHlsZT5cbjwvaGVhZD5cbjxib2R5PlxuICAgIDxkaXYgY2xhc3M9XCJlcnJvci1jb250YWluZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImljb25cIj5cXHUyNkEwXFx1RkUwRjwvZGl2PlxuICAgICAgICA8aDE+QmV0dGVyIEF1dGggRXJyb3I8L2gxPlxuICAgICAgICA8cD5XZSBlbmNvdW50ZXJlZCBhbiBpc3N1ZSB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHRyeSBhZ2FpbiBvciBjb250YWN0IHRoZSBhcHBsaWNhdGlvbiBvd25lciBpZiB0aGUgcHJvYmxlbSBwZXJzaXN0cy48L3A+XG4gICAgICAgIDxhIGhyZWY9XCIvXCIgaWQ9XCJyZXR1cm5MaW5rXCIgY2xhc3M9XCJidG5cIj5SZXR1cm4gdG8gQXBwbGljYXRpb248L2E+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJlcnJvci1jb2RlXCI+RXJyb3IgQ29kZTogPHNwYW4gaWQ9XCJlcnJvckNvZGVcIj4ke3Nhbml0aXplKFxuICBlcnJvckNvZGVcbil9PC9zcGFuPjwvZGl2PlxuICAgIDwvZGl2PlxuPC9ib2R5PlxuPC9odG1sPmA7XG5jb25zdCBlcnJvciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZXJyb3JcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uSElERV9NRVRBREFUQSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzcGxheXMgYW4gZXJyb3IgcGFnZVwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwidGV4dC9odG1sXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgSFRNTCBjb250ZW50IG9mIHRoZSBlcnJvciBwYWdlXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSBuZXcgVVJMKGMucmVxdWVzdD8udXJsIHx8IFwiXCIpLnNlYXJjaFBhcmFtcy5nZXQoXCJlcnJvclwiKSB8fCBcIlVua25vd25cIjtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGh0bWwocXVlcnkpLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwidGV4dC9odG1sXCJcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcblxuY29uc3Qgb2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29rXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIC4uLkhJREVfTUVUQURBVEEsXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoZWNrIGlmIHRoZSBBUEkgaXMgd29ya2luZ1wiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBUEkgaXMgd29ya2luZ1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgb2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIEFQSSBpcyB3b3JraW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJva1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBvazogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG5jb25zdCBsaXN0VXNlckFjY291bnRzID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saXN0LWFjY291bnRzXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3QgYWxsIGFjY291bnRzIGxpbmtlZCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVySWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHNjb3Blczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudElkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJzY29wZXNcIlxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICByZXR1cm4gYy5qc29uKFxuICAgICAgYWNjb3VudHMubWFwKChhKSA9PiAoe1xuICAgICAgICBpZDogYS5pZCxcbiAgICAgICAgcHJvdmlkZXJJZDogYS5wcm92aWRlcklkLFxuICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LFxuICAgICAgICBhY2NvdW50SWQ6IGEuYWNjb3VudElkLFxuICAgICAgICBzY29wZXM6IGEuc2NvcGU/LnNwbGl0KFwiLFwiKSB8fCBbXVxuICAgICAgfSkpXG4gICAgKTtcbiAgfVxuKTtcbmNvbnN0IGxpbmtTb2NpYWxBY2NvdW50ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saW5rLXNvY2lhbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBoYXMgc2lnbmVkIGluLlxuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBoYXMgc2lnbmVkIGluXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIE9BdXRoMiBwcm92aWRlciB0byB1c2VcbiAgICAgICAqL1xuICAgICAgcHJvdmlkZXI6IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0sXG4gICAgICAvKipcbiAgICAgICAqIElEIFRva2VuIGZvciBkaXJlY3QgYXV0aGVudGljYXRpb24gd2l0aG91dCByZWRpcmVjdFxuICAgICAgICovXG4gICAgICBpZFRva2VuOiB6Lm9iamVjdCh7XG4gICAgICAgIHRva2VuOiB6LnN0cmluZygpLFxuICAgICAgICBub25jZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICBhY2Nlc3NUb2tlbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICByZWZyZXNoVG9rZW46IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgICAgc2NvcGVzOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKClcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFdoZXRoZXIgdG8gYWxsb3cgc2lnbiB1cCBmb3IgbmV3IHVzZXJzXG4gICAgICAgKi9cbiAgICAgIHJlcXVlc3RTaWduVXA6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIEFkZGl0aW9uYWwgc2NvcGVzIHRvIHJlcXVlc3Qgd2hlbiBsaW5raW5nIHRoZSBhY2NvdW50LlxuICAgICAgICogVGhpcyBpcyB1c2VmdWwgZm9yIHJlcXVlc3RpbmcgYWRkaXRpb25hbCBwZXJtaXNzaW9ucyB3aGVuXG4gICAgICAgKiBsaW5raW5nIGEgc29jaWFsIGFjY291bnQgY29tcGFyZWQgdG8gdGhlIGluaXRpYWwgYXV0aGVudGljYXRpb24uXG4gICAgICAgKi9cbiAgICAgIHNjb3Blczogei5hcnJheSh6LnN0cmluZygpKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQWRkaXRpb25hbCBzY29wZXMgdG8gcmVxdWVzdCBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIHRoZXJlIGlzIGFuIGVycm9yIGR1cmluZyB0aGUgbGluayBwcm9jZXNzLlxuICAgICAgICovXG4gICAgICBlcnJvckNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIHRoZXJlIGlzIGFuIGVycm9yIGR1cmluZyB0aGUgbGluayBwcm9jZXNzXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIERpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlclxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIGhhbmRsZSB0aGUgcmVkaXJlY3Rpb25cbiAgICAgICAqIHlvdXJzZWxmIGxpa2UgaW4gYSBwb3B1cCBvciBhIGRpZmZlcmVudCB0YWIuXG4gICAgICAgKi9cbiAgICAgIGRpc2FibGVSZWRpcmVjdDogei5ib29sZWFuKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlci4gVXNlZnVsIGZvciBoYW5kbGluZyB0aGUgcmVkaXJlY3Rpb24geW91cnNlbGZcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJMaW5rIGEgc29jaWFsIGFjY291bnQgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgYXV0aG9yaXphdGlvbiBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG9cIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgdXNlciBzaG91bGQgYmUgcmVkaXJlY3RlZCB0byB0aGUgYXV0aG9yaXphdGlvbiBVUkxcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInJlZGlyZWN0XCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLmJvZHkucHJvdmlkZXJcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gYWRkIHRoZSBwcm92aWRlciBpbiB5b3VyIGF1dGggY29uZmlnXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBST1ZJREVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjLmJvZHkuaWRUb2tlbikge1xuICAgICAgaWYgKCFwcm92aWRlci52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJQcm92aWRlciBkb2VzIG5vdCBzdXBwb3J0IGlkIHRva2VuIHZlcmlmaWNhdGlvblwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JRF9UT0tFTl9OT1RfU1VQUE9SVEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyB0b2tlbiwgbm9uY2UgfSA9IGMuYm9keS5pZFRva2VuO1xuICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIGlkIHRva2VuXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxpbmtpbmdVc2VySW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHtcbiAgICAgICAgaWRUb2tlbjogdG9rZW4sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaFRva2VuOiBjLmJvZHkuaWRUb2tlbi5yZWZyZXNoVG9rZW5cbiAgICAgIH0pO1xuICAgICAgaWYgKCFsaW5raW5nVXNlckluZm8gfHwgIWxpbmtpbmdVc2VySW5mbz8udXNlcikge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9cIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxpbmtpbmdVc2VySWQgPSBTdHJpbmcobGlua2luZ1VzZXJJbmZvLnVzZXIuaWQpO1xuICAgICAgaWYgKCFsaW5raW5nVXNlckluZm8udXNlci5lbWFpbCkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlciBlbWFpbCBub3QgZm91bmRcIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX0VNQUlMX05PVF9GT1VORFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4aXN0aW5nQWNjb3VudHMgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgICAgY29uc3QgaGFzQmVlbkxpbmtlZCA9IGV4aXN0aW5nQWNjb3VudHMuZmluZChcbiAgICAgICAgKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXIuaWQgJiYgYS5hY2NvdW50SWQgPT09IGxpbmtpbmdVc2VySWRcbiAgICAgICk7XG4gICAgICBpZiAoaGFzQmVlbkxpbmtlZCkge1xuICAgICAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgICAgICB1cmw6IFwiXCIsXG4gICAgICAgICAgLy8gdGhpcyBpcyBmb3IgdHlwZSBpbmZlcmVuY2VcbiAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgcmVkaXJlY3Q6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdHJ1c3RlZFByb3ZpZGVycyA9IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzO1xuICAgICAgY29uc3QgaXNUcnVzdGVkUHJvdmlkZXIgPSB0cnVzdGVkUHJvdmlkZXJzPy5pbmNsdWRlcyhwcm92aWRlci5pZCk7XG4gICAgICBpZiAoIWlzVHJ1c3RlZFByb3ZpZGVyICYmICFsaW5raW5nVXNlckluZm8udXNlci5lbWFpbFZlcmlmaWVkIHx8IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiQWNjb3VudCBub3QgbGlua2VkIC0gbGlua2luZyBub3QgYWxsb3dlZFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGxpbmtpbmdVc2VySW5mby51c2VyLmVtYWlsICE9PSBzZXNzaW9uLnVzZXIuZW1haWwgJiYgYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93RGlmZmVyZW50RW1haWxzICE9PSB0cnVlKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJBY2NvdW50IG5vdCBsaW5rZWQgLSBkaWZmZXJlbnQgZW1haWxzIG5vdCBhbGxvd2VkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgICAgIGFjY291bnRJZDogbGlua2luZ1VzZXJJZCxcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIGlkVG9rZW46IHRva2VuLFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBjLmJvZHkuaWRUb2tlbi5yZWZyZXNoVG9rZW4sXG4gICAgICAgICAgICBzY29wZTogYy5ib2R5LmlkVG9rZW4uc2NvcGVzPy5qb2luKFwiLFwiKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgY1xuICAgICAgICApO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJFWFBFQ1RBVElPTl9GQUlMRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiQWNjb3VudCBub3QgbGlua2VkIC0gdW5hYmxlIHRvIGNyZWF0ZSBhY2NvdW50XCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnVwZGF0ZVVzZXJJbmZvT25MaW5rID09PSB0cnVlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKHNlc3Npb24udXNlci5pZCwge1xuICAgICAgICAgICAgbmFtZTogbGlua2luZ1VzZXJJbmZvLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgICBpbWFnZTogbGlua2luZ1VzZXJJbmZvLnVzZXI/LmltYWdlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgdXBkYXRlIHVzZXIgLSBcIiArIGUudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgICB1cmw6IFwiXCIsXG4gICAgICAgIC8vIHRoaXMgaXMgZm9yIHR5cGUgaW5mZXJlbmNlXG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgcmVkaXJlY3Q6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBnZW5lcmF0ZVN0YXRlKGMsIHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbFxuICAgIH0pO1xuICAgIGNvbnN0IHVybCA9IGF3YWl0IHByb3ZpZGVyLmNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGU6IHN0YXRlLnN0YXRlLFxuICAgICAgY29kZVZlcmlmaWVyOiBzdGF0ZS5jb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSTogYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2NhbGxiYWNrLyR7cHJvdmlkZXIuaWR9YCxcbiAgICAgIHNjb3BlczogYy5ib2R5LnNjb3Blc1xuICAgIH0pO1xuICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgdXJsOiB1cmwudG9TdHJpbmcoKSxcbiAgICAgIHJlZGlyZWN0OiAhYy5ib2R5LmRpc2FibGVSZWRpcmVjdFxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgdW5saW5rQWNjb3VudCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvdW5saW5rLWFjY291bnRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgcHJvdmlkZXJJZDogei5zdHJpbmcoKSxcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbZnJlc2hTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVW5saW5rIGFuIGFjY291bnRcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHsgcHJvdmlkZXJJZCwgYWNjb3VudElkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGlmIChhY2NvdW50cy5sZW5ndGggPT09IDEgJiYgIWN0eC5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93VW5saW5raW5nQWxsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX1VOTElOS19MQVNUX0FDQ09VTlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NvdW50RXhpc3QgPSBhY2NvdW50cy5maW5kKFxuICAgICAgKGFjY291bnQpID0+IGFjY291bnRJZCA/IGFjY291bnQuYWNjb3VudElkID09PSBhY2NvdW50SWQgJiYgYWNjb3VudC5wcm92aWRlcklkID09PSBwcm92aWRlcklkIDogYWNjb3VudC5wcm92aWRlcklkID09PSBwcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnRFeGlzdCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkFDQ09VTlRfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZUFjY291bnQoYWNjb3VudEV4aXN0LmlkKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBnZXRBY2Nlc3NUb2tlbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZ2V0LWFjY2Vzcy10b2tlblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvdmlkZXIgSUQgZm9yIHRoZSBPQXV0aCBwcm92aWRlclwiXG4gICAgICB9KSxcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGFjY291bnQgSUQgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWZyZXNoIHRva2VuXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIElEIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWNjb3VudFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IGEgdmFsaWQgYWNjZXNzIHRva2VuLCBkb2luZyBhIHJlZnJlc2ggaWYgbmVlZGVkXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQSBWYWxpZCBhY2Nlc3MgdG9rZW5cIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuVHlwZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICA0MDA6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkludmFsaWQgcmVmcmVzaCB0b2tlbiBvciBwcm92aWRlciBjb25maWd1cmF0aW9uXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IHByb3ZpZGVySWQsIGFjY291bnRJZCwgdXNlcklkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCByZXEgPSBjdHgucmVxdWVzdDtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAocmVxICYmICFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBjdHguZXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIGxldCByZXNvbHZlZFVzZXJJZCA9IHNlc3Npb24/LnVzZXI/LmlkIHx8IHVzZXJJZDtcbiAgICBpZiAoIXJlc29sdmVkVXNlcklkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGBFaXRoZXIgdXNlcklkIG9yIHNlc3Npb24gaXMgcmVxdWlyZWRgXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFjdHguY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZCgocCkgPT4gcC5pZCA9PT0gcHJvdmlkZXJJZCkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gaXMgbm90IHN1cHBvcnRlZC5gXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKHJlc29sdmVkVXNlcklkKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2MpID0+IGFjY291bnRJZCA/IGFjYy5pZCA9PT0gYWNjb3VudElkICYmIGFjYy5wcm92aWRlcklkID09PSBwcm92aWRlcklkIDogYWNjLnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY291bnQgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGN0eC5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gbm90IGZvdW5kLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgbGV0IG5ld1Rva2VucyA9IG51bGw7XG4gICAgICBjb25zdCBhY2Nlc3NUb2tlbkV4cGlyZWQgPSBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0ICYmIG5ldyBEYXRlKGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQpLmdldFRpbWUoKSAtIERhdGUubm93KCkgPCA1ZTM7XG4gICAgICBpZiAoYWNjb3VudC5yZWZyZXNoVG9rZW4gJiYgYWNjZXNzVG9rZW5FeHBpcmVkICYmIHByb3ZpZGVyLnJlZnJlc2hBY2Nlc3NUb2tlbikge1xuICAgICAgICBuZXdUb2tlbnMgPSBhd2FpdCBwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW4oXG4gICAgICAgICAgYWNjb3VudC5yZWZyZXNoVG9rZW5cbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZUFjY291bnQoYWNjb3VudC5pZCwge1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwobmV3VG9rZW5zLmFjY2Vzc1Rva2VuLCBjdHguY29udGV4dCksXG4gICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IG5ld1Rva2Vucy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChuZXdUb2tlbnMucmVmcmVzaFRva2VuLCBjdHguY29udGV4dCksXG4gICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiBuZXdUb2tlbnMucmVmcmVzaFRva2VuRXhwaXJlc0F0XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdG9rZW5zID0ge1xuICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgZGVjcnlwdE9BdXRoVG9rZW4oXG4gICAgICAgICAgbmV3VG9rZW5zPy5hY2Nlc3NUb2tlbiA/PyBhY2NvdW50LmFjY2Vzc1Rva2VuID8/IFwiXCIsXG4gICAgICAgICAgY3R4LmNvbnRleHRcbiAgICAgICAgKSxcbiAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IG5ld1Rva2Vucz8uYWNjZXNzVG9rZW5FeHBpcmVzQXQgPz8gYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA/PyB2b2lkIDAsXG4gICAgICAgIHNjb3BlczogYWNjb3VudC5zY29wZT8uc3BsaXQoXCIsXCIpID8/IFtdLFxuICAgICAgICBpZFRva2VuOiBuZXdUb2tlbnM/LmlkVG9rZW4gPz8gYWNjb3VudC5pZFRva2VuID8/IHZvaWQgMFxuICAgICAgfTtcbiAgICAgIHJldHVybiBjdHguanNvbih0b2tlbnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGdldCBhIHZhbGlkIGFjY2VzcyB0b2tlblwiLFxuICAgICAgICBjYXVzZTogZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuKTtcbmNvbnN0IHJlZnJlc2hUb2tlbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVmcmVzaC10b2tlblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvdmlkZXIgSUQgZm9yIHRoZSBPQXV0aCBwcm92aWRlclwiXG4gICAgICB9KSxcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGFjY291bnQgSUQgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWZyZXNoIHRva2VuXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIElEIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWNjb3VudFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVmcmVzaCB0aGUgYWNjZXNzIHRva2VuIHVzaW5nIGEgcmVmcmVzaCB0b2tlblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkFjY2VzcyB0b2tlbiByZWZyZXNoZWQgc3VjY2Vzc2Z1bGx5XCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlblR5cGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgNDAwOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbnZhbGlkIHJlZnJlc2ggdG9rZW4gb3IgcHJvdmlkZXIgY29uZmlndXJhdGlvblwiXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBwcm92aWRlcklkLCBhY2NvdW50SWQsIHVzZXJJZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgcmVxID0gY3R4LnJlcXVlc3Q7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKHJlcSAmJiAhc2Vzc2lvbikge1xuICAgICAgdGhyb3cgY3R4LmVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICBsZXQgcmVzb2x2ZWRVc2VySWQgPSBzZXNzaW9uPy51c2VyPy5pZCB8fCB1c2VySWQ7XG4gICAgaWYgKCFyZXNvbHZlZFVzZXJJZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBgRWl0aGVyIHVzZXJJZCBvciBzZXNzaW9uIGlzIHJlcXVpcmVkYFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhyZXNvbHZlZFVzZXJJZCk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjKSA9PiBhY2NvdW50SWQgPyBhY2MuaWQgPT09IGFjY291bnRJZCAmJiBhY2MucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXJJZCA6IGFjYy5wcm92aWRlcklkID09PSBwcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJBY2NvdW50IG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjdHguY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBwcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGBQcm92aWRlciAke3Byb3ZpZGVySWR9IG5vdCBmb3VuZC5gXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gZG9lcyBub3Qgc3VwcG9ydCB0b2tlbiByZWZyZXNoaW5nLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgdG9rZW5zID0gYXdhaXQgcHJvdmlkZXIucmVmcmVzaEFjY2Vzc1Rva2VuKFxuICAgICAgICBhY2NvdW50LnJlZnJlc2hUb2tlblxuICAgICAgKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVBY2NvdW50KGFjY291bnQuaWQsIHtcbiAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMuYWNjZXNzVG9rZW4sIGN0eC5jb250ZXh0KSxcbiAgICAgICAgcmVmcmVzaFRva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwodG9rZW5zLnJlZnJlc2hUb2tlbiwgY3R4LmNvbnRleHQpLFxuICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogdG9rZW5zLmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHRva2Vucy5yZWZyZXNoVG9rZW5FeHBpcmVzQXRcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHRva2Vucyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gcmVmcmVzaCBhY2Nlc3MgdG9rZW5cIixcbiAgICAgICAgY2F1c2U6IGVycm9yXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbik7XG5jb25zdCBhY2NvdW50SW5mbyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvYWNjb3VudC1pbmZvXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGFjY291bnQgaW5mbyBwcm92aWRlZCBieSB0aGUgcHJvdmlkZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcImlkXCIsIFwiZW1haWxWZXJpZmllZFwiXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInVzZXJcIiwgXCJkYXRhXCJdLFxuICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbFByb3BlcnRpZXM6IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBhY2NvdW50SWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm92aWRlciBnaXZlbiBhY2NvdW50IGlkIGZvciB3aGljaCB0byBnZXQgdGhlIGFjY291bnQgaW5mb1wiXG4gICAgICB9KVxuICAgIH0pXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50KFxuICAgICAgY3R4LmJvZHkuYWNjb3VudElkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnQgfHwgYWNjb3VudC51c2VySWQgIT09IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY291bnQgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGN0eC5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IGFjY291bnQucHJvdmlkZXJJZFxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyIGFjY291bnQgcHJvdmlkZXIgaXMgJHthY2NvdW50LnByb3ZpZGVySWR9IGJ1dCBpdCBpcyBub3QgY29uZmlndXJlZGBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbih7XG4gICAgICAuLi5jdHgsXG4gICAgICBib2R5OiB7XG4gICAgICAgIGFjY291bnRJZDogYWNjb3VudC5pZCxcbiAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkXG4gICAgICB9LFxuICAgICAgcmV0dXJuSGVhZGVyczogZmFsc2VcbiAgICB9KTtcbiAgICBpZiAoIXRva2Vucy5hY2Nlc3NUb2tlbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY2VzcyB0b2tlbiBub3QgZm91bmRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGluZm8gPSBhd2FpdCBwcm92aWRlci5nZXRVc2VySW5mbyh7XG4gICAgICAuLi50b2tlbnMsXG4gICAgICBhY2Nlc3NUb2tlbjogdG9rZW5zLmFjY2Vzc1Rva2VuXG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKGluZm8pO1xuICB9XG4pO1xuXG5jb25zdCBkZWZ1UmVwbGFjZUFycmF5cyA9IGNyZWF0ZURlZnUoKG9iaiwga2V5LCB2YWx1ZSkgPT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShvYmpba2V5XSkgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59KTtcbmZ1bmN0aW9uIHRvQXV0aEVuZHBvaW50cyhlbmRwb2ludHMsIGN0eCkge1xuICBjb25zdCBhcGkgPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCBlbmRwb2ludF0gb2YgT2JqZWN0LmVudHJpZXMoZW5kcG9pbnRzKSkge1xuICAgIGFwaVtrZXldID0gYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgICAgIGNvbnN0IGF1dGhDb250ZXh0ID0gYXdhaXQgY3R4O1xuICAgICAgbGV0IGludGVybmFsQ29udGV4dCA9IHtcbiAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgIC4uLmF1dGhDb250ZXh0LFxuICAgICAgICAgIHJldHVybmVkOiB2b2lkIDAsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzOiB2b2lkIDAsXG4gICAgICAgICAgc2Vzc2lvbjogbnVsbFxuICAgICAgICB9LFxuICAgICAgICBwYXRoOiBlbmRwb2ludC5wYXRoLFxuICAgICAgICBoZWFkZXJzOiBjb250ZXh0Py5oZWFkZXJzID8gbmV3IEhlYWRlcnMoY29udGV4dD8uaGVhZGVycykgOiB2b2lkIDBcbiAgICAgIH07XG4gICAgICBjb25zdCB7IGJlZm9yZUhvb2tzLCBhZnRlckhvb2tzIH0gPSBnZXRIb29rcyhhdXRoQ29udGV4dCk7XG4gICAgICBjb25zdCBiZWZvcmUgPSBhd2FpdCBydW5CZWZvcmVIb29rcyhpbnRlcm5hbENvbnRleHQsIGJlZm9yZUhvb2tzKTtcbiAgICAgIGlmIChcImNvbnRleHRcIiBpbiBiZWZvcmUgJiYgYmVmb3JlLmNvbnRleHQgJiYgdHlwZW9mIGJlZm9yZS5jb250ZXh0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIGNvbnN0IHsgaGVhZGVycywgLi4ucmVzdCB9ID0gYmVmb3JlLmNvbnRleHQ7XG4gICAgICAgIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5MikgPT4ge1xuICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmhlYWRlcnMuc2V0KGtleTIsIHZhbHVlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpbnRlcm5hbENvbnRleHQgPSBkZWZ1UmVwbGFjZUFycmF5cyhyZXN0LCBpbnRlcm5hbENvbnRleHQpO1xuICAgICAgfSBlbHNlIGlmIChiZWZvcmUpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQ/LmFzUmVzcG9uc2UgPyB0b1Jlc3BvbnNlKGJlZm9yZSwge1xuICAgICAgICAgIGhlYWRlcnM6IGNvbnRleHQ/LmhlYWRlcnNcbiAgICAgICAgfSkgOiBjb250ZXh0Py5yZXR1cm5IZWFkZXJzID8ge1xuICAgICAgICAgIGhlYWRlcnM6IGNvbnRleHQ/LmhlYWRlcnMsXG4gICAgICAgICAgcmVzcG9uc2U6IGJlZm9yZVxuICAgICAgICB9IDogYmVmb3JlO1xuICAgICAgfVxuICAgICAgaW50ZXJuYWxDb250ZXh0LmFzUmVzcG9uc2UgPSBmYWxzZTtcbiAgICAgIGludGVybmFsQ29udGV4dC5yZXR1cm5IZWFkZXJzID0gdHJ1ZTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGVuZHBvaW50KGludGVybmFsQ29udGV4dCkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXNwb25zZTogZSxcbiAgICAgICAgICAgIGhlYWRlcnM6IGUuaGVhZGVycyA/IG5ldyBIZWFkZXJzKGUuaGVhZGVycykgOiBudWxsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlO1xuICAgICAgfSk7XG4gICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdCBpbnN0YW5jZW9mIFJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZCA9IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJlc3BvbnNlSGVhZGVycyA9IHJlc3VsdC5oZWFkZXJzO1xuICAgICAgY29uc3QgYWZ0ZXIgPSBhd2FpdCBydW5BZnRlckhvb2tzKGludGVybmFsQ29udGV4dCwgYWZ0ZXJIb29rcyk7XG4gICAgICBpZiAoYWZ0ZXIucmVzcG9uc2UpIHtcbiAgICAgICAgcmVzdWx0LnJlc3BvbnNlID0gYWZ0ZXIucmVzcG9uc2U7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0LnJlc3BvbnNlIGluc3RhbmNlb2YgQVBJRXJyb3IgJiYgc2hvdWxkUHVibGlzaExvZyhhdXRoQ29udGV4dC5sb2dnZXIubGV2ZWwsIFwiZGVidWdcIikpIHtcbiAgICAgICAgcmVzdWx0LnJlc3BvbnNlLnN0YWNrID0gcmVzdWx0LnJlc3BvbnNlLmVycm9yU3RhY2s7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0LnJlc3BvbnNlIGluc3RhbmNlb2YgQVBJRXJyb3IgJiYgIWNvbnRleHQ/LmFzUmVzcG9uc2UpIHtcbiAgICAgICAgdGhyb3cgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb250ZXh0Py5hc1Jlc3BvbnNlID8gdG9SZXNwb25zZShyZXN1bHQucmVzcG9uc2UsIHtcbiAgICAgICAgaGVhZGVyczogcmVzdWx0LmhlYWRlcnNcbiAgICAgIH0pIDogY29udGV4dD8ucmV0dXJuSGVhZGVycyA/IHtcbiAgICAgICAgaGVhZGVyczogcmVzdWx0LmhlYWRlcnMsXG4gICAgICAgIHJlc3BvbnNlOiByZXN1bHQucmVzcG9uc2VcbiAgICAgIH0gOiByZXN1bHQucmVzcG9uc2U7XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfTtcbiAgICBhcGlba2V5XS5wYXRoID0gZW5kcG9pbnQucGF0aDtcbiAgICBhcGlba2V5XS5vcHRpb25zID0gZW5kcG9pbnQub3B0aW9ucztcbiAgfVxuICByZXR1cm4gYXBpO1xufVxuYXN5bmMgZnVuY3Rpb24gcnVuQmVmb3JlSG9va3MoY29udGV4dCwgaG9va3MpIHtcbiAgbGV0IG1vZGlmaWVkQ29udGV4dCA9IHt9O1xuICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MpIHtcbiAgICBpZiAoaG9vay5tYXRjaGVyKGNvbnRleHQpKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBob29rLmhhbmRsZXIoe1xuICAgICAgICAuLi5jb250ZXh0LFxuICAgICAgICByZXR1cm5IZWFkZXJzOiBmYWxzZVxuICAgICAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvciAmJiBzaG91bGRQdWJsaXNoTG9nKGNvbnRleHQuY29udGV4dC5sb2dnZXIubGV2ZWwsIFwiZGVidWdcIikpIHtcbiAgICAgICAgICBlLnN0YWNrID0gZS5lcnJvclN0YWNrO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAoXCJjb250ZXh0XCIgaW4gcmVzdWx0ICYmIHR5cGVvZiByZXN1bHQuY29udGV4dCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIGNvbnN0IHsgaGVhZGVycywgLi4ucmVzdCB9ID0gcmVzdWx0LmNvbnRleHQ7XG4gICAgICAgICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICAgICAgICBpZiAobW9kaWZpZWRDb250ZXh0LmhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgbW9kaWZpZWRDb250ZXh0LmhlYWRlcnM/LnNldChrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtb2RpZmllZENvbnRleHQuaGVhZGVycyA9IGhlYWRlcnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIG1vZGlmaWVkQ29udGV4dCA9IGRlZnVSZXBsYWNlQXJyYXlzKHJlc3QsIG1vZGlmaWVkQ29udGV4dCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgY29udGV4dDogbW9kaWZpZWRDb250ZXh0IH07XG59XG5hc3luYyBmdW5jdGlvbiBydW5BZnRlckhvb2tzKGNvbnRleHQsIGhvb2tzKSB7XG4gIGZvciAoY29uc3QgaG9vayBvZiBob29rcykge1xuICAgIGlmIChob29rLm1hdGNoZXIoY29udGV4dCkpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhvb2suaGFuZGxlcihjb250ZXh0KS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgaWYgKHNob3VsZFB1Ymxpc2hMb2coY29udGV4dC5jb250ZXh0LmxvZ2dlci5sZXZlbCwgXCJkZWJ1Z1wiKSkge1xuICAgICAgICAgICAgZS5zdGFjayA9IGUuZXJyb3JTdGFjaztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3BvbnNlOiBlLFxuICAgICAgICAgICAgaGVhZGVyczogZS5oZWFkZXJzID8gbmV3IEhlYWRlcnMoZS5oZWFkZXJzKSA6IG51bGxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQuaGVhZGVycykge1xuICAgICAgICByZXN1bHQuaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICAgICAgaWYgKCFjb250ZXh0LmNvbnRleHQucmVzcG9uc2VIZWFkZXJzKSB7XG4gICAgICAgICAgICBjb250ZXh0LmNvbnRleHQucmVzcG9uc2VIZWFkZXJzID0gbmV3IEhlYWRlcnMoe1xuICAgICAgICAgICAgICBba2V5XTogdmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoa2V5LnRvTG93ZXJDYXNlKCkgPT09IFwic2V0LWNvb2tpZVwiKSB7XG4gICAgICAgICAgICAgIGNvbnRleHQuY29udGV4dC5yZXNwb25zZUhlYWRlcnMuYXBwZW5kKGtleSwgdmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29udGV4dC5jb250ZXh0LnJlc3BvbnNlSGVhZGVycy5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXN1bHQucmVzcG9uc2UpIHtcbiAgICAgICAgY29udGV4dC5jb250ZXh0LnJldHVybmVkID0gcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIHJlc3BvbnNlOiBjb250ZXh0LmNvbnRleHQucmV0dXJuZWQsXG4gICAgaGVhZGVyczogY29udGV4dC5jb250ZXh0LnJlc3BvbnNlSGVhZGVyc1xuICB9O1xufVxuZnVuY3Rpb24gZ2V0SG9va3MoYXV0aENvbnRleHQpIHtcbiAgY29uc3QgcGx1Z2lucyA9IGF1dGhDb250ZXh0Lm9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgY29uc3QgYmVmb3JlSG9va3MgPSBbXTtcbiAgY29uc3QgYWZ0ZXJIb29rcyA9IFtdO1xuICBpZiAoYXV0aENvbnRleHQub3B0aW9ucy5ob29rcz8uYmVmb3JlKSB7XG4gICAgYmVmb3JlSG9va3MucHVzaCh7XG4gICAgICBtYXRjaGVyOiAoKSA9PiB0cnVlLFxuICAgICAgaGFuZGxlcjogYXV0aENvbnRleHQub3B0aW9ucy5ob29rcy5iZWZvcmVcbiAgICB9KTtcbiAgfVxuICBpZiAoYXV0aENvbnRleHQub3B0aW9ucy5ob29rcz8uYWZ0ZXIpIHtcbiAgICBhZnRlckhvb2tzLnB1c2goe1xuICAgICAgbWF0Y2hlcjogKCkgPT4gdHJ1ZSxcbiAgICAgIGhhbmRsZXI6IGF1dGhDb250ZXh0Lm9wdGlvbnMuaG9va3MuYWZ0ZXJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBwbHVnaW5CZWZvcmVIb29rcyA9IHBsdWdpbnMubWFwKChwbHVnaW4pID0+IHtcbiAgICBpZiAocGx1Z2luLmhvb2tzPy5iZWZvcmUpIHtcbiAgICAgIHJldHVybiBwbHVnaW4uaG9va3MuYmVmb3JlO1xuICAgIH1cbiAgfSkuZmlsdGVyKChwbHVnaW4pID0+IHBsdWdpbiAhPT0gdm9pZCAwKS5mbGF0KCk7XG4gIGNvbnN0IHBsdWdpbkFmdGVySG9va3MgPSBwbHVnaW5zLm1hcCgocGx1Z2luKSA9PiB7XG4gICAgaWYgKHBsdWdpbi5ob29rcz8uYWZ0ZXIpIHtcbiAgICAgIHJldHVybiBwbHVnaW4uaG9va3MuYWZ0ZXI7XG4gICAgfVxuICB9KS5maWx0ZXIoKHBsdWdpbikgPT4gcGx1Z2luICE9PSB2b2lkIDApLmZsYXQoKTtcbiAgcGx1Z2luQmVmb3JlSG9va3MubGVuZ3RoICYmIGJlZm9yZUhvb2tzLnB1c2goLi4ucGx1Z2luQmVmb3JlSG9va3MpO1xuICBwbHVnaW5BZnRlckhvb2tzLmxlbmd0aCAmJiBhZnRlckhvb2tzLnB1c2goLi4ucGx1Z2luQWZ0ZXJIb29rcyk7XG4gIHJldHVybiB7XG4gICAgYmVmb3JlSG9va3MsXG4gICAgYWZ0ZXJIb29rc1xuICB9O1xufVxuXG5leHBvcnQgeyBjaGFuZ2VFbWFpbCBhcyBBLCBzZW5kVmVyaWZpY2F0aW9uRW1haWwgYXMgQiwgdmVyaWZ5RW1haWwgYXMgQywgcmVzZXRQYXNzd29yZCBhcyBELCBmb3JnZXRQYXNzd29yZCBhcyBFLCBzaWduSW5FbWFpbCBhcyBGLCBzaWduT3V0IGFzIEcsIEhJREVfTUVUQURBVEEgYXMgSCwgY2FsbGJhY2tPQXV0aCBhcyBJLCBzaWduSW5Tb2NpYWwgYXMgSiwgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4gYXMgSywgaXNTaW1wbGVSZXF1ZXN0IGFzIEwsIG9yaWdpbkNoZWNrTWlkZGxld2FyZSBhcyBhLCBvayBhcyBiLCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuIGFzIGMsIGRlY3J5cHRPQXV0aFRva2VuIGFzIGQsIGVycm9yIGFzIGUsIGFjY291bnRJbmZvIGFzIGYsIGdlbmVyYXRlU3RhdGUgYXMgZywgaGFuZGxlT0F1dGhVc2VySW5mbyBhcyBoLCBnZXRBY2Nlc3NUb2tlbiBhcyBpLCB1bmxpbmtBY2NvdW50IGFzIGosIGRlbGV0ZVVzZXJDYWxsYmFjayBhcyBrLCBsaXN0VXNlckFjY291bnRzIGFzIGwsIGxpbmtTb2NpYWxBY2NvdW50IGFzIG0sIHJlcXVlc3RQYXNzd29yZFJlc2V0Q2FsbGJhY2sgYXMgbiwgb3JpZ2luQ2hlY2sgYXMgbywgcGFyc2VTdGF0ZSBhcyBwLCByZXF1ZXN0UGFzc3dvcmRSZXNldCBhcyBxLCByZWZyZXNoVG9rZW4gYXMgciwgc2V0VG9rZW5VdGlsIGFzIHMsIHRvQXV0aEVuZHBvaW50cyBhcyB0LCB1cGRhdGVVc2VyIGFzIHUsIGZvcmdldFBhc3N3b3JkQ2FsbGJhY2sgYXMgdiwgd2lsZGNhcmRNYXRjaCBhcyB3LCBkZWxldGVVc2VyIGFzIHgsIHNldFBhc3N3b3JkIGFzIHksIGNoYW5nZVBhc3N3b3JkIGFzIHogfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BX9UB8EP.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createKyselyAdapter),\n/* harmony export */   g: () => (/* binding */ getKyselyDatabaseType),\n/* harmony export */   k: () => (/* binding */ kyselyAdapter)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/dialect/mssql/mssql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/kysely.js\");\n/* harmony import */ var _better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.EBxKeVNZ.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\");\n\n\n\nfunction getKyselyDatabaseType(db) {\n  if (!db) {\n    return null;\n  }\n  if (\"dialect\" in db) {\n    return getKyselyDatabaseType(db.dialect);\n  }\n  if (\"createDriver\" in db) {\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_1__.SqliteDialect) {\n      return \"sqlite\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_2__.MysqlDialect) {\n      return \"mysql\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_3__.PostgresDialect) {\n      return \"postgres\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_4__.MssqlDialect) {\n      return \"mssql\";\n    }\n  }\n  if (\"aggregate\" in db) {\n    return \"sqlite\";\n  }\n  if (\"getConnection\" in db) {\n    return \"mysql\";\n  }\n  if (\"connect\" in db) {\n    return \"postgres\";\n  }\n  if (\"fileControl\" in db) {\n    return \"sqlite\";\n  }\n  if (\"open\" in db && \"close\" in db && \"prepare\" in db) {\n    return \"sqlite\";\n  }\n  return null;\n}\nconst createKyselyAdapter = async (config) => {\n  const db = config.database;\n  if (!db) {\n    return {\n      kysely: null,\n      databaseType: null,\n      transaction: void 0\n    };\n  }\n  if (\"db\" in db) {\n    return {\n      kysely: db.db,\n      databaseType: db.type,\n      transaction: db.transaction\n    };\n  }\n  if (\"dialect\" in db) {\n    return {\n      kysely: new kysely__WEBPACK_IMPORTED_MODULE_5__.Kysely({ dialect: db.dialect }),\n      databaseType: db.type,\n      transaction: db.transaction\n    };\n  }\n  let dialect = void 0;\n  const databaseType = getKyselyDatabaseType(db);\n  if (\"createDriver\" in db) {\n    dialect = db;\n  }\n  if (\"aggregate\" in db && !(\"createSession\" in db)) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_1__.SqliteDialect({\n      database: db\n    });\n  }\n  if (\"getConnection\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_2__.MysqlDialect(db);\n  }\n  if (\"connect\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_3__.PostgresDialect({\n      pool: db\n    });\n  }\n  if (\"fileControl\" in db) {\n    const { BunSqliteDialect } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621\").then(__webpack_require__.bind(__webpack_require__, /*! ../chunks/bun-sqlite-dialect.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs\"));\n    dialect = new BunSqliteDialect({\n      database: db\n    });\n  }\n  if (\"createSession\" in db && typeof window === \"undefined\") {\n    let DatabaseSync = void 0;\n    try {\n      let nodeSqlite = \"node:sqlite\";\n      ({ DatabaseSync } = await import(\n        /* @vite-ignore */\n        /* webpackIgnore: true */\n        nodeSqlite\n      ));\n    } catch (error) {\n      if (error !== null && typeof error === \"object\" && \"code\" in error && error.code !== \"ERR_UNKNOWN_BUILTIN_MODULE\") {\n        throw error;\n      }\n    }\n    if (DatabaseSync && db instanceof DatabaseSync) {\n      const { NodeSqliteDialect } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621\").then(__webpack_require__.bind(__webpack_require__, /*! ../chunks/node-sqlite-dialect.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs\"));\n      dialect = new NodeSqliteDialect({\n        database: db\n      });\n    }\n  }\n  return {\n    kysely: dialect ? new kysely__WEBPACK_IMPORTED_MODULE_5__.Kysely({ dialect }) : null,\n    databaseType,\n    transaction: void 0\n  };\n};\n\nconst kyselyAdapter = (db, config) => {\n  let lazyOptions = null;\n  const createCustomAdapter = (db2) => {\n    return ({ getFieldName, schema, getDefaultModelName }) => {\n      const withReturning = async (values, builder, model, where) => {\n        let res;\n        if (config?.type === \"mysql\") {\n          await builder.execute();\n          const field = values.id ? \"id\" : where.length > 0 && where[0]?.field ? where[0].field : \"id\";\n          if (!values.id && where.length === 0) {\n            res = await db2.selectFrom(model).selectAll().orderBy(getFieldName({ model, field }), \"desc\").limit(1).executeTakeFirst();\n            return res;\n          }\n          const value = values[field] || where[0]?.value;\n          res = await db2.selectFrom(model).selectAll().orderBy(getFieldName({ model, field }), \"desc\").where(getFieldName({ model, field }), \"=\", value).limit(1).executeTakeFirst();\n          return res;\n        }\n        if (config?.type === \"mssql\") {\n          res = await builder.outputAll(\"inserted\").executeTakeFirst();\n          return res;\n        }\n        res = await builder.returningAll().executeTakeFirst();\n        return res;\n      };\n      function transformValueToDB(value, model, field) {\n        if (field === \"id\") {\n          return value;\n        }\n        const { type = \"sqlite\" } = config || {};\n        let f = schema[model]?.fields[field];\n        if (!f) {\n          f = Object.values(schema).find((f2) => f2.modelName === model);\n        }\n        if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null && value !== void 0) {\n          return value ? 1 : 0;\n        }\n        if (f.type === \"date\" && value && value instanceof Date) {\n          if (type === \"sqlite\") return value.toISOString();\n          return value;\n        }\n        return value;\n      }\n      function transformValueFromDB(value) {\n        function transformObject(obj) {\n          for (const key in obj) {\n            if (!Object.prototype.hasOwnProperty.call(obj, key)) continue;\n            const field = obj[key];\n            if (field instanceof Date && config?.type === \"mysql\") ; else if (typeof field === \"object\" && field !== null) {\n              transformObject(field);\n            }\n          }\n        }\n        if (Array.isArray(value)) {\n          for (let i = 0; i < value.length; i++) {\n            const item = value[i];\n            if (typeof item === \"object\" && item !== null) {\n              transformObject(item);\n            }\n          }\n        } else if (typeof value === \"object\" && value !== null) {\n          transformObject(value);\n        }\n        return value;\n      }\n      function convertWhereClause(model, w) {\n        if (!w)\n          return {\n            and: null,\n            or: null\n          };\n        const conditions = {\n          and: [],\n          or: []\n        };\n        w.forEach((condition) => {\n          let {\n            field: _field,\n            value,\n            operator = \"=\",\n            connector = \"AND\"\n          } = condition;\n          const field = getFieldName({ model, field: _field });\n          value = transformValueToDB(value, model, _field);\n          const expr = (eb) => {\n            if (operator.toLowerCase() === \"in\") {\n              return eb(field, \"in\", Array.isArray(value) ? value : [value]);\n            }\n            if (operator.toLowerCase() === \"not_in\") {\n              return eb(\n                field,\n                \"not in\",\n                Array.isArray(value) ? value : [value]\n              );\n            }\n            if (operator === \"contains\") {\n              return eb(field, \"like\", `%${value}%`);\n            }\n            if (operator === \"starts_with\") {\n              return eb(field, \"like\", `${value}%`);\n            }\n            if (operator === \"ends_with\") {\n              return eb(field, \"like\", `%${value}`);\n            }\n            if (operator === \"eq\") {\n              return eb(field, \"=\", value);\n            }\n            if (operator === \"ne\") {\n              return eb(field, \"<>\", value);\n            }\n            if (operator === \"gt\") {\n              return eb(field, \">\", value);\n            }\n            if (operator === \"gte\") {\n              return eb(field, \">=\", value);\n            }\n            if (operator === \"lt\") {\n              return eb(field, \"<\", value);\n            }\n            if (operator === \"lte\") {\n              return eb(field, \"<=\", value);\n            }\n            return eb(field, operator, value);\n          };\n          if (connector === \"OR\") {\n            conditions.or.push(expr);\n          } else {\n            conditions.and.push(expr);\n          }\n        });\n        return {\n          and: conditions.and.length ? conditions.and : null,\n          or: conditions.or.length ? conditions.or : null\n        };\n      }\n      return {\n        async create({ data, model }) {\n          const builder = db2.insertInto(model).values(data);\n          const returned = await withReturning(data, builder, model, []);\n          return transformValueFromDB(returned);\n        },\n        async findOne({ model, where, select }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.selectFrom(model).selectAll();\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          const res = await query.executeTakeFirst();\n          if (!res) return null;\n          return transformValueFromDB(res);\n        },\n        async findMany({ model, where, limit, offset, sortBy }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.selectFrom(model);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          if (config?.type === \"mssql\") {\n            if (!offset) {\n              query = query.top(limit || 100);\n            }\n          } else {\n            query = query.limit(limit || 100);\n          }\n          if (sortBy) {\n            query = query.orderBy(\n              getFieldName({ model, field: sortBy.field }),\n              sortBy.direction\n            );\n          }\n          if (offset) {\n            if (config?.type === \"mssql\") {\n              if (!sortBy) {\n                query = query.orderBy(getFieldName({ model, field: \"id\" }));\n              }\n              query = query.offset(offset).fetch(limit || 100);\n            } else {\n              query = query.offset(offset);\n            }\n          }\n          const res = await query.selectAll().execute();\n          if (!res) return [];\n          return transformValueFromDB(res);\n        },\n        async update({ model, where, update: values }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.updateTable(model).set(values);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          return transformValueFromDB(\n            await withReturning(values, query, model, where)\n          );\n        },\n        async updateMany({ model, where, update: values }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.updateTable(model).set(values);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          const res = await query.execute();\n          return res.length;\n        },\n        async count({ model, where }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.selectFrom(model).select(db2.fn.count(\"id\").as(\"count\"));\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          const res = await query.execute();\n          if (typeof res[0].count === \"number\") {\n            return res[0].count;\n          }\n          if (typeof res[0].count === \"bigint\") {\n            return Number(res[0].count);\n          }\n          return parseInt(res[0].count);\n        },\n        async delete({ model, where }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.deleteFrom(model);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          await query.execute();\n        },\n        async deleteMany({ model, where }) {\n          const { and, or } = convertWhereClause(model, where);\n          let query = db2.deleteFrom(model);\n          if (and) {\n            query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n          }\n          if (or) {\n            query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n          }\n          return (await query.execute()).length;\n        },\n        options: config\n      };\n    };\n  };\n  let adapterOptions = null;\n  adapterOptions = {\n    config: {\n      adapterId: \"kysely\",\n      adapterName: \"Kysely Adapter\",\n      usePlural: config?.usePlural,\n      debugLogs: config?.debugLogs,\n      supportsBooleans: config?.type === \"sqlite\" || config?.type === \"mssql\" || config?.type === \"mysql\" || !config?.type ? false : true,\n      supportsDates: config?.type === \"sqlite\" || config?.type === \"mssql\" || !config?.type ? false : true,\n      supportsJSON: false,\n      transaction: config?.transaction ?? false ? (cb) => db.transaction().execute((trx) => {\n        const adapter2 = (0,_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c)({\n          config: adapterOptions.config,\n          adapter: createCustomAdapter(trx)\n        })(lazyOptions);\n        return cb(adapter2);\n      }) : false\n    },\n    adapter: createCustomAdapter(db)\n  };\n  const adapter = (0,_better_auth_EBxKeVNZ_mjs__WEBPACK_IMPORTED_MODULE_0__.c)(adapterOptions);\n  return (options) => {\n    lazyOptions = options;\n    return adapter(options);\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DQlRTMk96WC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQTRGO0FBQ3JCOztBQUV2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFhO0FBQ25DO0FBQ0E7QUFDQSxzQkFBc0IsZ0RBQVk7QUFDbEM7QUFDQTtBQUNBLHNCQUFzQixtREFBZTtBQUNyQztBQUNBO0FBQ0Esc0JBQXNCLGdEQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsMENBQU0sR0FBRyxxQkFBcUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQWE7QUFDL0I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGtCQUFrQixnREFBWTtBQUM5QjtBQUNBO0FBQ0Esa0JBQWtCLG1EQUFlO0FBQ2pDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZLG1CQUFtQixRQUFRLHNXQUEwQztBQUNqRjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLGVBQWU7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMs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O0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNERBQW9CO0FBQzdDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxrQkFBa0IsNERBQW9CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW9GIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DQlRTMk96WC5tanM/ZDM3ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTcWxpdGVEaWFsZWN0LCBNeXNxbERpYWxlY3QsIFBvc3RncmVzRGlhbGVjdCwgTXNzcWxEaWFsZWN0LCBLeXNlbHkgfSBmcm9tICdreXNlbHknO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVBZGFwdGVyRmFjdG9yeSB9IGZyb20gJy4vYmV0dGVyLWF1dGguRUJ4S2VWTloubWpzJztcblxuZnVuY3Rpb24gZ2V0S3lzZWx5RGF0YWJhc2VUeXBlKGRiKSB7XG4gIGlmICghZGIpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoXCJkaWFsZWN0XCIgaW4gZGIpIHtcbiAgICByZXR1cm4gZ2V0S3lzZWx5RGF0YWJhc2VUeXBlKGRiLmRpYWxlY3QpO1xuICB9XG4gIGlmIChcImNyZWF0ZURyaXZlclwiIGluIGRiKSB7XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgU3FsaXRlRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwic3FsaXRlXCI7XG4gICAgfVxuICAgIGlmIChkYiBpbnN0YW5jZW9mIE15c3FsRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwibXlzcWxcIjtcbiAgICB9XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgUG9zdGdyZXNEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJwb3N0Z3Jlc1wiO1xuICAgIH1cbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBNc3NxbERpYWxlY3QpIHtcbiAgICAgIHJldHVybiBcIm1zc3FsXCI7XG4gICAgfVxuICB9XG4gIGlmIChcImFnZ3JlZ2F0ZVwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwic3FsaXRlXCI7XG4gIH1cbiAgaWYgKFwiZ2V0Q29ubmVjdGlvblwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwibXlzcWxcIjtcbiAgfVxuICBpZiAoXCJjb25uZWN0XCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJwb3N0Z3Jlc1wiO1xuICB9XG4gIGlmIChcImZpbGVDb250cm9sXCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJzcWxpdGVcIjtcbiAgfVxuICBpZiAoXCJvcGVuXCIgaW4gZGIgJiYgXCJjbG9zZVwiIGluIGRiICYmIFwicHJlcGFyZVwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwic3FsaXRlXCI7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5jb25zdCBjcmVhdGVLeXNlbHlBZGFwdGVyID0gYXN5bmMgKGNvbmZpZykgPT4ge1xuICBjb25zdCBkYiA9IGNvbmZpZy5kYXRhYmFzZTtcbiAgaWYgKCFkYikge1xuICAgIHJldHVybiB7XG4gICAgICBreXNlbHk6IG51bGwsXG4gICAgICBkYXRhYmFzZVR5cGU6IG51bGwsXG4gICAgICB0cmFuc2FjdGlvbjogdm9pZCAwXG4gICAgfTtcbiAgfVxuICBpZiAoXCJkYlwiIGluIGRiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGt5c2VseTogZGIuZGIsXG4gICAgICBkYXRhYmFzZVR5cGU6IGRiLnR5cGUsXG4gICAgICB0cmFuc2FjdGlvbjogZGIudHJhbnNhY3Rpb25cbiAgICB9O1xuICB9XG4gIGlmIChcImRpYWxlY3RcIiBpbiBkYikge1xuICAgIHJldHVybiB7XG4gICAgICBreXNlbHk6IG5ldyBLeXNlbHkoeyBkaWFsZWN0OiBkYi5kaWFsZWN0IH0pLFxuICAgICAgZGF0YWJhc2VUeXBlOiBkYi50eXBlLFxuICAgICAgdHJhbnNhY3Rpb246IGRiLnRyYW5zYWN0aW9uXG4gICAgfTtcbiAgfVxuICBsZXQgZGlhbGVjdCA9IHZvaWQgMDtcbiAgY29uc3QgZGF0YWJhc2VUeXBlID0gZ2V0S3lzZWx5RGF0YWJhc2VUeXBlKGRiKTtcbiAgaWYgKFwiY3JlYXRlRHJpdmVyXCIgaW4gZGIpIHtcbiAgICBkaWFsZWN0ID0gZGI7XG4gIH1cbiAgaWYgKFwiYWdncmVnYXRlXCIgaW4gZGIgJiYgIShcImNyZWF0ZVNlc3Npb25cIiBpbiBkYikpIHtcbiAgICBkaWFsZWN0ID0gbmV3IFNxbGl0ZURpYWxlY3Qoe1xuICAgICAgZGF0YWJhc2U6IGRiXG4gICAgfSk7XG4gIH1cbiAgaWYgKFwiZ2V0Q29ubmVjdGlvblwiIGluIGRiKSB7XG4gICAgZGlhbGVjdCA9IG5ldyBNeXNxbERpYWxlY3QoZGIpO1xuICB9XG4gIGlmIChcImNvbm5lY3RcIiBpbiBkYikge1xuICAgIGRpYWxlY3QgPSBuZXcgUG9zdGdyZXNEaWFsZWN0KHtcbiAgICAgIHBvb2w6IGRiXG4gICAgfSk7XG4gIH1cbiAgaWYgKFwiZmlsZUNvbnRyb2xcIiBpbiBkYikge1xuICAgIGNvbnN0IHsgQnVuU3FsaXRlRGlhbGVjdCB9ID0gYXdhaXQgaW1wb3J0KCcuLi9jaHVua3MvYnVuLXNxbGl0ZS1kaWFsZWN0Lm1qcycpO1xuICAgIGRpYWxlY3QgPSBuZXcgQnVuU3FsaXRlRGlhbGVjdCh7XG4gICAgICBkYXRhYmFzZTogZGJcbiAgICB9KTtcbiAgfVxuICBpZiAoXCJjcmVhdGVTZXNzaW9uXCIgaW4gZGIgJiYgdHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGxldCBEYXRhYmFzZVN5bmMgPSB2b2lkIDA7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBub2RlU3FsaXRlID0gXCJub2RlOnNxbGl0ZVwiO1xuICAgICAgKHsgRGF0YWJhc2VTeW5jIH0gPSBhd2FpdCBpbXBvcnQoXG4gICAgICAgIC8qIEB2aXRlLWlnbm9yZSAqL1xuICAgICAgICAvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovXG4gICAgICAgIG5vZGVTcWxpdGVcbiAgICAgICkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgIT09IG51bGwgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIFwiY29kZVwiIGluIGVycm9yICYmIGVycm9yLmNvZGUgIT09IFwiRVJSX1VOS05PV05fQlVJTFRJTl9NT0RVTEVcIikge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKERhdGFiYXNlU3luYyAmJiBkYiBpbnN0YW5jZW9mIERhdGFiYXNlU3luYykge1xuICAgICAgY29uc3QgeyBOb2RlU3FsaXRlRGlhbGVjdCB9ID0gYXdhaXQgaW1wb3J0KCcuLi9jaHVua3Mvbm9kZS1zcWxpdGUtZGlhbGVjdC5tanMnKTtcbiAgICAgIGRpYWxlY3QgPSBuZXcgTm9kZVNxbGl0ZURpYWxlY3Qoe1xuICAgICAgICBkYXRhYmFzZTogZGJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIGt5c2VseTogZGlhbGVjdCA/IG5ldyBLeXNlbHkoeyBkaWFsZWN0IH0pIDogbnVsbCxcbiAgICBkYXRhYmFzZVR5cGUsXG4gICAgdHJhbnNhY3Rpb246IHZvaWQgMFxuICB9O1xufTtcblxuY29uc3Qga3lzZWx5QWRhcHRlciA9IChkYiwgY29uZmlnKSA9PiB7XG4gIGxldCBsYXp5T3B0aW9ucyA9IG51bGw7XG4gIGNvbnN0IGNyZWF0ZUN1c3RvbUFkYXB0ZXIgPSAoZGIyKSA9PiB7XG4gICAgcmV0dXJuICh7IGdldEZpZWxkTmFtZSwgc2NoZW1hLCBnZXREZWZhdWx0TW9kZWxOYW1lIH0pID0+IHtcbiAgICAgIGNvbnN0IHdpdGhSZXR1cm5pbmcgPSBhc3luYyAodmFsdWVzLCBidWlsZGVyLCBtb2RlbCwgd2hlcmUpID0+IHtcbiAgICAgICAgbGV0IHJlcztcbiAgICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJteXNxbFwiKSB7XG4gICAgICAgICAgYXdhaXQgYnVpbGRlci5leGVjdXRlKCk7XG4gICAgICAgICAgY29uc3QgZmllbGQgPSB2YWx1ZXMuaWQgPyBcImlkXCIgOiB3aGVyZS5sZW5ndGggPiAwICYmIHdoZXJlWzBdPy5maWVsZCA/IHdoZXJlWzBdLmZpZWxkIDogXCJpZFwiO1xuICAgICAgICAgIGlmICghdmFsdWVzLmlkICYmIHdoZXJlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmVzID0gYXdhaXQgZGIyLnNlbGVjdEZyb20obW9kZWwpLnNlbGVjdEFsbCgpLm9yZGVyQnkoZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkIH0pLCBcImRlc2NcIikubGltaXQoMSkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbZmllbGRdIHx8IHdoZXJlWzBdPy52YWx1ZTtcbiAgICAgICAgICByZXMgPSBhd2FpdCBkYjIuc2VsZWN0RnJvbShtb2RlbCkuc2VsZWN0QWxsKCkub3JkZXJCeShnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQgfSksIFwiZGVzY1wiKS53aGVyZShnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQgfSksIFwiPVwiLCB2YWx1ZSkubGltaXQoMSkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJtc3NxbFwiKSB7XG4gICAgICAgICAgcmVzID0gYXdhaXQgYnVpbGRlci5vdXRwdXRBbGwoXCJpbnNlcnRlZFwiKS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICByZXMgPSBhd2FpdCBidWlsZGVyLnJldHVybmluZ0FsbCgpLmV4ZWN1dGVUYWtlRmlyc3QoKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH07XG4gICAgICBmdW5jdGlvbiB0cmFuc2Zvcm1WYWx1ZVRvREIodmFsdWUsIG1vZGVsLCBmaWVsZCkge1xuICAgICAgICBpZiAoZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHR5cGUgPSBcInNxbGl0ZVwiIH0gPSBjb25maWcgfHwge307XG4gICAgICAgIGxldCBmID0gc2NoZW1hW21vZGVsXT8uZmllbGRzW2ZpZWxkXTtcbiAgICAgICAgaWYgKCFmKSB7XG4gICAgICAgICAgZiA9IE9iamVjdC52YWx1ZXMoc2NoZW1hKS5maW5kKChmMikgPT4gZjIubW9kZWxOYW1lID09PSBtb2RlbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGYudHlwZSA9PT0gXCJib29sZWFuXCIgJiYgKHR5cGUgPT09IFwic3FsaXRlXCIgfHwgdHlwZSA9PT0gXCJtc3NxbFwiKSAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8gMSA6IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGYudHlwZSA9PT0gXCJkYXRlXCIgJiYgdmFsdWUgJiYgdmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgaWYgKHR5cGUgPT09IFwic3FsaXRlXCIpIHJldHVybiB2YWx1ZS50b0lTT1N0cmluZygpO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiB0cmFuc2Zvcm1WYWx1ZUZyb21EQih2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiB0cmFuc2Zvcm1PYmplY3Qob2JqKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBvYmpba2V5XTtcbiAgICAgICAgICAgIGlmIChmaWVsZCBpbnN0YW5jZW9mIERhdGUgJiYgY29uZmlnPy50eXBlID09PSBcIm15c3FsXCIpIDsgZWxzZSBpZiAodHlwZW9mIGZpZWxkID09PSBcIm9iamVjdFwiICYmIGZpZWxkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybU9iamVjdChmaWVsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB2YWx1ZVtpXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gXCJvYmplY3RcIiAmJiBpdGVtICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybU9iamVjdChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgdHJhbnNmb3JtT2JqZWN0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHcpIHtcbiAgICAgICAgaWYgKCF3KVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhbmQ6IG51bGwsXG4gICAgICAgICAgICBvcjogbnVsbFxuICAgICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNvbmRpdGlvbnMgPSB7XG4gICAgICAgICAgYW5kOiBbXSxcbiAgICAgICAgICBvcjogW11cbiAgICAgICAgfTtcbiAgICAgICAgdy5mb3JFYWNoKChjb25kaXRpb24pID0+IHtcbiAgICAgICAgICBsZXQge1xuICAgICAgICAgICAgZmllbGQ6IF9maWVsZCxcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgb3BlcmF0b3IgPSBcIj1cIixcbiAgICAgICAgICAgIGNvbm5lY3RvciA9IFwiQU5EXCJcbiAgICAgICAgICB9ID0gY29uZGl0aW9uO1xuICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiBfZmllbGQgfSk7XG4gICAgICAgICAgdmFsdWUgPSB0cmFuc2Zvcm1WYWx1ZVRvREIodmFsdWUsIG1vZGVsLCBfZmllbGQpO1xuICAgICAgICAgIGNvbnN0IGV4cHIgPSAoZWIpID0+IHtcbiAgICAgICAgICAgIGlmIChvcGVyYXRvci50b0xvd2VyQ2FzZSgpID09PSBcImluXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcImluXCIsIEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbdmFsdWVdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvci50b0xvd2VyQ2FzZSgpID09PSBcIm5vdF9pblwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihcbiAgICAgICAgICAgICAgICBmaWVsZCxcbiAgICAgICAgICAgICAgICBcIm5vdCBpblwiLFxuICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbdmFsdWVdXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiY29udGFpbnNcIikge1xuICAgICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwibGlrZVwiLCBgJSR7dmFsdWV9JWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcInN0YXJ0c193aXRoXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcImxpa2VcIiwgYCR7dmFsdWV9JWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImVuZHNfd2l0aFwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCJsaWtlXCIsIGAlJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJlcVwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI9XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJuZVwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8PlwiLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZ3RcIikge1xuICAgICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPlwiLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZ3RlXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIj49XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJsdFwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJsdGVcIikge1xuICAgICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPD1cIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBvcGVyYXRvciwgdmFsdWUpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGNvbm5lY3RvciA9PT0gXCJPUlwiKSB7XG4gICAgICAgICAgICBjb25kaXRpb25zLm9yLnB1c2goZXhwcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbmRpdGlvbnMuYW5kLnB1c2goZXhwcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhbmQ6IGNvbmRpdGlvbnMuYW5kLmxlbmd0aCA/IGNvbmRpdGlvbnMuYW5kIDogbnVsbCxcbiAgICAgICAgICBvcjogY29uZGl0aW9ucy5vci5sZW5ndGggPyBjb25kaXRpb25zLm9yIDogbnVsbFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXN5bmMgY3JlYXRlKHsgZGF0YSwgbW9kZWwgfSkge1xuICAgICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYjIuaW5zZXJ0SW50byhtb2RlbCkudmFsdWVzKGRhdGEpO1xuICAgICAgICAgIGNvbnN0IHJldHVybmVkID0gYXdhaXQgd2l0aFJldHVybmluZyhkYXRhLCBidWlsZGVyLCBtb2RlbCwgW10pO1xuICAgICAgICAgIHJldHVybiB0cmFuc2Zvcm1WYWx1ZUZyb21EQihyZXR1cm5lZCk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIGZpbmRPbmUoeyBtb2RlbCwgd2hlcmUsIHNlbGVjdCB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIuc2VsZWN0RnJvbShtb2RlbCkuc2VsZWN0QWxsKCk7XG4gICAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICAgIGlmICghcmVzKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtVmFsdWVGcm9tREIocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgZmluZE1hbnkoeyBtb2RlbCwgd2hlcmUsIGxpbWl0LCBvZmZzZXQsIHNvcnRCeSB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIuc2VsZWN0RnJvbShtb2RlbCk7XG4gICAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJtc3NxbFwiKSB7XG4gICAgICAgICAgICBpZiAoIW9mZnNldCkge1xuICAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LnRvcChsaW1pdCB8fCAxMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LmxpbWl0KGxpbWl0IHx8IDEwMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzb3J0QnkpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXJCeShcbiAgICAgICAgICAgICAgZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiBzb3J0QnkuZmllbGQgfSksXG4gICAgICAgICAgICAgIHNvcnRCeS5kaXJlY3Rpb25cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAgIGlmIChjb25maWc/LnR5cGUgPT09IFwibXNzcWxcIikge1xuICAgICAgICAgICAgICBpZiAoIXNvcnRCeSkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXJCeShnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IFwiaWRcIiB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5vZmZzZXQob2Zmc2V0KS5mZXRjaChsaW1pdCB8fCAxMDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5vZmZzZXQob2Zmc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuc2VsZWN0QWxsKCkuZXhlY3V0ZSgpO1xuICAgICAgICAgIGlmICghcmVzKSByZXR1cm4gW107XG4gICAgICAgICAgcmV0dXJuIHRyYW5zZm9ybVZhbHVlRnJvbURCKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHVwZGF0ZSh7IG1vZGVsLCB3aGVyZSwgdXBkYXRlOiB2YWx1ZXMgfSkge1xuICAgICAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgICAgbGV0IHF1ZXJ5ID0gZGIyLnVwZGF0ZVRhYmxlKG1vZGVsKS5zZXQodmFsdWVzKTtcbiAgICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtVmFsdWVGcm9tREIoXG4gICAgICAgICAgICBhd2FpdCB3aXRoUmV0dXJuaW5nKHZhbHVlcywgcXVlcnksIG1vZGVsLCB3aGVyZSlcbiAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyB1cGRhdGVNYW55KHsgbW9kZWwsIHdoZXJlLCB1cGRhdGU6IHZhbHVlcyB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIudXBkYXRlVGFibGUobW9kZWwpLnNldCh2YWx1ZXMpO1xuICAgICAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcikge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICAgICAgICByZXR1cm4gcmVzLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgY291bnQoeyBtb2RlbCwgd2hlcmUgfSkge1xuICAgICAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgICAgbGV0IHF1ZXJ5ID0gZGIyLnNlbGVjdEZyb20obW9kZWwpLnNlbGVjdChkYjIuZm4uY291bnQoXCJpZFwiKS5hcyhcImNvdW50XCIpKTtcbiAgICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeS5leGVjdXRlKCk7XG4gICAgICAgICAgaWYgKHR5cGVvZiByZXNbMF0uY291bnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNbMF0uY291bnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgcmVzWzBdLmNvdW50ID09PSBcImJpZ2ludFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gTnVtYmVyKHJlc1swXS5jb3VudCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBwYXJzZUludChyZXNbMF0uY291bnQpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBkZWxldGUoeyBtb2RlbCwgd2hlcmUgfSkge1xuICAgICAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgICAgbGV0IHF1ZXJ5ID0gZGIyLmRlbGV0ZUZyb20obW9kZWwpO1xuICAgICAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcikge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgZGVsZXRlTWFueSh7IG1vZGVsLCB3aGVyZSB9KSB7XG4gICAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgICBsZXQgcXVlcnkgPSBkYjIuZGVsZXRlRnJvbShtb2RlbCk7XG4gICAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIChhd2FpdCBxdWVyeS5leGVjdXRlKCkpLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgb3B0aW9uczogY29uZmlnXG4gICAgICB9O1xuICAgIH07XG4gIH07XG4gIGxldCBhZGFwdGVyT3B0aW9ucyA9IG51bGw7XG4gIGFkYXB0ZXJPcHRpb25zID0ge1xuICAgIGNvbmZpZzoge1xuICAgICAgYWRhcHRlcklkOiBcImt5c2VseVwiLFxuICAgICAgYWRhcHRlck5hbWU6IFwiS3lzZWx5IEFkYXB0ZXJcIixcbiAgICAgIHVzZVBsdXJhbDogY29uZmlnPy51c2VQbHVyYWwsXG4gICAgICBkZWJ1Z0xvZ3M6IGNvbmZpZz8uZGVidWdMb2dzLFxuICAgICAgc3VwcG9ydHNCb29sZWFuczogY29uZmlnPy50eXBlID09PSBcInNxbGl0ZVwiIHx8IGNvbmZpZz8udHlwZSA9PT0gXCJtc3NxbFwiIHx8IGNvbmZpZz8udHlwZSA9PT0gXCJteXNxbFwiIHx8ICFjb25maWc/LnR5cGUgPyBmYWxzZSA6IHRydWUsXG4gICAgICBzdXBwb3J0c0RhdGVzOiBjb25maWc/LnR5cGUgPT09IFwic3FsaXRlXCIgfHwgY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIgfHwgIWNvbmZpZz8udHlwZSA/IGZhbHNlIDogdHJ1ZSxcbiAgICAgIHN1cHBvcnRzSlNPTjogZmFsc2UsXG4gICAgICB0cmFuc2FjdGlvbjogY29uZmlnPy50cmFuc2FjdGlvbiA/PyBmYWxzZSA/IChjYikgPT4gZGIudHJhbnNhY3Rpb24oKS5leGVjdXRlKCh0cngpID0+IHtcbiAgICAgICAgY29uc3QgYWRhcHRlcjIgPSBjcmVhdGVBZGFwdGVyRmFjdG9yeSh7XG4gICAgICAgICAgY29uZmlnOiBhZGFwdGVyT3B0aW9ucy5jb25maWcsXG4gICAgICAgICAgYWRhcHRlcjogY3JlYXRlQ3VzdG9tQWRhcHRlcih0cngpXG4gICAgICAgIH0pKGxhenlPcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIGNiKGFkYXB0ZXIyKTtcbiAgICAgIH0pIDogZmFsc2VcbiAgICB9LFxuICAgIGFkYXB0ZXI6IGNyZWF0ZUN1c3RvbUFkYXB0ZXIoZGIpXG4gIH07XG4gIGNvbnN0IGFkYXB0ZXIgPSBjcmVhdGVBZGFwdGVyRmFjdG9yeShhZGFwdGVyT3B0aW9ucyk7XG4gIHJldHVybiAob3B0aW9ucykgPT4ge1xuICAgIGxhenlPcHRpb25zID0gb3B0aW9ucztcbiAgICByZXR1cm4gYWRhcHRlcihvcHRpb25zKTtcbiAgfTtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUt5c2VseUFkYXB0ZXIgYXMgYywgZ2V0S3lzZWx5RGF0YWJhc2VUeXBlIGFzIGcsIGt5c2VseUFkYXB0ZXIgYXMgayB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   b: () => (/* binding */ betterAuth)\n/* harmony export */ });\n/* harmony import */ var _api_index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../api/index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/api/index.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_core_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/core/db */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/index.mjs\");\n/* harmony import */ var _better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BG42OQGC.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BG42OQGC.mjs\");\n/* harmony import */ var _better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/core/social-providers */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/social-providers/index.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.YwDQhoPc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_telemetry__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @better-auth/telemetry */ \"(rsc)/./node_modules/.pnpm/@better-auth+telemetry@1.3._9689844af577e247fe82d98ccf8641df/node_modules/@better-auth/telemetry/dist/index.mjs\");\n/* harmony import */ var _better_auth_core_db_adapter__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @better-auth/core/db/adapter */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/db/adapter/index.mjs\");\n/* harmony import */ var _better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./better-auth.CBTS2OzX.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CBTS2OzX.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst DEFAULT_SECRET = \"better-auth-secret-123456789\";\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === \"object\" || typeof obj === \"function\") && typeof obj.then === \"function\";\n}\n\nconst init = async (options) => {\n  const adapter = await (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.a)(options);\n  const plugins = options.plugins || [];\n  const internalPlugins = getInternalPlugins(options);\n  const logger = (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.createLogger)(options.logger);\n  const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.a)(options.baseURL, options.basePath);\n  const secret = options.secret || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.env.BETTER_AUTH_SECRET || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.env.AUTH_SECRET || DEFAULT_SECRET;\n  if (secret === DEFAULT_SECRET) {\n    if (_better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.isProduction) {\n      logger.error(\n        \"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\"\n      );\n    }\n  }\n  options = {\n    ...options,\n    secret,\n    baseURL: baseURL ? new URL(baseURL).origin : \"\",\n    basePath: options.basePath || \"/api/auth\",\n    plugins: plugins.concat(internalPlugins)\n  };\n  (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.checkEndpointConflicts)(options, logger);\n  const cookies = (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(options);\n  const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_5__.g)(options);\n  const providers = Object.entries(\n    options.socialProviders || {}\n  ).map(([key, config]) => {\n    if (config == null) {\n      return null;\n    }\n    if (config.enabled === false) {\n      return null;\n    }\n    if (!config.clientId) {\n      logger.warn(\n        `Social provider ${key} is missing clientId or clientSecret`\n      );\n    }\n    const provider = _better_auth_core_social_providers__WEBPACK_IMPORTED_MODULE_9__.socialProviders[key](config);\n    provider.disableImplicitSignUp = config.disableImplicitSignUp;\n    return provider;\n  }).filter((x) => x !== null);\n  const generateIdFunc = ({ model, size }) => {\n    if (typeof options.advanced?.generateId === \"function\") {\n      return options.advanced.generateId({ model, size });\n    }\n    if (typeof options?.advanced?.database?.generateId === \"function\") {\n      return options.advanced.database.generateId({ model, size });\n    }\n    return (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(size);\n  };\n  const { publish } = await (0,_better_auth_telemetry__WEBPACK_IMPORTED_MODULE_17__.createTelemetry)(options, {\n    adapter: adapter.id,\n    database: typeof options.database === \"function\" ? \"adapter\" : (0,_better_auth_CBTS2OzX_mjs__WEBPACK_IMPORTED_MODULE_19__.g)(options.database) || \"unknown\"\n  });\n  let ctx = {\n    appName: options.appName || \"Better Auth\",\n    socialProviders: providers,\n    options,\n    tables,\n    trustedOrigins: getTrustedOrigins(options),\n    baseURL: baseURL || \"\",\n    sessionConfig: {\n      updateAge: options.session?.updateAge !== void 0 ? options.session.updateAge : 24 * 60 * 60,\n      // 24 hours\n      expiresIn: options.session?.expiresIn || 60 * 60 * 24 * 7,\n      // 7 days\n      freshAge: options.session?.freshAge === void 0 ? 60 * 60 * 24 : options.session.freshAge\n    },\n    secret,\n    rateLimit: {\n      ...options.rateLimit,\n      enabled: options.rateLimit?.enabled ?? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.isProduction,\n      window: options.rateLimit?.window || 10,\n      max: options.rateLimit?.max || 100,\n      storage: options.rateLimit?.storage || (options.secondaryStorage ? \"secondary-storage\" : \"memory\")\n    },\n    authCookies: cookies,\n    logger,\n    generateId: generateIdFunc,\n    session: null,\n    secondaryStorage: options.secondaryStorage,\n    password: {\n      hash: options.emailAndPassword?.password?.hash || _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.hashPassword,\n      verify: options.emailAndPassword?.password?.verify || _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.verifyPassword,\n      config: {\n        minPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n        maxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128\n      },\n      checkPassword: _better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_14__.c\n    },\n    setNewSession(session) {\n      this.newSession = session;\n    },\n    newSession: null,\n    adapter,\n    internalAdapter: (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.c)(adapter, {\n      options,\n      logger,\n      hooks: options.databaseHooks ? [options.databaseHooks] : []}),\n    createAuthCookie: (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_7__.c)(options),\n    async runMigrations() {\n      if (!options.database || \"updateMany\" in options.database) {\n        throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError(\n          \"Database is not provided or it's an adapter. Migrations are only supported with a database instance.\"\n        );\n      }\n      const { runMigrations } = await (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.e)(options);\n      await runMigrations();\n    },\n    publishTelemetry: publish,\n    skipCSRFCheck: !!options.advanced?.disableCSRFCheck,\n    skipOriginCheck: options.advanced?.disableOriginCheck !== void 0 ? options.advanced.disableOriginCheck : (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.isTest)() ? true : false\n  };\n  const initOrPromise = runPluginInit(ctx);\n  let context;\n  if (isPromise(initOrPromise)) {\n    ({ context } = await initOrPromise);\n  } else {\n    ({ context } = initOrPromise);\n  }\n  return context;\n};\nasync function runPluginInit(ctx) {\n  let options = ctx.options;\n  const plugins = options.plugins || [];\n  let context = ctx;\n  const dbHooks = [];\n  for (const plugin of plugins) {\n    if (plugin.init) {\n      let initPromise = plugin.init(context);\n      let result;\n      if (isPromise(initPromise)) {\n        result = await initPromise;\n      } else {\n        result = initPromise;\n      }\n      if (typeof result === \"object\") {\n        if (result.options) {\n          const { databaseHooks, ...restOpts } = result.options;\n          if (databaseHooks) {\n            dbHooks.push(databaseHooks);\n          }\n          options = (0,defu__WEBPACK_IMPORTED_MODULE_1__.defu)(options, restOpts);\n        }\n        if (result.context) {\n          context = {\n            ...context,\n            ...result.context\n          };\n        }\n      }\n    }\n  }\n  dbHooks.push(options.databaseHooks);\n  context.internalAdapter = (0,_better_auth_BG42OQGC_mjs__WEBPACK_IMPORTED_MODULE_4__.c)(ctx.adapter, {\n    options,\n    logger: ctx.logger,\n    hooks: dbHooks.filter((u) => u !== void 0),\n    generateId: ctx.generateId\n  });\n  context.options = options;\n  return { context };\n}\nfunction getInternalPlugins(options) {\n  const plugins = [];\n  if (options.advanced?.crossSubDomainCookies?.enabled) ;\n  return plugins;\n}\nfunction getTrustedOrigins(options) {\n  const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.a)(options.baseURL, options.basePath);\n  if (!baseURL) {\n    return [];\n  }\n  const trustedOrigins = [new URL(baseURL).origin];\n  if (options.trustedOrigins && Array.isArray(options.trustedOrigins)) {\n    trustedOrigins.push(...options.trustedOrigins);\n  }\n  const envTrustedOrigins = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_8__.env.BETTER_AUTH_TRUSTED_ORIGINS;\n  if (envTrustedOrigins) {\n    trustedOrigins.push(...envTrustedOrigins.split(\",\"));\n  }\n  if (trustedOrigins.filter((x) => !x).length) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError(\n      \"A provided trusted origin is invalid, make sure your trusted origins list is properly defined.\"\n    );\n  }\n  return trustedOrigins;\n}\n\nconst betterAuth = (options) => {\n  const authContext = init(options);\n  const { api } = (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(authContext, options);\n  const errorCodes = options.plugins?.reduce((acc, plugin) => {\n    if (plugin.$ERROR_CODES) {\n      return {\n        ...acc,\n        ...plugin.$ERROR_CODES\n      };\n    }\n    return acc;\n  }, {});\n  return {\n    handler: async (request) => {\n      const ctx = await authContext;\n      const basePath = ctx.options.basePath || \"/api/auth\";\n      if (!ctx.options.baseURL) {\n        const baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.a)(void 0, basePath, request);\n        if (baseURL) {\n          ctx.baseURL = baseURL;\n          ctx.options.baseURL = (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_15__.g)(ctx.baseURL) || void 0;\n        } else {\n          throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError(\n            \"Could not get base URL from request. Please provide a valid base URL.\"\n          );\n        }\n      }\n      ctx.trustedOrigins = [\n        ...options.trustedOrigins ? Array.isArray(options.trustedOrigins) ? options.trustedOrigins : await options.trustedOrigins(request) : [],\n        ctx.options.baseURL\n      ];\n      const { handler } = (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.router)(ctx, options);\n      return handler(request);\n    },\n    api,\n    options,\n    $context: authContext,\n    $Infer: {},\n    $ERROR_CODES: {\n      ...errorCodes,\n      ..._better_auth_core_error__WEBPACK_IMPORTED_MODULE_16__.BASE_ERROR_CODES\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DRHgxUG9OTy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWdGO0FBQ3BEO0FBQ3VDO0FBQ3JDO0FBQytFO0FBQzdDO0FBQ25EO0FBQ1E7QUFDaUU7QUFDTjtBQUNYO0FBQ1I7QUFDNUI7QUFDQztBQUNEO0FBQ0U7QUFDckI7QUFDc0I7QUFDNEI7QUFDYTtBQUNEO0FBQ25CO0FBQ25CO0FBQ2tDOztBQUV4RTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3QkFBd0IsNERBQVU7QUFDbEM7QUFDQTtBQUNBLGlCQUFpQixtRUFBWTtBQUM3QixrQkFBa0IsNkRBQVU7QUFDNUIsbUNBQW1DLHNEQUFHLHVCQUF1QixzREFBRztBQUNoRTtBQUNBLFFBQVEsK0RBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxzRUFBc0I7QUFDeEIsa0JBQWtCLDREQUFVO0FBQzVCLGlCQUFpQiw0REFBYTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLEtBQUs7QUFDaEM7QUFDQTtBQUNBLHFCQUFxQiwrRUFBZTtBQUNwQztBQUNBO0FBQ0EsR0FBRztBQUNILDRCQUE0QixhQUFhO0FBQ3pDO0FBQ0EsMkNBQTJDLGFBQWE7QUFDeEQ7QUFDQTtBQUNBLG9EQUFvRCxhQUFhO0FBQ2pFO0FBQ0EsV0FBVyw2REFBVTtBQUNyQjtBQUNBLFVBQVUsVUFBVSxRQUFRLHdFQUFlO0FBQzNDO0FBQ0EsbUVBQW1FLDZEQUFxQjtBQUN4RixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLCtEQUFZO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsMkRBQVk7QUFDcEUsNERBQTRELDZEQUFjO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxtQkFBbUI7QUFDbkIsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHFCQUFxQiw0REFBcUI7QUFDMUM7QUFDQTtBQUNBLGtFQUFrRTtBQUNsRSxzQkFBc0IsNERBQWtCO0FBQ3hDO0FBQ0E7QUFDQSxrQkFBa0IscUVBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0EsY0FBYyxnQkFBZ0IsUUFBUSw0REFBYTtBQUNuRDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsNkdBQTZHLDZEQUFNO0FBQ25IO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxVQUFVO0FBQ2pCLElBQUk7QUFDSixPQUFPLFVBQVU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw2QkFBNkI7QUFDL0M7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBDQUFJO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNERBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZEQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHNEQUFHO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxxRUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxVQUFVLE1BQU0sRUFBRSw0REFBWTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxJQUFJO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw2REFBVTtBQUNsQztBQUNBO0FBQ0EsZ0NBQWdDLDZEQUFTO0FBQ3pDLFVBQVU7QUFDVixvQkFBb0IscUVBQWU7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsVUFBVSxFQUFFLHNEQUFNO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsU0FBUyxzRUFBZ0I7QUFDekI7QUFDQTtBQUNBOztBQUUyQiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ0R4MVBvTk8ubWpzP2JmM2QiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hlY2tFbmRwb2ludENvbmZsaWN0cywgZ2V0RW5kcG9pbnRzLCByb3V0ZXIgfSBmcm9tICcuLi9hcGkvaW5kZXgubWpzJztcbmltcG9ydCB7IGRlZnUgfSBmcm9tICdkZWZ1JztcbmltcG9ydCB7IHZlcmlmeVBhc3N3b3JkLCBoYXNoUGFzc3dvcmQgfSBmcm9tICcuLi9jcnlwdG8vaW5kZXgubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZGInO1xuaW1wb3J0IHsgYSBhcyBnZXRBZGFwdGVyLCBjIGFzIGNyZWF0ZUludGVybmFsQWRhcHRlciwgZSBhcyBnZXRNaWdyYXRpb25zIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CRzQyT1FHQy5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRBdXRoVGFibGVzIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5wUWplUmt6Ti5tanMnO1xuaW1wb3J0ICd6b2QnO1xuaW1wb3J0ICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBnIGFzIGdldENvb2tpZXMsIGMgYXMgY3JlYXRlQ29va2llR2V0dGVyIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EOV92UVI4My5tanMnO1xuaW1wb3J0IHsgY3JlYXRlTG9nZ2VyLCBlbnYsIGlzUHJvZHVjdGlvbiwgaXNUZXN0IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCB7IHNvY2lhbFByb3ZpZGVycyB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL3NvY2lhbC1wcm92aWRlcnMnO1xuaW1wb3J0IHsgZyBhcyBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICcuL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgeyBjIGFzIGNoZWNrUGFzc3dvcmQgfSBmcm9tICcuL2JldHRlci1hdXRoLll3RFFob1BjLm1qcyc7XG5pbXBvcnQgeyBhIGFzIGdldEJhc2VVUkwsIGcgYXMgZ2V0T3JpZ2luIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanMnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yLCBCQVNFX0VSUk9SX0NPREVTIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0IHsgY3JlYXRlVGVsZW1ldHJ5IH0gZnJvbSAnQGJldHRlci1hdXRoL3RlbGVtZXRyeSc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL2RiL2FkYXB0ZXInO1xuaW1wb3J0IHsgZyBhcyBnZXRLeXNlbHlEYXRhYmFzZVR5cGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkNCVFMyT3pYLm1qcyc7XG5cbmNvbnN0IERFRkFVTFRfU0VDUkVUID0gXCJiZXR0ZXItYXV0aC1zZWNyZXQtMTIzNDU2Nzg5XCI7XG5cbmZ1bmN0aW9uIGlzUHJvbWlzZShvYmopIHtcbiAgcmV0dXJuICEhb2JqICYmICh0eXBlb2Ygb2JqID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBvYmogPT09IFwiZnVuY3Rpb25cIikgJiYgdHlwZW9mIG9iai50aGVuID09PSBcImZ1bmN0aW9uXCI7XG59XG5cbmNvbnN0IGluaXQgPSBhc3luYyAob3B0aW9ucykgPT4ge1xuICBjb25zdCBhZGFwdGVyID0gYXdhaXQgZ2V0QWRhcHRlcihvcHRpb25zKTtcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgY29uc3QgaW50ZXJuYWxQbHVnaW5zID0gZ2V0SW50ZXJuYWxQbHVnaW5zKG9wdGlvbnMpO1xuICBjb25zdCBsb2dnZXIgPSBjcmVhdGVMb2dnZXIob3B0aW9ucy5sb2dnZXIpO1xuICBjb25zdCBiYXNlVVJMID0gZ2V0QmFzZVVSTChvcHRpb25zLmJhc2VVUkwsIG9wdGlvbnMuYmFzZVBhdGgpO1xuICBjb25zdCBzZWNyZXQgPSBvcHRpb25zLnNlY3JldCB8fCBlbnYuQkVUVEVSX0FVVEhfU0VDUkVUIHx8IGVudi5BVVRIX1NFQ1JFVCB8fCBERUZBVUxUX1NFQ1JFVDtcbiAgaWYgKHNlY3JldCA9PT0gREVGQVVMVF9TRUNSRVQpIHtcbiAgICBpZiAoaXNQcm9kdWN0aW9uKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiWW91IGFyZSB1c2luZyB0aGUgZGVmYXVsdCBzZWNyZXQuIFBsZWFzZSBzZXQgYEJFVFRFUl9BVVRIX1NFQ1JFVGAgaW4geW91ciBlbnZpcm9ubWVudCB2YXJpYWJsZXMgb3IgcGFzcyBgc2VjcmV0YCBpbiB5b3VyIGF1dGggY29uZmlnLlwiXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBvcHRpb25zID0ge1xuICAgIC4uLm9wdGlvbnMsXG4gICAgc2VjcmV0LFxuICAgIGJhc2VVUkw6IGJhc2VVUkwgPyBuZXcgVVJMKGJhc2VVUkwpLm9yaWdpbiA6IFwiXCIsXG4gICAgYmFzZVBhdGg6IG9wdGlvbnMuYmFzZVBhdGggfHwgXCIvYXBpL2F1dGhcIixcbiAgICBwbHVnaW5zOiBwbHVnaW5zLmNvbmNhdChpbnRlcm5hbFBsdWdpbnMpXG4gIH07XG4gIGNoZWNrRW5kcG9pbnRDb25mbGljdHMob3B0aW9ucywgbG9nZ2VyKTtcbiAgY29uc3QgY29va2llcyA9IGdldENvb2tpZXMob3B0aW9ucyk7XG4gIGNvbnN0IHRhYmxlcyA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGNvbnN0IHByb3ZpZGVycyA9IE9iamVjdC5lbnRyaWVzKFxuICAgIG9wdGlvbnMuc29jaWFsUHJvdmlkZXJzIHx8IHt9XG4gICkubWFwKChba2V5LCBjb25maWddKSA9PiB7XG4gICAgaWYgKGNvbmZpZyA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKGNvbmZpZy5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICghY29uZmlnLmNsaWVudElkKSB7XG4gICAgICBsb2dnZXIud2FybihcbiAgICAgICAgYFNvY2lhbCBwcm92aWRlciAke2tleX0gaXMgbWlzc2luZyBjbGllbnRJZCBvciBjbGllbnRTZWNyZXRgXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IHNvY2lhbFByb3ZpZGVyc1trZXldKGNvbmZpZyk7XG4gICAgcHJvdmlkZXIuZGlzYWJsZUltcGxpY2l0U2lnblVwID0gY29uZmlnLmRpc2FibGVJbXBsaWNpdFNpZ25VcDtcbiAgICByZXR1cm4gcHJvdmlkZXI7XG4gIH0pLmZpbHRlcigoeCkgPT4geCAhPT0gbnVsbCk7XG4gIGNvbnN0IGdlbmVyYXRlSWRGdW5jID0gKHsgbW9kZWwsIHNpemUgfSkgPT4ge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5hZHZhbmNlZC5nZW5lcmF0ZUlkKHsgbW9kZWwsIHNpemUgfSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucz8uYWR2YW5jZWQ/LmRhdGFiYXNlPy5nZW5lcmF0ZUlkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmFkdmFuY2VkLmRhdGFiYXNlLmdlbmVyYXRlSWQoeyBtb2RlbCwgc2l6ZSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGdlbmVyYXRlSWQoc2l6ZSk7XG4gIH07XG4gIGNvbnN0IHsgcHVibGlzaCB9ID0gYXdhaXQgY3JlYXRlVGVsZW1ldHJ5KG9wdGlvbnMsIHtcbiAgICBhZGFwdGVyOiBhZGFwdGVyLmlkLFxuICAgIGRhdGFiYXNlOiB0eXBlb2Ygb3B0aW9ucy5kYXRhYmFzZSA9PT0gXCJmdW5jdGlvblwiID8gXCJhZGFwdGVyXCIgOiBnZXRLeXNlbHlEYXRhYmFzZVR5cGUob3B0aW9ucy5kYXRhYmFzZSkgfHwgXCJ1bmtub3duXCJcbiAgfSk7XG4gIGxldCBjdHggPSB7XG4gICAgYXBwTmFtZTogb3B0aW9ucy5hcHBOYW1lIHx8IFwiQmV0dGVyIEF1dGhcIixcbiAgICBzb2NpYWxQcm92aWRlcnM6IHByb3ZpZGVycyxcbiAgICBvcHRpb25zLFxuICAgIHRhYmxlcyxcbiAgICB0cnVzdGVkT3JpZ2luczogZ2V0VHJ1c3RlZE9yaWdpbnMob3B0aW9ucyksXG4gICAgYmFzZVVSTDogYmFzZVVSTCB8fCBcIlwiLFxuICAgIHNlc3Npb25Db25maWc6IHtcbiAgICAgIHVwZGF0ZUFnZTogb3B0aW9ucy5zZXNzaW9uPy51cGRhdGVBZ2UgIT09IHZvaWQgMCA/IG9wdGlvbnMuc2Vzc2lvbi51cGRhdGVBZ2UgOiAyNCAqIDYwICogNjAsXG4gICAgICAvLyAyNCBob3Vyc1xuICAgICAgZXhwaXJlc0luOiBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQgKiA3LFxuICAgICAgLy8gNyBkYXlzXG4gICAgICBmcmVzaEFnZTogb3B0aW9ucy5zZXNzaW9uPy5mcmVzaEFnZSA9PT0gdm9pZCAwID8gNjAgKiA2MCAqIDI0IDogb3B0aW9ucy5zZXNzaW9uLmZyZXNoQWdlXG4gICAgfSxcbiAgICBzZWNyZXQsXG4gICAgcmF0ZUxpbWl0OiB7XG4gICAgICAuLi5vcHRpb25zLnJhdGVMaW1pdCxcbiAgICAgIGVuYWJsZWQ6IG9wdGlvbnMucmF0ZUxpbWl0Py5lbmFibGVkID8/IGlzUHJvZHVjdGlvbixcbiAgICAgIHdpbmRvdzogb3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyB8fCAxMCxcbiAgICAgIG1heDogb3B0aW9ucy5yYXRlTGltaXQ/Lm1heCB8fCAxMDAsXG4gICAgICBzdG9yYWdlOiBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSB8fCAob3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlID8gXCJzZWNvbmRhcnktc3RvcmFnZVwiIDogXCJtZW1vcnlcIilcbiAgICB9LFxuICAgIGF1dGhDb29raWVzOiBjb29raWVzLFxuICAgIGxvZ2dlcixcbiAgICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkRnVuYyxcbiAgICBzZXNzaW9uOiBudWxsLFxuICAgIHNlY29uZGFyeVN0b3JhZ2U6IG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSxcbiAgICBwYXNzd29yZDoge1xuICAgICAgaGFzaDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5wYXNzd29yZD8uaGFzaCB8fCBoYXNoUGFzc3dvcmQsXG4gICAgICB2ZXJpZnk6IG9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucGFzc3dvcmQ/LnZlcmlmeSB8fCB2ZXJpZnlQYXNzd29yZCxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBtaW5QYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5taW5QYXNzd29yZExlbmd0aCB8fCA4LFxuICAgICAgICBtYXhQYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5tYXhQYXNzd29yZExlbmd0aCB8fCAxMjhcbiAgICAgIH0sXG4gICAgICBjaGVja1Bhc3N3b3JkXG4gICAgfSxcbiAgICBzZXROZXdTZXNzaW9uKHNlc3Npb24pIHtcbiAgICAgIHRoaXMubmV3U2Vzc2lvbiA9IHNlc3Npb247XG4gICAgfSxcbiAgICBuZXdTZXNzaW9uOiBudWxsLFxuICAgIGFkYXB0ZXIsXG4gICAgaW50ZXJuYWxBZGFwdGVyOiBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIoYWRhcHRlciwge1xuICAgICAgb3B0aW9ucyxcbiAgICAgIGxvZ2dlcixcbiAgICAgIGhvb2tzOiBvcHRpb25zLmRhdGFiYXNlSG9va3MgPyBbb3B0aW9ucy5kYXRhYmFzZUhvb2tzXSA6IFtdfSksXG4gICAgY3JlYXRlQXV0aENvb2tpZTogY3JlYXRlQ29va2llR2V0dGVyKG9wdGlvbnMpLFxuICAgIGFzeW5jIHJ1bk1pZ3JhdGlvbnMoKSB7XG4gICAgICBpZiAoIW9wdGlvbnMuZGF0YWJhc2UgfHwgXCJ1cGRhdGVNYW55XCIgaW4gb3B0aW9ucy5kYXRhYmFzZSkge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgIFwiRGF0YWJhc2UgaXMgbm90IHByb3ZpZGVkIG9yIGl0J3MgYW4gYWRhcHRlci4gTWlncmF0aW9ucyBhcmUgb25seSBzdXBwb3J0ZWQgd2l0aCBhIGRhdGFiYXNlIGluc3RhbmNlLlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCB7IHJ1bk1pZ3JhdGlvbnMgfSA9IGF3YWl0IGdldE1pZ3JhdGlvbnMob3B0aW9ucyk7XG4gICAgICBhd2FpdCBydW5NaWdyYXRpb25zKCk7XG4gICAgfSxcbiAgICBwdWJsaXNoVGVsZW1ldHJ5OiBwdWJsaXNoLFxuICAgIHNraXBDU1JGQ2hlY2s6ICEhb3B0aW9ucy5hZHZhbmNlZD8uZGlzYWJsZUNTUkZDaGVjayxcbiAgICBza2lwT3JpZ2luQ2hlY2s6IG9wdGlvbnMuYWR2YW5jZWQ/LmRpc2FibGVPcmlnaW5DaGVjayAhPT0gdm9pZCAwID8gb3B0aW9ucy5hZHZhbmNlZC5kaXNhYmxlT3JpZ2luQ2hlY2sgOiBpc1Rlc3QoKSA/IHRydWUgOiBmYWxzZVxuICB9O1xuICBjb25zdCBpbml0T3JQcm9taXNlID0gcnVuUGx1Z2luSW5pdChjdHgpO1xuICBsZXQgY29udGV4dDtcbiAgaWYgKGlzUHJvbWlzZShpbml0T3JQcm9taXNlKSkge1xuICAgICh7IGNvbnRleHQgfSA9IGF3YWl0IGluaXRPclByb21pc2UpO1xuICB9IGVsc2Uge1xuICAgICh7IGNvbnRleHQgfSA9IGluaXRPclByb21pc2UpO1xuICB9XG4gIHJldHVybiBjb250ZXh0O1xufTtcbmFzeW5jIGZ1bmN0aW9uIHJ1blBsdWdpbkluaXQoY3R4KSB7XG4gIGxldCBvcHRpb25zID0gY3R4Lm9wdGlvbnM7XG4gIGNvbnN0IHBsdWdpbnMgPSBvcHRpb25zLnBsdWdpbnMgfHwgW107XG4gIGxldCBjb250ZXh0ID0gY3R4O1xuICBjb25zdCBkYkhvb2tzID0gW107XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIHBsdWdpbnMpIHtcbiAgICBpZiAocGx1Z2luLmluaXQpIHtcbiAgICAgIGxldCBpbml0UHJvbWlzZSA9IHBsdWdpbi5pbml0KGNvbnRleHQpO1xuICAgICAgbGV0IHJlc3VsdDtcbiAgICAgIGlmIChpc1Byb21pc2UoaW5pdFByb21pc2UpKSB7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGluaXRQcm9taXNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gaW5pdFByb21pc2U7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAocmVzdWx0Lm9wdGlvbnMpIHtcbiAgICAgICAgICBjb25zdCB7IGRhdGFiYXNlSG9va3MsIC4uLnJlc3RPcHRzIH0gPSByZXN1bHQub3B0aW9ucztcbiAgICAgICAgICBpZiAoZGF0YWJhc2VIb29rcykge1xuICAgICAgICAgICAgZGJIb29rcy5wdXNoKGRhdGFiYXNlSG9va3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcHRpb25zID0gZGVmdShvcHRpb25zLCByZXN0T3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdC5jb250ZXh0KSB7XG4gICAgICAgICAgY29udGV4dCA9IHtcbiAgICAgICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgICAgICAuLi5yZXN1bHQuY29udGV4dFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZGJIb29rcy5wdXNoKG9wdGlvbnMuZGF0YWJhc2VIb29rcyk7XG4gIGNvbnRleHQuaW50ZXJuYWxBZGFwdGVyID0gY3JlYXRlSW50ZXJuYWxBZGFwdGVyKGN0eC5hZGFwdGVyLCB7XG4gICAgb3B0aW9ucyxcbiAgICBsb2dnZXI6IGN0eC5sb2dnZXIsXG4gICAgaG9va3M6IGRiSG9va3MuZmlsdGVyKCh1KSA9PiB1ICE9PSB2b2lkIDApLFxuICAgIGdlbmVyYXRlSWQ6IGN0eC5nZW5lcmF0ZUlkXG4gIH0pO1xuICBjb250ZXh0Lm9wdGlvbnMgPSBvcHRpb25zO1xuICByZXR1cm4geyBjb250ZXh0IH07XG59XG5mdW5jdGlvbiBnZXRJbnRlcm5hbFBsdWdpbnMob3B0aW9ucykge1xuICBjb25zdCBwbHVnaW5zID0gW107XG4gIGlmIChvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmVuYWJsZWQpIDtcbiAgcmV0dXJuIHBsdWdpbnM7XG59XG5mdW5jdGlvbiBnZXRUcnVzdGVkT3JpZ2lucyhvcHRpb25zKSB7XG4gIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKG9wdGlvbnMuYmFzZVVSTCwgb3B0aW9ucy5iYXNlUGF0aCk7XG4gIGlmICghYmFzZVVSTCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCB0cnVzdGVkT3JpZ2lucyA9IFtuZXcgVVJMKGJhc2VVUkwpLm9yaWdpbl07XG4gIGlmIChvcHRpb25zLnRydXN0ZWRPcmlnaW5zICYmIEFycmF5LmlzQXJyYXkob3B0aW9ucy50cnVzdGVkT3JpZ2lucykpIHtcbiAgICB0cnVzdGVkT3JpZ2lucy5wdXNoKC4uLm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpO1xuICB9XG4gIGNvbnN0IGVudlRydXN0ZWRPcmlnaW5zID0gZW52LkJFVFRFUl9BVVRIX1RSVVNURURfT1JJR0lOUztcbiAgaWYgKGVudlRydXN0ZWRPcmlnaW5zKSB7XG4gICAgdHJ1c3RlZE9yaWdpbnMucHVzaCguLi5lbnZUcnVzdGVkT3JpZ2lucy5zcGxpdChcIixcIikpO1xuICB9XG4gIGlmICh0cnVzdGVkT3JpZ2lucy5maWx0ZXIoKHgpID0+ICF4KS5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgXCJBIHByb3ZpZGVkIHRydXN0ZWQgb3JpZ2luIGlzIGludmFsaWQsIG1ha2Ugc3VyZSB5b3VyIHRydXN0ZWQgb3JpZ2lucyBsaXN0IGlzIHByb3Blcmx5IGRlZmluZWQuXCJcbiAgICApO1xuICB9XG4gIHJldHVybiB0cnVzdGVkT3JpZ2lucztcbn1cblxuY29uc3QgYmV0dGVyQXV0aCA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGF1dGhDb250ZXh0ID0gaW5pdChvcHRpb25zKTtcbiAgY29uc3QgeyBhcGkgfSA9IGdldEVuZHBvaW50cyhhdXRoQ29udGV4dCwgb3B0aW9ucyk7XG4gIGNvbnN0IGVycm9yQ29kZXMgPSBvcHRpb25zLnBsdWdpbnM/LnJlZHVjZSgoYWNjLCBwbHVnaW4pID0+IHtcbiAgICBpZiAocGx1Z2luLiRFUlJPUl9DT0RFUykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uYWNjLFxuICAgICAgICAuLi5wbHVnaW4uJEVSUk9SX0NPREVTXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHJldHVybiB7XG4gICAgaGFuZGxlcjogYXN5bmMgKHJlcXVlc3QpID0+IHtcbiAgICAgIGNvbnN0IGN0eCA9IGF3YWl0IGF1dGhDb250ZXh0O1xuICAgICAgY29uc3QgYmFzZVBhdGggPSBjdHgub3B0aW9ucy5iYXNlUGF0aCB8fCBcIi9hcGkvYXV0aFwiO1xuICAgICAgaWYgKCFjdHgub3B0aW9ucy5iYXNlVVJMKSB7XG4gICAgICAgIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKHZvaWQgMCwgYmFzZVBhdGgsIHJlcXVlc3QpO1xuICAgICAgICBpZiAoYmFzZVVSTCkge1xuICAgICAgICAgIGN0eC5iYXNlVVJMID0gYmFzZVVSTDtcbiAgICAgICAgICBjdHgub3B0aW9ucy5iYXNlVVJMID0gZ2V0T3JpZ2luKGN0eC5iYXNlVVJMKSB8fCB2b2lkIDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIFwiQ291bGQgbm90IGdldCBiYXNlIFVSTCBmcm9tIHJlcXVlc3QuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjdHgudHJ1c3RlZE9yaWdpbnMgPSBbXG4gICAgICAgIC4uLm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMgPyBBcnJheS5pc0FycmF5KG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpID8gb3B0aW9ucy50cnVzdGVkT3JpZ2lucyA6IGF3YWl0IG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMocmVxdWVzdCkgOiBbXSxcbiAgICAgICAgY3R4Lm9wdGlvbnMuYmFzZVVSTFxuICAgICAgXTtcbiAgICAgIGNvbnN0IHsgaGFuZGxlciB9ID0gcm91dGVyKGN0eCwgb3B0aW9ucyk7XG4gICAgICByZXR1cm4gaGFuZGxlcihyZXF1ZXN0KTtcbiAgICB9LFxuICAgIGFwaSxcbiAgICBvcHRpb25zLFxuICAgICRjb250ZXh0OiBhdXRoQ29udGV4dCxcbiAgICAkSW5mZXI6IHt9LFxuICAgICRFUlJPUl9DT0RFUzoge1xuICAgICAgLi4uZXJyb3JDb2RlcyxcbiAgICAgIC4uLkJBU0VfRVJST1JfQ09ERVNcbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgeyBiZXR0ZXJBdXRoIGFzIGIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CDx1PoNO.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getDate)\n/* harmony export */ });\nconst getDate = (span, unit = \"ms\") => {\n  return new Date(Date.now() + (unit === \"sec\" ? span * 1e3 : span));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DVzZEOWVTeC5tanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTs7QUFFd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcz8wNjI1Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGdldERhdGUgPSAoc3BhbiwgdW5pdCA9IFwibXNcIikgPT4ge1xuICByZXR1cm4gbmV3IERhdGUoRGF0ZS5ub3coKSArICh1bml0ID09PSBcInNlY1wiID8gc3BhbiAqIDFlMyA6IHNwYW4pKTtcbn07XG5cbmV4cG9ydCB7IGdldERhdGUgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getIp)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.1.12/node_modules/zod/v4/classic/external.js\");\n\n\n\nfunction getIp(req, options) {\n  if (options.advanced?.ipAddress?.disableIpTracking) {\n    return null;\n  }\n  if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest)()) {\n    return \"127.0.0.1\";\n  }\n  if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isDevelopment)()) {\n    return \"127.0.0.1\";\n  }\n  const headers = \"headers\" in req ? req.headers : req;\n  const defaultHeaders = [\"x-forwarded-for\"];\n  const ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders || defaultHeaders;\n  for (const key of ipHeaders) {\n    const value = \"get\" in headers ? headers.get(key) : headers[key];\n    if (typeof value === \"string\") {\n      const ip = value.split(\",\")[0].trim();\n      if (isValidIP(ip)) {\n        return ip;\n      }\n    }\n  }\n  return null;\n}\nfunction isValidIP(ip) {\n  const ipv4 = zod__WEBPACK_IMPORTED_MODULE_1__.ipv4().safeParse(ip);\n  if (ipv4.success) {\n    return true;\n  }\n  const ipv6 = zod__WEBPACK_IMPORTED_MODULE_1__.ipv6().safeParse(ip);\n  if (ipv6.success) {\n    return true;\n  }\n  return false;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DbEg1cjNOSC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThEO0FBQ3RDOztBQUV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sNkRBQU07QUFDWjtBQUNBO0FBQ0EsTUFBTSxvRUFBYTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxxQ0FBTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxlQUFlLHFDQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5DbEg1cjNOSC5tanM/NmU1YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1Rlc3QsIGlzRGV2ZWxvcG1lbnQgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbmZ1bmN0aW9uIGdldElwKHJlcSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uaXBBZGRyZXNzPy5kaXNhYmxlSXBUcmFja2luZykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmIChpc1Rlc3QoKSkge1xuICAgIHJldHVybiBcIjEyNy4wLjAuMVwiO1xuICB9XG4gIGlmIChpc0RldmVsb3BtZW50KCkpIHtcbiAgICByZXR1cm4gXCIxMjcuMC4wLjFcIjtcbiAgfVxuICBjb25zdCBoZWFkZXJzID0gXCJoZWFkZXJzXCIgaW4gcmVxID8gcmVxLmhlYWRlcnMgOiByZXE7XG4gIGNvbnN0IGRlZmF1bHRIZWFkZXJzID0gW1wieC1mb3J3YXJkZWQtZm9yXCJdO1xuICBjb25zdCBpcEhlYWRlcnMgPSBvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmlwQWRkcmVzc0hlYWRlcnMgfHwgZGVmYXVsdEhlYWRlcnM7XG4gIGZvciAoY29uc3Qga2V5IG9mIGlwSGVhZGVycykge1xuICAgIGNvbnN0IHZhbHVlID0gXCJnZXRcIiBpbiBoZWFkZXJzID8gaGVhZGVycy5nZXQoa2V5KSA6IGhlYWRlcnNba2V5XTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBpcCA9IHZhbHVlLnNwbGl0KFwiLFwiKVswXS50cmltKCk7XG4gICAgICBpZiAoaXNWYWxpZElQKGlwKSkge1xuICAgICAgICByZXR1cm4gaXA7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gaXNWYWxpZElQKGlwKSB7XG4gIGNvbnN0IGlwdjQgPSB6LmlwdjQoKS5zYWZlUGFyc2UoaXApO1xuICBpZiAoaXB2NC5zdWNjZXNzKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgaXB2NiA9IHouaXB2NigpLnNhZmVQYXJzZShpcCk7XG4gIGlmIChpcHY2LnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCB7IGdldElwIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.ClH5r3NH.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ parseAccountOutput),\n/* harmony export */   b: () => (/* binding */ parseSessionOutput),\n/* harmony export */   c: () => (/* binding */ parseInputData),\n/* harmony export */   d: () => (/* binding */ parseUserInput),\n/* harmony export */   e: () => (/* binding */ parseAdditionalUserInput),\n/* harmony export */   f: () => (/* binding */ parseAccountInput),\n/* harmony export */   g: () => (/* binding */ parseSessionInput),\n/* harmony export */   m: () => (/* binding */ mergeSchema),\n/* harmony export */   p: () => (/* binding */ parseUserOutput)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n\n\nconst cache = /* @__PURE__ */ new WeakMap();\nfunction parseOutputData(data, schema) {\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in data) {\n    const field = fields[key];\n    if (!field) {\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (field.returned === false) {\n      continue;\n    }\n    parsedData[key] = data[key];\n  }\n  return parsedData;\n}\nfunction getAllFields(options, table) {\n  if (!cache.has(options)) {\n    cache.set(options, /* @__PURE__ */ new Map());\n  }\n  const tableCache = cache.get(options);\n  if (tableCache.has(table)) {\n    return tableCache.get(table);\n  }\n  let schema = {\n    ...table === \"user\" ? options.user?.additionalFields : {},\n    ...table === \"session\" ? options.session?.additionalFields : {}\n  };\n  for (const plugin of options.plugins || []) {\n    if (plugin.schema && plugin.schema[table]) {\n      schema = {\n        ...schema,\n        ...plugin.schema[table].fields\n      };\n    }\n  }\n  cache.get(options).set(table, schema);\n  return schema;\n}\nfunction parseUserOutput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseOutputData(user, { fields: schema });\n}\nfunction parseAccountOutput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseOutputData(account, { fields: schema });\n}\nfunction parseSessionOutput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseOutputData(session, { fields: schema });\n}\nfunction parseInputData(data, schema) {\n  const action = schema.action || \"create\";\n  const fields = schema.fields;\n  const parsedData = Object.assign(\n    /* @__PURE__ */ Object.create(null),\n    null\n  );\n  for (const key in fields) {\n    if (key in data) {\n      if (fields[key].input === false) {\n        if (fields[key].defaultValue !== void 0) {\n          if (action !== \"update\") {\n            parsedData[key] = fields[key].defaultValue;\n            continue;\n          }\n        }\n        if (data[key]) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n            message: `${key} is not allowed to be set`\n          });\n        }\n        continue;\n      }\n      if (fields[key].validator?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].validator.input.parse(data[key]);\n        continue;\n      }\n      if (fields[key].transform?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].transform?.input(data[key]);\n        continue;\n      }\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (fields[key].defaultValue !== void 0 && action === \"create\") {\n      parsedData[key] = fields[key].defaultValue;\n      continue;\n    }\n    if (fields[key].required && action === \"create\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: `${key} is required`\n      });\n    }\n  }\n  return parsedData;\n}\nfunction parseUserInput(options, user = {}, action) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user, { fields: schema, action });\n}\nfunction parseAdditionalUserInput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema });\n}\nfunction parseAccountInput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseInputData(account, { fields: schema });\n}\nfunction parseSessionInput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseInputData(session, { fields: schema });\n}\nfunction mergeSchema(schema, newSchema) {\n  if (!newSchema) {\n    return schema;\n  }\n  for (const table in newSchema) {\n    const newModelName = newSchema[table]?.modelName;\n    if (newModelName) {\n      schema[table].modelName = newModelName;\n    }\n    for (const field in schema[table].fields) {\n      const newField = newSchema[table]?.fields?.[field];\n      if (!newField) {\n        continue;\n      }\n      schema[table].fields[field].fieldName = newField;\n    }\n  }\n  return schema;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5Dd2o5ZHQ2aS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUF1Qzs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsZ0JBQWdCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnQkFBZ0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGdCQUFnQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsaURBQVE7QUFDNUIsd0JBQXdCLEtBQUs7QUFDN0IsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCLG9CQUFvQixLQUFLO0FBQ3pCLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBLGdDQUFnQyx3QkFBd0I7QUFDeEQ7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLElBQUksZ0JBQWdCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxnQkFBZ0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGdCQUFnQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2TiIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ3dqOWR0NmkubWpzPzMyYzEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbmNvbnN0IGNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBwYXJzZU91dHB1dERhdGEoZGF0YSwgc2NoZW1hKSB7XG4gIGNvbnN0IGZpZWxkcyA9IHNjaGVtYS5maWVsZHM7XG4gIGNvbnN0IHBhcnNlZERhdGEgPSB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xuICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2tleV07XG4gICAgaWYgKCFmaWVsZCkge1xuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZGF0YVtrZXldO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZC5yZXR1cm5lZCA9PT0gZmFsc2UpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBwYXJzZWREYXRhW2tleV0gPSBkYXRhW2tleV07XG4gIH1cbiAgcmV0dXJuIHBhcnNlZERhdGE7XG59XG5mdW5jdGlvbiBnZXRBbGxGaWVsZHMob3B0aW9ucywgdGFibGUpIHtcbiAgaWYgKCFjYWNoZS5oYXMob3B0aW9ucykpIHtcbiAgICBjYWNoZS5zZXQob3B0aW9ucywgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSk7XG4gIH1cbiAgY29uc3QgdGFibGVDYWNoZSA9IGNhY2hlLmdldChvcHRpb25zKTtcbiAgaWYgKHRhYmxlQ2FjaGUuaGFzKHRhYmxlKSkge1xuICAgIHJldHVybiB0YWJsZUNhY2hlLmdldCh0YWJsZSk7XG4gIH1cbiAgbGV0IHNjaGVtYSA9IHtcbiAgICAuLi50YWJsZSA9PT0gXCJ1c2VyXCIgPyBvcHRpb25zLnVzZXI/LmFkZGl0aW9uYWxGaWVsZHMgOiB7fSxcbiAgICAuLi50YWJsZSA9PT0gXCJzZXNzaW9uXCIgPyBvcHRpb25zLnNlc3Npb24/LmFkZGl0aW9uYWxGaWVsZHMgOiB7fVxuICB9O1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBvcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICBpZiAocGx1Z2luLnNjaGVtYSAmJiBwbHVnaW4uc2NoZW1hW3RhYmxlXSkge1xuICAgICAgc2NoZW1hID0ge1xuICAgICAgICAuLi5zY2hlbWEsXG4gICAgICAgIC4uLnBsdWdpbi5zY2hlbWFbdGFibGVdLmZpZWxkc1xuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgY2FjaGUuZ2V0KG9wdGlvbnMpLnNldCh0YWJsZSwgc2NoZW1hKTtcbiAgcmV0dXJuIHNjaGVtYTtcbn1cbmZ1bmN0aW9uIHBhcnNlVXNlck91dHB1dChvcHRpb25zLCB1c2VyKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInVzZXJcIik7XG4gIHJldHVybiBwYXJzZU91dHB1dERhdGEodXNlciwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlQWNjb3VudE91dHB1dChvcHRpb25zLCBhY2NvdW50KSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcImFjY291bnRcIik7XG4gIHJldHVybiBwYXJzZU91dHB1dERhdGEoYWNjb3VudCwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlU2Vzc2lvbk91dHB1dChvcHRpb25zLCBzZXNzaW9uKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInNlc3Npb25cIik7XG4gIHJldHVybiBwYXJzZU91dHB1dERhdGEoc2Vzc2lvbiwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlSW5wdXREYXRhKGRhdGEsIHNjaGVtYSkge1xuICBjb25zdCBhY3Rpb24gPSBzY2hlbWEuYWN0aW9uIHx8IFwiY3JlYXRlXCI7XG4gIGNvbnN0IGZpZWxkcyA9IHNjaGVtYS5maWVsZHM7XG4gIGNvbnN0IHBhcnNlZERhdGEgPSBPYmplY3QuYXNzaWduKFxuICAgIC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpLFxuICAgIG51bGxcbiAgKTtcbiAgZm9yIChjb25zdCBrZXkgaW4gZmllbGRzKSB7XG4gICAgaWYgKGtleSBpbiBkYXRhKSB7XG4gICAgICBpZiAoZmllbGRzW2tleV0uaW5wdXQgPT09IGZhbHNlKSB7XG4gICAgICAgIGlmIChmaWVsZHNba2V5XS5kZWZhdWx0VmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICAgIGlmIChhY3Rpb24gIT09IFwidXBkYXRlXCIpIHtcbiAgICAgICAgICAgIHBhcnNlZERhdGFba2V5XSA9IGZpZWxkc1trZXldLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YVtrZXldKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgbWVzc2FnZTogYCR7a2V5fSBpcyBub3QgYWxsb3dlZCB0byBiZSBzZXRgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGRzW2tleV0udmFsaWRhdG9yPy5pbnB1dCAmJiBkYXRhW2tleV0gIT09IHZvaWQgMCkge1xuICAgICAgICBwYXJzZWREYXRhW2tleV0gPSBmaWVsZHNba2V5XS52YWxpZGF0b3IuaW5wdXQucGFyc2UoZGF0YVtrZXldKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGRzW2tleV0udHJhbnNmb3JtPy5pbnB1dCAmJiBkYXRhW2tleV0gIT09IHZvaWQgMCkge1xuICAgICAgICBwYXJzZWREYXRhW2tleV0gPSBmaWVsZHNba2V5XS50cmFuc2Zvcm0/LmlucHV0KGRhdGFba2V5XSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZGF0YVtrZXldO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZHNba2V5XS5kZWZhdWx0VmFsdWUgIT09IHZvaWQgMCAmJiBhY3Rpb24gPT09IFwiY3JlYXRlXCIpIHtcbiAgICAgIHBhcnNlZERhdGFba2V5XSA9IGZpZWxkc1trZXldLmRlZmF1bHRWYWx1ZTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZmllbGRzW2tleV0ucmVxdWlyZWQgJiYgYWN0aW9uID09PSBcImNyZWF0ZVwiKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGAke2tleX0gaXMgcmVxdWlyZWRgXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcnNlZERhdGE7XG59XG5mdW5jdGlvbiBwYXJzZVVzZXJJbnB1dChvcHRpb25zLCB1c2VyID0ge30sIGFjdGlvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEodXNlciwgeyBmaWVsZHM6IHNjaGVtYSwgYWN0aW9uIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VBZGRpdGlvbmFsVXNlcklucHV0KG9wdGlvbnMsIHVzZXIpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwidXNlclwiKTtcbiAgcmV0dXJuIHBhcnNlSW5wdXREYXRhKHVzZXIgfHwge30sIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFjY291bnRJbnB1dChvcHRpb25zLCBhY2NvdW50KSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcImFjY291bnRcIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YShhY2NvdW50LCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VTZXNzaW9uSW5wdXQob3B0aW9ucywgc2Vzc2lvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJzZXNzaW9uXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEoc2Vzc2lvbiwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIG1lcmdlU2NoZW1hKHNjaGVtYSwgbmV3U2NoZW1hKSB7XG4gIGlmICghbmV3U2NoZW1hKSB7XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfVxuICBmb3IgKGNvbnN0IHRhYmxlIGluIG5ld1NjaGVtYSkge1xuICAgIGNvbnN0IG5ld01vZGVsTmFtZSA9IG5ld1NjaGVtYVt0YWJsZV0/Lm1vZGVsTmFtZTtcbiAgICBpZiAobmV3TW9kZWxOYW1lKSB7XG4gICAgICBzY2hlbWFbdGFibGVdLm1vZGVsTmFtZSA9IG5ld01vZGVsTmFtZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBmaWVsZCBpbiBzY2hlbWFbdGFibGVdLmZpZWxkcykge1xuICAgICAgY29uc3QgbmV3RmllbGQgPSBuZXdTY2hlbWFbdGFibGVdPy5maWVsZHM/LltmaWVsZF07XG4gICAgICBpZiAoIW5ld0ZpZWxkKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgc2NoZW1hW3RhYmxlXS5maWVsZHNbZmllbGRdLmZpZWxkTmFtZSA9IG5ld0ZpZWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufVxuXG5leHBvcnQgeyBwYXJzZUFjY291bnRPdXRwdXQgYXMgYSwgcGFyc2VTZXNzaW9uT3V0cHV0IGFzIGIsIHBhcnNlSW5wdXREYXRhIGFzIGMsIHBhcnNlVXNlcklucHV0IGFzIGQsIHBhcnNlQWRkaXRpb25hbFVzZXJJbnB1dCBhcyBlLCBwYXJzZUFjY291bnRJbnB1dCBhcyBmLCBwYXJzZVNlc3Npb25JbnB1dCBhcyBnLCBtZXJnZVNjaGVtYSBhcyBtLCBwYXJzZVVzZXJPdXRwdXQgYXMgcCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Cwj9dt6i.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ capitalizeFirstLetter)\n/* harmony export */ });\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5ELTJDbUV3ei5tanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTs7QUFFc0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkQtMkNtRXd6Lm1qcz82Nzc4Il0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdExldHRlcihzdHIpIHtcbiAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcbn1cblxuZXhwb3J0IHsgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyIGFzIGMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ setCookieCache),\n/* harmony export */   b: () => (/* binding */ getSessionCookie),\n/* harmony export */   c: () => (/* binding */ createCookieGetter),\n/* harmony export */   d: () => (/* binding */ deleteSessionCookie),\n/* harmony export */   e: () => (/* binding */ getCookieCache),\n/* harmony export */   g: () => (/* binding */ getCookies),\n/* harmony export */   m: () => (/* binding */ ms),\n/* harmony export */   p: () => (/* binding */ parseCookies),\n/* harmony export */   s: () => (/* binding */ setSessionCookie)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./better-auth.DR3R5wdU.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _better_auth_Ih8C76Vo_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.Ih8C76Vo.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\");\n\n\n\n\n\n\n\n\n\n\n//#region src/index.ts\nconst s = 1e3;\nconst m = s * 60;\nconst h = m * 60;\nconst d = h * 24;\nconst w = d * 7;\nconst y = d * 365.25;\nconst mo = y / 12;\nfunction ms(value, options) {\n\tif (typeof value === \"string\") return parse(value);\n\telse if (typeof value === \"number\") return format(value);\n\tthrow new Error(`Value provided to ms() must be a string or number. value=${JSON.stringify(value)}`);\n}\n/**\n* Parse the given string and return milliseconds.\n*\n* @param str - A string to parse to milliseconds\n* @returns The parsed value in milliseconds, or `NaN` if the string can't be\n* parsed\n*/\nfunction parse(str) {\n\tif (typeof str !== \"string\" || str.length === 0 || str.length > 100) throw new Error(`Value provided to ms.parse() must be a string with length between 1 and 99. value=${JSON.stringify(str)}`);\n\tconst match = /^(?<value>-?\\d*\\.?\\d+) *(?<unit>milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)?$/i.exec(str);\n\tif (!match?.groups) return NaN;\n\tconst { value, unit = \"ms\" } = match.groups;\n\tconst n = parseFloat(value);\n\tconst matchUnit = unit.toLowerCase();\n\t/* istanbul ignore next - istanbul doesn't understand, but thankfully the TypeScript the exhaustiveness check in the default case keeps us type safe here */\n\tswitch (matchUnit) {\n\t\tcase \"years\":\n\t\tcase \"year\":\n\t\tcase \"yrs\":\n\t\tcase \"yr\":\n\t\tcase \"y\": return n * y;\n\t\tcase \"months\":\n\t\tcase \"month\":\n\t\tcase \"mo\": return n * mo;\n\t\tcase \"weeks\":\n\t\tcase \"week\":\n\t\tcase \"w\": return n * w;\n\t\tcase \"days\":\n\t\tcase \"day\":\n\t\tcase \"d\": return n * d;\n\t\tcase \"hours\":\n\t\tcase \"hour\":\n\t\tcase \"hrs\":\n\t\tcase \"hr\":\n\t\tcase \"h\": return n * h;\n\t\tcase \"minutes\":\n\t\tcase \"minute\":\n\t\tcase \"mins\":\n\t\tcase \"min\":\n\t\tcase \"m\": return n * m;\n\t\tcase \"seconds\":\n\t\tcase \"second\":\n\t\tcase \"secs\":\n\t\tcase \"sec\":\n\t\tcase \"s\": return n * s;\n\t\tcase \"milliseconds\":\n\t\tcase \"millisecond\":\n\t\tcase \"msecs\":\n\t\tcase \"msec\":\n\t\tcase \"ms\": return n;\n\t\tdefault: throw new Error(`Unknown unit \"${matchUnit}\" provided to ms.parse(). value=${JSON.stringify(str)}`);\n\t}\n}\n/**\n* Short format for `ms`.\n*/\nfunction fmtShort(ms$1) {\n\tconst msAbs = Math.abs(ms$1);\n\tif (msAbs >= y) return `${Math.round(ms$1 / y)}y`;\n\tif (msAbs >= mo) return `${Math.round(ms$1 / mo)}mo`;\n\tif (msAbs >= w) return `${Math.round(ms$1 / w)}w`;\n\tif (msAbs >= d) return `${Math.round(ms$1 / d)}d`;\n\tif (msAbs >= h) return `${Math.round(ms$1 / h)}h`;\n\tif (msAbs >= m) return `${Math.round(ms$1 / m)}m`;\n\tif (msAbs >= s) return `${Math.round(ms$1 / s)}s`;\n\treturn `${ms$1}ms`;\n}\n/**\n* Format the given integer as a string.\n*\n* @param ms - milliseconds\n* @param options - Options for the conversion\n* @returns The formatted string\n*/\nfunction format(ms$1, options) {\n\tif (typeof ms$1 !== \"number\" || !Number.isFinite(ms$1)) throw new Error(\"Value provided to ms.format() must be of type number.\");\n\treturn fmtShort(ms$1);\n}\n\nfunction createCookieGetter(options) {\n  const secure = options.advanced?.useSecureCookies !== void 0 ? options.advanced?.useSecureCookies : options.baseURL !== void 0 ? options.baseURL.startsWith(\"https://\") ? true : false : _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__.isProduction;\n  const secureCookiePrefix = secure ? \"__Secure-\" : \"\";\n  const crossSubdomainEnabled = !!options.advanced?.crossSubDomainCookies?.enabled;\n  const domain = crossSubdomainEnabled ? options.advanced?.crossSubDomainCookies?.domain || (options.baseURL ? new URL(options.baseURL).hostname : void 0) : void 0;\n  if (crossSubdomainEnabled && !domain) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__.BetterAuthError(\n      \"baseURL is required when crossSubdomainCookies are enabled\"\n    );\n  }\n  function createCookie(cookieName, overrideAttributes = {}) {\n    const prefix = options.advanced?.cookiePrefix || \"better-auth\";\n    const name = options.advanced?.cookies?.[cookieName]?.name || `${prefix}.${cookieName}`;\n    const attributes = options.advanced?.cookies?.[cookieName]?.attributes;\n    return {\n      name: `${secureCookiePrefix}${name}`,\n      attributes: {\n        secure: !!secureCookiePrefix,\n        sameSite: \"lax\",\n        path: \"/\",\n        httpOnly: true,\n        ...crossSubdomainEnabled ? { domain } : {},\n        ...options.advanced?.defaultCookieAttributes,\n        ...overrideAttributes,\n        ...attributes\n      }\n    };\n  }\n  return createCookie;\n}\nfunction getCookies(options) {\n  const createCookie = createCookieGetter(options);\n  const sessionMaxAge = options.session?.expiresIn || ms(\"7d\") / 1e3;\n  const sessionToken = createCookie(\"session_token\", {\n    maxAge: sessionMaxAge\n  });\n  const sessionData = createCookie(\"session_data\", {\n    maxAge: options.session?.cookieCache?.maxAge || 60 * 5\n  });\n  const dontRememberToken = createCookie(\"dont_remember\");\n  return {\n    sessionToken: {\n      name: sessionToken.name,\n      options: sessionToken.attributes\n    },\n    /**\n     * This cookie is used to store the session data in the cookie\n     * This is useful for when you want to cache the session in the cookie\n     */\n    sessionData: {\n      name: sessionData.name,\n      options: sessionData.attributes\n    },\n    dontRememberToken: {\n      name: dontRememberToken.name,\n      options: dontRememberToken.attributes\n    }\n  };\n}\nasync function setCookieCache(ctx, session, dontRememberMe) {\n  const shouldStoreSessionDataInCookie = ctx.context.options.session?.cookieCache?.enabled;\n  if (shouldStoreSessionDataInCookie) {\n    const filteredSession = Object.entries(session.session).reduce(\n      (acc, [key, value]) => {\n        const fieldConfig = ctx.context.options.session?.additionalFields?.[key];\n        if (!fieldConfig || fieldConfig.returned !== false) {\n          acc[key] = value;\n        }\n        return acc;\n      },\n      {}\n    );\n    const sessionData = { session: filteredSession, user: session.user };\n    const options = {\n      ...ctx.context.authCookies.sessionData.options,\n      maxAge: dontRememberMe ? void 0 : ctx.context.authCookies.sessionData.options.maxAge\n    };\n    const expiresAtDate = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options.maxAge || 60, \"sec\").getTime();\n    const data = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64Url.encode(\n      JSON.stringify({\n        session: sessionData,\n        expiresAt: expiresAtDate,\n        signature: await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n          ctx.context.secret,\n          JSON.stringify({\n            ...sessionData,\n            expiresAt: expiresAtDate\n          })\n        )\n      }),\n      {\n        padding: false\n      }\n    );\n    if (data.length > 4093) {\n      ctx.context?.logger?.error(\n        `Session data exceeds cookie size limit (${data.length} bytes > 4093 bytes). Consider reducing session data size or disabling cookie cache. Session will not be cached in cookie.`\n      );\n      return;\n    }\n    ctx.setCookie(ctx.context.authCookies.sessionData.name, data, options);\n  }\n}\nasync function setSessionCookie(ctx, session, dontRememberMe, overrides) {\n  const dontRememberMeCookie = await ctx.getSignedCookie(\n    ctx.context.authCookies.dontRememberToken.name,\n    ctx.context.secret\n  );\n  dontRememberMe = dontRememberMe !== void 0 ? dontRememberMe : !!dontRememberMeCookie;\n  const options = ctx.context.authCookies.sessionToken.options;\n  const maxAge = dontRememberMe ? void 0 : ctx.context.sessionConfig.expiresIn;\n  await ctx.setSignedCookie(\n    ctx.context.authCookies.sessionToken.name,\n    session.session.token,\n    ctx.context.secret,\n    {\n      ...options,\n      maxAge,\n      ...overrides\n    }\n  );\n  if (dontRememberMe) {\n    await ctx.setSignedCookie(\n      ctx.context.authCookies.dontRememberToken.name,\n      \"true\",\n      ctx.context.secret,\n      ctx.context.authCookies.dontRememberToken.options\n    );\n  }\n  await setCookieCache(ctx, session, dontRememberMe);\n  ctx.context.setNewSession(session);\n  if (ctx.context.options.secondaryStorage) {\n    await ctx.context.secondaryStorage?.set(\n      session.session.token,\n      JSON.stringify({\n        user: session.user,\n        session: session.session\n      }),\n      Math.floor(\n        (new Date(session.session.expiresAt).getTime() - Date.now()) / 1e3\n      )\n    );\n  }\n}\nfunction deleteSessionCookie(ctx, skipDontRememberMe) {\n  ctx.setCookie(ctx.context.authCookies.sessionToken.name, \"\", {\n    ...ctx.context.authCookies.sessionToken.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.sessionData.name, \"\", {\n    ...ctx.context.authCookies.sessionData.options,\n    maxAge: 0\n  });\n  if (!skipDontRememberMe) {\n    ctx.setCookie(ctx.context.authCookies.dontRememberToken.name, \"\", {\n      ...ctx.context.authCookies.dontRememberToken.options,\n      maxAge: 0\n    });\n  }\n}\nfunction parseCookies(cookieHeader) {\n  const cookies = cookieHeader.split(\"; \");\n  const cookieMap = /* @__PURE__ */ new Map();\n  cookies.forEach((cookie) => {\n    const [name, value] = cookie.split(\"=\");\n    cookieMap.set(name, value);\n  });\n  return cookieMap;\n}\nconst getSessionCookie = (request, config) => {\n  if (config?.cookiePrefix) {\n    if (config.cookieName) {\n      config.cookiePrefix = `${config.cookiePrefix}-`;\n    } else {\n      config.cookiePrefix = `${config.cookiePrefix}.`;\n    }\n  }\n  const headers = \"headers\" in request ? request.headers : request;\n  const req = request instanceof Request ? request : void 0;\n  (0,_better_auth_DR3R5wdU_mjs__WEBPACK_IMPORTED_MODULE_6__.a)(req?.url, config?.path, req);\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_token\", cookiePrefix = \"better-auth.\" } = config || {};\n  const name = `${cookiePrefix}${cookieName}`;\n  const secureCookieName = `__Secure-${name}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionToken = parsedCookie.get(name) || parsedCookie.get(secureCookieName);\n  if (sessionToken) {\n    return sessionToken;\n  }\n  return null;\n};\nconst getCookieCache = async (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_data\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = config?.isSecure !== void 0 ? config.isSecure ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}` : _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__.isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionData = parsedCookie.get(name);\n  if (sessionData) {\n    const sessionDataPayload = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_5__.s)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64Url.decode(sessionData)));\n    if (!sessionDataPayload) {\n      return null;\n    }\n    const secret = config?.secret || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_2__.env.BETTER_AUTH_SECRET;\n    if (!secret) {\n      throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_0__.BetterAuthError(\n        \"getCookieCache requires a secret to be provided. Either pass it as an option or set the BETTER_AUTH_SECRET environment variable\"\n      );\n    }\n    const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n      secret,\n      JSON.stringify({\n        ...sessionDataPayload.session,\n        expiresAt: sessionDataPayload.expiresAt\n      }),\n      sessionDataPayload.signature\n    );\n    if (!isValid) {\n      return null;\n    }\n    return sessionDataPayload.session;\n  }\n  return null;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5EOV92UVI4My5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTBEO0FBQ0E7QUFDQTtBQUNKO0FBQ0Q7QUFDVztBQUNIO0FBQ1Y7QUFDZjs7QUFFcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxzQkFBc0I7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMktBQTJLLG9CQUFvQjtBQUMvTDtBQUNBO0FBQ0EsU0FBUyxxQkFBcUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxVQUFVLGtDQUFrQyxvQkFBb0I7QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIscUJBQXFCO0FBQ2hELDRCQUE0QixzQkFBc0I7QUFDbEQsMkJBQTJCLHFCQUFxQjtBQUNoRCwyQkFBMkIscUJBQXFCO0FBQ2hELDJCQUEyQixxQkFBcUI7QUFDaEQsMkJBQTJCLHFCQUFxQjtBQUNoRCwyQkFBMkIscUJBQXFCO0FBQ2hELFdBQVcsS0FBSztBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyTEFBMkwsK0RBQVk7QUFDdk07QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9FQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBLHFFQUFxRSxPQUFPLEdBQUcsV0FBVztBQUMxRjtBQUNBO0FBQ0EsZUFBZSxtQkFBbUIsRUFBRSxLQUFLO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsU0FBUyxJQUFJO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDREQUFPO0FBQ2pDLGlCQUFpQixnRUFBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsbUVBQVU7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGFBQWE7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLG9CQUFvQjtBQUNuRCxNQUFNO0FBQ04sK0JBQStCLG9CQUFvQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsNERBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsOERBQThEO0FBQ3hFLGtCQUFrQixhQUFhLEVBQUUsV0FBVztBQUM1Qyx1Q0FBdUMsS0FBSztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsNERBQTREO0FBQ3RFLDJFQUEyRSxhQUFhLEdBQUcsV0FBVyxPQUFPLGFBQWEsR0FBRyxXQUFXLElBQUksK0RBQVksZUFBZSxhQUFhLEdBQUcsV0FBVyxPQUFPLGFBQWEsR0FBRyxXQUFXO0FBQ3BPO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0REFBYSxDQUFDLDZEQUFNLFFBQVEsZ0VBQVM7QUFDcEU7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHNEQUFHO0FBQ3hDO0FBQ0EsZ0JBQWdCLG9FQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixtRUFBVTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWtNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV3cy1odWIvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5EOV92UVI4My5tanM/ZTk5NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lcnJvcic7XG5pbXBvcnQgeyBnIGFzIGdldERhdGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgeyBpc1Byb2R1Y3Rpb24sIGVudiB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5pbXBvcnQgeyBiYXNlNjRVcmwgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IGNyZWF0ZUhNQUMgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaG1hYyc7XG5pbXBvcnQgeyBzIGFzIHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcyc7XG5pbXBvcnQgeyBhIGFzIGdldEJhc2VVUkwgfSBmcm9tICcuL2JldHRlci1hdXRoLkRSM1I1d2RVLm1qcyc7XG5pbXBvcnQgeyBiaW5hcnkgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCAnLi9iZXR0ZXItYXV0aC5JaDhDNzZWby5tanMnO1xuXG4vLyNyZWdpb24gc3JjL2luZGV4LnRzXG5jb25zdCBzID0gMWUzO1xuY29uc3QgbSA9IHMgKiA2MDtcbmNvbnN0IGggPSBtICogNjA7XG5jb25zdCBkID0gaCAqIDI0O1xuY29uc3QgdyA9IGQgKiA3O1xuY29uc3QgeSA9IGQgKiAzNjUuMjU7XG5jb25zdCBtbyA9IHkgLyAxMjtcbmZ1bmN0aW9uIG1zKHZhbHVlLCBvcHRpb25zKSB7XG5cdGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHJldHVybiBwYXJzZSh2YWx1ZSk7XG5cdGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikgcmV0dXJuIGZvcm1hdCh2YWx1ZSk7XG5cdHRocm93IG5ldyBFcnJvcihgVmFsdWUgcHJvdmlkZWQgdG8gbXMoKSBtdXN0IGJlIGEgc3RyaW5nIG9yIG51bWJlci4gdmFsdWU9JHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9YCk7XG59XG4vKipcbiogUGFyc2UgdGhlIGdpdmVuIHN0cmluZyBhbmQgcmV0dXJuIG1pbGxpc2Vjb25kcy5cbipcbiogQHBhcmFtIHN0ciAtIEEgc3RyaW5nIHRvIHBhcnNlIHRvIG1pbGxpc2Vjb25kc1xuKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlIGluIG1pbGxpc2Vjb25kcywgb3IgYE5hTmAgaWYgdGhlIHN0cmluZyBjYW4ndCBiZVxuKiBwYXJzZWRcbiovXG5mdW5jdGlvbiBwYXJzZShzdHIpIHtcblx0aWYgKHR5cGVvZiBzdHIgIT09IFwic3RyaW5nXCIgfHwgc3RyLmxlbmd0aCA9PT0gMCB8fCBzdHIubGVuZ3RoID4gMTAwKSB0aHJvdyBuZXcgRXJyb3IoYFZhbHVlIHByb3ZpZGVkIHRvIG1zLnBhcnNlKCkgbXVzdCBiZSBhIHN0cmluZyB3aXRoIGxlbmd0aCBiZXR3ZWVuIDEgYW5kIDk5LiB2YWx1ZT0ke0pTT04uc3RyaW5naWZ5KHN0cil9YCk7XG5cdGNvbnN0IG1hdGNoID0gL14oPzx2YWx1ZT4tP1xcZCpcXC4/XFxkKykgKig/PHVuaXQ+bWlsbGlzZWNvbmRzP3xtc2Vjcz98bXN8c2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx3ZWVrcz98d3xtb250aHM/fG1vfHllYXJzP3x5cnM/fHkpPyQvaS5leGVjKHN0cik7XG5cdGlmICghbWF0Y2g/Lmdyb3VwcykgcmV0dXJuIE5hTjtcblx0Y29uc3QgeyB2YWx1ZSwgdW5pdCA9IFwibXNcIiB9ID0gbWF0Y2guZ3JvdXBzO1xuXHRjb25zdCBuID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG5cdGNvbnN0IG1hdGNoVW5pdCA9IHVuaXQudG9Mb3dlckNhc2UoKTtcblx0LyogaXN0YW5idWwgaWdub3JlIG5leHQgLSBpc3RhbmJ1bCBkb2Vzbid0IHVuZGVyc3RhbmQsIGJ1dCB0aGFua2Z1bGx5IHRoZSBUeXBlU2NyaXB0IHRoZSBleGhhdXN0aXZlbmVzcyBjaGVjayBpbiB0aGUgZGVmYXVsdCBjYXNlIGtlZXBzIHVzIHR5cGUgc2FmZSBoZXJlICovXG5cdHN3aXRjaCAobWF0Y2hVbml0KSB7XG5cdFx0Y2FzZSBcInllYXJzXCI6XG5cdFx0Y2FzZSBcInllYXJcIjpcblx0XHRjYXNlIFwieXJzXCI6XG5cdFx0Y2FzZSBcInlyXCI6XG5cdFx0Y2FzZSBcInlcIjogcmV0dXJuIG4gKiB5O1xuXHRcdGNhc2UgXCJtb250aHNcIjpcblx0XHRjYXNlIFwibW9udGhcIjpcblx0XHRjYXNlIFwibW9cIjogcmV0dXJuIG4gKiBtbztcblx0XHRjYXNlIFwid2Vla3NcIjpcblx0XHRjYXNlIFwid2Vla1wiOlxuXHRcdGNhc2UgXCJ3XCI6IHJldHVybiBuICogdztcblx0XHRjYXNlIFwiZGF5c1wiOlxuXHRcdGNhc2UgXCJkYXlcIjpcblx0XHRjYXNlIFwiZFwiOiByZXR1cm4gbiAqIGQ7XG5cdFx0Y2FzZSBcImhvdXJzXCI6XG5cdFx0Y2FzZSBcImhvdXJcIjpcblx0XHRjYXNlIFwiaHJzXCI6XG5cdFx0Y2FzZSBcImhyXCI6XG5cdFx0Y2FzZSBcImhcIjogcmV0dXJuIG4gKiBoO1xuXHRcdGNhc2UgXCJtaW51dGVzXCI6XG5cdFx0Y2FzZSBcIm1pbnV0ZVwiOlxuXHRcdGNhc2UgXCJtaW5zXCI6XG5cdFx0Y2FzZSBcIm1pblwiOlxuXHRcdGNhc2UgXCJtXCI6IHJldHVybiBuICogbTtcblx0XHRjYXNlIFwic2Vjb25kc1wiOlxuXHRcdGNhc2UgXCJzZWNvbmRcIjpcblx0XHRjYXNlIFwic2Vjc1wiOlxuXHRcdGNhc2UgXCJzZWNcIjpcblx0XHRjYXNlIFwic1wiOiByZXR1cm4gbiAqIHM7XG5cdFx0Y2FzZSBcIm1pbGxpc2Vjb25kc1wiOlxuXHRcdGNhc2UgXCJtaWxsaXNlY29uZFwiOlxuXHRcdGNhc2UgXCJtc2Vjc1wiOlxuXHRcdGNhc2UgXCJtc2VjXCI6XG5cdFx0Y2FzZSBcIm1zXCI6IHJldHVybiBuO1xuXHRcdGRlZmF1bHQ6IHRocm93IG5ldyBFcnJvcihgVW5rbm93biB1bml0IFwiJHttYXRjaFVuaXR9XCIgcHJvdmlkZWQgdG8gbXMucGFyc2UoKS4gdmFsdWU9JHtKU09OLnN0cmluZ2lmeShzdHIpfWApO1xuXHR9XG59XG4vKipcbiogU2hvcnQgZm9ybWF0IGZvciBgbXNgLlxuKi9cbmZ1bmN0aW9uIGZtdFNob3J0KG1zJDEpIHtcblx0Y29uc3QgbXNBYnMgPSBNYXRoLmFicyhtcyQxKTtcblx0aWYgKG1zQWJzID49IHkpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyB5KX15YDtcblx0aWYgKG1zQWJzID49IG1vKSByZXR1cm4gYCR7TWF0aC5yb3VuZChtcyQxIC8gbW8pfW1vYDtcblx0aWYgKG1zQWJzID49IHcpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyB3KX13YDtcblx0aWYgKG1zQWJzID49IGQpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBkKX1kYDtcblx0aWYgKG1zQWJzID49IGgpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBoKX1oYDtcblx0aWYgKG1zQWJzID49IG0pIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBtKX1tYDtcblx0aWYgKG1zQWJzID49IHMpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBzKX1zYDtcblx0cmV0dXJuIGAke21zJDF9bXNgO1xufVxuLyoqXG4qIEZvcm1hdCB0aGUgZ2l2ZW4gaW50ZWdlciBhcyBhIHN0cmluZy5cbipcbiogQHBhcmFtIG1zIC0gbWlsbGlzZWNvbmRzXG4qIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9ucyBmb3IgdGhlIGNvbnZlcnNpb25cbiogQHJldHVybnMgVGhlIGZvcm1hdHRlZCBzdHJpbmdcbiovXG5mdW5jdGlvbiBmb3JtYXQobXMkMSwgb3B0aW9ucykge1xuXHRpZiAodHlwZW9mIG1zJDEgIT09IFwibnVtYmVyXCIgfHwgIU51bWJlci5pc0Zpbml0ZShtcyQxKSkgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgcHJvdmlkZWQgdG8gbXMuZm9ybWF0KCkgbXVzdCBiZSBvZiB0eXBlIG51bWJlci5cIik7XG5cdHJldHVybiBmbXRTaG9ydChtcyQxKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29va2llR2V0dGVyKG9wdGlvbnMpIHtcbiAgY29uc3Qgc2VjdXJlID0gb3B0aW9ucy5hZHZhbmNlZD8udXNlU2VjdXJlQ29va2llcyAhPT0gdm9pZCAwID8gb3B0aW9ucy5hZHZhbmNlZD8udXNlU2VjdXJlQ29va2llcyA6IG9wdGlvbnMuYmFzZVVSTCAhPT0gdm9pZCAwID8gb3B0aW9ucy5iYXNlVVJMLnN0YXJ0c1dpdGgoXCJodHRwczovL1wiKSA/IHRydWUgOiBmYWxzZSA6IGlzUHJvZHVjdGlvbjtcbiAgY29uc3Qgc2VjdXJlQ29va2llUHJlZml4ID0gc2VjdXJlID8gXCJfX1NlY3VyZS1cIiA6IFwiXCI7XG4gIGNvbnN0IGNyb3NzU3ViZG9tYWluRW5hYmxlZCA9ICEhb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5lbmFibGVkO1xuICBjb25zdCBkb21haW4gPSBjcm9zc1N1YmRvbWFpbkVuYWJsZWQgPyBvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmRvbWFpbiB8fCAob3B0aW9ucy5iYXNlVVJMID8gbmV3IFVSTChvcHRpb25zLmJhc2VVUkwpLmhvc3RuYW1lIDogdm9pZCAwKSA6IHZvaWQgMDtcbiAgaWYgKGNyb3NzU3ViZG9tYWluRW5hYmxlZCAmJiAhZG9tYWluKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIFwiYmFzZVVSTCBpcyByZXF1aXJlZCB3aGVuIGNyb3NzU3ViZG9tYWluQ29va2llcyBhcmUgZW5hYmxlZFwiXG4gICAgKTtcbiAgfVxuICBmdW5jdGlvbiBjcmVhdGVDb29raWUoY29va2llTmFtZSwgb3ZlcnJpZGVBdHRyaWJ1dGVzID0ge30pIHtcbiAgICBjb25zdCBwcmVmaXggPSBvcHRpb25zLmFkdmFuY2VkPy5jb29raWVQcmVmaXggfHwgXCJiZXR0ZXItYXV0aFwiO1xuICAgIGNvbnN0IG5hbWUgPSBvcHRpb25zLmFkdmFuY2VkPy5jb29raWVzPy5bY29va2llTmFtZV0/Lm5hbWUgfHwgYCR7cHJlZml4fS4ke2Nvb2tpZU5hbWV9YDtcbiAgICBjb25zdCBhdHRyaWJ1dGVzID0gb3B0aW9ucy5hZHZhbmNlZD8uY29va2llcz8uW2Nvb2tpZU5hbWVdPy5hdHRyaWJ1dGVzO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBgJHtzZWN1cmVDb29raWVQcmVmaXh9JHtuYW1lfWAsXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIHNlY3VyZTogISFzZWN1cmVDb29raWVQcmVmaXgsXG4gICAgICAgIHNhbWVTaXRlOiBcImxheFwiLFxuICAgICAgICBwYXRoOiBcIi9cIixcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIC4uLmNyb3NzU3ViZG9tYWluRW5hYmxlZCA/IHsgZG9tYWluIH0gOiB7fSxcbiAgICAgICAgLi4ub3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXMsXG4gICAgICAgIC4uLm92ZXJyaWRlQXR0cmlidXRlcyxcbiAgICAgICAgLi4uYXR0cmlidXRlc1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUNvb2tpZTtcbn1cbmZ1bmN0aW9uIGdldENvb2tpZXMob3B0aW9ucykge1xuICBjb25zdCBjcmVhdGVDb29raWUgPSBjcmVhdGVDb29raWVHZXR0ZXIob3B0aW9ucyk7XG4gIGNvbnN0IHNlc3Npb25NYXhBZ2UgPSBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCBtcyhcIjdkXCIpIC8gMWUzO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBjcmVhdGVDb29raWUoXCJzZXNzaW9uX3Rva2VuXCIsIHtcbiAgICBtYXhBZ2U6IHNlc3Npb25NYXhBZ2VcbiAgfSk7XG4gIGNvbnN0IHNlc3Npb25EYXRhID0gY3JlYXRlQ29va2llKFwic2Vzc2lvbl9kYXRhXCIsIHtcbiAgICBtYXhBZ2U6IG9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/Lm1heEFnZSB8fCA2MCAqIDVcbiAgfSk7XG4gIGNvbnN0IGRvbnRSZW1lbWJlclRva2VuID0gY3JlYXRlQ29va2llKFwiZG9udF9yZW1lbWJlclwiKTtcbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uVG9rZW46IHtcbiAgICAgIG5hbWU6IHNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgb3B0aW9uczogc2Vzc2lvblRva2VuLmF0dHJpYnV0ZXNcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFRoaXMgY29va2llIGlzIHVzZWQgdG8gc3RvcmUgdGhlIHNlc3Npb24gZGF0YSBpbiB0aGUgY29va2llXG4gICAgICogVGhpcyBpcyB1c2VmdWwgZm9yIHdoZW4geW91IHdhbnQgdG8gY2FjaGUgdGhlIHNlc3Npb24gaW4gdGhlIGNvb2tpZVxuICAgICAqL1xuICAgIHNlc3Npb25EYXRhOiB7XG4gICAgICBuYW1lOiBzZXNzaW9uRGF0YS5uYW1lLFxuICAgICAgb3B0aW9uczogc2Vzc2lvbkRhdGEuYXR0cmlidXRlc1xuICAgIH0sXG4gICAgZG9udFJlbWVtYmVyVG9rZW46IHtcbiAgICAgIG5hbWU6IGRvbnRSZW1lbWJlclRva2VuLm5hbWUsXG4gICAgICBvcHRpb25zOiBkb250UmVtZW1iZXJUb2tlbi5hdHRyaWJ1dGVzXG4gICAgfVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gc2V0Q29va2llQ2FjaGUoY3R4LCBzZXNzaW9uLCBkb250UmVtZW1iZXJNZSkge1xuICBjb25zdCBzaG91bGRTdG9yZVNlc3Npb25EYXRhSW5Db29raWUgPSBjdHguY29udGV4dC5vcHRpb25zLnNlc3Npb24/LmNvb2tpZUNhY2hlPy5lbmFibGVkO1xuICBpZiAoc2hvdWxkU3RvcmVTZXNzaW9uRGF0YUluQ29va2llKSB7XG4gICAgY29uc3QgZmlsdGVyZWRTZXNzaW9uID0gT2JqZWN0LmVudHJpZXMoc2Vzc2lvbi5zZXNzaW9uKS5yZWR1Y2UoXG4gICAgICAoYWNjLCBba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgY29uc3QgZmllbGRDb25maWcgPSBjdHguY29udGV4dC5vcHRpb25zLnNlc3Npb24/LmFkZGl0aW9uYWxGaWVsZHM/LltrZXldO1xuICAgICAgICBpZiAoIWZpZWxkQ29uZmlnIHx8IGZpZWxkQ29uZmlnLnJldHVybmVkICE9PSBmYWxzZSkge1xuICAgICAgICAgIGFjY1trZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSB7IHNlc3Npb246IGZpbHRlcmVkU2Vzc2lvbiwgdXNlcjogc2Vzc2lvbi51c2VyIH07XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm9wdGlvbnMsXG4gICAgICBtYXhBZ2U6IGRvbnRSZW1lbWJlck1lID8gdm9pZCAwIDogY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEub3B0aW9ucy5tYXhBZ2VcbiAgICB9O1xuICAgIGNvbnN0IGV4cGlyZXNBdERhdGUgPSBnZXREYXRlKG9wdGlvbnMubWF4QWdlIHx8IDYwLCBcInNlY1wiKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgZGF0YSA9IGJhc2U2NFVybC5lbmNvZGUoXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHNlc3Npb246IHNlc3Npb25EYXRhLFxuICAgICAgICBleHBpcmVzQXQ6IGV4cGlyZXNBdERhdGUsXG4gICAgICAgIHNpZ25hdHVyZTogYXdhaXQgY3JlYXRlSE1BQyhcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS5zaWduKFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAuLi5zZXNzaW9uRGF0YSxcbiAgICAgICAgICAgIGV4cGlyZXNBdDogZXhwaXJlc0F0RGF0ZVxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIH0pLFxuICAgICAge1xuICAgICAgICBwYWRkaW5nOiBmYWxzZVxuICAgICAgfVxuICAgICk7XG4gICAgaWYgKGRhdGEubGVuZ3RoID4gNDA5Mykge1xuICAgICAgY3R4LmNvbnRleHQ/LmxvZ2dlcj8uZXJyb3IoXG4gICAgICAgIGBTZXNzaW9uIGRhdGEgZXhjZWVkcyBjb29raWUgc2l6ZSBsaW1pdCAoJHtkYXRhLmxlbmd0aH0gYnl0ZXMgPiA0MDkzIGJ5dGVzKS4gQ29uc2lkZXIgcmVkdWNpbmcgc2Vzc2lvbiBkYXRhIHNpemUgb3IgZGlzYWJsaW5nIGNvb2tpZSBjYWNoZS4gU2Vzc2lvbiB3aWxsIG5vdCBiZSBjYWNoZWQgaW4gY29va2llLmBcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGN0eC5zZXRDb29raWUoY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZSwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIHNldFNlc3Npb25Db29raWUoY3R4LCBzZXNzaW9uLCBkb250UmVtZW1iZXJNZSwgb3ZlcnJpZGVzKSB7XG4gIGNvbnN0IGRvbnRSZW1lbWJlck1lQ29va2llID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLFxuICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICApO1xuICBkb250UmVtZW1iZXJNZSA9IGRvbnRSZW1lbWJlck1lICE9PSB2b2lkIDAgPyBkb250UmVtZW1iZXJNZSA6ICEhZG9udFJlbWVtYmVyTWVDb29raWU7XG4gIGNvbnN0IG9wdGlvbnMgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ub3B0aW9ucztcbiAgY29uc3QgbWF4QWdlID0gZG9udFJlbWVtYmVyTWUgPyB2b2lkIDAgOiBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmV4cGlyZXNJbjtcbiAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZSxcbiAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgIHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBtYXhBZ2UsXG4gICAgICAuLi5vdmVycmlkZXNcbiAgICB9XG4gICk7XG4gIGlmIChkb250UmVtZW1iZXJNZSkge1xuICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLFxuICAgICAgXCJ0cnVlXCIsXG4gICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5vcHRpb25zXG4gICAgKTtcbiAgfVxuICBhd2FpdCBzZXRDb29raWVDYWNoZShjdHgsIHNlc3Npb24sIGRvbnRSZW1lbWJlck1lKTtcbiAgY3R4LmNvbnRleHQuc2V0TmV3U2Vzc2lvbihzZXNzaW9uKTtcbiAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LnNlY29uZGFyeVN0b3JhZ2U/LnNldChcbiAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgICAgICBzZXNzaW9uOiBzZXNzaW9uLnNlc3Npb25cbiAgICAgIH0pLFxuICAgICAgTWF0aC5mbG9vcihcbiAgICAgICAgKG5ldyBEYXRlKHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQpLmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMWUzXG4gICAgICApXG4gICAgKTtcbiAgfVxufVxuZnVuY3Rpb24gZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgsIHNraXBEb250UmVtZW1iZXJNZSkge1xuICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLCBcIlwiLCB7XG4gICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm9wdGlvbnMsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm5hbWUsIFwiXCIsIHtcbiAgICAuLi5jdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5vcHRpb25zLFxuICAgIG1heEFnZTogMFxuICB9KTtcbiAgaWYgKCFza2lwRG9udFJlbWVtYmVyTWUpIHtcbiAgICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm5hbWUsIFwiXCIsIHtcbiAgICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm9wdGlvbnMsXG4gICAgICBtYXhBZ2U6IDBcbiAgICB9KTtcbiAgfVxufVxuZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikge1xuICBjb25zdCBjb29raWVzID0gY29va2llSGVhZGVyLnNwbGl0KFwiOyBcIik7XG4gIGNvbnN0IGNvb2tpZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGNvb2tpZXMuZm9yRWFjaCgoY29va2llKSA9PiB7XG4gICAgY29uc3QgW25hbWUsIHZhbHVlXSA9IGNvb2tpZS5zcGxpdChcIj1cIik7XG4gICAgY29va2llTWFwLnNldChuYW1lLCB2YWx1ZSk7XG4gIH0pO1xuICByZXR1cm4gY29va2llTWFwO1xufVxuY29uc3QgZ2V0U2Vzc2lvbkNvb2tpZSA9IChyZXF1ZXN0LCBjb25maWcpID0+IHtcbiAgaWYgKGNvbmZpZz8uY29va2llUHJlZml4KSB7XG4gICAgaWYgKGNvbmZpZy5jb29raWVOYW1lKSB7XG4gICAgICBjb25maWcuY29va2llUHJlZml4ID0gYCR7Y29uZmlnLmNvb2tpZVByZWZpeH0tYDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uZmlnLmNvb2tpZVByZWZpeCA9IGAke2NvbmZpZy5jb29raWVQcmVmaXh9LmA7XG4gICAgfVxuICB9XG4gIGNvbnN0IGhlYWRlcnMgPSBcImhlYWRlcnNcIiBpbiByZXF1ZXN0ID8gcmVxdWVzdC5oZWFkZXJzIDogcmVxdWVzdDtcbiAgY29uc3QgcmVxID0gcmVxdWVzdCBpbnN0YW5jZW9mIFJlcXVlc3QgPyByZXF1ZXN0IDogdm9pZCAwO1xuICBnZXRCYXNlVVJMKHJlcT8udXJsLCBjb25maWc/LnBhdGgsIHJlcSk7XG4gIGNvbnN0IGNvb2tpZXMgPSBoZWFkZXJzLmdldChcImNvb2tpZVwiKTtcbiAgaWYgKCFjb29raWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBjb29raWVOYW1lID0gXCJzZXNzaW9uX3Rva2VuXCIsIGNvb2tpZVByZWZpeCA9IFwiYmV0dGVyLWF1dGguXCIgfSA9IGNvbmZpZyB8fCB7fTtcbiAgY29uc3QgbmFtZSA9IGAke2Nvb2tpZVByZWZpeH0ke2Nvb2tpZU5hbWV9YDtcbiAgY29uc3Qgc2VjdXJlQ29va2llTmFtZSA9IGBfX1NlY3VyZS0ke25hbWV9YDtcbiAgY29uc3QgcGFyc2VkQ29va2llID0gcGFyc2VDb29raWVzKGNvb2tpZXMpO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBwYXJzZWRDb29raWUuZ2V0KG5hbWUpIHx8IHBhcnNlZENvb2tpZS5nZXQoc2VjdXJlQ29va2llTmFtZSk7XG4gIGlmIChzZXNzaW9uVG9rZW4pIHtcbiAgICByZXR1cm4gc2Vzc2lvblRva2VuO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbmNvbnN0IGdldENvb2tpZUNhY2hlID0gYXN5bmMgKHJlcXVlc3QsIGNvbmZpZykgPT4ge1xuICBjb25zdCBoZWFkZXJzID0gcmVxdWVzdCBpbnN0YW5jZW9mIEhlYWRlcnMgPyByZXF1ZXN0IDogcmVxdWVzdC5oZWFkZXJzO1xuICBjb25zdCBjb29raWVzID0gaGVhZGVycy5nZXQoXCJjb29raWVcIik7XG4gIGlmICghY29va2llcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHsgY29va2llTmFtZSA9IFwic2Vzc2lvbl9kYXRhXCIsIGNvb2tpZVByZWZpeCA9IFwiYmV0dGVyLWF1dGhcIiB9ID0gY29uZmlnIHx8IHt9O1xuICBjb25zdCBuYW1lID0gY29uZmlnPy5pc1NlY3VyZSAhPT0gdm9pZCAwID8gY29uZmlnLmlzU2VjdXJlID8gYF9fU2VjdXJlLSR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YCA6IGAke2Nvb2tpZVByZWZpeH0uJHtjb29raWVOYW1lfWAgOiBpc1Byb2R1Y3Rpb24gPyBgX19TZWN1cmUtJHtjb29raWVQcmVmaXh9LiR7Y29va2llTmFtZX1gIDogYCR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YDtcbiAgY29uc3QgcGFyc2VkQ29va2llID0gcGFyc2VDb29raWVzKGNvb2tpZXMpO1xuICBjb25zdCBzZXNzaW9uRGF0YSA9IHBhcnNlZENvb2tpZS5nZXQobmFtZSk7XG4gIGlmIChzZXNzaW9uRGF0YSkge1xuICAgIGNvbnN0IHNlc3Npb25EYXRhUGF5bG9hZCA9IHNhZmVKU09OUGFyc2UoYmluYXJ5LmRlY29kZShiYXNlNjRVcmwuZGVjb2RlKHNlc3Npb25EYXRhKSkpO1xuICAgIGlmICghc2Vzc2lvbkRhdGFQYXlsb2FkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3Qgc2VjcmV0ID0gY29uZmlnPy5zZWNyZXQgfHwgZW52LkJFVFRFUl9BVVRIX1NFQ1JFVDtcbiAgICBpZiAoIXNlY3JldCkge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJnZXRDb29raWVDYWNoZSByZXF1aXJlcyBhIHNlY3JldCB0byBiZSBwcm92aWRlZC4gRWl0aGVyIHBhc3MgaXQgYXMgYW4gb3B0aW9uIG9yIHNldCB0aGUgQkVUVEVSX0FVVEhfU0VDUkVUIGVudmlyb25tZW50IHZhcmlhYmxlXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnZlcmlmeShcbiAgICAgIHNlY3JldCxcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgLi4uc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb24sXG4gICAgICAgIGV4cGlyZXNBdDogc2Vzc2lvbkRhdGFQYXlsb2FkLmV4cGlyZXNBdFxuICAgICAgfSksXG4gICAgICBzZXNzaW9uRGF0YVBheWxvYWQuc2lnbmF0dXJlXG4gICAgKTtcbiAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb247XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xuXG5leHBvcnQgeyBzZXRDb29raWVDYWNoZSBhcyBhLCBnZXRTZXNzaW9uQ29va2llIGFzIGIsIGNyZWF0ZUNvb2tpZUdldHRlciBhcyBjLCBkZWxldGVTZXNzaW9uQ29va2llIGFzIGQsIGdldENvb2tpZUNhY2hlIGFzIGUsIGdldENvb2tpZXMgYXMgZywgbXMgYXMgbSwgcGFyc2VDb29raWVzIGFzIHAsIHNldFNlc3Npb25Db29raWUgYXMgcyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getSession),\n/* harmony export */   b: () => (/* binding */ revokeSessions),\n/* harmony export */   c: () => (/* binding */ revokeSession),\n/* harmony export */   d: () => (/* binding */ getSessionQuerySchema),\n/* harmony export */   e: () => (/* binding */ sensitiveSessionMiddleware),\n/* harmony export */   f: () => (/* binding */ freshSessionMiddleware),\n/* harmony export */   g: () => (/* binding */ getSessionFromCtx),\n/* harmony export */   h: () => (/* binding */ requestOnlySessionMiddleware),\n/* harmony export */   l: () => (/* binding */ listSessions),\n/* harmony export */   r: () => (/* binding */ revokeOtherSessions),\n/* harmony export */   s: () => (/* binding */ sessionMiddleware)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/middleware */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/middleware/index.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.D9_vQR83.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.D9_vQR83.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.1.12/node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/binary.mjs\");\n\n\n\n\n\n\n\n\n\n\n\nconst getSessionQuerySchema = zod__WEBPACK_IMPORTED_MODULE_9__.optional(\n  zod__WEBPACK_IMPORTED_MODULE_9__.object({\n    /**\n     * If cookie cache is enabled, it will disable the cache\n     * and fetch the session from the database\n     */\n    disableCookieCache: zod__WEBPACK_IMPORTED_MODULE_9__.coerce.boolean().meta({\n      description: \"Disable cookie cache and fetch session from database\"\n    }).optional(),\n    disableRefresh: zod__WEBPACK_IMPORTED_MODULE_9__.coerce.boolean().meta({\n      description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n    }).optional()\n  })\n);\nconst getSession = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/get-session\",\n  {\n    method: \"GET\",\n    query: getSessionQuerySchema,\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Get the current session\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      $ref: \"#/components/schemas/Session\"\n                    },\n                    user: {\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  },\n                  required: [\"session\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessionCookieToken = await ctx.getSignedCookie(\n        ctx.context.authCookies.sessionToken.name,\n        ctx.context.secret\n      );\n      if (!sessionCookieToken) {\n        return null;\n      }\n      const sessionDataCookie = ctx.getCookie(\n        ctx.context.authCookies.sessionData.name\n      );\n      const sessionDataPayload = sessionDataCookie ? (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_4__.s)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_8__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_7__.base64Url.decode(sessionDataCookie))) : null;\n      if (sessionDataPayload) {\n        const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_6__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n          ctx.context.secret,\n          JSON.stringify({\n            ...sessionDataPayload.session,\n            expiresAt: sessionDataPayload.expiresAt\n          }),\n          sessionDataPayload.signature\n        );\n        if (!isValid) {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n          return ctx.json(null);\n        }\n      }\n      const dontRememberMe = await ctx.getSignedCookie(\n        ctx.context.authCookies.dontRememberToken.name,\n        ctx.context.secret\n      );\n      if (sessionDataPayload?.session && ctx.context.options.session?.cookieCache?.enabled && !ctx.query?.disableCookieCache) {\n        const session2 = sessionDataPayload.session;\n        const hasExpired = sessionDataPayload.expiresAt < Date.now() || session2.session.expiresAt < /* @__PURE__ */ new Date();\n        if (!hasExpired) {\n          ctx.context.session = session2;\n          return ctx.json(\n            session2\n          );\n        } else {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n        }\n      }\n      const session = await ctx.context.internalAdapter.findSession(sessionCookieToken);\n      ctx.context.session = session;\n      if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n        (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.d)(ctx);\n        if (session) {\n          await ctx.context.internalAdapter.deleteSession(\n            session.session.token\n          );\n        }\n        return ctx.json(null);\n      }\n      if (dontRememberMe || ctx.query?.disableRefresh) {\n        return ctx.json(\n          session\n        );\n      }\n      const expiresIn = ctx.context.sessionConfig.expiresIn;\n      const updateAge = ctx.context.sessionConfig.updateAge;\n      const sessionIsDueToBeUpdatedDate = session.session.expiresAt.valueOf() - expiresIn * 1e3 + updateAge * 1e3;\n      const shouldBeUpdated = sessionIsDueToBeUpdatedDate <= Date.now();\n      if (shouldBeUpdated && (!ctx.query?.disableRefresh || !ctx.context.options.session?.disableSessionRefresh)) {\n        const updatedSession = await ctx.context.internalAdapter.updateSession(\n          session.session.token,\n          {\n            expiresAt: (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_2__.g)(ctx.context.sessionConfig.expiresIn, \"sec\"),\n            updatedAt: /* @__PURE__ */ new Date()\n          }\n        );\n        if (!updatedSession) {\n          (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.d)(ctx);\n          return ctx.json(null, { status: 401 });\n        }\n        const maxAge = (updatedSession.expiresAt.valueOf() - Date.now()) / 1e3;\n        await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(\n          ctx,\n          {\n            session: updatedSession,\n            user: session.user\n          },\n          false,\n          {\n            maxAge\n          }\n        );\n        return ctx.json({\n          session: updatedSession,\n          user: session.user\n        });\n      }\n      await (0,_better_auth_D9_vQR83_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(ctx, session, !!dontRememberMe);\n      return ctx.json(\n        session\n      );\n    } catch (error) {\n      ctx.context.logger.error(\"INTERNAL_SERVER_ERROR\", error);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: _better_auth_core_error__WEBPACK_IMPORTED_MODULE_5__.BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n  }\n);\nconst getSessionFromCtx = async (ctx, config) => {\n  if (ctx.context.session) {\n    return ctx.context.session;\n  }\n  const session = await getSession()({\n    ...ctx,\n    asResponse: false,\n    headers: ctx.headers,\n    returnHeaders: false,\n    query: {\n      ...config,\n      ...ctx.query\n    }\n  }).catch((e) => {\n    return null;\n  });\n  ctx.context.session = session;\n  return session;\n};\nconst sessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nconst sensitiveSessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  const session = await getSessionFromCtx(ctx, { disableCookieCache: true });\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nconst requestOnlySessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(\n  async (ctx) => {\n    const session = await getSessionFromCtx(ctx);\n    if (!session?.session && (ctx.request || ctx.headers)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    return { session };\n  }\n);\nconst freshSessionMiddleware = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  if (ctx.context.sessionConfig.freshAge === 0) {\n    return {\n      session\n    };\n  }\n  const freshAge = ctx.context.sessionConfig.freshAge;\n  const lastUpdated = session.session.updatedAt?.valueOf() || session.session.createdAt.valueOf();\n  const now = Date.now();\n  const isFresh = now - lastUpdated < freshAge * 1e3;\n  if (!isFresh) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"FORBIDDEN\", {\n      message: \"Session is not fresh\"\n    });\n  }\n  return {\n    session\n  };\n});\nconst listSessions = () => (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/list-sessions\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"List all active sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    $ref: \"#/components/schemas/Session\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessions = await ctx.context.internalAdapter.listSessions(\n        ctx.context.session.user.id\n      );\n      const activeSessions = sessions.filter((session) => {\n        return session.expiresAt > /* @__PURE__ */ new Date();\n      });\n      return ctx.json(\n        activeSessions\n      );\n    } catch (e) {\n      ctx.context.logger.error(e);\n      throw ctx.error(\"INTERNAL_SERVER_ERROR\");\n    }\n  }\n);\nconst revokeSession = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/revoke-session\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_9__.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_9__.string().meta({\n        description: \"The token to revoke\"\n      })\n    }),\n    use: [sensitiveSessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke a single session\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  token: {\n                    type: \"string\",\n                    description: \"The token to revoke\"\n                  }\n                },\n                required: [\"token\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the session was revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token;\n    const findSession = await ctx.context.internalAdapter.findSession(token);\n    if (!findSession) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: \"Session not found\"\n      });\n    }\n    if (findSession.session.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    try {\n      await ctx.context.internalAdapter.deleteSession(token);\n    } catch (error) {\n      ctx.context.logger.error(\n        error && typeof error === \"object\" && \"name\" in error ? error.name : \"\",\n        error\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst revokeSessions = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/revoke-sessions\",\n  {\n    method: \"POST\",\n    use: [sensitiveSessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke all sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if all sessions were revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      await ctx.context.internalAdapter.deleteSessions(\n        ctx.context.session.user.id\n      );\n    } catch (error) {\n      ctx.context.logger.error(\n        error && typeof error === \"object\" && \"name\" in error ? error.name : \"\",\n        error\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst revokeOtherSessions = (0,_better_auth_core_middleware__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/revoke-other-sessions\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    use: [sensitiveSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Revoke all other sessions for the user except the current one\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if all other sessions were revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    if (!session.user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      session.user.id\n    );\n    const activeSessions = sessions.filter((session2) => {\n      return session2.expiresAt > /* @__PURE__ */ new Date();\n    });\n    const otherSessions = activeSessions.filter(\n      (session2) => session2.token !== ctx.context.session.session.token\n    );\n    await Promise.all(\n      otherSessions.map(\n        (session2) => ctx.context.internalAdapter.deleteSession(session2.token)\n      )\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5ERUJ0Uk9GOS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXVDO0FBQ2lEO0FBQzlCO0FBQ3dEO0FBQ3pGO0FBQ3VDO0FBQ0w7QUFDTjtBQUNDO0FBQ0g7O0FBRW5ELDhCQUE4Qix5Q0FBVTtBQUN4QyxFQUFFLHVDQUFRO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsK0NBQWdCO0FBQ3hDO0FBQ0EsS0FBSztBQUNMLG9CQUFvQiwrQ0FBZ0I7QUFDcEM7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EseUJBQXlCLGdGQUFrQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELDREQUFhLENBQUMsNkRBQU0sUUFBUSxnRUFBUztBQUMxRjtBQUNBLDhCQUE4QixtRUFBVTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFD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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDRCQUE0QixnRkFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFOFIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkRFQnRST0Y5Lm1qcz80YzJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIGNyZWF0ZUF1dGhFbmRwb2ludCB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL21pZGRsZXdhcmUnO1xuaW1wb3J0IHsgZyBhcyBnZXREYXRlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DVzZEOWVTeC5tanMnO1xuaW1wb3J0IHsgZCBhcyBkZWxldGVTZXNzaW9uQ29va2llLCBzIGFzIHNldFNlc3Npb25Db29raWUsIGEgYXMgc2V0Q29va2llQ2FjaGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkQ5X3ZRUjgzLm1qcyc7XG5pbXBvcnQgKiBhcyB6IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBzIGFzIHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2JldHRlci1hdXRoLkJLRXRFcHQwLm1qcyc7XG5pbXBvcnQgeyBCQVNFX0VSUk9SX0NPREVTIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0IHsgY3JlYXRlSE1BQyB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCB7IGJhc2U2NFVybCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgYmluYXJ5IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2JpbmFyeSc7XG5cbmNvbnN0IGdldFNlc3Npb25RdWVyeVNjaGVtYSA9IHoub3B0aW9uYWwoXG4gIHoub2JqZWN0KHtcbiAgICAvKipcbiAgICAgKiBJZiBjb29raWUgY2FjaGUgaXMgZW5hYmxlZCwgaXQgd2lsbCBkaXNhYmxlIHRoZSBjYWNoZVxuICAgICAqIGFuZCBmZXRjaCB0aGUgc2Vzc2lvbiBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAqL1xuICAgIGRpc2FibGVDb29raWVDYWNoZTogei5jb2VyY2UuYm9vbGVhbigpLm1ldGEoe1xuICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBjb29raWUgY2FjaGUgYW5kIGZldGNoIHNlc3Npb24gZnJvbSBkYXRhYmFzZVwiXG4gICAgfSkub3B0aW9uYWwoKSxcbiAgICBkaXNhYmxlUmVmcmVzaDogei5jb2VyY2UuYm9vbGVhbigpLm1ldGEoe1xuICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBzZXNzaW9uIHJlZnJlc2guIFVzZWZ1bCBmb3IgY2hlY2tpbmcgc2Vzc2lvbiBzdGF0dXMsIHdpdGhvdXQgdXBkYXRpbmcgdGhlIHNlc3Npb25cIlxuICAgIH0pLm9wdGlvbmFsKClcbiAgfSlcbik7XG5jb25zdCBnZXRTZXNzaW9uID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9nZXQtc2Vzc2lvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiBnZXRTZXNzaW9uUXVlcnlTY2hlbWEsXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSBjdXJyZW50IHNlc3Npb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvU2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInNlc3Npb25cIiwgXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb25Db29raWVUb2tlbiA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICk7XG4gICAgICBpZiAoIXNlc3Npb25Db29raWVUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhQ29va2llID0gY3R4LmdldENvb2tpZShcbiAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhUGF5bG9hZCA9IHNlc3Npb25EYXRhQ29va2llID8gc2FmZUpTT05QYXJzZShiaW5hcnkuZGVjb2RlKGJhc2U2NFVybC5kZWNvZGUoc2Vzc2lvbkRhdGFDb29raWUpKSkgOiBudWxsO1xuICAgICAgaWYgKHNlc3Npb25EYXRhUGF5bG9hZCkge1xuICAgICAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgY3JlYXRlSE1BQyhcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS52ZXJpZnkoXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIC4uLnNlc3Npb25EYXRhUGF5bG9hZC5zZXNzaW9uLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBzZXNzaW9uRGF0YVBheWxvYWQuZXhwaXJlc0F0XG4gICAgICAgICAgfSksXG4gICAgICAgICAgc2Vzc2lvbkRhdGFQYXlsb2FkLnNpZ25hdHVyZVxuICAgICAgICApO1xuICAgICAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgICBjb25zdCBkYXRhQ29va2llID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZTtcbiAgICAgICAgICBjdHguc2V0Q29va2llKGRhdGFDb29raWUsIFwiXCIsIHtcbiAgICAgICAgICAgIG1heEFnZTogMFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgZG9udFJlbWVtYmVyTWUgPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICk7XG4gICAgICBpZiAoc2Vzc2lvbkRhdGFQYXlsb2FkPy5zZXNzaW9uICYmIGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/LmVuYWJsZWQgJiYgIWN0eC5xdWVyeT8uZGlzYWJsZUNvb2tpZUNhY2hlKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb24yID0gc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb247XG4gICAgICAgIGNvbnN0IGhhc0V4cGlyZWQgPSBzZXNzaW9uRGF0YVBheWxvYWQuZXhwaXJlc0F0IDwgRGF0ZS5ub3coKSB8fCBzZXNzaW9uMi5zZXNzaW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAoIWhhc0V4cGlyZWQpIHtcbiAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uID0gc2Vzc2lvbjI7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgICAgc2Vzc2lvbjJcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGRhdGFDb29raWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lO1xuICAgICAgICAgIGN0eC5zZXRDb29raWUoZGF0YUNvb2tpZSwgXCJcIiwge1xuICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24oc2Vzc2lvbkNvb2tpZVRva2VuKTtcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uO1xuICAgICAgaWYgKCFzZXNzaW9uIHx8IHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgIGlmIChzZXNzaW9uKSB7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW5cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgIH1cbiAgICAgIGlmIChkb250UmVtZW1iZXJNZSB8fCBjdHgucXVlcnk/LmRpc2FibGVSZWZyZXNoKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbihcbiAgICAgICAgICBzZXNzaW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCBleHBpcmVzSW4gPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmV4cGlyZXNJbjtcbiAgICAgIGNvbnN0IHVwZGF0ZUFnZSA9IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcudXBkYXRlQWdlO1xuICAgICAgY29uc3Qgc2Vzc2lvbklzRHVlVG9CZVVwZGF0ZWREYXRlID0gc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdC52YWx1ZU9mKCkgLSBleHBpcmVzSW4gKiAxZTMgKyB1cGRhdGVBZ2UgKiAxZTM7XG4gICAgICBjb25zdCBzaG91bGRCZVVwZGF0ZWQgPSBzZXNzaW9uSXNEdWVUb0JlVXBkYXRlZERhdGUgPD0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChzaG91bGRCZVVwZGF0ZWQgJiYgKCFjdHgucXVlcnk/LmRpc2FibGVSZWZyZXNoIHx8ICFjdHguY29udGV4dC5vcHRpb25zLnNlc3Npb24/LmRpc2FibGVTZXNzaW9uUmVmcmVzaCkpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlU2Vzc2lvbihcbiAgICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZXhwaXJlc0luLCBcInNlY1wiKSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICghdXBkYXRlZFNlc3Npb24pIHtcbiAgICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWF4QWdlID0gKHVwZGF0ZWRTZXNzaW9uLmV4cGlyZXNBdC52YWx1ZU9mKCkgLSBEYXRlLm5vdygpKSAvIDFlMztcbiAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgICAgICBjdHgsXG4gICAgICAgICAge1xuICAgICAgICAgICAgc2Vzc2lvbjogdXBkYXRlZFNlc3Npb24sXG4gICAgICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG1heEFnZVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICBzZXNzaW9uOiB1cGRhdGVkU2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRDb29raWVDYWNoZShjdHgsIHNlc3Npb24sICEhZG9udFJlbWVtYmVyTWUpO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICBzZXNzaW9uXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuKTtcbmNvbnN0IGdldFNlc3Npb25Gcm9tQ3R4ID0gYXN5bmMgKGN0eCwgY29uZmlnKSA9PiB7XG4gIGlmIChjdHguY29udGV4dC5zZXNzaW9uKSB7XG4gICAgcmV0dXJuIGN0eC5jb250ZXh0LnNlc3Npb247XG4gIH1cbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oKSh7XG4gICAgLi4uY3R4LFxuICAgIGFzUmVzcG9uc2U6IGZhbHNlLFxuICAgIGhlYWRlcnM6IGN0eC5oZWFkZXJzLFxuICAgIHJldHVybkhlYWRlcnM6IGZhbHNlLFxuICAgIHF1ZXJ5OiB7XG4gICAgICAuLi5jb25maWcsXG4gICAgICAuLi5jdHgucXVlcnlcbiAgICB9XG4gIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0pO1xuICBjdHguY29udGV4dC5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgcmV0dXJuIHNlc3Npb247XG59O1xuY29uc3Qgc2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uXG4gIH07XG59KTtcbmNvbnN0IHNlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4LCB7IGRpc2FibGVDb29raWVDYWNoZTogdHJ1ZSB9KTtcbiAgaWYgKCFzZXNzaW9uPy5zZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICB9XG4gIHJldHVybiB7XG4gICAgc2Vzc2lvblxuICB9O1xufSk7XG5jb25zdCByZXF1ZXN0T25seVNlc3Npb25NaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAoIXNlc3Npb24/LnNlc3Npb24gJiYgKGN0eC5yZXF1ZXN0IHx8IGN0eC5oZWFkZXJzKSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICByZXR1cm4geyBzZXNzaW9uIH07XG4gIH1cbik7XG5jb25zdCBmcmVzaFNlc3Npb25NaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgaWYgKCFzZXNzaW9uPy5zZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICB9XG4gIGlmIChjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlID09PSAwKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNlc3Npb25cbiAgICB9O1xuICB9XG4gIGNvbnN0IGZyZXNoQWdlID0gY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy5mcmVzaEFnZTtcbiAgY29uc3QgbGFzdFVwZGF0ZWQgPSBzZXNzaW9uLnNlc3Npb24udXBkYXRlZEF0Py52YWx1ZU9mKCkgfHwgc2Vzc2lvbi5zZXNzaW9uLmNyZWF0ZWRBdC52YWx1ZU9mKCk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGlzRnJlc2ggPSBub3cgLSBsYXN0VXBkYXRlZCA8IGZyZXNoQWdlICogMWUzO1xuICBpZiAoIWlzRnJlc2gpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgbWVzc2FnZTogXCJTZXNzaW9uIGlzIG5vdCBmcmVzaFwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uXG4gIH07XG59KTtcbmNvbnN0IGxpc3RTZXNzaW9ucyA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvbGlzdC1zZXNzaW9uc1wiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJMaXN0IGFsbCBhY3RpdmUgc2Vzc2lvbnMgZm9yIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvU2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpc3RTZXNzaW9ucyhcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgICAgY29uc3QgYWN0aXZlU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIoKHNlc3Npb24pID0+IHtcbiAgICAgICAgcmV0dXJuIHNlc3Npb24uZXhwaXJlc0F0ID4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbihcbiAgICAgICAgYWN0aXZlU2Vzc2lvbnNcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGUpO1xuICAgICAgdGhyb3cgY3R4LmVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIpO1xuICAgIH1cbiAgfVxuKTtcbmNvbnN0IHJldm9rZVNlc3Npb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jldm9rZS1zZXNzaW9uXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gcmV2b2tlXCJcbiAgICAgIH0pXG4gICAgfSksXG4gICAgdXNlOiBbc2Vuc2l0aXZlU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhIHNpbmdsZSBzZXNzaW9uXCIsXG4gICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gcmV2b2tlXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ0b2tlblwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIHNlc3Npb24gd2FzIHJldm9rZWQgc3VjY2Vzc2Z1bGx5XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJzdGF0dXNcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IGN0eC5ib2R5LnRva2VuO1xuICAgIGNvbnN0IGZpbmRTZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRTZXNzaW9uKHRva2VuKTtcbiAgICBpZiAoIWZpbmRTZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiU2Vzc2lvbiBub3QgZm91bmRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChmaW5kU2Vzc2lvbi5zZXNzaW9uLnVzZXJJZCAhPT0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbih0b2tlbik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIFwibmFtZVwiIGluIGVycm9yID8gZXJyb3IubmFtZSA6IFwiXCIsXG4gICAgICAgIGVycm9yXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCByZXZva2VTZXNzaW9ucyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLXNlc3Npb25zXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHVzZTogW3NlbnNpdGl2ZVNlc3Npb25NaWRkbGV3YXJlXSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYWxsIHNlc3Npb25zIGZvciB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgYWxsIHNlc3Npb25zIHdlcmUgcmV2b2tlZCBzdWNjZXNzZnVsbHlcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN0YXR1c1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoXG4gICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZXJyb3IgPyBlcnJvci5uYW1lIDogXCJcIixcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIik7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHJldm9rZU90aGVyU2Vzc2lvbnMgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jldm9rZS1vdGhlci1zZXNzaW9uc1wiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICB1c2U6IFtzZW5zaXRpdmVTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGFsbCBvdGhlciBzZXNzaW9ucyBmb3IgdGhlIHVzZXIgZXhjZXB0IHRoZSBjdXJyZW50IG9uZVwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgYWxsIG90aGVyIHNlc3Npb25zIHdlcmUgcmV2b2tlZCBzdWNjZXNzZnVsbHlcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN0YXR1c1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGlmICghc2Vzc2lvbi51c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpc3RTZXNzaW9ucyhcbiAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgY29uc3QgYWN0aXZlU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIoKHNlc3Npb24yKSA9PiB7XG4gICAgICByZXR1cm4gc2Vzc2lvbjIuZXhwaXJlc0F0ID4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gICAgfSk7XG4gICAgY29uc3Qgb3RoZXJTZXNzaW9ucyA9IGFjdGl2ZVNlc3Npb25zLmZpbHRlcihcbiAgICAgIChzZXNzaW9uMikgPT4gc2Vzc2lvbjIudG9rZW4gIT09IGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi50b2tlblxuICAgICk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICBvdGhlclNlc3Npb25zLm1hcChcbiAgICAgICAgKHNlc3Npb24yKSA9PiBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihzZXNzaW9uMi50b2tlbilcbiAgICAgIClcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcblxuZXhwb3J0IHsgZ2V0U2Vzc2lvbiBhcyBhLCByZXZva2VTZXNzaW9ucyBhcyBiLCByZXZva2VTZXNzaW9uIGFzIGMsIGdldFNlc3Npb25RdWVyeVNjaGVtYSBhcyBkLCBzZW5zaXRpdmVTZXNzaW9uTWlkZGxld2FyZSBhcyBlLCBmcmVzaFNlc3Npb25NaWRkbGV3YXJlIGFzIGYsIGdldFNlc3Npb25Gcm9tQ3R4IGFzIGcsIHJlcXVlc3RPbmx5U2Vzc2lvbk1pZGRsZXdhcmUgYXMgaCwgbGlzdFNlc3Npb25zIGFzIGwsIHJldm9rZU90aGVyU2Vzc2lvbnMgYXMgciwgc2Vzc2lvbk1pZGRsZXdhcmUgYXMgcyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DEBtROF9.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getBaseURL),\n/* harmony export */   b: () => (/* binding */ getHost),\n/* harmony export */   c: () => (/* binding */ getProtocol),\n/* harmony export */   g: () => (/* binding */ getOrigin)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n\n\n\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    const pathname = parsedUrl.pathname.replace(/\\/+$/, \"\") || \"/\";\n    return pathname !== \"/\";\n  } catch (error) {\n    throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  const trimmedUrl = url.replace(/\\/+$/, \"\");\n  if (!path || path === \"/\") {\n    return trimmedUrl;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${trimmedUrl}${path}`;\n}\nfunction getBaseURL(url, path, request, loadEnv) {\n  if (url) {\n    return withPath(url, path);\n  }\n  if (loadEnv !== false) {\n    const fromEnv = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n    if (fromEnv) {\n      return withPath(fromEnv, path);\n    }\n  }\n  const fromRequest = request?.headers.get(\"x-forwarded-host\");\n  const fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n  if (fromRequest && fromRequestProto) {\n    return withPath(`${fromRequestProto}://${fromRequest}`, path);\n  }\n  if (request) {\n    const url2 = getOrigin(request.url);\n    if (!url2) {\n      throw new _better_auth_core_error__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n        \"Could not get origin from request. Please provide a valid base URL.\"\n      );\n    }\n    return withPath(url2, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  } catch (error) {\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5EUjNSNXdkVS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTRDO0FBQ2M7O0FBRTFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osY0FBYyxvRUFBZTtBQUM3QiwyQkFBMkIsSUFBSTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsS0FBSztBQUNoRCxZQUFZLFdBQVcsRUFBRSxLQUFLO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzREFBRyxvQkFBb0Isc0RBQUcsZ0NBQWdDLHNEQUFHLDJCQUEyQixzREFBRyxnQ0FBZ0Msc0RBQUcsMEJBQTBCLHNEQUFHLG9CQUFvQixzREFBRztBQUN0TTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUIsS0FBSyxZQUFZO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9FQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUUyRSIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRFIzUjV3ZFUubWpzPzM3N2MiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZW52IH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vycm9yJztcblxuZnVuY3Rpb24gY2hlY2tIYXNQYXRoKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICBjb25zdCBwYXRobmFtZSA9IHBhcnNlZFVybC5wYXRobmFtZS5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpIHx8IFwiL1wiO1xuICAgIHJldHVybiBwYXRobmFtZSAhPT0gXCIvXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIGBJbnZhbGlkIGJhc2UgVVJMOiAke3VybH0uIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIHdpdGhQYXRoKHVybCwgcGF0aCA9IFwiL2FwaS9hdXRoXCIpIHtcbiAgY29uc3QgaGFzUGF0aCA9IGNoZWNrSGFzUGF0aCh1cmwpO1xuICBpZiAoaGFzUGF0aCkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgY29uc3QgdHJpbW1lZFVybCA9IHVybC5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpO1xuICBpZiAoIXBhdGggfHwgcGF0aCA9PT0gXCIvXCIpIHtcbiAgICByZXR1cm4gdHJpbW1lZFVybDtcbiAgfVxuICBwYXRoID0gcGF0aC5zdGFydHNXaXRoKFwiL1wiKSA/IHBhdGggOiBgLyR7cGF0aH1gO1xuICByZXR1cm4gYCR7dHJpbW1lZFVybH0ke3BhdGh9YDtcbn1cbmZ1bmN0aW9uIGdldEJhc2VVUkwodXJsLCBwYXRoLCByZXF1ZXN0LCBsb2FkRW52KSB7XG4gIGlmICh1cmwpIHtcbiAgICByZXR1cm4gd2l0aFBhdGgodXJsLCBwYXRoKTtcbiAgfVxuICBpZiAobG9hZEVudiAhPT0gZmFsc2UpIHtcbiAgICBjb25zdCBmcm9tRW52ID0gZW52LkJFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTkVYVF9QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5OVVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0FVVEhfVVJMIHx8IChlbnYuQkFTRV9VUkwgIT09IFwiL1wiID8gZW52LkJBU0VfVVJMIDogdm9pZCAwKTtcbiAgICBpZiAoZnJvbUVudikge1xuICAgICAgcmV0dXJuIHdpdGhQYXRoKGZyb21FbnYsIHBhdGgpO1xuICAgIH1cbiAgfVxuICBjb25zdCBmcm9tUmVxdWVzdCA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtaG9zdFwiKTtcbiAgY29uc3QgZnJvbVJlcXVlc3RQcm90byA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtcHJvdG9cIik7XG4gIGlmIChmcm9tUmVxdWVzdCAmJiBmcm9tUmVxdWVzdFByb3RvKSB7XG4gICAgcmV0dXJuIHdpdGhQYXRoKGAke2Zyb21SZXF1ZXN0UHJvdG99Oi8vJHtmcm9tUmVxdWVzdH1gLCBwYXRoKTtcbiAgfVxuICBpZiAocmVxdWVzdCkge1xuICAgIGNvbnN0IHVybDIgPSBnZXRPcmlnaW4ocmVxdWVzdC51cmwpO1xuICAgIGlmICghdXJsMikge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJDb3VsZCBub3QgZ2V0IG9yaWdpbiBmcm9tIHJlcXVlc3QuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB3aXRoUGF0aCh1cmwyLCBwYXRoKTtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgod2luZG93LmxvY2F0aW9uLm9yaWdpbiwgcGF0aCk7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGdldE9yaWdpbih1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5vcmlnaW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFByb3RvY29sKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLnByb3RvY29sO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRIb3N0KHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3Q7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IHsgZ2V0QmFzZVVSTCBhcyBhLCBnZXRIb3N0IGFzIGIsIGdldFByb3RvY29sIGFzIGMsIGdldE9yaWdpbiBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.DR3R5wdU.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createAdapterFactory)\n/* harmony export */ });\n/* harmony import */ var _better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.BKEtEpt0.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BKEtEpt0.mjs\");\n/* harmony import */ var _better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.pQjeRkzN.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.3.0/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_core_error__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/core/error */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/.pnpm/@better-auth+core@1.3.34_@b_566acc6130a3ff36333cffd139a2cceb/node_modules/@better-auth/core/dist/env/index.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction withApplyDefault(value, field, action) {\n  if (action === \"update\") {\n    if (value === void 0 && field.onUpdate !== void 0) {\n      if (typeof field.onUpdate === \"function\") {\n        return field.onUpdate();\n      }\n      return field.onUpdate;\n    }\n    return value;\n  }\n  if (value === void 0 || value === null) {\n    if (field.defaultValue !== void 0) {\n      if (typeof field.defaultValue === \"function\") {\n        return field.defaultValue();\n      }\n      return field.defaultValue;\n    }\n  }\n  return value;\n}\n\nlet debugLogs = [];\nlet transactionId = -1;\nconst createAsIsTransaction = (adapter) => (fn) => fn(adapter);\nconst createAdapterFactory = ({\n  adapter: customAdapter,\n  config: cfg\n}) => (options) => {\n  const uniqueAdapterFactoryInstanceId = Math.random().toString(36).substring(2, 15);\n  const config = {\n    ...cfg,\n    supportsBooleans: cfg.supportsBooleans ?? true,\n    supportsDates: cfg.supportsDates ?? true,\n    supportsJSON: cfg.supportsJSON ?? false,\n    adapterName: cfg.adapterName ?? cfg.adapterId,\n    supportsNumericIds: cfg.supportsNumericIds ?? true,\n    transaction: cfg.transaction ?? false,\n    disableTransformInput: cfg.disableTransformInput ?? false,\n    disableTransformOutput: cfg.disableTransformOutput ?? false\n  };\n  if (options.advanced?.database?.useNumberId === true && config.supportsNumericIds === false) {\n    throw new Error(\n      `[${config.adapterName}] Your database or database adapter does not support numeric ids. Please disable \"useNumberId\" in your config.`\n    );\n  }\n  const schema = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options);\n  const getDefaultFieldName = ({\n    field,\n    model: unsafe_model\n  }) => {\n    if (field === \"id\" || field === \"_id\") {\n      return \"id\";\n    }\n    const model = getDefaultModelName(unsafe_model);\n    let f = schema[model]?.fields[field];\n    if (!f) {\n      const result = Object.entries(schema[model].fields).find(\n        ([_, f2]) => f2.fieldName === field\n      );\n      if (result) {\n        f = result[1];\n        field = result[0];\n      }\n    }\n    if (!f) {\n      debugLog(`Field ${field} not found in model ${model}`);\n      debugLog(`Schema:`, schema);\n      throw new Error(`Field ${field} not found in model ${model}`);\n    }\n    return field;\n  };\n  const getDefaultModelName = (model) => {\n    if (config.usePlural && model.charAt(model.length - 1) === \"s\") {\n      let pluralessModel = model.slice(0, -1);\n      let m2 = schema[pluralessModel] ? pluralessModel : void 0;\n      if (!m2) {\n        m2 = Object.entries(schema).find(\n          ([_, f]) => f.modelName === pluralessModel\n        )?.[0];\n      }\n      if (m2) {\n        return m2;\n      }\n    }\n    let m = schema[model] ? model : void 0;\n    if (!m) {\n      m = Object.entries(schema).find(([_, f]) => f.modelName === model)?.[0];\n    }\n    if (!m) {\n      debugLog(`Model \"${model}\" not found in schema`);\n      debugLog(`Schema:`, schema);\n      throw new Error(`Model \"${model}\" not found in schema`);\n    }\n    return m;\n  };\n  const getModelName = (model) => {\n    const defaultModelKey = getDefaultModelName(model);\n    const usePlural = config && config.usePlural;\n    const useCustomModelName = schema && schema[defaultModelKey] && schema[defaultModelKey].modelName !== model;\n    if (useCustomModelName) {\n      return usePlural ? `${schema[defaultModelKey].modelName}s` : schema[defaultModelKey].modelName;\n    }\n    return usePlural ? `${model}s` : model;\n  };\n  function getFieldName({\n    model: model_name,\n    field: field_name\n  }) {\n    const model = getDefaultModelName(model_name);\n    const field = getDefaultFieldName({ model, field: field_name });\n    return schema[model]?.fields[field]?.fieldName || field;\n  }\n  const debugLog = (...args) => {\n    if (config.debugLogs === true || typeof config.debugLogs === \"object\") {\n      if (typeof config.debugLogs === \"object\" && \"isRunningAdapterTests\" in config.debugLogs) {\n        if (config.debugLogs.isRunningAdapterTests) {\n          args.shift();\n          debugLogs.push({ instance: uniqueAdapterFactoryInstanceId, args });\n        }\n        return;\n      }\n      if (typeof config.debugLogs === \"object\" && config.debugLogs.logCondition && !config.debugLogs.logCondition?.()) {\n        return;\n      }\n      if (typeof args[0] === \"object\" && \"method\" in args[0]) {\n        const method = args.shift().method;\n        if (typeof config.debugLogs === \"object\") {\n          if (method === \"create\" && !config.debugLogs.create) {\n            return;\n          } else if (method === \"update\" && !config.debugLogs.update) {\n            return;\n          } else if (method === \"updateMany\" && !config.debugLogs.updateMany) {\n            return;\n          } else if (method === \"findOne\" && !config.debugLogs.findOne) {\n            return;\n          } else if (method === \"findMany\" && !config.debugLogs.findMany) {\n            return;\n          } else if (method === \"delete\" && !config.debugLogs.delete) {\n            return;\n          } else if (method === \"deleteMany\" && !config.debugLogs.deleteMany) {\n            return;\n          } else if (method === \"count\" && !config.debugLogs.count) {\n            return;\n          }\n        }\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.info(`[${config.adapterName}]`, ...args);\n      } else {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.info(`[${config.adapterName}]`, ...args);\n      }\n    }\n  };\n  const idField = ({\n    customModelName,\n    forceAllowId\n  }) => {\n    const shouldGenerateId = !config.disableIdGeneration && !options.advanced?.database?.useNumberId && !forceAllowId;\n    const model = getDefaultModelName(customModelName ?? \"id\");\n    return {\n      type: options.advanced?.database?.useNumberId ? \"number\" : \"string\",\n      required: shouldGenerateId ? true : false,\n      ...shouldGenerateId ? {\n        defaultValue() {\n          if (config.disableIdGeneration) return void 0;\n          const useNumberId = options.advanced?.database?.useNumberId;\n          let generateId$1 = options.advanced?.database?.generateId;\n          if (options.advanced?.generateId !== void 0) {\n            _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.warn(\n              \"Your Better Auth config includes advanced.generateId which is deprecated. Please use advanced.database.generateId instead. This will be removed in future releases.\"\n            );\n            generateId$1 = options.advanced?.generateId;\n          }\n          if (generateId$1 === false || useNumberId) return void 0;\n          if (generateId$1) {\n            return generateId$1({\n              model\n            });\n          }\n          if (config.customIdGenerator) {\n            return config.customIdGenerator({ model });\n          }\n          return (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_2__.g)();\n        }\n      } : {}\n    };\n  };\n  const getFieldAttributes = ({\n    model,\n    field\n  }) => {\n    const defaultModelName = getDefaultModelName(model);\n    const defaultFieldName = getDefaultFieldName({\n      field,\n      model: defaultModelName\n    });\n    const fields = schema[defaultModelName].fields;\n    fields.id = idField({ customModelName: defaultModelName });\n    return fields[defaultFieldName];\n  };\n  const transformInput = async (data, defaultModelName, action, forceAllowId) => {\n    const transformedData = {};\n    const fields = schema[defaultModelName].fields;\n    const newMappedKeys = config.mapKeysTransformInput ?? {};\n    if (!config.disableIdGeneration && !options.advanced?.database?.useNumberId) {\n      fields.id = idField({\n        customModelName: defaultModelName,\n        forceAllowId: forceAllowId && \"id\" in data\n      });\n    }\n    for (const field in fields) {\n      const value = data[field];\n      const fieldAttributes = fields[field];\n      let newFieldName = newMappedKeys[field] || fields[field].fieldName || field;\n      if (value === void 0 && (fieldAttributes.defaultValue === void 0 && !fieldAttributes.transform?.input && !(action === \"update\" && fieldAttributes.onUpdate) || action === \"update\" && !fieldAttributes.onUpdate)) {\n        continue;\n      }\n      let newValue = withApplyDefault(value, fieldAttributes, action);\n      if (fieldAttributes.transform?.input) {\n        newValue = await fieldAttributes.transform.input(newValue);\n      }\n      if (fieldAttributes.references?.field === \"id\" && options.advanced?.database?.useNumberId) {\n        if (Array.isArray(newValue)) {\n          newValue = newValue.map((x) => x !== null ? Number(x) : null);\n        } else {\n          newValue = newValue !== null ? Number(newValue) : null;\n        }\n      } else if (config.supportsJSON === false && typeof newValue === \"object\" && fieldAttributes.type === \"json\") {\n        newValue = JSON.stringify(newValue);\n      } else if (config.supportsDates === false && newValue instanceof Date && fieldAttributes.type === \"date\") {\n        newValue = newValue.toISOString();\n      } else if (config.supportsBooleans === false && typeof newValue === \"boolean\") {\n        newValue = newValue ? 1 : 0;\n      }\n      if (config.customTransformInput) {\n        newValue = config.customTransformInput({\n          data: newValue,\n          action,\n          field: newFieldName,\n          fieldAttributes,\n          model: defaultModelName,\n          schema,\n          options\n        });\n      }\n      if (newValue !== void 0) {\n        transformedData[newFieldName] = newValue;\n      }\n    }\n    return transformedData;\n  };\n  const transformOutput = async (data, unsafe_model, select = []) => {\n    if (!data) return null;\n    const newMappedKeys = config.mapKeysTransformOutput ?? {};\n    const transformedData = {};\n    const tableSchema = schema[unsafe_model].fields;\n    const idKey = Object.entries(newMappedKeys).find(\n      ([_, v]) => v === \"id\"\n    )?.[0];\n    tableSchema[idKey ?? \"id\"] = {\n      type: options.advanced?.database?.useNumberId ? \"number\" : \"string\"\n    };\n    for (const key in tableSchema) {\n      if (select.length && !select.includes(key)) {\n        continue;\n      }\n      const field = tableSchema[key];\n      if (field) {\n        const originalKey = field.fieldName || key;\n        let newValue = data[Object.entries(newMappedKeys).find(\n          ([_, v]) => v === originalKey\n        )?.[0] || originalKey];\n        if (field.transform?.output) {\n          newValue = await field.transform.output(newValue);\n        }\n        let newFieldName = newMappedKeys[key] || key;\n        if (originalKey === \"id\" || field.references?.field === \"id\") {\n          if (typeof newValue !== \"undefined\" && newValue !== null)\n            newValue = String(newValue);\n        } else if (config.supportsJSON === false && typeof newValue === \"string\" && field.type === \"json\") {\n          newValue = (0,_better_auth_BKEtEpt0_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(newValue);\n        } else if (config.supportsDates === false && typeof newValue === \"string\" && field.type === \"date\") {\n          newValue = new Date(newValue);\n        } else if (config.supportsBooleans === false && typeof newValue === \"number\" && field.type === \"boolean\") {\n          newValue = newValue === 1;\n        }\n        if (config.customTransformOutput) {\n          newValue = config.customTransformOutput({\n            data: newValue,\n            field: newFieldName,\n            fieldAttributes: field,\n            select,\n            model: unsafe_model,\n            schema,\n            options\n          });\n        }\n        transformedData[newFieldName] = newValue;\n      }\n    }\n    return transformedData;\n  };\n  const transformWhereClause = ({\n    model,\n    where\n  }) => {\n    if (!where) return void 0;\n    const newMappedKeys = config.mapKeysTransformInput ?? {};\n    return where.map((w) => {\n      const {\n        field: unsafe_field,\n        value,\n        operator = \"eq\",\n        connector = \"AND\"\n      } = w;\n      if (operator === \"in\") {\n        if (!Array.isArray(value)) {\n          throw new Error(\"Value must be an array\");\n        }\n      }\n      const defaultModelName = getDefaultModelName(model);\n      const defaultFieldName = getDefaultFieldName({\n        field: unsafe_field,\n        model\n      });\n      const fieldName = newMappedKeys[defaultFieldName] || getFieldName({\n        field: defaultFieldName,\n        model: defaultModelName\n      });\n      const fieldAttr = getFieldAttributes({\n        field: defaultFieldName,\n        model: defaultModelName\n      });\n      if (defaultFieldName === \"id\" || fieldAttr.references?.field === \"id\") {\n        if (options.advanced?.database?.useNumberId) {\n          if (Array.isArray(value)) {\n            return {\n              operator,\n              connector,\n              field: fieldName,\n              value: value.map(Number)\n            };\n          }\n          return {\n            operator,\n            connector,\n            field: fieldName,\n            value: Number(value)\n          };\n        }\n      }\n      return {\n        operator,\n        connector,\n        field: fieldName,\n        value\n      };\n    });\n  };\n  const adapterInstance = customAdapter({\n    options,\n    schema,\n    debugLog,\n    getFieldName,\n    getModelName,\n    getDefaultModelName,\n    getDefaultFieldName,\n    getFieldAttributes,\n    transformInput,\n    transformOutput,\n    transformWhereClause\n  });\n  let lazyLoadTransaction = null;\n  const adapter = {\n    transaction: async (cb) => {\n      if (!lazyLoadTransaction) {\n        if (!config.transaction) {\n          if (typeof config.debugLogs === \"object\" && \"isRunningAdapterTests\" in config.debugLogs && config.debugLogs.isRunningAdapterTests) ; else {\n            _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.warn(\n              `[${config.adapterName}] - Transactions are not supported. Executing operations sequentially.`\n            );\n          }\n          lazyLoadTransaction = createAsIsTransaction(adapter);\n        } else {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.debug(\n            `[${config.adapterName}] - Using provided transaction implementation.`\n          );\n          lazyLoadTransaction = config.transaction;\n        }\n      }\n      return lazyLoadTransaction(cb);\n    },\n    create: async ({\n      data: unsafeData,\n      model: unsafeModel,\n      select,\n      forceAllowId = false\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      unsafeModel = getDefaultModelName(unsafeModel);\n      if (\"id\" in unsafeData && !forceAllowId) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.logger.warn(\n          `[${config.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \\`forceAllowId\\` parameter. The id will be ignored.`\n        );\n        const err = new Error();\n        const stack = err.stack?.split(\"\\n\").filter((_, i) => i !== 1).join(\"\\n\").replace(\"Error:\", \"Create method with `id` being called at:\");\n        console.log(stack);\n        unsafeData.id = void 0;\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      let data = unsafeData;\n      if (!config.disableTransformInput) {\n        data = await transformInput(\n          unsafeData,\n          unsafeModel,\n          \"create\",\n          forceAllowId\n        );\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const res = await adapterInstance.create({ data, model });\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"DB Result\")}:`,\n        { model, res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await transformOutput(res, unsafeModel, select);\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    update: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      update: unsafeData\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      unsafeModel = getDefaultModelName(unsafeModel);\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      let data = unsafeData;\n      if (!config.disableTransformInput) {\n        data = await transformInput(unsafeData, unsafeModel, \"update\");\n      }\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const res = await adapterInstance.update({\n        model,\n        where,\n        update: data\n      });\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await transformOutput(res, unsafeModel);\n      }\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    updateMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      update: unsafeData\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      let data = unsafeData;\n      if (!config.disableTransformInput) {\n        data = await transformInput(unsafeData, unsafeModel, \"update\");\n      }\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const updatedCount = await adapterInstance.updateMany({\n        model,\n        where,\n        update: data\n      });\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: updatedCount }\n      );\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: updatedCount }\n      );\n      return updatedCount;\n    },\n    findOne: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      select\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`,\n        `${formatMethod(\"findOne\")}:`,\n        { model, where, select }\n      );\n      const res = await adapterInstance.findOne({\n        model,\n        where,\n        select\n      });\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`,\n        `${formatMethod(\"findOne\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await transformOutput(res, unsafeModel, select);\n      }\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`,\n        `${formatMethod(\"findOne\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    findMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      limit: unsafeLimit,\n      sortBy,\n      offset\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const limit = unsafeLimit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`,\n        `${formatMethod(\"findMany\")}:`,\n        { model, where, limit, sortBy, offset }\n      );\n      const res = await adapterInstance.findMany({\n        model,\n        where,\n        limit,\n        sortBy,\n        offset\n      });\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`,\n        `${formatMethod(\"findMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      let transformed = res;\n      if (!config.disableTransformOutput) {\n        transformed = await Promise.all(\n          res.map(async (r) => await transformOutput(r, unsafeModel))\n        );\n      }\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`,\n        `${formatMethod(\"findMany\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    delete: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"delete\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"delete\")}:`,\n        { model, where }\n      );\n      await adapterInstance.delete({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"delete\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"delete\")} ${formatAction(\"DB Result\")}:`,\n        { model }\n      );\n    },\n    deleteMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"deleteMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"deleteMany\")} ${formatAction(\"DeleteMany\")}:`,\n        { model, where }\n      );\n      const res = await adapterInstance.deleteMany({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"deleteMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"deleteMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      return res;\n    },\n    count: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      unsafeModel = getDefaultModelName(unsafeModel);\n      debugLog(\n        { method: \"count\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"count\")}:`,\n        {\n          model,\n          where\n        }\n      );\n      const res = await adapterInstance.count({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"count\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"count\")}:`,\n        {\n          model,\n          data: res\n        }\n      );\n      return res;\n    },\n    createSchema: adapterInstance.createSchema ? async (_, file) => {\n      const tables = (0,_better_auth_pQjeRkzN_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options);\n      if (options.secondaryStorage && !options.session?.storeSessionInDatabase) {\n        delete tables.session;\n      }\n      if (options.rateLimit && options.rateLimit.storage === \"database\" && // rate-limit will default to enabled in production,\n      // and given storage is database, it will try to use the rate-limit table,\n      // so we should make sure to generate rate-limit table schema\n      (typeof options.rateLimit.enabled === \"undefined\" || // and of course if they forcefully set to true, then they want rate-limit,\n      // thus we should also generate rate-limit table schema\n      options.rateLimit.enabled === true)) {\n        tables.ratelimit = {\n          modelName: options.rateLimit.modelName ?? \"ratelimit\",\n          fields: {\n            key: {\n              type: \"string\",\n              unique: true,\n              required: true,\n              fieldName: options.rateLimit.fields?.key ?? \"key\"\n            },\n            count: {\n              type: \"number\",\n              required: true,\n              fieldName: options.rateLimit.fields?.count ?? \"count\"\n            },\n            lastRequest: {\n              type: \"number\",\n              required: true,\n              bigint: true,\n              defaultValue: () => Date.now(),\n              fieldName: options.rateLimit.fields?.lastRequest ?? \"lastRequest\"\n            }\n          }\n        };\n      }\n      return adapterInstance.createSchema({ file, tables });\n    } : void 0,\n    options: {\n      adapterConfig: config,\n      ...adapterInstance.options ?? {}\n    },\n    id: config.adapterId,\n    // Secretly export values ONLY if this adapter has enabled adapter-test-debug-logs.\n    // This would then be used during our adapter-tests to help print debug logs if a test fails.\n    //@ts-expect-error - ^^\n    ...config.debugLogs?.isRunningAdapterTests ? {\n      adapterTestDebugLogs: {\n        resetDebugLogs() {\n          debugLogs = debugLogs.filter(\n            (log) => log.instance !== uniqueAdapterFactoryInstanceId\n          );\n        },\n        printDebugLogs() {\n          const separator = `\\u2500`.repeat(80);\n          const logs = debugLogs.filter(\n            (log2) => log2.instance === uniqueAdapterFactoryInstanceId\n          );\n          if (logs.length === 0) {\n            return;\n          }\n          let log = logs.reverse().map((log2) => {\n            log2.args[0] = `\n${log2.args[0]}`;\n            return [...log2.args, \"\\n\"];\n          }).reduce(\n            (prev, curr) => {\n              return [...curr, ...prev];\n            },\n            [`\n${separator}`]\n          );\n          console.log(...log);\n        }\n      }\n    } : {}\n  };\n  return adapter;\n};\nfunction formatTransactionId(transactionId2) {\n  if ((0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.getColorDepth)() < 8) {\n    return `#${transactionId2}`;\n  }\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.fg.magenta}#${transactionId2}${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\nfunction formatStep(step, total) {\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.bg.black}${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.fg.yellow}[${step}/${total}]${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\nfunction formatMethod(method) {\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.bright}${method}${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\nfunction formatAction(action) {\n  return `${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.dim}(${action})${_better_auth_core_env__WEBPACK_IMPORTED_MODULE_9__.TTY_COLORS.reset}`;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5FQnhLZVZOWi5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBZ0U7QUFDQTtBQUNIO0FBQ2hEO0FBQ1E7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNEO0FBQ0E7QUFDQztBQUNHO0FBQ3NDOztBQUUxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxtQkFBbUI7QUFDN0I7QUFDQTtBQUNBLGlCQUFpQiw0REFBYTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLE9BQU8scUJBQXFCLE1BQU07QUFDMUQ7QUFDQSwrQkFBK0IsT0FBTyxxQkFBcUIsTUFBTTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsTUFBTTtBQUMvQjtBQUNBLGdDQUFnQyxNQUFNO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGNBQWM7QUFDMUQsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsYUFBYTtBQUNmO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxFQUFFLFVBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sb0VBQWE7QUFDbkIsZUFBZSxlQUFlO0FBQzlCO0FBQ0EsWUFBWSw2REFBVSxZQUFZLEdBQUcsZUFBZSxFQUFFLDZEQUFVLE9BQU87QUFDdkU7QUFDQTtBQUNBLFlBQVksNkRBQVUsVUFBVSxFQUFFLDZEQUFVLFdBQVcsR0FBRyxLQUFLLEdBQUcsTUFBTSxHQUFHLDZEQUFVLE9BQU87QUFDNUY7QUFDQTtBQUNBLFlBQVksNkRBQVUsUUFBUSxFQUFFLE9BQU8sRUFBRSw2REFBVSxPQUFPO0FBQzFEO0FBQ0E7QUFDQSxZQUFZLDZEQUFVLEtBQUssR0FBRyxPQUFPLEdBQUcsNkRBQVUsT0FBTztBQUN6RDs7QUFFcUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkVCeEtlVk5aLm1qcz9jMWNhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQktFdEVwdDAubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0QXV0aFRhYmxlcyB9IGZyb20gJy4vYmV0dGVyLWF1dGgucFFqZVJrek4ubWpzJztcbmltcG9ydCB7IGcgYXMgZ2VuZXJhdGVJZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnem9kJztcbmltcG9ydCAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvZXJyb3InO1xuaW1wb3J0ICcuL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgeyBsb2dnZXIsIFRUWV9DT0xPUlMsIGdldENvbG9yRGVwdGggfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuXG5mdW5jdGlvbiB3aXRoQXBwbHlEZWZhdWx0KHZhbHVlLCBmaWVsZCwgYWN0aW9uKSB7XG4gIGlmIChhY3Rpb24gPT09IFwidXBkYXRlXCIpIHtcbiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCAmJiBmaWVsZC5vblVwZGF0ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBpZiAodHlwZW9mIGZpZWxkLm9uVXBkYXRlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGZpZWxkLm9uVXBkYXRlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmllbGQub25VcGRhdGU7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBpZiAodmFsdWUgPT09IHZvaWQgMCB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgIGlmIChmaWVsZC5kZWZhdWx0VmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgaWYgKHR5cGVvZiBmaWVsZC5kZWZhdWx0VmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gZmllbGQuZGVmYXVsdFZhbHVlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmllbGQuZGVmYXVsdFZhbHVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmxldCBkZWJ1Z0xvZ3MgPSBbXTtcbmxldCB0cmFuc2FjdGlvbklkID0gLTE7XG5jb25zdCBjcmVhdGVBc0lzVHJhbnNhY3Rpb24gPSAoYWRhcHRlcikgPT4gKGZuKSA9PiBmbihhZGFwdGVyKTtcbmNvbnN0IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5ID0gKHtcbiAgYWRhcHRlcjogY3VzdG9tQWRhcHRlcixcbiAgY29uZmlnOiBjZmdcbn0pID0+IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHVuaXF1ZUFkYXB0ZXJGYWN0b3J5SW5zdGFuY2VJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxNSk7XG4gIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAuLi5jZmcsXG4gICAgc3VwcG9ydHNCb29sZWFuczogY2ZnLnN1cHBvcnRzQm9vbGVhbnMgPz8gdHJ1ZSxcbiAgICBzdXBwb3J0c0RhdGVzOiBjZmcuc3VwcG9ydHNEYXRlcyA/PyB0cnVlLFxuICAgIHN1cHBvcnRzSlNPTjogY2ZnLnN1cHBvcnRzSlNPTiA/PyBmYWxzZSxcbiAgICBhZGFwdGVyTmFtZTogY2ZnLmFkYXB0ZXJOYW1lID8/IGNmZy5hZGFwdGVySWQsXG4gICAgc3VwcG9ydHNOdW1lcmljSWRzOiBjZmcuc3VwcG9ydHNOdW1lcmljSWRzID8/IHRydWUsXG4gICAgdHJhbnNhY3Rpb246IGNmZy50cmFuc2FjdGlvbiA/PyBmYWxzZSxcbiAgICBkaXNhYmxlVHJhbnNmb3JtSW5wdXQ6IGNmZy5kaXNhYmxlVHJhbnNmb3JtSW5wdXQgPz8gZmFsc2UsXG4gICAgZGlzYWJsZVRyYW5zZm9ybU91dHB1dDogY2ZnLmRpc2FibGVUcmFuc2Zvcm1PdXRwdXQgPz8gZmFsc2VcbiAgfTtcbiAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA9PT0gdHJ1ZSAmJiBjb25maWcuc3VwcG9ydHNOdW1lcmljSWRzID09PSBmYWxzZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBbJHtjb25maWcuYWRhcHRlck5hbWV9XSBZb3VyIGRhdGFiYXNlIG9yIGRhdGFiYXNlIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCBudW1lcmljIGlkcy4gUGxlYXNlIGRpc2FibGUgXCJ1c2VOdW1iZXJJZFwiIGluIHlvdXIgY29uZmlnLmBcbiAgICApO1xuICB9XG4gIGNvbnN0IHNjaGVtYSA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGNvbnN0IGdldERlZmF1bHRGaWVsZE5hbWUgPSAoe1xuICAgIGZpZWxkLFxuICAgIG1vZGVsOiB1bnNhZmVfbW9kZWxcbiAgfSkgPT4ge1xuICAgIGlmIChmaWVsZCA9PT0gXCJpZFwiIHx8IGZpZWxkID09PSBcIl9pZFwiKSB7XG4gICAgICByZXR1cm4gXCJpZFwiO1xuICAgIH1cbiAgICBjb25zdCBtb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlX21vZGVsKTtcbiAgICBsZXQgZiA9IHNjaGVtYVttb2RlbF0/LmZpZWxkc1tmaWVsZF07XG4gICAgaWYgKCFmKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBPYmplY3QuZW50cmllcyhzY2hlbWFbbW9kZWxdLmZpZWxkcykuZmluZChcbiAgICAgICAgKFtfLCBmMl0pID0+IGYyLmZpZWxkTmFtZSA9PT0gZmllbGRcbiAgICAgICk7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGYgPSByZXN1bHRbMV07XG4gICAgICAgIGZpZWxkID0gcmVzdWx0WzBdO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWYpIHtcbiAgICAgIGRlYnVnTG9nKGBGaWVsZCAke2ZpZWxkfSBub3QgZm91bmQgaW4gbW9kZWwgJHttb2RlbH1gKTtcbiAgICAgIGRlYnVnTG9nKGBTY2hlbWE6YCwgc2NoZW1hKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmllbGQgJHtmaWVsZH0gbm90IGZvdW5kIGluIG1vZGVsICR7bW9kZWx9YCk7XG4gICAgfVxuICAgIHJldHVybiBmaWVsZDtcbiAgfTtcbiAgY29uc3QgZ2V0RGVmYXVsdE1vZGVsTmFtZSA9IChtb2RlbCkgPT4ge1xuICAgIGlmIChjb25maWcudXNlUGx1cmFsICYmIG1vZGVsLmNoYXJBdChtb2RlbC5sZW5ndGggLSAxKSA9PT0gXCJzXCIpIHtcbiAgICAgIGxldCBwbHVyYWxlc3NNb2RlbCA9IG1vZGVsLnNsaWNlKDAsIC0xKTtcbiAgICAgIGxldCBtMiA9IHNjaGVtYVtwbHVyYWxlc3NNb2RlbF0gPyBwbHVyYWxlc3NNb2RlbCA6IHZvaWQgMDtcbiAgICAgIGlmICghbTIpIHtcbiAgICAgICAgbTIgPSBPYmplY3QuZW50cmllcyhzY2hlbWEpLmZpbmQoXG4gICAgICAgICAgKFtfLCBmXSkgPT4gZi5tb2RlbE5hbWUgPT09IHBsdXJhbGVzc01vZGVsXG4gICAgICAgICk/LlswXTtcbiAgICAgIH1cbiAgICAgIGlmIChtMikge1xuICAgICAgICByZXR1cm4gbTI7XG4gICAgICB9XG4gICAgfVxuICAgIGxldCBtID0gc2NoZW1hW21vZGVsXSA/IG1vZGVsIDogdm9pZCAwO1xuICAgIGlmICghbSkge1xuICAgICAgbSA9IE9iamVjdC5lbnRyaWVzKHNjaGVtYSkuZmluZCgoW18sIGZdKSA9PiBmLm1vZGVsTmFtZSA9PT0gbW9kZWwpPy5bMF07XG4gICAgfVxuICAgIGlmICghbSkge1xuICAgICAgZGVidWdMb2coYE1vZGVsIFwiJHttb2RlbH1cIiBub3QgZm91bmQgaW4gc2NoZW1hYCk7XG4gICAgICBkZWJ1Z0xvZyhgU2NoZW1hOmAsIHNjaGVtYSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE1vZGVsIFwiJHttb2RlbH1cIiBub3QgZm91bmQgaW4gc2NoZW1hYCk7XG4gICAgfVxuICAgIHJldHVybiBtO1xuICB9O1xuICBjb25zdCBnZXRNb2RlbE5hbWUgPSAobW9kZWwpID0+IHtcbiAgICBjb25zdCBkZWZhdWx0TW9kZWxLZXkgPSBnZXREZWZhdWx0TW9kZWxOYW1lKG1vZGVsKTtcbiAgICBjb25zdCB1c2VQbHVyYWwgPSBjb25maWcgJiYgY29uZmlnLnVzZVBsdXJhbDtcbiAgICBjb25zdCB1c2VDdXN0b21Nb2RlbE5hbWUgPSBzY2hlbWEgJiYgc2NoZW1hW2RlZmF1bHRNb2RlbEtleV0gJiYgc2NoZW1hW2RlZmF1bHRNb2RlbEtleV0ubW9kZWxOYW1lICE9PSBtb2RlbDtcbiAgICBpZiAodXNlQ3VzdG9tTW9kZWxOYW1lKSB7XG4gICAgICByZXR1cm4gdXNlUGx1cmFsID8gYCR7c2NoZW1hW2RlZmF1bHRNb2RlbEtleV0ubW9kZWxOYW1lfXNgIDogc2NoZW1hW2RlZmF1bHRNb2RlbEtleV0ubW9kZWxOYW1lO1xuICAgIH1cbiAgICByZXR1cm4gdXNlUGx1cmFsID8gYCR7bW9kZWx9c2AgOiBtb2RlbDtcbiAgfTtcbiAgZnVuY3Rpb24gZ2V0RmllbGROYW1lKHtcbiAgICBtb2RlbDogbW9kZWxfbmFtZSxcbiAgICBmaWVsZDogZmllbGRfbmFtZVxuICB9KSB7XG4gICAgY29uc3QgbW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKG1vZGVsX25hbWUpO1xuICAgIGNvbnN0IGZpZWxkID0gZ2V0RGVmYXVsdEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZDogZmllbGRfbmFtZSB9KTtcbiAgICByZXR1cm4gc2NoZW1hW21vZGVsXT8uZmllbGRzW2ZpZWxkXT8uZmllbGROYW1lIHx8IGZpZWxkO1xuICB9XG4gIGNvbnN0IGRlYnVnTG9nID0gKC4uLmFyZ3MpID0+IHtcbiAgICBpZiAoY29uZmlnLmRlYnVnTG9ncyA9PT0gdHJ1ZSB8fCB0eXBlb2YgY29uZmlnLmRlYnVnTG9ncyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGVidWdMb2dzID09PSBcIm9iamVjdFwiICYmIFwiaXNSdW5uaW5nQWRhcHRlclRlc3RzXCIgaW4gY29uZmlnLmRlYnVnTG9ncykge1xuICAgICAgICBpZiAoY29uZmlnLmRlYnVnTG9ncy5pc1J1bm5pbmdBZGFwdGVyVGVzdHMpIHtcbiAgICAgICAgICBhcmdzLnNoaWZ0KCk7XG4gICAgICAgICAgZGVidWdMb2dzLnB1c2goeyBpbnN0YW5jZTogdW5pcXVlQWRhcHRlckZhY3RvcnlJbnN0YW5jZUlkLCBhcmdzIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgY29uZmlnLmRlYnVnTG9ncyA9PT0gXCJvYmplY3RcIiAmJiBjb25maWcuZGVidWdMb2dzLmxvZ0NvbmRpdGlvbiAmJiAhY29uZmlnLmRlYnVnTG9ncy5sb2dDb25kaXRpb24/LigpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gXCJvYmplY3RcIiAmJiBcIm1ldGhvZFwiIGluIGFyZ3NbMF0pIHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gYXJncy5zaGlmdCgpLm1ldGhvZDtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGVidWdMb2dzID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJjcmVhdGVcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5jcmVhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJ1cGRhdGVcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy51cGRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJ1cGRhdGVNYW55XCIgJiYgIWNvbmZpZy5kZWJ1Z0xvZ3MudXBkYXRlTWFueSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcImZpbmRPbmVcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5maW5kT25lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiZmluZE1hbnlcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5maW5kTWFueSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcImRlbGV0ZVwiICYmICFjb25maWcuZGVidWdMb2dzLmRlbGV0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcImRlbGV0ZU1hbnlcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5kZWxldGVNYW55KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiY291bnRcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5jb3VudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsb2dnZXIuaW5mbyhgWyR7Y29uZmlnLmFkYXB0ZXJOYW1lfV1gLCAuLi5hcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBbJHtjb25maWcuYWRhcHRlck5hbWV9XWAsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgaWRGaWVsZCA9ICh7XG4gICAgY3VzdG9tTW9kZWxOYW1lLFxuICAgIGZvcmNlQWxsb3dJZFxuICB9KSA9PiB7XG4gICAgY29uc3Qgc2hvdWxkR2VuZXJhdGVJZCA9ICFjb25maWcuZGlzYWJsZUlkR2VuZXJhdGlvbiAmJiAhb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkICYmICFmb3JjZUFsbG93SWQ7XG4gICAgY29uc3QgbW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKGN1c3RvbU1vZGVsTmFtZSA/PyBcImlkXCIpO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcIm51bWJlclwiIDogXCJzdHJpbmdcIixcbiAgICAgIHJlcXVpcmVkOiBzaG91bGRHZW5lcmF0ZUlkID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgLi4uc2hvdWxkR2VuZXJhdGVJZCA/IHtcbiAgICAgICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgICAgIGlmIChjb25maWcuZGlzYWJsZUlkR2VuZXJhdGlvbikgcmV0dXJuIHZvaWQgMDtcbiAgICAgICAgICBjb25zdCB1c2VOdW1iZXJJZCA9IG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZDtcbiAgICAgICAgICBsZXQgZ2VuZXJhdGVJZCQxID0gb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LmdlbmVyYXRlSWQ7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmdlbmVyYXRlSWQgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgICAgIFwiWW91ciBCZXR0ZXIgQXV0aCBjb25maWcgaW5jbHVkZXMgYWR2YW5jZWQuZ2VuZXJhdGVJZCB3aGljaCBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIGFkdmFuY2VkLmRhdGFiYXNlLmdlbmVyYXRlSWQgaW5zdGVhZC4gVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gZnV0dXJlIHJlbGVhc2VzLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZ2VuZXJhdGVJZCQxID0gb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGdlbmVyYXRlSWQkMSA9PT0gZmFsc2UgfHwgdXNlTnVtYmVySWQpIHJldHVybiB2b2lkIDA7XG4gICAgICAgICAgaWYgKGdlbmVyYXRlSWQkMSkge1xuICAgICAgICAgICAgcmV0dXJuIGdlbmVyYXRlSWQkMSh7XG4gICAgICAgICAgICAgIG1vZGVsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvbmZpZy5jdXN0b21JZEdlbmVyYXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy5jdXN0b21JZEdlbmVyYXRvcih7IG1vZGVsIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZ2VuZXJhdGVJZCgpO1xuICAgICAgICB9XG4gICAgICB9IDoge31cbiAgICB9O1xuICB9O1xuICBjb25zdCBnZXRGaWVsZEF0dHJpYnV0ZXMgPSAoe1xuICAgIG1vZGVsLFxuICAgIGZpZWxkXG4gIH0pID0+IHtcbiAgICBjb25zdCBkZWZhdWx0TW9kZWxOYW1lID0gZ2V0RGVmYXVsdE1vZGVsTmFtZShtb2RlbCk7XG4gICAgY29uc3QgZGVmYXVsdEZpZWxkTmFtZSA9IGdldERlZmF1bHRGaWVsZE5hbWUoe1xuICAgICAgZmllbGQsXG4gICAgICBtb2RlbDogZGVmYXVsdE1vZGVsTmFtZVxuICAgIH0pO1xuICAgIGNvbnN0IGZpZWxkcyA9IHNjaGVtYVtkZWZhdWx0TW9kZWxOYW1lXS5maWVsZHM7XG4gICAgZmllbGRzLmlkID0gaWRGaWVsZCh7IGN1c3RvbU1vZGVsTmFtZTogZGVmYXVsdE1vZGVsTmFtZSB9KTtcbiAgICByZXR1cm4gZmllbGRzW2RlZmF1bHRGaWVsZE5hbWVdO1xuICB9O1xuICBjb25zdCB0cmFuc2Zvcm1JbnB1dCA9IGFzeW5jIChkYXRhLCBkZWZhdWx0TW9kZWxOYW1lLCBhY3Rpb24sIGZvcmNlQWxsb3dJZCkgPT4ge1xuICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IHt9O1xuICAgIGNvbnN0IGZpZWxkcyA9IHNjaGVtYVtkZWZhdWx0TW9kZWxOYW1lXS5maWVsZHM7XG4gICAgY29uc3QgbmV3TWFwcGVkS2V5cyA9IGNvbmZpZy5tYXBLZXlzVHJhbnNmb3JtSW5wdXQgPz8ge307XG4gICAgaWYgKCFjb25maWcuZGlzYWJsZUlkR2VuZXJhdGlvbiAmJiAhb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICBmaWVsZHMuaWQgPSBpZEZpZWxkKHtcbiAgICAgICAgY3VzdG9tTW9kZWxOYW1lOiBkZWZhdWx0TW9kZWxOYW1lLFxuICAgICAgICBmb3JjZUFsbG93SWQ6IGZvcmNlQWxsb3dJZCAmJiBcImlkXCIgaW4gZGF0YVxuICAgICAgfSk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgZmllbGQgaW4gZmllbGRzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGRhdGFbZmllbGRdO1xuICAgICAgY29uc3QgZmllbGRBdHRyaWJ1dGVzID0gZmllbGRzW2ZpZWxkXTtcbiAgICAgIGxldCBuZXdGaWVsZE5hbWUgPSBuZXdNYXBwZWRLZXlzW2ZpZWxkXSB8fCBmaWVsZHNbZmllbGRdLmZpZWxkTmFtZSB8fCBmaWVsZDtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwICYmIChmaWVsZEF0dHJpYnV0ZXMuZGVmYXVsdFZhbHVlID09PSB2b2lkIDAgJiYgIWZpZWxkQXR0cmlidXRlcy50cmFuc2Zvcm0/LmlucHV0ICYmICEoYWN0aW9uID09PSBcInVwZGF0ZVwiICYmIGZpZWxkQXR0cmlidXRlcy5vblVwZGF0ZSkgfHwgYWN0aW9uID09PSBcInVwZGF0ZVwiICYmICFmaWVsZEF0dHJpYnV0ZXMub25VcGRhdGUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgbGV0IG5ld1ZhbHVlID0gd2l0aEFwcGx5RGVmYXVsdCh2YWx1ZSwgZmllbGRBdHRyaWJ1dGVzLCBhY3Rpb24pO1xuICAgICAgaWYgKGZpZWxkQXR0cmlidXRlcy50cmFuc2Zvcm0/LmlucHV0KSB7XG4gICAgICAgIG5ld1ZhbHVlID0gYXdhaXQgZmllbGRBdHRyaWJ1dGVzLnRyYW5zZm9ybS5pbnB1dChuZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGRBdHRyaWJ1dGVzLnJlZmVyZW5jZXM/LmZpZWxkID09PSBcImlkXCIgJiYgb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG5ld1ZhbHVlKSkge1xuICAgICAgICAgIG5ld1ZhbHVlID0gbmV3VmFsdWUubWFwKCh4KSA9PiB4ICE9PSBudWxsID8gTnVtYmVyKHgpIDogbnVsbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZSAhPT0gbnVsbCA/IE51bWJlcihuZXdWYWx1ZSkgOiBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zdXBwb3J0c0pTT04gPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJvYmplY3RcIiAmJiBmaWVsZEF0dHJpYnV0ZXMudHlwZSA9PT0gXCJqc29uXCIpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSk7XG4gICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zdXBwb3J0c0RhdGVzID09PSBmYWxzZSAmJiBuZXdWYWx1ZSBpbnN0YW5jZW9mIERhdGUgJiYgZmllbGRBdHRyaWJ1dGVzLnR5cGUgPT09IFwiZGF0ZVwiKSB7XG4gICAgICAgIG5ld1ZhbHVlID0gbmV3VmFsdWUudG9JU09TdHJpbmcoKTtcbiAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzQm9vbGVhbnMgPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZSA/IDEgOiAwO1xuICAgICAgfVxuICAgICAgaWYgKGNvbmZpZy5jdXN0b21UcmFuc2Zvcm1JbnB1dCkge1xuICAgICAgICBuZXdWYWx1ZSA9IGNvbmZpZy5jdXN0b21UcmFuc2Zvcm1JbnB1dCh7XG4gICAgICAgICAgZGF0YTogbmV3VmFsdWUsXG4gICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgIGZpZWxkOiBuZXdGaWVsZE5hbWUsXG4gICAgICAgICAgZmllbGRBdHRyaWJ1dGVzLFxuICAgICAgICAgIG1vZGVsOiBkZWZhdWx0TW9kZWxOYW1lLFxuICAgICAgICAgIHNjaGVtYSxcbiAgICAgICAgICBvcHRpb25zXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKG5ld1ZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgICAgdHJhbnNmb3JtZWREYXRhW25ld0ZpZWxkTmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRyYW5zZm9ybWVkRGF0YTtcbiAgfTtcbiAgY29uc3QgdHJhbnNmb3JtT3V0cHV0ID0gYXN5bmMgKGRhdGEsIHVuc2FmZV9tb2RlbCwgc2VsZWN0ID0gW10pID0+IHtcbiAgICBpZiAoIWRhdGEpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IG5ld01hcHBlZEtleXMgPSBjb25maWcubWFwS2V5c1RyYW5zZm9ybU91dHB1dCA/PyB7fTtcbiAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSB7fTtcbiAgICBjb25zdCB0YWJsZVNjaGVtYSA9IHNjaGVtYVt1bnNhZmVfbW9kZWxdLmZpZWxkcztcbiAgICBjb25zdCBpZEtleSA9IE9iamVjdC5lbnRyaWVzKG5ld01hcHBlZEtleXMpLmZpbmQoXG4gICAgICAoW18sIHZdKSA9PiB2ID09PSBcImlkXCJcbiAgICApPy5bMF07XG4gICAgdGFibGVTY2hlbWFbaWRLZXkgPz8gXCJpZFwiXSA9IHtcbiAgICAgIHR5cGU6IG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwibnVtYmVyXCIgOiBcInN0cmluZ1wiXG4gICAgfTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0YWJsZVNjaGVtYSkge1xuICAgICAgaWYgKHNlbGVjdC5sZW5ndGggJiYgIXNlbGVjdC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgZmllbGQgPSB0YWJsZVNjaGVtYVtrZXldO1xuICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsS2V5ID0gZmllbGQuZmllbGROYW1lIHx8IGtleTtcbiAgICAgICAgbGV0IG5ld1ZhbHVlID0gZGF0YVtPYmplY3QuZW50cmllcyhuZXdNYXBwZWRLZXlzKS5maW5kKFxuICAgICAgICAgIChbXywgdl0pID0+IHYgPT09IG9yaWdpbmFsS2V5XG4gICAgICAgICk/LlswXSB8fCBvcmlnaW5hbEtleV07XG4gICAgICAgIGlmIChmaWVsZC50cmFuc2Zvcm0/Lm91dHB1dCkge1xuICAgICAgICAgIG5ld1ZhbHVlID0gYXdhaXQgZmllbGQudHJhbnNmb3JtLm91dHB1dChuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG5ld0ZpZWxkTmFtZSA9IG5ld01hcHBlZEtleXNba2V5XSB8fCBrZXk7XG4gICAgICAgIGlmIChvcmlnaW5hbEtleSA9PT0gXCJpZFwiIHx8IGZpZWxkLnJlZmVyZW5jZXM/LmZpZWxkID09PSBcImlkXCIpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlICE9PSBcInVuZGVmaW5lZFwiICYmIG5ld1ZhbHVlICE9PSBudWxsKVxuICAgICAgICAgICAgbmV3VmFsdWUgPSBTdHJpbmcobmV3VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zdXBwb3J0c0pTT04gPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBmaWVsZC50eXBlID09PSBcImpzb25cIikge1xuICAgICAgICAgIG5ld1ZhbHVlID0gc2FmZUpTT05QYXJzZShuZXdWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzRGF0ZXMgPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBmaWVsZC50eXBlID09PSBcImRhdGVcIikge1xuICAgICAgICAgIG5ld1ZhbHVlID0gbmV3IERhdGUobmV3VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zdXBwb3J0c0Jvb2xlYW5zID09PSBmYWxzZSAmJiB0eXBlb2YgbmV3VmFsdWUgPT09IFwibnVtYmVyXCIgJiYgZmllbGQudHlwZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlID09PSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb25maWcuY3VzdG9tVHJhbnNmb3JtT3V0cHV0KSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBjb25maWcuY3VzdG9tVHJhbnNmb3JtT3V0cHV0KHtcbiAgICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlLFxuICAgICAgICAgICAgZmllbGQ6IG5ld0ZpZWxkTmFtZSxcbiAgICAgICAgICAgIGZpZWxkQXR0cmlidXRlczogZmllbGQsXG4gICAgICAgICAgICBzZWxlY3QsXG4gICAgICAgICAgICBtb2RlbDogdW5zYWZlX21vZGVsLFxuICAgICAgICAgICAgc2NoZW1hLFxuICAgICAgICAgICAgb3B0aW9uc1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zZm9ybWVkRGF0YVtuZXdGaWVsZE5hbWVdID0gbmV3VmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gIH07XG4gIGNvbnN0IHRyYW5zZm9ybVdoZXJlQ2xhdXNlID0gKHtcbiAgICBtb2RlbCxcbiAgICB3aGVyZVxuICB9KSA9PiB7XG4gICAgaWYgKCF3aGVyZSkgcmV0dXJuIHZvaWQgMDtcbiAgICBjb25zdCBuZXdNYXBwZWRLZXlzID0gY29uZmlnLm1hcEtleXNUcmFuc2Zvcm1JbnB1dCA/PyB7fTtcbiAgICByZXR1cm4gd2hlcmUubWFwKCh3KSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGZpZWxkOiB1bnNhZmVfZmllbGQsXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBvcGVyYXRvciA9IFwiZXFcIixcbiAgICAgICAgY29ubmVjdG9yID0gXCJBTkRcIlxuICAgICAgfSA9IHc7XG4gICAgICBpZiAob3BlcmF0b3IgPT09IFwiaW5cIikge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgbXVzdCBiZSBhbiBhcnJheVwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgZGVmYXVsdE1vZGVsTmFtZSA9IGdldERlZmF1bHRNb2RlbE5hbWUobW9kZWwpO1xuICAgICAgY29uc3QgZGVmYXVsdEZpZWxkTmFtZSA9IGdldERlZmF1bHRGaWVsZE5hbWUoe1xuICAgICAgICBmaWVsZDogdW5zYWZlX2ZpZWxkLFxuICAgICAgICBtb2RlbFxuICAgICAgfSk7XG4gICAgICBjb25zdCBmaWVsZE5hbWUgPSBuZXdNYXBwZWRLZXlzW2RlZmF1bHRGaWVsZE5hbWVdIHx8IGdldEZpZWxkTmFtZSh7XG4gICAgICAgIGZpZWxkOiBkZWZhdWx0RmllbGROYW1lLFxuICAgICAgICBtb2RlbDogZGVmYXVsdE1vZGVsTmFtZVxuICAgICAgfSk7XG4gICAgICBjb25zdCBmaWVsZEF0dHIgPSBnZXRGaWVsZEF0dHJpYnV0ZXMoe1xuICAgICAgICBmaWVsZDogZGVmYXVsdEZpZWxkTmFtZSxcbiAgICAgICAgbW9kZWw6IGRlZmF1bHRNb2RlbE5hbWVcbiAgICAgIH0pO1xuICAgICAgaWYgKGRlZmF1bHRGaWVsZE5hbWUgPT09IFwiaWRcIiB8fCBmaWVsZEF0dHIucmVmZXJlbmNlcz8uZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBvcGVyYXRvcixcbiAgICAgICAgICAgICAgY29ubmVjdG9yLFxuICAgICAgICAgICAgICBmaWVsZDogZmllbGROYW1lLFxuICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUubWFwKE51bWJlcilcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvcGVyYXRvcixcbiAgICAgICAgICAgIGNvbm5lY3RvcixcbiAgICAgICAgICAgIGZpZWxkOiBmaWVsZE5hbWUsXG4gICAgICAgICAgICB2YWx1ZTogTnVtYmVyKHZhbHVlKVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9wZXJhdG9yLFxuICAgICAgICBjb25uZWN0b3IsXG4gICAgICAgIGZpZWxkOiBmaWVsZE5hbWUsXG4gICAgICAgIHZhbHVlXG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xuICBjb25zdCBhZGFwdGVySW5zdGFuY2UgPSBjdXN0b21BZGFwdGVyKHtcbiAgICBvcHRpb25zLFxuICAgIHNjaGVtYSxcbiAgICBkZWJ1Z0xvZyxcbiAgICBnZXRGaWVsZE5hbWUsXG4gICAgZ2V0TW9kZWxOYW1lLFxuICAgIGdldERlZmF1bHRNb2RlbE5hbWUsXG4gICAgZ2V0RGVmYXVsdEZpZWxkTmFtZSxcbiAgICBnZXRGaWVsZEF0dHJpYnV0ZXMsXG4gICAgdHJhbnNmb3JtSW5wdXQsXG4gICAgdHJhbnNmb3JtT3V0cHV0LFxuICAgIHRyYW5zZm9ybVdoZXJlQ2xhdXNlXG4gIH0pO1xuICBsZXQgbGF6eUxvYWRUcmFuc2FjdGlvbiA9IG51bGw7XG4gIGNvbnN0IGFkYXB0ZXIgPSB7XG4gICAgdHJhbnNhY3Rpb246IGFzeW5jIChjYikgPT4ge1xuICAgICAgaWYgKCFsYXp5TG9hZFRyYW5zYWN0aW9uKSB7XG4gICAgICAgIGlmICghY29uZmlnLnRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGVidWdMb2dzID09PSBcIm9iamVjdFwiICYmIFwiaXNSdW5uaW5nQWRhcHRlclRlc3RzXCIgaW4gY29uZmlnLmRlYnVnTG9ncyAmJiBjb25maWcuZGVidWdMb2dzLmlzUnVubmluZ0FkYXB0ZXJUZXN0cykgOyBlbHNlIHtcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKFxuICAgICAgICAgICAgICBgWyR7Y29uZmlnLmFkYXB0ZXJOYW1lfV0gLSBUcmFuc2FjdGlvbnMgYXJlIG5vdCBzdXBwb3J0ZWQuIEV4ZWN1dGluZyBvcGVyYXRpb25zIHNlcXVlbnRpYWxseS5gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsYXp5TG9hZFRyYW5zYWN0aW9uID0gY3JlYXRlQXNJc1RyYW5zYWN0aW9uKGFkYXB0ZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgICAgIGBbJHtjb25maWcuYWRhcHRlck5hbWV9XSAtIFVzaW5nIHByb3ZpZGVkIHRyYW5zYWN0aW9uIGltcGxlbWVudGF0aW9uLmBcbiAgICAgICAgICApO1xuICAgICAgICAgIGxhenlMb2FkVHJhbnNhY3Rpb24gPSBjb25maWcudHJhbnNhY3Rpb247XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBsYXp5TG9hZFRyYW5zYWN0aW9uKGNiKTtcbiAgICB9LFxuICAgIGNyZWF0ZTogYXN5bmMgKHtcbiAgICAgIGRhdGE6IHVuc2FmZURhdGEsXG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICBzZWxlY3QsXG4gICAgICBmb3JjZUFsbG93SWQgPSBmYWxzZVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICB1bnNhZmVNb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgaWYgKFwiaWRcIiBpbiB1bnNhZmVEYXRhICYmICFmb3JjZUFsbG93SWQpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgYFske2NvbmZpZy5hZGFwdGVyTmFtZX1dIC0gWW91IGFyZSB0cnlpbmcgdG8gY3JlYXRlIGEgcmVjb3JkIHdpdGggYW4gaWQuIFRoaXMgaXMgbm90IGFsbG93ZWQgYXMgd2UgaGFuZGxlIGlkIGdlbmVyYXRpb24gZm9yIHlvdSwgdW5sZXNzIHlvdSBwYXNzIGluIHRoZSBcXGBmb3JjZUFsbG93SWRcXGAgcGFyYW1ldGVyLiBUaGUgaWQgd2lsbCBiZSBpZ25vcmVkLmBcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKCk7XG4gICAgICAgIGNvbnN0IHN0YWNrID0gZXJyLnN0YWNrPy5zcGxpdChcIlxcblwiKS5maWx0ZXIoKF8sIGkpID0+IGkgIT09IDEpLmpvaW4oXCJcXG5cIikucmVwbGFjZShcIkVycm9yOlwiLCBcIkNyZWF0ZSBtZXRob2Qgd2l0aCBgaWRgIGJlaW5nIGNhbGxlZCBhdDpcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHN0YWNrKTtcbiAgICAgICAgdW5zYWZlRGF0YS5pZCA9IHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJjcmVhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImNyZWF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJVbnNhZmUgSW5wdXRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHVuc2FmZURhdGEgfVxuICAgICAgKTtcbiAgICAgIGxldCBkYXRhID0gdW5zYWZlRGF0YTtcbiAgICAgIGlmICghY29uZmlnLmRpc2FibGVUcmFuc2Zvcm1JbnB1dCkge1xuICAgICAgICBkYXRhID0gYXdhaXQgdHJhbnNmb3JtSW5wdXQoXG4gICAgICAgICAgdW5zYWZlRGF0YSxcbiAgICAgICAgICB1bnNhZmVNb2RlbCxcbiAgICAgICAgICBcImNyZWF0ZVwiLFxuICAgICAgICAgIGZvcmNlQWxsb3dJZFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YSB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmNyZWF0ZSh7IGRhdGEsIG1vZGVsIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgcmVzIH1cbiAgICAgICk7XG4gICAgICBsZXQgdHJhbnNmb3JtZWQgPSByZXM7XG4gICAgICBpZiAoIWNvbmZpZy5kaXNhYmxlVHJhbnNmb3JtT3V0cHV0KSB7XG4gICAgICAgIHRyYW5zZm9ybWVkID0gYXdhaXQgdHJhbnNmb3JtT3V0cHV0KHJlcywgdW5zYWZlTW9kZWwsIHNlbGVjdCk7XG4gICAgICB9XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiY3JlYXRlXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCg0LCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJjcmVhdGVcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdHJhbnNmb3JtZWQgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcbiAgICB9LFxuICAgIHVwZGF0ZTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZSxcbiAgICAgIHVwZGF0ZTogdW5zYWZlRGF0YVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICB1bnNhZmVNb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJVbnNhZmUgSW5wdXRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHVuc2FmZURhdGEgfVxuICAgICAgKTtcbiAgICAgIGxldCBkYXRhID0gdW5zYWZlRGF0YTtcbiAgICAgIGlmICghY29uZmlnLmRpc2FibGVUcmFuc2Zvcm1JbnB1dCkge1xuICAgICAgICBkYXRhID0gYXdhaXQgdHJhbnNmb3JtSW5wdXQodW5zYWZlRGF0YSwgdW5zYWZlTW9kZWwsIFwidXBkYXRlXCIpO1xuICAgICAgfVxuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YSB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLnVwZGF0ZSh7XG4gICAgICAgIG1vZGVsLFxuICAgICAgICB3aGVyZSxcbiAgICAgICAgdXBkYXRlOiBkYXRhXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDMsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHJlcyB9XG4gICAgICApO1xuICAgICAgbGV0IHRyYW5zZm9ybWVkID0gcmVzO1xuICAgICAgaWYgKCFjb25maWcuZGlzYWJsZVRyYW5zZm9ybU91dHB1dCkge1xuICAgICAgICB0cmFuc2Zvcm1lZCA9IGF3YWl0IHRyYW5zZm9ybU91dHB1dChyZXMsIHVuc2FmZU1vZGVsKTtcbiAgICAgIH1cbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDQsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJQYXJzZWQgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB0cmFuc2Zvcm1lZCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkO1xuICAgIH0sXG4gICAgdXBkYXRlTWFueTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZSxcbiAgICAgIHVwZGF0ZTogdW5zYWZlRGF0YVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgdW5zYWZlTW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJ1cGRhdGVNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIlVuc2FmZSBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdW5zYWZlRGF0YSB9XG4gICAgICApO1xuICAgICAgbGV0IGRhdGEgPSB1bnNhZmVEYXRhO1xuICAgICAgaWYgKCFjb25maWcuZGlzYWJsZVRyYW5zZm9ybUlucHV0KSB7XG4gICAgICAgIGRhdGEgPSBhd2FpdCB0cmFuc2Zvcm1JbnB1dCh1bnNhZmVEYXRhLCB1bnNhZmVNb2RlbCwgXCJ1cGRhdGVcIik7XG4gICAgICB9XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwidXBkYXRlTWFueVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJQYXJzZWQgSW5wdXRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGEgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRDb3VudCA9IGF3YWl0IGFkYXB0ZXJJbnN0YW5jZS51cGRhdGVNYW55KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlLFxuICAgICAgICB1cGRhdGU6IGRhdGFcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDMsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiREIgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB1cGRhdGVkQ291bnQgfVxuICAgICAgKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCg0LCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJ1cGRhdGVNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHVwZGF0ZWRDb3VudCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHVwZGF0ZWRDb3VudDtcbiAgICB9LFxuICAgIGZpbmRPbmU6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmUsXG4gICAgICBzZWxlY3RcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIHVuc2FmZU1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE9uZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgMyl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZmluZE9uZVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUsIHNlbGVjdCB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIHNlbGVjdFxuICAgICAgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE9uZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMyl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZmluZE9uZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHJlcyB9XG4gICAgICApO1xuICAgICAgbGV0IHRyYW5zZm9ybWVkID0gcmVzO1xuICAgICAgaWYgKCFjb25maWcuZGlzYWJsZVRyYW5zZm9ybU91dHB1dCkge1xuICAgICAgICB0cmFuc2Zvcm1lZCA9IGF3YWl0IHRyYW5zZm9ybU91dHB1dChyZXMsIHVuc2FmZU1vZGVsLCBzZWxlY3QpO1xuICAgICAgfVxuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImZpbmRPbmVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDMsIDMpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImZpbmRPbmVcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdHJhbnNmb3JtZWQgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcbiAgICB9LFxuICAgIGZpbmRNYW55OiBhc3luYyAoe1xuICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlLFxuICAgICAgbGltaXQ6IHVuc2FmZUxpbWl0LFxuICAgICAgc29ydEJ5LFxuICAgICAgb2Zmc2V0XG4gICAgfSkgPT4ge1xuICAgICAgdHJhbnNhY3Rpb25JZCsrO1xuICAgICAgbGV0IHRoaXNUcmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25JZDtcbiAgICAgIGNvbnN0IGxpbWl0ID0gdW5zYWZlTGltaXQgPz8gb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LmRlZmF1bHRGaW5kTWFueUxpbWl0ID8/IDEwMDtcbiAgICAgIGNvbnN0IG1vZGVsID0gZ2V0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGNvbnN0IHdoZXJlID0gdHJhbnNmb3JtV2hlcmVDbGF1c2Uoe1xuICAgICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgICAgfSk7XG4gICAgICB1bnNhZmVNb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImZpbmRNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kTWFueVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUsIGxpbWl0LCBzb3J0QnksIG9mZnNldCB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgc29ydEJ5LFxuICAgICAgICBvZmZzZXRcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImZpbmRNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHJlcyB9XG4gICAgICApO1xuICAgICAgbGV0IHRyYW5zZm9ybWVkID0gcmVzO1xuICAgICAgaWYgKCFjb25maWcuZGlzYWJsZVRyYW5zZm9ybU91dHB1dCkge1xuICAgICAgICB0cmFuc2Zvcm1lZCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgIHJlcy5tYXAoYXN5bmMgKHIpID0+IGF3YWl0IHRyYW5zZm9ybU91dHB1dChyLCB1bnNhZmVNb2RlbCkpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDMsIDMpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImZpbmRNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHRyYW5zZm9ybWVkIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG4gICAgfSxcbiAgICBkZWxldGU6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIHVuc2FmZU1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZGVsZXRlXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCAyKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJkZWxldGVcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIHdoZXJlIH1cbiAgICAgICk7XG4gICAgICBhd2FpdCBhZGFwdGVySW5zdGFuY2UuZGVsZXRlKHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJkZWxldGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDIsIDIpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImRlbGV0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwgfVxuICAgICAgKTtcbiAgICB9LFxuICAgIGRlbGV0ZU1hbnk6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIHVuc2FmZU1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZGVsZXRlTWFueVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZGVsZXRlTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEZWxldGVNYW55XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCB3aGVyZSB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmRlbGV0ZU1hbnkoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImRlbGV0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDIsIDIpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImRlbGV0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiREIgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiByZXMgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBjb3VudDogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgdW5zYWZlTW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJjb3VudFwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY291bnRcIil9OmAsXG4gICAgICAgIHtcbiAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICB3aGVyZVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmNvdW50KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJjb3VudFwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY291bnRcIil9OmAsXG4gICAgICAgIHtcbiAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICBkYXRhOiByZXNcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBjcmVhdGVTY2hlbWE6IGFkYXB0ZXJJbnN0YW5jZS5jcmVhdGVTY2hlbWEgPyBhc3luYyAoXywgZmlsZSkgPT4ge1xuICAgICAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgICAgIGlmIChvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2UgJiYgIW9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICBkZWxldGUgdGFibGVzLnNlc3Npb247XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5yYXRlTGltaXQgJiYgb3B0aW9ucy5yYXRlTGltaXQuc3RvcmFnZSA9PT0gXCJkYXRhYmFzZVwiICYmIC8vIHJhdGUtbGltaXQgd2lsbCBkZWZhdWx0IHRvIGVuYWJsZWQgaW4gcHJvZHVjdGlvbixcbiAgICAgIC8vIGFuZCBnaXZlbiBzdG9yYWdlIGlzIGRhdGFiYXNlLCBpdCB3aWxsIHRyeSB0byB1c2UgdGhlIHJhdGUtbGltaXQgdGFibGUsXG4gICAgICAvLyBzbyB3ZSBzaG91bGQgbWFrZSBzdXJlIHRvIGdlbmVyYXRlIHJhdGUtbGltaXQgdGFibGUgc2NoZW1hXG4gICAgICAodHlwZW9mIG9wdGlvbnMucmF0ZUxpbWl0LmVuYWJsZWQgPT09IFwidW5kZWZpbmVkXCIgfHwgLy8gYW5kIG9mIGNvdXJzZSBpZiB0aGV5IGZvcmNlZnVsbHkgc2V0IHRvIHRydWUsIHRoZW4gdGhleSB3YW50IHJhdGUtbGltaXQsXG4gICAgICAvLyB0aHVzIHdlIHNob3VsZCBhbHNvIGdlbmVyYXRlIHJhdGUtbGltaXQgdGFibGUgc2NoZW1hXG4gICAgICBvcHRpb25zLnJhdGVMaW1pdC5lbmFibGVkID09PSB0cnVlKSkge1xuICAgICAgICB0YWJsZXMucmF0ZWxpbWl0ID0ge1xuICAgICAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQubW9kZWxOYW1lID8/IFwicmF0ZWxpbWl0XCIsXG4gICAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICBrZXk6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdC5maWVsZHM/LmtleSA/PyBcImtleVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY291bnQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQuZmllbGRzPy5jb3VudCA/PyBcImNvdW50XCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsYXN0UmVxdWVzdDoge1xuICAgICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgYmlnaW50OiB0cnVlLFxuICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IERhdGUubm93KCksXG4gICAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQuZmllbGRzPy5sYXN0UmVxdWVzdCA/PyBcImxhc3RSZXF1ZXN0XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gYWRhcHRlckluc3RhbmNlLmNyZWF0ZVNjaGVtYSh7IGZpbGUsIHRhYmxlcyB9KTtcbiAgICB9IDogdm9pZCAwLFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIGFkYXB0ZXJDb25maWc6IGNvbmZpZyxcbiAgICAgIC4uLmFkYXB0ZXJJbnN0YW5jZS5vcHRpb25zID8/IHt9XG4gICAgfSxcbiAgICBpZDogY29uZmlnLmFkYXB0ZXJJZCxcbiAgICAvLyBTZWNyZXRseSBleHBvcnQgdmFsdWVzIE9OTFkgaWYgdGhpcyBhZGFwdGVyIGhhcyBlbmFibGVkIGFkYXB0ZXItdGVzdC1kZWJ1Zy1sb2dzLlxuICAgIC8vIFRoaXMgd291bGQgdGhlbiBiZSB1c2VkIGR1cmluZyBvdXIgYWRhcHRlci10ZXN0cyB0byBoZWxwIHByaW50IGRlYnVnIGxvZ3MgaWYgYSB0ZXN0IGZhaWxzLlxuICAgIC8vQHRzLWV4cGVjdC1lcnJvciAtIF5eXG4gICAgLi4uY29uZmlnLmRlYnVnTG9ncz8uaXNSdW5uaW5nQWRhcHRlclRlc3RzID8ge1xuICAgICAgYWRhcHRlclRlc3REZWJ1Z0xvZ3M6IHtcbiAgICAgICAgcmVzZXREZWJ1Z0xvZ3MoKSB7XG4gICAgICAgICAgZGVidWdMb2dzID0gZGVidWdMb2dzLmZpbHRlcihcbiAgICAgICAgICAgIChsb2cpID0+IGxvZy5pbnN0YW5jZSAhPT0gdW5pcXVlQWRhcHRlckZhY3RvcnlJbnN0YW5jZUlkXG4gICAgICAgICAgKTtcbiAgICAgICAgfSxcbiAgICAgICAgcHJpbnREZWJ1Z0xvZ3MoKSB7XG4gICAgICAgICAgY29uc3Qgc2VwYXJhdG9yID0gYFxcdTI1MDBgLnJlcGVhdCg4MCk7XG4gICAgICAgICAgY29uc3QgbG9ncyA9IGRlYnVnTG9ncy5maWx0ZXIoXG4gICAgICAgICAgICAobG9nMikgPT4gbG9nMi5pbnN0YW5jZSA9PT0gdW5pcXVlQWRhcHRlckZhY3RvcnlJbnN0YW5jZUlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAobG9ncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IGxvZyA9IGxvZ3MucmV2ZXJzZSgpLm1hcCgobG9nMikgPT4ge1xuICAgICAgICAgICAgbG9nMi5hcmdzWzBdID0gYFxuJHtsb2cyLmFyZ3NbMF19YDtcbiAgICAgICAgICAgIHJldHVybiBbLi4ubG9nMi5hcmdzLCBcIlxcblwiXTtcbiAgICAgICAgICB9KS5yZWR1Y2UoXG4gICAgICAgICAgICAocHJldiwgY3VycikgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gWy4uLmN1cnIsIC4uLnByZXZdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtgXG4ke3NlcGFyYXRvcn1gXVxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc29sZS5sb2coLi4ubG9nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gOiB7fVxuICB9O1xuICByZXR1cm4gYWRhcHRlcjtcbn07XG5mdW5jdGlvbiBmb3JtYXRUcmFuc2FjdGlvbklkKHRyYW5zYWN0aW9uSWQyKSB7XG4gIGlmIChnZXRDb2xvckRlcHRoKCkgPCA4KSB7XG4gICAgcmV0dXJuIGAjJHt0cmFuc2FjdGlvbklkMn1gO1xuICB9XG4gIHJldHVybiBgJHtUVFlfQ09MT1JTLmZnLm1hZ2VudGF9IyR7dHJhbnNhY3Rpb25JZDJ9JHtUVFlfQ09MT1JTLnJlc2V0fWA7XG59XG5mdW5jdGlvbiBmb3JtYXRTdGVwKHN0ZXAsIHRvdGFsKSB7XG4gIHJldHVybiBgJHtUVFlfQ09MT1JTLmJnLmJsYWNrfSR7VFRZX0NPTE9SUy5mZy55ZWxsb3d9WyR7c3RlcH0vJHt0b3RhbH1dJHtUVFlfQ09MT1JTLnJlc2V0fWA7XG59XG5mdW5jdGlvbiBmb3JtYXRNZXRob2QobWV0aG9kKSB7XG4gIHJldHVybiBgJHtUVFlfQ09MT1JTLmJyaWdodH0ke21ldGhvZH0ke1RUWV9DT0xPUlMucmVzZXR9YDtcbn1cbmZ1bmN0aW9uIGZvcm1hdEFjdGlvbihhY3Rpb24pIHtcbiAgcmV0dXJuIGAke1RUWV9DT0xPUlMuZGltfSgke2FjdGlvbn0pJHtUVFlfQ09MT1JTLnJlc2V0fWA7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZUFkYXB0ZXJGYWN0b3J5IGFzIGMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.EBxKeVNZ.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   p: () => (/* binding */ parseSetCookieHeader),\n/* harmony export */   s: () => (/* binding */ setCookieToHeader)\n/* harmony export */ });\nfunction parseSetCookieHeader(setCookie) {\n  const cookies = /* @__PURE__ */ new Map();\n  const cookieArray = setCookie.split(\", \");\n  cookieArray.forEach((cookieString) => {\n    const parts = cookieString.split(\";\").map((part) => part.trim());\n    const [nameValue, ...attributes] = parts;\n    const [name, ...valueParts] = (nameValue || \"\").split(\"=\");\n    const value = valueParts.join(\"=\");\n    if (!name || value === void 0) {\n      return;\n    }\n    const attrObj = { value };\n    attributes.forEach((attribute) => {\n      const [attrName, ...attrValueParts] = attribute.split(\"=\");\n      const attrValue = attrValueParts.join(\"=\");\n      const normalizedAttrName = attrName.trim().toLowerCase();\n      switch (normalizedAttrName) {\n        case \"max-age\":\n          attrObj[\"max-age\"] = attrValue ? parseInt(attrValue.trim(), 10) : void 0;\n          break;\n        case \"expires\":\n          attrObj.expires = attrValue ? new Date(attrValue.trim()) : void 0;\n          break;\n        case \"domain\":\n          attrObj.domain = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"path\":\n          attrObj.path = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"secure\":\n          attrObj.secure = true;\n          break;\n        case \"httponly\":\n          attrObj.httponly = true;\n          break;\n        case \"samesite\":\n          attrObj.samesite = attrValue ? attrValue.trim().toLowerCase() : void 0;\n          break;\n        default:\n          attrObj[normalizedAttrName] = attrValue ? attrValue.trim() : true;\n          break;\n      }\n    });\n    cookies.set(name, attrObj);\n  });\n  return cookies;\n}\nfunction setCookieToHeader(headers) {\n  return (context) => {\n    const setCookieHeader = context.response.headers.get(\"set-cookie\");\n    if (!setCookieHeader) {\n      return;\n    }\n    const cookieMap = /* @__PURE__ */ new Map();\n    const existingCookiesHeader = headers.get(\"cookie\") || \"\";\n    existingCookiesHeader.split(\";\").forEach((cookie) => {\n      const [name, ...rest] = cookie.trim().split(\"=\");\n      if (name && rest.length > 0) {\n        cookieMap.set(name, rest.join(\"=\"));\n      }\n    });\n    const setCookieHeaders = setCookieHeader.split(\",\");\n    setCookieHeaders.forEach((header) => {\n      const cookies = parseSetCookieHeader(header);\n      cookies.forEach((value, name) => {\n        cookieMap.set(name, value.value);\n      });\n    });\n    const updatedCookies = Array.from(cookieMap.entries()).map(([name, value]) => `${name}=${value}`).join(\"; \");\n    headers.set(\"cookie\", updatedCookies);\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5JaDhDNzZWby5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLHFGQUFxRixLQUFLLEdBQUcsTUFBTSxXQUFXO0FBQzlHO0FBQ0E7QUFDQTs7QUFFNkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLkloOEM3NlZvLm1qcz8yNDRjIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHBhcnNlU2V0Q29va2llSGVhZGVyKHNldENvb2tpZSkge1xuICBjb25zdCBjb29raWVzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgY29uc3QgY29va2llQXJyYXkgPSBzZXRDb29raWUuc3BsaXQoXCIsIFwiKTtcbiAgY29va2llQXJyYXkuZm9yRWFjaCgoY29va2llU3RyaW5nKSA9PiB7XG4gICAgY29uc3QgcGFydHMgPSBjb29raWVTdHJpbmcuc3BsaXQoXCI7XCIpLm1hcCgocGFydCkgPT4gcGFydC50cmltKCkpO1xuICAgIGNvbnN0IFtuYW1lVmFsdWUsIC4uLmF0dHJpYnV0ZXNdID0gcGFydHM7XG4gICAgY29uc3QgW25hbWUsIC4uLnZhbHVlUGFydHNdID0gKG5hbWVWYWx1ZSB8fCBcIlwiKS5zcGxpdChcIj1cIik7XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZVBhcnRzLmpvaW4oXCI9XCIpO1xuICAgIGlmICghbmFtZSB8fCB2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGF0dHJPYmogPSB7IHZhbHVlIH07XG4gICAgYXR0cmlidXRlcy5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICAgIGNvbnN0IFthdHRyTmFtZSwgLi4uYXR0clZhbHVlUGFydHNdID0gYXR0cmlidXRlLnNwbGl0KFwiPVwiKTtcbiAgICAgIGNvbnN0IGF0dHJWYWx1ZSA9IGF0dHJWYWx1ZVBhcnRzLmpvaW4oXCI9XCIpO1xuICAgICAgY29uc3Qgbm9ybWFsaXplZEF0dHJOYW1lID0gYXR0ck5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBzd2l0Y2ggKG5vcm1hbGl6ZWRBdHRyTmFtZSkge1xuICAgICAgICBjYXNlIFwibWF4LWFnZVwiOlxuICAgICAgICAgIGF0dHJPYmpbXCJtYXgtYWdlXCJdID0gYXR0clZhbHVlID8gcGFyc2VJbnQoYXR0clZhbHVlLnRyaW0oKSwgMTApIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZXhwaXJlc1wiOlxuICAgICAgICAgIGF0dHJPYmouZXhwaXJlcyA9IGF0dHJWYWx1ZSA/IG5ldyBEYXRlKGF0dHJWYWx1ZS50cmltKCkpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZG9tYWluXCI6XG4gICAgICAgICAgYXR0ck9iai5kb21haW4gPSBhdHRyVmFsdWUgPyBhdHRyVmFsdWUudHJpbSgpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwicGF0aFwiOlxuICAgICAgICAgIGF0dHJPYmoucGF0aCA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzZWN1cmVcIjpcbiAgICAgICAgICBhdHRyT2JqLnNlY3VyZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJodHRwb25seVwiOlxuICAgICAgICAgIGF0dHJPYmouaHR0cG9ubHkgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic2FtZXNpdGVcIjpcbiAgICAgICAgICBhdHRyT2JqLnNhbWVzaXRlID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGF0dHJPYmpbbm9ybWFsaXplZEF0dHJOYW1lXSA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkgOiB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvb2tpZXMuc2V0KG5hbWUsIGF0dHJPYmopO1xuICB9KTtcbiAgcmV0dXJuIGNvb2tpZXM7XG59XG5mdW5jdGlvbiBzZXRDb29raWVUb0hlYWRlcihoZWFkZXJzKSB7XG4gIHJldHVybiAoY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IHNldENvb2tpZUhlYWRlciA9IGNvbnRleHQucmVzcG9uc2UuaGVhZGVycy5nZXQoXCJzZXQtY29va2llXCIpO1xuICAgIGlmICghc2V0Q29va2llSGVhZGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGNvb2tpZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gICAgY29uc3QgZXhpc3RpbmdDb29raWVzSGVhZGVyID0gaGVhZGVycy5nZXQoXCJjb29raWVcIikgfHwgXCJcIjtcbiAgICBleGlzdGluZ0Nvb2tpZXNIZWFkZXIuc3BsaXQoXCI7XCIpLmZvckVhY2goKGNvb2tpZSkgPT4ge1xuICAgICAgY29uc3QgW25hbWUsIC4uLnJlc3RdID0gY29va2llLnRyaW0oKS5zcGxpdChcIj1cIik7XG4gICAgICBpZiAobmFtZSAmJiByZXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29va2llTWFwLnNldChuYW1lLCByZXN0LmpvaW4oXCI9XCIpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCBzZXRDb29raWVIZWFkZXJzID0gc2V0Q29va2llSGVhZGVyLnNwbGl0KFwiLFwiKTtcbiAgICBzZXRDb29raWVIZWFkZXJzLmZvckVhY2goKGhlYWRlcikgPT4ge1xuICAgICAgY29uc3QgY29va2llcyA9IHBhcnNlU2V0Q29va2llSGVhZGVyKGhlYWRlcik7XG4gICAgICBjb29raWVzLmZvckVhY2goKHZhbHVlLCBuYW1lKSA9PiB7XG4gICAgICAgIGNvb2tpZU1hcC5zZXQobmFtZSwgdmFsdWUudmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY29uc3QgdXBkYXRlZENvb2tpZXMgPSBBcnJheS5mcm9tKGNvb2tpZU1hcC5lbnRyaWVzKCkpLm1hcCgoW25hbWUsIHZhbHVlXSkgPT4gYCR7bmFtZX09JHt2YWx1ZX1gKS5qb2luKFwiOyBcIik7XG4gICAgaGVhZGVycy5zZXQoXCJjb29raWVcIiwgdXBkYXRlZENvb2tpZXMpO1xuICB9O1xufVxuXG5leHBvcnQgeyBwYXJzZVNldENvb2tpZUhlYWRlciBhcyBwLCBzZXRDb29raWVUb0hlYWRlciBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.Ih8C76Vo.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ checkPassword),\n/* harmony export */   v: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js\");\n\n\nasync function validatePassword(ctx, data) {\n  const accounts = await ctx.context.internalAdapter.findAccounts(data.userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword) {\n    return false;\n  }\n  const compare = await ctx.context.password.verify({\n    hash: currentPassword,\n    password: data.password\n  });\n  return compare;\n}\nasync function checkPassword(userId, c) {\n  const accounts = await c.context.internalAdapter.findAccounts(userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword || !c.body.password) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"No password credential found\"\n    });\n  }\n  const compare = await c.context.password.verify({\n    hash: currentPassword,\n    password: c.body.password\n  });\n  if (!compare) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid password\"\n    });\n  }\n  return true;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5Zd0RRaG9QYy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXVDOztBQUV2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpREFBUTtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGNBQWMsaURBQVE7QUFDdEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVxRCIsInNvdXJjZXMiOlsid2VicGFjazovL25ld3MtaHViLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMy4zNF9uZXh0QDE0Ll83MDdkMjFiYzdhMDFlYjAyNWIxNTU0Yjg5ZWRiYzYyMS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzPzM3NDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUGFzc3dvcmQoY3R4LCBkYXRhKSB7XG4gIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhkYXRhLnVzZXJJZCk7XG4gIGNvbnN0IGNyZWRlbnRpYWxBY2NvdW50ID0gYWNjb3VudHM/LmZpbmQoXG4gICAgKGFjY291bnQpID0+IGFjY291bnQucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCJcbiAgKTtcbiAgY29uc3QgY3VycmVudFBhc3N3b3JkID0gY3JlZGVudGlhbEFjY291bnQ/LnBhc3N3b3JkO1xuICBpZiAoIWNyZWRlbnRpYWxBY2NvdW50IHx8ICFjdXJyZW50UGFzc3dvcmQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29uc3QgY29tcGFyZSA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgIHBhc3N3b3JkOiBkYXRhLnBhc3N3b3JkXG4gIH0pO1xuICByZXR1cm4gY29tcGFyZTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrUGFzc3dvcmQodXNlcklkLCBjKSB7XG4gIGNvbnN0IGFjY291bnRzID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHModXNlcklkKTtcbiAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSBhY2NvdW50cz8uZmluZChcbiAgICAoYWNjb3VudCkgPT4gYWNjb3VudC5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIlxuICApO1xuICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBjcmVkZW50aWFsQWNjb3VudD8ucGFzc3dvcmQ7XG4gIGlmICghY3JlZGVudGlhbEFjY291bnQgfHwgIWN1cnJlbnRQYXNzd29yZCB8fCAhYy5ib2R5LnBhc3N3b3JkKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJObyBwYXNzd29yZCBjcmVkZW50aWFsIGZvdW5kXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBjb21wYXJlID0gYXdhaXQgYy5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgIHBhc3N3b3JkOiBjLmJvZHkucGFzc3dvcmRcbiAgfSk7XG4gIGlmICghY29tcGFyZSkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBwYXNzd29yZFwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCB7IGNoZWNrUGFzc3dvcmQgYXMgYywgdmFsaWRhdGVQYXNzd29yZCBhcyB2IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getAuthTables)\n/* harmony export */ });\nconst getAuthTables = (options) => {\n  const pluginSchema = (options.plugins ?? []).reduce(\n    (acc, plugin) => {\n      const schema = plugin.schema;\n      if (!schema) return acc;\n      for (const [key, value] of Object.entries(schema)) {\n        acc[key] = {\n          fields: {\n            ...acc[key]?.fields,\n            ...value.fields\n          },\n          modelName: value.modelName || key\n        };\n      }\n      return acc;\n    },\n    {}\n  );\n  const shouldAddRateLimitTable = options.rateLimit?.storage === \"database\";\n  const rateLimitTable = {\n    rateLimit: {\n      modelName: options.rateLimit?.modelName || \"rateLimit\",\n      fields: {\n        key: {\n          type: \"string\",\n          fieldName: options.rateLimit?.fields?.key || \"key\"\n        },\n        count: {\n          type: \"number\",\n          fieldName: options.rateLimit?.fields?.count || \"count\"\n        },\n        lastRequest: {\n          type: \"number\",\n          bigint: true,\n          fieldName: options.rateLimit?.fields?.lastRequest || \"lastRequest\"\n        }\n      }\n    }\n  };\n  const { user, session, account, ...pluginTables } = pluginSchema;\n  const sessionTable = {\n    session: {\n      modelName: options.session?.modelName || \"session\",\n      fields: {\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.expiresAt || \"expiresAt\"\n        },\n        token: {\n          type: \"string\",\n          required: true,\n          fieldName: options.session?.fields?.token || \"token\",\n          unique: true\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.createdAt || \"createdAt\",\n          defaultValue: () => /* @__PURE__ */ new Date()\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.updatedAt || \"updatedAt\",\n          onUpdate: () => /* @__PURE__ */ new Date()\n        },\n        ipAddress: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.ipAddress || \"ipAddress\"\n        },\n        userAgent: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.userAgent || \"userAgent\"\n        },\n        userId: {\n          type: \"string\",\n          fieldName: options.session?.fields?.userId || \"userId\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true\n        },\n        ...session?.fields,\n        ...options.session?.additionalFields\n      },\n      order: 2\n    }\n  };\n  return {\n    user: {\n      modelName: options.user?.modelName || \"user\",\n      fields: {\n        name: {\n          type: \"string\",\n          required: true,\n          fieldName: options.user?.fields?.name || \"name\",\n          sortable: true\n        },\n        email: {\n          type: \"string\",\n          unique: true,\n          required: true,\n          fieldName: options.user?.fields?.email || \"email\",\n          sortable: true\n        },\n        emailVerified: {\n          type: \"boolean\",\n          defaultValue: false,\n          required: true,\n          fieldName: options.user?.fields?.emailVerified || \"emailVerified\",\n          input: false\n        },\n        image: {\n          type: \"string\",\n          required: false,\n          fieldName: options.user?.fields?.image || \"image\"\n        },\n        createdAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          onUpdate: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...user?.fields,\n        ...options.user?.additionalFields\n      },\n      order: 1\n    },\n    //only add session table if it's not stored in secondary storage\n    ...!options.secondaryStorage || options.session?.storeSessionInDatabase ? sessionTable : {},\n    account: {\n      modelName: options.account?.modelName || \"account\",\n      fields: {\n        accountId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.accountId || \"accountId\"\n        },\n        providerId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.providerId || \"providerId\"\n        },\n        userId: {\n          type: \"string\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true,\n          fieldName: options.account?.fields?.userId || \"userId\"\n        },\n        accessToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.accessToken || \"accessToken\"\n        },\n        refreshToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.refreshToken || \"refreshToken\"\n        },\n        idToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.idToken || \"idToken\"\n        },\n        accessTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"accessTokenExpiresAt\"\n        },\n        refreshTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.refreshTokenExpiresAt || \"refreshTokenExpiresAt\"\n        },\n        scope: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.scope || \"scope\"\n        },\n        password: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.password || \"password\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.createdAt || \"createdAt\",\n          defaultValue: () => /* @__PURE__ */ new Date()\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.updatedAt || \"updatedAt\",\n          onUpdate: () => /* @__PURE__ */ new Date()\n        },\n        ...account?.fields,\n        ...options.account?.additionalFields\n      },\n      order: 3\n    },\n    verification: {\n      modelName: options.verification?.modelName || \"verification\",\n      fields: {\n        identifier: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.identifier || \"identifier\"\n        },\n        value: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.value || \"value\"\n        },\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.verification?.fields?.expiresAt || \"expiresAt\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          onUpdate: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.updatedAt || \"updatedAt\"\n        }\n      },\n      order: 4\n    },\n    ...pluginTables,\n    ...shouldAddRateLimitTable ? rateLimitTable : {}\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4zLjM0X25leHRAMTQuXzcwN2QyMWJjN2EwMWViMDI1YjE1NTRiODllZGJjNjIxL25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3NoYXJlZC9iZXR0ZXItYXV0aC5wUWplUmt6Ti5tanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSwwQ0FBMEM7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQSwrRkFBK0Y7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFOEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXdzLWh1Yi8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjMuMzRfbmV4dEAxNC5fNzA3ZDIxYmM3YTAxZWIwMjViMTU1NGI4OWVkYmM2MjEvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3Qvc2hhcmVkL2JldHRlci1hdXRoLnBRamVSa3pOLm1qcz8wOTQ3Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGdldEF1dGhUYWJsZXMgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBwbHVnaW5TY2hlbWEgPSAob3B0aW9ucy5wbHVnaW5zID8/IFtdKS5yZWR1Y2UoXG4gICAgKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgICBjb25zdCBzY2hlbWEgPSBwbHVnaW4uc2NoZW1hO1xuICAgICAgaWYgKCFzY2hlbWEpIHJldHVybiBhY2M7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEpKSB7XG4gICAgICAgIGFjY1trZXldID0ge1xuICAgICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgLi4uYWNjW2tleV0/LmZpZWxkcyxcbiAgICAgICAgICAgIC4uLnZhbHVlLmZpZWxkc1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbW9kZWxOYW1lOiB2YWx1ZS5tb2RlbE5hbWUgfHwga2V5XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sXG4gICAge31cbiAgKTtcbiAgY29uc3Qgc2hvdWxkQWRkUmF0ZUxpbWl0VGFibGUgPSBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSA9PT0gXCJkYXRhYmFzZVwiO1xuICBjb25zdCByYXRlTGltaXRUYWJsZSA9IHtcbiAgICByYXRlTGltaXQ6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/Lm1vZGVsTmFtZSB8fCBcInJhdGVMaW1pdFwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGtleToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5rZXkgfHwgXCJrZXlcIlxuICAgICAgICB9LFxuICAgICAgICBjb3VudDoge1xuICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5jb3VudCB8fCBcImNvdW50XCJcbiAgICAgICAgfSxcbiAgICAgICAgbGFzdFJlcXVlc3Q6IHtcbiAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgIGJpZ2ludDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5maWVsZHM/Lmxhc3RSZXF1ZXN0IHx8IFwibGFzdFJlcXVlc3RcIlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCB7IHVzZXIsIHNlc3Npb24sIGFjY291bnQsIC4uLnBsdWdpblRhYmxlcyB9ID0gcGx1Z2luU2NoZW1hO1xuICBjb25zdCBzZXNzaW9uVGFibGUgPSB7XG4gICAgc2Vzc2lvbjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnNlc3Npb24/Lm1vZGVsTmFtZSB8fCBcInNlc3Npb25cIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5leHBpcmVzQXQgfHwgXCJleHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICB0b2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udG9rZW4gfHwgXCJ0b2tlblwiLFxuICAgICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiLFxuICAgICAgICAgIG9uVXBkYXRlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBpcEFkZHJlc3M6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5pcEFkZHJlc3MgfHwgXCJpcEFkZHJlc3NcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VyQWdlbnQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy51c2VyQWdlbnQgfHwgXCJ1c2VyQWdlbnRcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnVzZXJJZCB8fCBcInVzZXJJZFwiLFxuICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICBvbkRlbGV0ZTogXCJjYXNjYWRlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIC4uLnNlc3Npb24/LmZpZWxkcyxcbiAgICAgICAgLi4ub3B0aW9ucy5zZXNzaW9uPy5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9LFxuICAgICAgb3JkZXI6IDJcbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgdXNlcjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5uYW1lIHx8IFwibmFtZVwiLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uZW1haWwgfHwgXCJlbWFpbFwiLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy51c2VyPy5maWVsZHM/LmVtYWlsVmVyaWZpZWQgfHwgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgaW5wdXQ6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uaW1hZ2UgfHwgXCJpbWFnZVwiXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uY3JlYXRlZEF0IHx8IFwiY3JlYXRlZEF0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICBvblVwZGF0ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCJcbiAgICAgICAgfSxcbiAgICAgICAgLi4udXNlcj8uZmllbGRzLFxuICAgICAgICAuLi5vcHRpb25zLnVzZXI/LmFkZGl0aW9uYWxGaWVsZHNcbiAgICAgIH0sXG4gICAgICBvcmRlcjogMVxuICAgIH0sXG4gICAgLy9vbmx5IGFkZCBzZXNzaW9uIHRhYmxlIGlmIGl0J3Mgbm90IHN0b3JlZCBpbiBzZWNvbmRhcnkgc3RvcmFnZVxuICAgIC4uLiFvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2UgfHwgb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlID8gc2Vzc2lvblRhYmxlIDoge30sXG4gICAgYWNjb3VudDoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLmFjY291bnQ/Lm1vZGVsTmFtZSB8fCBcImFjY291bnRcIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBhY2NvdW50SWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmFjY291bnRJZCB8fCBcImFjY291bnRJZFwiXG4gICAgICAgIH0sXG4gICAgICAgIHByb3ZpZGVySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnByb3ZpZGVySWQgfHwgXCJwcm92aWRlcklkXCJcbiAgICAgICAgfSxcbiAgICAgICAgdXNlcklkOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICBtb2RlbDogb3B0aW9ucy51c2VyPy5tb2RlbE5hbWUgfHwgXCJ1c2VyXCIsXG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgb25EZWxldGU6IFwiY2FzY2FkZVwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy51c2VySWQgfHwgXCJ1c2VySWRcIlxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NUb2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmFjY2Vzc1Rva2VuIHx8IFwiYWNjZXNzVG9rZW5cIlxuICAgICAgICB9LFxuICAgICAgICByZWZyZXNoVG9rZW46IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5yZWZyZXNoVG9rZW4gfHwgXCJyZWZyZXNoVG9rZW5cIlxuICAgICAgICB9LFxuICAgICAgICBpZFRva2VuOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uaWRUb2tlbiB8fCBcImlkVG9rZW5cIlxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCB8fCBcImFjY2Vzc1Rva2VuRXhwaXJlc0F0XCJcbiAgICAgICAgfSxcbiAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnJlZnJlc2hUb2tlbkV4cGlyZXNBdCB8fCBcInJlZnJlc2hUb2tlbkV4cGlyZXNBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uc2NvcGUgfHwgXCJzY29wZVwiXG4gICAgICAgIH0sXG4gICAgICAgIHBhc3N3b3JkOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucGFzc3dvcmQgfHwgXCJwYXNzd29yZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmNyZWF0ZWRBdCB8fCBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCIsXG4gICAgICAgICAgb25VcGRhdGU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIC4uLmFjY291bnQ/LmZpZWxkcyxcbiAgICAgICAgLi4ub3B0aW9ucy5hY2NvdW50Py5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9LFxuICAgICAgb3JkZXI6IDNcbiAgICB9LFxuICAgIHZlcmlmaWNhdGlvbjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8ubW9kZWxOYW1lIHx8IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICBmaWVsZHM6IHtcbiAgICAgICAgaWRlbnRpZmllcjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZmllbGRzPy5pZGVudGlmaWVyIHx8IFwiaWRlbnRpZmllclwiXG4gICAgICAgIH0sXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LnZhbHVlIHx8IFwidmFsdWVcIlxuICAgICAgICB9LFxuICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmV4cGlyZXNBdCB8fCBcImV4cGlyZXNBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIG9uVXBkYXRlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvcmRlcjogNFxuICAgIH0sXG4gICAgLi4ucGx1Z2luVGFibGVzLFxuICAgIC4uLnNob3VsZEFkZFJhdGVMaW1pdFRhYmxlID8gcmF0ZUxpbWl0VGFibGUgOiB7fVxuICB9O1xufTtcblxuZXhwb3J0IHsgZ2V0QXV0aFRhYmxlcyBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.3.34_next@14._707d21bc7a01eb025b1554b89edbc621/node_modules/better-auth/dist/shared/better-auth.pQjeRkzN.mjs\n");

/***/ })

};
;